"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
exports.id = "vendor-chunks/better-auth";
exports.ids = ["vendor-chunks/better-auth"];
exports.modules = {

/***/ "(rsc)/./node_modules/better-auth/dist/adapters/drizzle-adapter/index.mjs":
/*!**************************************************************************!*\
  !*** ./node_modules/better-auth/dist/adapters/drizzle-adapter/index.mjs ***!
  \**************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   drizzleAdapter: () => (/* binding */ drizzleAdapter)\n/* harmony export */ });\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/sql/sql.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/sql/expressions/select.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/sql/expressions/conditions.js\");\n/* harmony import */ var drizzle_orm__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! drizzle-orm */ \"(rsc)/./node_modules/drizzle-orm/sql/functions/aggregate.js\");\n/* harmony import */ var _shared_better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/better-auth.DdzSJf-n.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DdzSJf-n.mjs\");\n/* harmony import */ var _shared_better_auth_DOXaXTC6_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../shared/better-auth.DOXaXTC6.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DOXaXTC6.mjs\");\n/* harmony import */ var _shared_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../shared/better-auth.BZZKN1g7.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BZZKN1g7.mjs\");\n/* harmony import */ var _shared_better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../shared/better-auth.BjBlybv-.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BjBlybv-.mjs\");\n/* harmony import */ var _shared_better_auth_B_PTVODM_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../shared/better-auth.B_PTVODM.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B_PTVODM.mjs\");\n/* harmony import */ var _shared_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../shared/better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var zod_v4__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! zod/v4 */ \"(rsc)/./node_modules/zod/v4/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @better-auth/utils */ \"(rsc)/./node_modules/@better-auth/utils/dist/index.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _shared_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../shared/better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst drizzleAdapter = (db, config) => (0,_shared_better_auth_DOXaXTC6_mjs__WEBPACK_IMPORTED_MODULE_1__.c)({\n  config: {\n    adapterId: \"drizzle\",\n    adapterName: \"Drizzle Adapter\",\n    usePlural: config.usePlural ?? false,\n    debugLogs: config.debugLogs ?? false\n  },\n  adapter: ({ getFieldName, debugLog }) => {\n    function getSchema(model) {\n      const schema = config.schema || db._.fullSchema;\n      if (!schema) {\n        throw new _shared_better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_0__.B(\n          \"Drizzle adapter failed to initialize. Schema not found. Please provide a schema object in the adapter options object.\"\n        );\n      }\n      const schemaModel = schema[model];\n      if (!schemaModel) {\n        throw new _shared_better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_0__.B(\n          `[# Drizzle Adapter]: The model \"${model}\" was not found in the schema object. Please pass the schema directly to the adapter options.`\n        );\n      }\n      return schemaModel;\n    }\n    const withReturning = async (model, builder, data, where) => {\n      if (config.provider !== \"mysql\") {\n        const c = await builder.returning();\n        return c[0];\n      }\n      await builder.execute();\n      const schemaModel = getSchema(model);\n      const builderVal = builder.config?.values;\n      if (where?.length) {\n        const clause = convertWhereClause(where, model);\n        const res = await db.select().from(schemaModel).where(...clause);\n        return res[0];\n      } else if (builderVal && builderVal[0]?.id?.value) {\n        let tId = builderVal[0]?.id?.value;\n        if (!tId) {\n          const lastInsertId = await db.select({ id: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_14__.sql)`LAST_INSERT_ID()` }).from(schemaModel).orderBy((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_15__.desc)(schemaModel.id)).limit(1);\n          tId = lastInsertId[0].id;\n        }\n        const res = await db.select().from(schemaModel).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.eq)(schemaModel.id, tId)).limit(1).execute();\n        return res[0];\n      } else if (data.id) {\n        const res = await db.select().from(schemaModel).where((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.eq)(schemaModel.id, data.id)).limit(1).execute();\n        return res[0];\n      } else {\n        if (!(\"id\" in schemaModel)) {\n          throw new _shared_better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_0__.B(\n            `The model \"${model}\" does not have an \"id\" field. Please use the \"id\" field as your primary key.`\n          );\n        }\n        const res = await db.select().from(schemaModel).orderBy((0,drizzle_orm__WEBPACK_IMPORTED_MODULE_15__.desc)(schemaModel.id)).limit(1).execute();\n        return res[0];\n      }\n    };\n    function convertWhereClause(where, model) {\n      const schemaModel = getSchema(model);\n      if (!where) return [];\n      if (where.length === 1) {\n        const w = where[0];\n        if (!w) {\n          return [];\n        }\n        const field = getFieldName({ model, field: w.field });\n        if (!schemaModel[field]) {\n          throw new _shared_better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_0__.B(\n            `The field \"${w.field}\" does not exist in the schema for the model \"${model}\". Please update your schema.`\n          );\n        }\n        if (w.operator === \"in\") {\n          if (!Array.isArray(w.value)) {\n            throw new _shared_better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_0__.B(\n              `The value for the field \"${w.field}\" must be an array when using the \"in\" operator.`\n            );\n          }\n          return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.inArray)(schemaModel[field], w.value)];\n        }\n        if (w.operator === \"not_in\") {\n          if (!Array.isArray(w.value)) {\n            throw new _shared_better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_0__.B(\n              `The value for the field \"${w.field}\" must be an array when using the \"not_in\" operator.`\n            );\n          }\n          return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.notInArray)(schemaModel[field], w.value)];\n        }\n        if (w.operator === \"contains\") {\n          return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.like)(schemaModel[field], `%${w.value}%`)];\n        }\n        if (w.operator === \"starts_with\") {\n          return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.like)(schemaModel[field], `${w.value}%`)];\n        }\n        if (w.operator === \"ends_with\") {\n          return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.like)(schemaModel[field], `%${w.value}`)];\n        }\n        if (w.operator === \"lt\") {\n          return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.lt)(schemaModel[field], w.value)];\n        }\n        if (w.operator === \"lte\") {\n          return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.lte)(schemaModel[field], w.value)];\n        }\n        if (w.operator === \"ne\") {\n          return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.ne)(schemaModel[field], w.value)];\n        }\n        if (w.operator === \"gt\") {\n          return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.gt)(schemaModel[field], w.value)];\n        }\n        if (w.operator === \"gte\") {\n          return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.gte)(schemaModel[field], w.value)];\n        }\n        return [(0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.eq)(schemaModel[field], w.value)];\n      }\n      const andGroup = where.filter(\n        (w) => w.connector === \"AND\" || !w.connector\n      );\n      const orGroup = where.filter((w) => w.connector === \"OR\");\n      const andClause = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.and)(\n        ...andGroup.map((w) => {\n          const field = getFieldName({ model, field: w.field });\n          if (w.operator === \"in\") {\n            if (!Array.isArray(w.value)) {\n              throw new _shared_better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_0__.B(\n                `The value for the field \"${w.field}\" must be an array when using the \"in\" operator.`\n              );\n            }\n            return (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.inArray)(schemaModel[field], w.value);\n          }\n          if (w.operator === \"not_in\") {\n            if (!Array.isArray(w.value)) {\n              throw new _shared_better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_0__.B(\n                `The value for the field \"${w.field}\" must be an array when using the \"not_in\" operator.`\n              );\n            }\n            return (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.notInArray)(schemaModel[field], w.value);\n          }\n          return (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.eq)(schemaModel[field], w.value);\n        })\n      );\n      const orClause = (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.or)(\n        ...orGroup.map((w) => {\n          const field = getFieldName({ model, field: w.field });\n          return (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_16__.eq)(schemaModel[field], w.value);\n        })\n      );\n      const clause = [];\n      if (andGroup.length) clause.push(andClause);\n      if (orGroup.length) clause.push(orClause);\n      return clause;\n    }\n    function checkMissingFields(schema, model, values) {\n      if (!schema) {\n        throw new _shared_better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_0__.B(\n          \"Drizzle adapter failed to initialize. Schema not found. Please provide a schema object in the adapter options object.\"\n        );\n      }\n      for (const key in values) {\n        if (!schema[key]) {\n          throw new _shared_better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_0__.B(\n            `The field \"${key}\" does not exist in the \"${model}\" schema. Please update your drizzle schema or re-generate using \"npx @better-auth/cli generate\".`\n          );\n        }\n      }\n    }\n    return {\n      async create({ model, data: values }) {\n        const schemaModel = getSchema(model);\n        checkMissingFields(schemaModel, model, values);\n        const builder = db.insert(schemaModel).values(values);\n        const returned = await withReturning(model, builder, values);\n        return returned;\n      },\n      async findOne({ model, where }) {\n        const schemaModel = getSchema(model);\n        const clause = convertWhereClause(where, model);\n        const res = await db.select().from(schemaModel).where(...clause);\n        if (!res.length) return null;\n        return res[0];\n      },\n      async findMany({ model, where, sortBy, limit, offset }) {\n        const schemaModel = getSchema(model);\n        const clause = where ? convertWhereClause(where, model) : [];\n        const sortFn = sortBy?.direction === \"desc\" ? drizzle_orm__WEBPACK_IMPORTED_MODULE_15__.desc : drizzle_orm__WEBPACK_IMPORTED_MODULE_15__.asc;\n        const builder = db.select().from(schemaModel).limit(limit || 100).offset(offset || 0);\n        if (sortBy?.field) {\n          builder.orderBy(\n            sortFn(\n              schemaModel[getFieldName({ model, field: sortBy?.field })]\n            )\n          );\n        }\n        return await builder.where(...clause);\n      },\n      async count({ model, where }) {\n        const schemaModel = getSchema(model);\n        const clause = where ? convertWhereClause(where, model) : [];\n        const res = await db.select({ count: (0,drizzle_orm__WEBPACK_IMPORTED_MODULE_17__.count)() }).from(schemaModel).where(...clause);\n        return res[0].count;\n      },\n      async update({ model, where, update: values }) {\n        const schemaModel = getSchema(model);\n        const clause = convertWhereClause(where, model);\n        const builder = db.update(schemaModel).set(values).where(...clause);\n        return await withReturning(model, builder, values, where);\n      },\n      async updateMany({ model, where, update: values }) {\n        const schemaModel = getSchema(model);\n        const clause = convertWhereClause(where, model);\n        const builder = db.update(schemaModel).set(values).where(...clause);\n        return await builder;\n      },\n      async delete({ model, where }) {\n        const schemaModel = getSchema(model);\n        const clause = convertWhereClause(where, model);\n        const builder = db.delete(schemaModel).where(...clause);\n        return await builder;\n      },\n      async deleteMany({ model, where }) {\n        const schemaModel = getSchema(model);\n        const clause = convertWhereClause(where, model);\n        const builder = db.delete(schemaModel).where(...clause);\n        return await builder;\n      },\n      options: config\n    };\n  }\n});\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9hZGFwdGVycy9kcml6emxlLWFkYXB0ZXIvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBa0g7QUFDckM7QUFDRjtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNaO0FBQ25CO0FBQ0s7QUFDWTtBQUNDO0FBQ0Q7QUFDRTtBQUNyQjtBQUNtQjtBQUNMO0FBQ0k7QUFDQTtBQUNlOztBQUUvQyx1Q0FBdUMsbUVBQWE7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSCxjQUFjLHdCQUF3QjtBQUN0QztBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsK0RBQWU7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiwrREFBZTtBQUNqQyw2Q0FBNkMsTUFBTTtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0EsaURBQWlELElBQUksaURBQUcsb0JBQW9CLDRCQUE0QixrREFBSTtBQUM1RztBQUNBO0FBQ0EsOERBQThELGdEQUFFO0FBQ2hFO0FBQ0EsUUFBUTtBQUNSLDhEQUE4RCxnREFBRTtBQUNoRTtBQUNBLFFBQVE7QUFDUjtBQUNBLG9CQUFvQiwrREFBZTtBQUNuQywwQkFBMEIsTUFBTTtBQUNoQztBQUNBO0FBQ0EsZ0VBQWdFLGtEQUFJO0FBQ3BFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsdUJBQXVCO0FBQzVEO0FBQ0Esb0JBQW9CLCtEQUFlO0FBQ25DLDBCQUEwQixRQUFRLGdEQUFnRCxNQUFNO0FBQ3hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLCtEQUFlO0FBQ3JDLDBDQUEwQyxRQUFRO0FBQ2xEO0FBQ0E7QUFDQSxrQkFBa0IscURBQU87QUFDekI7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLCtEQUFlO0FBQ3JDLDBDQUEwQyxRQUFRO0FBQ2xEO0FBQ0E7QUFDQSxrQkFBa0Isd0RBQVU7QUFDNUI7QUFDQTtBQUNBLGtCQUFrQixrREFBSSx5QkFBeUIsUUFBUTtBQUN2RDtBQUNBO0FBQ0Esa0JBQWtCLGtEQUFJLHdCQUF3QixRQUFRO0FBQ3REO0FBQ0E7QUFDQSxrQkFBa0Isa0RBQUkseUJBQXlCLFFBQVE7QUFDdkQ7QUFDQTtBQUNBLGtCQUFrQixnREFBRTtBQUNwQjtBQUNBO0FBQ0Esa0JBQWtCLGlEQUFHO0FBQ3JCO0FBQ0E7QUFDQSxrQkFBa0IsZ0RBQUU7QUFDcEI7QUFDQTtBQUNBLGtCQUFrQixnREFBRTtBQUNwQjtBQUNBO0FBQ0Esa0JBQWtCLGlEQUFHO0FBQ3JCO0FBQ0EsZ0JBQWdCLGdEQUFFO0FBQ2xCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsaURBQUc7QUFDM0I7QUFDQSx1Q0FBdUMsdUJBQXVCO0FBQzlEO0FBQ0E7QUFDQSx3QkFBd0IsK0RBQWU7QUFDdkMsNENBQTRDLFFBQVE7QUFDcEQ7QUFDQTtBQUNBLG1CQUFtQixxREFBTztBQUMxQjtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsK0RBQWU7QUFDdkMsNENBQTRDLFFBQVE7QUFDcEQ7QUFDQTtBQUNBLG1CQUFtQix3REFBVTtBQUM3QjtBQUNBLGlCQUFpQixnREFBRTtBQUNuQixTQUFTO0FBQ1Q7QUFDQSx1QkFBdUIsZ0RBQUU7QUFDekI7QUFDQSx1Q0FBdUMsdUJBQXVCO0FBQzlELGlCQUFpQixnREFBRTtBQUNuQixTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQiwrREFBZTtBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLCtEQUFlO0FBQ25DLDBCQUEwQixJQUFJLDJCQUEyQixNQUFNO0FBQy9EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUIscUJBQXFCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1Asc0JBQXNCLGNBQWM7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCx1QkFBdUIscUNBQXFDO0FBQzVEO0FBQ0E7QUFDQSxzREFBc0QsOENBQUksR0FBRyw2Q0FBRztBQUNoRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5Qyw2QkFBNkI7QUFDdEU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1Asb0JBQW9CLGNBQWM7QUFDbEM7QUFDQTtBQUNBLHNDQUFzQyxPQUFPLG1EQUFLLElBQUk7QUFDdEQ7QUFDQSxPQUFPO0FBQ1AscUJBQXFCLDhCQUE4QjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCx5QkFBeUIsOEJBQThCO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLHFCQUFxQixjQUFjO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLHlCQUF5QixjQUFjO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRXlCIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxhZGFwdGVyc1xcZHJpenpsZS1hZGFwdGVyXFxpbmRleC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY291bnQsIGRlc2MsIGFzYywgc3FsLCBlcSwgaW5BcnJheSwgbm90SW5BcnJheSwgbGlrZSwgbHQsIGx0ZSwgbmUsIGd0LCBndGUsIGFuZCwgb3IgfSBmcm9tICdkcml6emxlLW9ybSc7XG5pbXBvcnQgeyBCIGFzIEJldHRlckF1dGhFcnJvciB9IGZyb20gJy4uLy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5EZHpTSmYtbi5tanMnO1xuaW1wb3J0IHsgYyBhcyBjcmVhdGVBZGFwdGVyIH0gZnJvbSAnLi4vLi4vc2hhcmVkL2JldHRlci1hdXRoLkRPWGFYVEM2Lm1qcyc7XG5pbXBvcnQgJy4uLy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5CWlpLTjFnNy5tanMnO1xuaW1wb3J0ICcuLi8uLi9zaGFyZWQvYmV0dGVyLWF1dGguQmpCbHlidi0ubWpzJztcbmltcG9ydCAnLi4vLi4vc2hhcmVkL2JldHRlci1hdXRoLkJfUFRWT0RNLm1qcyc7XG5pbXBvcnQgJy4uLy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5CVVBQUlhmSy5tanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvcmFuZG9tJztcbmltcG9ydCAnem9kL3Y0JztcbmltcG9ydCAnYmV0dGVyLWNhbGwnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaGFzaCc7XG5pbXBvcnQgJ0Bub2JsZS9jaXBoZXJzL2NoYWNoYS5qcyc7XG5pbXBvcnQgJ0Bub2JsZS9jaXBoZXJzL3V0aWxzLmpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2Jhc2U2NCc7XG5pbXBvcnQgJ2pvc2UnO1xuaW1wb3J0ICdAbm9ibGUvaGFzaGVzL3NjcnlwdC5qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9oZXgnO1xuaW1wb3J0ICdAbm9ibGUvaGFzaGVzL3V0aWxzLmpzJztcbmltcG9ydCAnLi4vLi4vc2hhcmVkL2JldHRlci1hdXRoLkI0UW94ZGdjLm1qcyc7XG5cbmNvbnN0IGRyaXp6bGVBZGFwdGVyID0gKGRiLCBjb25maWcpID0+IGNyZWF0ZUFkYXB0ZXIoe1xuICBjb25maWc6IHtcbiAgICBhZGFwdGVySWQ6IFwiZHJpenpsZVwiLFxuICAgIGFkYXB0ZXJOYW1lOiBcIkRyaXp6bGUgQWRhcHRlclwiLFxuICAgIHVzZVBsdXJhbDogY29uZmlnLnVzZVBsdXJhbCA/PyBmYWxzZSxcbiAgICBkZWJ1Z0xvZ3M6IGNvbmZpZy5kZWJ1Z0xvZ3MgPz8gZmFsc2VcbiAgfSxcbiAgYWRhcHRlcjogKHsgZ2V0RmllbGROYW1lLCBkZWJ1Z0xvZyB9KSA9PiB7XG4gICAgZnVuY3Rpb24gZ2V0U2NoZW1hKG1vZGVsKSB7XG4gICAgICBjb25zdCBzY2hlbWEgPSBjb25maWcuc2NoZW1hIHx8IGRiLl8uZnVsbFNjaGVtYTtcbiAgICAgIGlmICghc2NoZW1hKSB7XG4gICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXG4gICAgICAgICAgXCJEcml6emxlIGFkYXB0ZXIgZmFpbGVkIHRvIGluaXRpYWxpemUuIFNjaGVtYSBub3QgZm91bmQuIFBsZWFzZSBwcm92aWRlIGEgc2NoZW1hIG9iamVjdCBpbiB0aGUgYWRhcHRlciBvcHRpb25zIG9iamVjdC5cIlxuICAgICAgICApO1xuICAgICAgfVxuICAgICAgY29uc3Qgc2NoZW1hTW9kZWwgPSBzY2hlbWFbbW9kZWxdO1xuICAgICAgaWYgKCFzY2hlbWFNb2RlbCkge1xuICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgICAgIGBbIyBEcml6emxlIEFkYXB0ZXJdOiBUaGUgbW9kZWwgXCIke21vZGVsfVwiIHdhcyBub3QgZm91bmQgaW4gdGhlIHNjaGVtYSBvYmplY3QuIFBsZWFzZSBwYXNzIHRoZSBzY2hlbWEgZGlyZWN0bHkgdG8gdGhlIGFkYXB0ZXIgb3B0aW9ucy5gXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICByZXR1cm4gc2NoZW1hTW9kZWw7XG4gICAgfVxuICAgIGNvbnN0IHdpdGhSZXR1cm5pbmcgPSBhc3luYyAobW9kZWwsIGJ1aWxkZXIsIGRhdGEsIHdoZXJlKSA9PiB7XG4gICAgICBpZiAoY29uZmlnLnByb3ZpZGVyICE9PSBcIm15c3FsXCIpIHtcbiAgICAgICAgY29uc3QgYyA9IGF3YWl0IGJ1aWxkZXIucmV0dXJuaW5nKCk7XG4gICAgICAgIHJldHVybiBjWzBdO1xuICAgICAgfVxuICAgICAgYXdhaXQgYnVpbGRlci5leGVjdXRlKCk7XG4gICAgICBjb25zdCBzY2hlbWFNb2RlbCA9IGdldFNjaGVtYShtb2RlbCk7XG4gICAgICBjb25zdCBidWlsZGVyVmFsID0gYnVpbGRlci5jb25maWc/LnZhbHVlcztcbiAgICAgIGlmICh3aGVyZT8ubGVuZ3RoKSB7XG4gICAgICAgIGNvbnN0IGNsYXVzZSA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpO1xuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBkYi5zZWxlY3QoKS5mcm9tKHNjaGVtYU1vZGVsKS53aGVyZSguLi5jbGF1c2UpO1xuICAgICAgICByZXR1cm4gcmVzWzBdO1xuICAgICAgfSBlbHNlIGlmIChidWlsZGVyVmFsICYmIGJ1aWxkZXJWYWxbMF0/LmlkPy52YWx1ZSkge1xuICAgICAgICBsZXQgdElkID0gYnVpbGRlclZhbFswXT8uaWQ/LnZhbHVlO1xuICAgICAgICBpZiAoIXRJZCkge1xuICAgICAgICAgIGNvbnN0IGxhc3RJbnNlcnRJZCA9IGF3YWl0IGRiLnNlbGVjdCh7IGlkOiBzcWxgTEFTVF9JTlNFUlRfSUQoKWAgfSkuZnJvbShzY2hlbWFNb2RlbCkub3JkZXJCeShkZXNjKHNjaGVtYU1vZGVsLmlkKSkubGltaXQoMSk7XG4gICAgICAgICAgdElkID0gbGFzdEluc2VydElkWzBdLmlkO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGRiLnNlbGVjdCgpLmZyb20oc2NoZW1hTW9kZWwpLndoZXJlKGVxKHNjaGVtYU1vZGVsLmlkLCB0SWQpKS5saW1pdCgxKS5leGVjdXRlKCk7XG4gICAgICAgIHJldHVybiByZXNbMF07XG4gICAgICB9IGVsc2UgaWYgKGRhdGEuaWQpIHtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZGIuc2VsZWN0KCkuZnJvbShzY2hlbWFNb2RlbCkud2hlcmUoZXEoc2NoZW1hTW9kZWwuaWQsIGRhdGEuaWQpKS5saW1pdCgxKS5leGVjdXRlKCk7XG4gICAgICAgIHJldHVybiByZXNbMF07XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoIShcImlkXCIgaW4gc2NoZW1hTW9kZWwpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgICAgIGBUaGUgbW9kZWwgXCIke21vZGVsfVwiIGRvZXMgbm90IGhhdmUgYW4gXCJpZFwiIGZpZWxkLiBQbGVhc2UgdXNlIHRoZSBcImlkXCIgZmllbGQgYXMgeW91ciBwcmltYXJ5IGtleS5gXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBkYi5zZWxlY3QoKS5mcm9tKHNjaGVtYU1vZGVsKS5vcmRlckJ5KGRlc2Moc2NoZW1hTW9kZWwuaWQpKS5saW1pdCgxKS5leGVjdXRlKCk7XG4gICAgICAgIHJldHVybiByZXNbMF07XG4gICAgICB9XG4gICAgfTtcbiAgICBmdW5jdGlvbiBjb252ZXJ0V2hlcmVDbGF1c2Uod2hlcmUsIG1vZGVsKSB7XG4gICAgICBjb25zdCBzY2hlbWFNb2RlbCA9IGdldFNjaGVtYShtb2RlbCk7XG4gICAgICBpZiAoIXdoZXJlKSByZXR1cm4gW107XG4gICAgICBpZiAod2hlcmUubGVuZ3RoID09PSAxKSB7XG4gICAgICAgIGNvbnN0IHcgPSB3aGVyZVswXTtcbiAgICAgICAgaWYgKCF3KSB7XG4gICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZpZWxkID0gZ2V0RmllbGROYW1lKHsgbW9kZWwsIGZpZWxkOiB3LmZpZWxkIH0pO1xuICAgICAgICBpZiAoIXNjaGVtYU1vZGVsW2ZpZWxkXSkge1xuICAgICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXG4gICAgICAgICAgICBgVGhlIGZpZWxkIFwiJHt3LmZpZWxkfVwiIGRvZXMgbm90IGV4aXN0IGluIHRoZSBzY2hlbWEgZm9yIHRoZSBtb2RlbCBcIiR7bW9kZWx9XCIuIFBsZWFzZSB1cGRhdGUgeW91ciBzY2hlbWEuYFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHcub3BlcmF0b3IgPT09IFwiaW5cIikge1xuICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh3LnZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgICAgICAgYFRoZSB2YWx1ZSBmb3IgdGhlIGZpZWxkIFwiJHt3LmZpZWxkfVwiIG11c3QgYmUgYW4gYXJyYXkgd2hlbiB1c2luZyB0aGUgXCJpblwiIG9wZXJhdG9yLmBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBbaW5BcnJheShzY2hlbWFNb2RlbFtmaWVsZF0sIHcudmFsdWUpXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAody5vcGVyYXRvciA9PT0gXCJub3RfaW5cIikge1xuICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh3LnZhbHVlKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgICAgICAgYFRoZSB2YWx1ZSBmb3IgdGhlIGZpZWxkIFwiJHt3LmZpZWxkfVwiIG11c3QgYmUgYW4gYXJyYXkgd2hlbiB1c2luZyB0aGUgXCJub3RfaW5cIiBvcGVyYXRvci5gXG4gICAgICAgICAgICApO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gW25vdEluQXJyYXkoc2NoZW1hTW9kZWxbZmllbGRdLCB3LnZhbHVlKV07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHcub3BlcmF0b3IgPT09IFwiY29udGFpbnNcIikge1xuICAgICAgICAgIHJldHVybiBbbGlrZShzY2hlbWFNb2RlbFtmaWVsZF0sIGAlJHt3LnZhbHVlfSVgKV07XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHcub3BlcmF0b3IgPT09IFwic3RhcnRzX3dpdGhcIikge1xuICAgICAgICAgIHJldHVybiBbbGlrZShzY2hlbWFNb2RlbFtmaWVsZF0sIGAke3cudmFsdWV9JWApXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAody5vcGVyYXRvciA9PT0gXCJlbmRzX3dpdGhcIikge1xuICAgICAgICAgIHJldHVybiBbbGlrZShzY2hlbWFNb2RlbFtmaWVsZF0sIGAlJHt3LnZhbHVlfWApXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAody5vcGVyYXRvciA9PT0gXCJsdFwiKSB7XG4gICAgICAgICAgcmV0dXJuIFtsdChzY2hlbWFNb2RlbFtmaWVsZF0sIHcudmFsdWUpXTtcbiAgICAgICAgfVxuICAgICAgICBpZiAody5vcGVyYXRvciA9PT0gXCJsdGVcIikge1xuICAgICAgICAgIHJldHVybiBbbHRlKHNjaGVtYU1vZGVsW2ZpZWxkXSwgdy52YWx1ZSldO1xuICAgICAgICB9XG4gICAgICAgIGlmICh3Lm9wZXJhdG9yID09PSBcIm5lXCIpIHtcbiAgICAgICAgICByZXR1cm4gW25lKHNjaGVtYU1vZGVsW2ZpZWxkXSwgdy52YWx1ZSldO1xuICAgICAgICB9XG4gICAgICAgIGlmICh3Lm9wZXJhdG9yID09PSBcImd0XCIpIHtcbiAgICAgICAgICByZXR1cm4gW2d0KHNjaGVtYU1vZGVsW2ZpZWxkXSwgdy52YWx1ZSldO1xuICAgICAgICB9XG4gICAgICAgIGlmICh3Lm9wZXJhdG9yID09PSBcImd0ZVwiKSB7XG4gICAgICAgICAgcmV0dXJuIFtndGUoc2NoZW1hTW9kZWxbZmllbGRdLCB3LnZhbHVlKV07XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIFtlcShzY2hlbWFNb2RlbFtmaWVsZF0sIHcudmFsdWUpXTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGFuZEdyb3VwID0gd2hlcmUuZmlsdGVyKFxuICAgICAgICAodykgPT4gdy5jb25uZWN0b3IgPT09IFwiQU5EXCIgfHwgIXcuY29ubmVjdG9yXG4gICAgICApO1xuICAgICAgY29uc3Qgb3JHcm91cCA9IHdoZXJlLmZpbHRlcigodykgPT4gdy5jb25uZWN0b3IgPT09IFwiT1JcIik7XG4gICAgICBjb25zdCBhbmRDbGF1c2UgPSBhbmQoXG4gICAgICAgIC4uLmFuZEdyb3VwLm1hcCgodykgPT4ge1xuICAgICAgICAgIGNvbnN0IGZpZWxkID0gZ2V0RmllbGROYW1lKHsgbW9kZWwsIGZpZWxkOiB3LmZpZWxkIH0pO1xuICAgICAgICAgIGlmICh3Lm9wZXJhdG9yID09PSBcImluXCIpIHtcbiAgICAgICAgICAgIGlmICghQXJyYXkuaXNBcnJheSh3LnZhbHVlKSkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgICAgICAgICAgIGBUaGUgdmFsdWUgZm9yIHRoZSBmaWVsZCBcIiR7dy5maWVsZH1cIiBtdXN0IGJlIGFuIGFycmF5IHdoZW4gdXNpbmcgdGhlIFwiaW5cIiBvcGVyYXRvci5gXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gaW5BcnJheShzY2hlbWFNb2RlbFtmaWVsZF0sIHcudmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAody5vcGVyYXRvciA9PT0gXCJub3RfaW5cIikge1xuICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHcudmFsdWUpKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXG4gICAgICAgICAgICAgICAgYFRoZSB2YWx1ZSBmb3IgdGhlIGZpZWxkIFwiJHt3LmZpZWxkfVwiIG11c3QgYmUgYW4gYXJyYXkgd2hlbiB1c2luZyB0aGUgXCJub3RfaW5cIiBvcGVyYXRvci5gXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gbm90SW5BcnJheShzY2hlbWFNb2RlbFtmaWVsZF0sIHcudmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZXEoc2NoZW1hTW9kZWxbZmllbGRdLCB3LnZhbHVlKTtcbiAgICAgICAgfSlcbiAgICAgICk7XG4gICAgICBjb25zdCBvckNsYXVzZSA9IG9yKFxuICAgICAgICAuLi5vckdyb3VwLm1hcCgodykgPT4ge1xuICAgICAgICAgIGNvbnN0IGZpZWxkID0gZ2V0RmllbGROYW1lKHsgbW9kZWwsIGZpZWxkOiB3LmZpZWxkIH0pO1xuICAgICAgICAgIHJldHVybiBlcShzY2hlbWFNb2RlbFtmaWVsZF0sIHcudmFsdWUpO1xuICAgICAgICB9KVxuICAgICAgKTtcbiAgICAgIGNvbnN0IGNsYXVzZSA9IFtdO1xuICAgICAgaWYgKGFuZEdyb3VwLmxlbmd0aCkgY2xhdXNlLnB1c2goYW5kQ2xhdXNlKTtcbiAgICAgIGlmIChvckdyb3VwLmxlbmd0aCkgY2xhdXNlLnB1c2gob3JDbGF1c2UpO1xuICAgICAgcmV0dXJuIGNsYXVzZTtcbiAgICB9XG4gICAgZnVuY3Rpb24gY2hlY2tNaXNzaW5nRmllbGRzKHNjaGVtYSwgbW9kZWwsIHZhbHVlcykge1xuICAgICAgaWYgKCFzY2hlbWEpIHtcbiAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgICBcIkRyaXp6bGUgYWRhcHRlciBmYWlsZWQgdG8gaW5pdGlhbGl6ZS4gU2NoZW1hIG5vdCBmb3VuZC4gUGxlYXNlIHByb3ZpZGUgYSBzY2hlbWEgb2JqZWN0IGluIHRoZSBhZGFwdGVyIG9wdGlvbnMgb2JqZWN0LlwiXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBmb3IgKGNvbnN0IGtleSBpbiB2YWx1ZXMpIHtcbiAgICAgICAgaWYgKCFzY2hlbWFba2V5XSkge1xuICAgICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXG4gICAgICAgICAgICBgVGhlIGZpZWxkIFwiJHtrZXl9XCIgZG9lcyBub3QgZXhpc3QgaW4gdGhlIFwiJHttb2RlbH1cIiBzY2hlbWEuIFBsZWFzZSB1cGRhdGUgeW91ciBkcml6emxlIHNjaGVtYSBvciByZS1nZW5lcmF0ZSB1c2luZyBcIm5weCBAYmV0dGVyLWF1dGgvY2xpIGdlbmVyYXRlXCIuYFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIGFzeW5jIGNyZWF0ZSh7IG1vZGVsLCBkYXRhOiB2YWx1ZXMgfSkge1xuICAgICAgICBjb25zdCBzY2hlbWFNb2RlbCA9IGdldFNjaGVtYShtb2RlbCk7XG4gICAgICAgIGNoZWNrTWlzc2luZ0ZpZWxkcyhzY2hlbWFNb2RlbCwgbW9kZWwsIHZhbHVlcyk7XG4gICAgICAgIGNvbnN0IGJ1aWxkZXIgPSBkYi5pbnNlcnQoc2NoZW1hTW9kZWwpLnZhbHVlcyh2YWx1ZXMpO1xuICAgICAgICBjb25zdCByZXR1cm5lZCA9IGF3YWl0IHdpdGhSZXR1cm5pbmcobW9kZWwsIGJ1aWxkZXIsIHZhbHVlcyk7XG4gICAgICAgIHJldHVybiByZXR1cm5lZDtcbiAgICAgIH0sXG4gICAgICBhc3luYyBmaW5kT25lKHsgbW9kZWwsIHdoZXJlIH0pIHtcbiAgICAgICAgY29uc3Qgc2NoZW1hTW9kZWwgPSBnZXRTY2hlbWEobW9kZWwpO1xuICAgICAgICBjb25zdCBjbGF1c2UgPSBjb252ZXJ0V2hlcmVDbGF1c2Uod2hlcmUsIG1vZGVsKTtcbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgZGIuc2VsZWN0KCkuZnJvbShzY2hlbWFNb2RlbCkud2hlcmUoLi4uY2xhdXNlKTtcbiAgICAgICAgaWYgKCFyZXMubGVuZ3RoKSByZXR1cm4gbnVsbDtcbiAgICAgICAgcmV0dXJuIHJlc1swXTtcbiAgICAgIH0sXG4gICAgICBhc3luYyBmaW5kTWFueSh7IG1vZGVsLCB3aGVyZSwgc29ydEJ5LCBsaW1pdCwgb2Zmc2V0IH0pIHtcbiAgICAgICAgY29uc3Qgc2NoZW1hTW9kZWwgPSBnZXRTY2hlbWEobW9kZWwpO1xuICAgICAgICBjb25zdCBjbGF1c2UgPSB3aGVyZSA/IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpIDogW107XG4gICAgICAgIGNvbnN0IHNvcnRGbiA9IHNvcnRCeT8uZGlyZWN0aW9uID09PSBcImRlc2NcIiA/IGRlc2MgOiBhc2M7XG4gICAgICAgIGNvbnN0IGJ1aWxkZXIgPSBkYi5zZWxlY3QoKS5mcm9tKHNjaGVtYU1vZGVsKS5saW1pdChsaW1pdCB8fCAxMDApLm9mZnNldChvZmZzZXQgfHwgMCk7XG4gICAgICAgIGlmIChzb3J0Qnk/LmZpZWxkKSB7XG4gICAgICAgICAgYnVpbGRlci5vcmRlckJ5KFxuICAgICAgICAgICAgc29ydEZuKFxuICAgICAgICAgICAgICBzY2hlbWFNb2RlbFtnZXRGaWVsZE5hbWUoeyBtb2RlbCwgZmllbGQ6IHNvcnRCeT8uZmllbGQgfSldXG4gICAgICAgICAgICApXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXdhaXQgYnVpbGRlci53aGVyZSguLi5jbGF1c2UpO1xuICAgICAgfSxcbiAgICAgIGFzeW5jIGNvdW50KHsgbW9kZWwsIHdoZXJlIH0pIHtcbiAgICAgICAgY29uc3Qgc2NoZW1hTW9kZWwgPSBnZXRTY2hlbWEobW9kZWwpO1xuICAgICAgICBjb25zdCBjbGF1c2UgPSB3aGVyZSA/IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpIDogW107XG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGRiLnNlbGVjdCh7IGNvdW50OiBjb3VudCgpIH0pLmZyb20oc2NoZW1hTW9kZWwpLndoZXJlKC4uLmNsYXVzZSk7XG4gICAgICAgIHJldHVybiByZXNbMF0uY291bnQ7XG4gICAgICB9LFxuICAgICAgYXN5bmMgdXBkYXRlKHsgbW9kZWwsIHdoZXJlLCB1cGRhdGU6IHZhbHVlcyB9KSB7XG4gICAgICAgIGNvbnN0IHNjaGVtYU1vZGVsID0gZ2V0U2NoZW1hKG1vZGVsKTtcbiAgICAgICAgY29uc3QgY2xhdXNlID0gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCBtb2RlbCk7XG4gICAgICAgIGNvbnN0IGJ1aWxkZXIgPSBkYi51cGRhdGUoc2NoZW1hTW9kZWwpLnNldCh2YWx1ZXMpLndoZXJlKC4uLmNsYXVzZSk7XG4gICAgICAgIHJldHVybiBhd2FpdCB3aXRoUmV0dXJuaW5nKG1vZGVsLCBidWlsZGVyLCB2YWx1ZXMsIHdoZXJlKTtcbiAgICAgIH0sXG4gICAgICBhc3luYyB1cGRhdGVNYW55KHsgbW9kZWwsIHdoZXJlLCB1cGRhdGU6IHZhbHVlcyB9KSB7XG4gICAgICAgIGNvbnN0IHNjaGVtYU1vZGVsID0gZ2V0U2NoZW1hKG1vZGVsKTtcbiAgICAgICAgY29uc3QgY2xhdXNlID0gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCBtb2RlbCk7XG4gICAgICAgIGNvbnN0IGJ1aWxkZXIgPSBkYi51cGRhdGUoc2NoZW1hTW9kZWwpLnNldCh2YWx1ZXMpLndoZXJlKC4uLmNsYXVzZSk7XG4gICAgICAgIHJldHVybiBhd2FpdCBidWlsZGVyO1xuICAgICAgfSxcbiAgICAgIGFzeW5jIGRlbGV0ZSh7IG1vZGVsLCB3aGVyZSB9KSB7XG4gICAgICAgIGNvbnN0IHNjaGVtYU1vZGVsID0gZ2V0U2NoZW1hKG1vZGVsKTtcbiAgICAgICAgY29uc3QgY2xhdXNlID0gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCBtb2RlbCk7XG4gICAgICAgIGNvbnN0IGJ1aWxkZXIgPSBkYi5kZWxldGUoc2NoZW1hTW9kZWwpLndoZXJlKC4uLmNsYXVzZSk7XG4gICAgICAgIHJldHVybiBhd2FpdCBidWlsZGVyO1xuICAgICAgfSxcbiAgICAgIGFzeW5jIGRlbGV0ZU1hbnkoeyBtb2RlbCwgd2hlcmUgfSkge1xuICAgICAgICBjb25zdCBzY2hlbWFNb2RlbCA9IGdldFNjaGVtYShtb2RlbCk7XG4gICAgICAgIGNvbnN0IGNsYXVzZSA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpO1xuICAgICAgICBjb25zdCBidWlsZGVyID0gZGIuZGVsZXRlKHNjaGVtYU1vZGVsKS53aGVyZSguLi5jbGF1c2UpO1xuICAgICAgICByZXR1cm4gYXdhaXQgYnVpbGRlcjtcbiAgICAgIH0sXG4gICAgICBvcHRpb25zOiBjb25maWdcbiAgICB9O1xuICB9XG59KTtcblxuZXhwb3J0IHsgZHJpenpsZUFkYXB0ZXIgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/adapters/drizzle-adapter/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/api/index.mjs":
/*!*****************************************************!*\
  !*** ./node_modules/better-auth/dist/api/index.mjs ***!
  \*****************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   APIError: () => (/* reexport safe */ better_call__WEBPACK_IMPORTED_MODULE_0__.APIError),\n/* harmony export */   accountInfo: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.q),\n/* harmony export */   callbackOAuth: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.R),\n/* harmony export */   changeEmail: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.K),\n/* harmony export */   changePassword: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.J),\n/* harmony export */   checkEndpointConflicts: () => (/* binding */ checkEndpointConflicts),\n/* harmony export */   createAuthEndpoint: () => (/* reexport safe */ _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.a),\n/* harmony export */   createAuthMiddleware: () => (/* reexport safe */ _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.c),\n/* harmony export */   createEmailVerificationToken: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.k),\n/* harmony export */   deleteUser: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.G),\n/* harmony export */   deleteUserCallback: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.A),\n/* harmony export */   error: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.m),\n/* harmony export */   forgetPassword: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.O),\n/* harmony export */   forgetPasswordCallback: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.F),\n/* harmony export */   freshSessionMiddleware: () => (/* reexport safe */ _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.f),\n/* harmony export */   getAccessToken: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.x),\n/* harmony export */   getEndpoints: () => (/* binding */ getEndpoints),\n/* harmony export */   getSession: () => (/* reexport safe */ _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.b),\n/* harmony export */   getSessionFromCtx: () => (/* reexport safe */ _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.g),\n/* harmony export */   getSessionQuerySchema: () => (/* reexport safe */ _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.h),\n/* harmony export */   linkSocialAccount: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.C),\n/* harmony export */   listSessions: () => (/* reexport safe */ _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.l),\n/* harmony export */   listUserAccounts: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.B),\n/* harmony export */   ok: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.n),\n/* harmony export */   optionsMiddleware: () => (/* reexport safe */ _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.o),\n/* harmony export */   originCheck: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.o),\n/* harmony export */   originCheckMiddleware: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.l),\n/* harmony export */   refreshToken: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.y),\n/* harmony export */   requestOnlySessionMiddleware: () => (/* reexport safe */ _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.i),\n/* harmony export */   requestPasswordReset: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.E),\n/* harmony export */   requestPasswordResetCallback: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.D),\n/* harmony export */   resetPassword: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.N),\n/* harmony export */   revokeOtherSessions: () => (/* reexport safe */ _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.r),\n/* harmony export */   revokeSession: () => (/* reexport safe */ _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.e),\n/* harmony export */   revokeSessions: () => (/* reexport safe */ _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.d),\n/* harmony export */   router: () => (/* binding */ router),\n/* harmony export */   sendVerificationEmail: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.L),\n/* harmony export */   sendVerificationEmailFn: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.T),\n/* harmony export */   sessionMiddleware: () => (/* reexport safe */ _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.s),\n/* harmony export */   setPassword: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.I),\n/* harmony export */   signInEmail: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.P),\n/* harmony export */   signInSocial: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.S),\n/* harmony export */   signOut: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.Q),\n/* harmony export */   signUpEmail: () => (/* binding */ signUpEmail),\n/* harmony export */   unlinkAccount: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.z),\n/* harmony export */   updateUser: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.u),\n/* harmony export */   verifyEmail: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.M)\n/* harmony export */ });\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../shared/better-auth.CewjboYP.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CewjboYP.mjs\");\n/* harmony import */ var _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../shared/better-auth.DV5EHeYG.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DV5EHeYG.mjs\");\n/* harmony import */ var zod_v4__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! zod/v4 */ \"(rsc)/./node_modules/zod/v4/index.js\");\n/* harmony import */ var _shared_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../shared/better-auth.UfVWArIB.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.UfVWArIB.mjs\");\n/* harmony import */ var _shared_better_auth_Dcv8PS7T_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../shared/better-auth.Dcv8PS7T.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.Dcv8PS7T.mjs\");\n/* harmony import */ var _shared_better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../shared/better-auth.CMQ3rA-I.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CMQ3rA-I.mjs\");\n/* harmony import */ var _shared_better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../shared/better-auth.BjBlybv-.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BjBlybv-.mjs\");\n/* harmony import */ var _shared_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../shared/better-auth.BZZKN1g7.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BZZKN1g7.mjs\");\n/* harmony import */ var _shared_better_auth_O2VtDkDK_mjs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../shared/better-auth.O2VtDkDK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.O2VtDkDK.mjs\");\n/* harmony import */ var _shared_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../shared/better-auth.CW6D9eSx.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _crypto_index_mjs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../crypto/index.mjs */ \"(rsc)/./node_modules/better-auth/dist/crypto/index.mjs\");\n/* harmony import */ var _better_auth_utils__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @better-auth/utils */ \"(rsc)/./node_modules/@better-auth/utils/dist/index.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _shared_better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../shared/better-auth.DdzSJf-n.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DdzSJf-n.mjs\");\n/* harmony import */ var _shared_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../shared/better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @better-fetch/fetch */ \"(rsc)/./node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var _shared_better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! ../shared/better-auth.CuS_eDdK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CuS_eDdK.mjs\");\n/* harmony import */ var _shared_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ../shared/better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! @better-auth/utils/binary */ \"(rsc)/./node_modules/@better-auth/utils/dist/binary.mjs\");\n/* harmony import */ var defu__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! defu */ \"(rsc)/./node_modules/defu/dist/defu.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst signUpEmail = () => (0,_shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.a)(\n  \"/sign-up/email\",\n  {\n    method: \"POST\",\n    body: zod_v4__WEBPACK_IMPORTED_MODULE_3__.record(zod_v4__WEBPACK_IMPORTED_MODULE_3__.string(), zod_v4__WEBPACK_IMPORTED_MODULE_3__.any()),\n    metadata: {\n      $Infer: {\n        body: {}\n      },\n      openapi: {\n        description: \"Sign up a user using email and password\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  name: {\n                    type: \"string\",\n                    description: \"The name of the user\"\n                  },\n                  email: {\n                    type: \"string\",\n                    description: \"The email of the user\"\n                  },\n                  password: {\n                    type: \"string\",\n                    description: \"The password of the user\"\n                  },\n                  image: {\n                    type: \"string\",\n                    description: \"The profile image URL of the user\"\n                  },\n                  callbackURL: {\n                    type: \"string\",\n                    description: \"The URL to use for email verification callback\"\n                  },\n                  rememberMe: {\n                    type: \"boolean\",\n                    description: \"If this is false, the session will not be remembered. Default is `true`.\"\n                  }\n                },\n                required: [\"name\", \"email\", \"password\"]\n              }\n            }\n          }\n        },\n        responses: {\n          \"200\": {\n            description: \"Successfully created user\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    token: {\n                      type: \"string\",\n                      nullable: true,\n                      description: \"Authentication token for the session\"\n                    },\n                    user: {\n                      type: \"object\",\n                      properties: {\n                        id: {\n                          type: \"string\",\n                          description: \"The unique identifier of the user\"\n                        },\n                        email: {\n                          type: \"string\",\n                          format: \"email\",\n                          description: \"The email address of the user\"\n                        },\n                        name: {\n                          type: \"string\",\n                          description: \"The name of the user\"\n                        },\n                        image: {\n                          type: \"string\",\n                          format: \"uri\",\n                          nullable: true,\n                          description: \"The profile image URL of the user\"\n                        },\n                        emailVerified: {\n                          type: \"boolean\",\n                          description: \"Whether the email has been verified\"\n                        },\n                        createdAt: {\n                          type: \"string\",\n                          format: \"date-time\",\n                          description: \"When the user was created\"\n                        },\n                        updatedAt: {\n                          type: \"string\",\n                          format: \"date-time\",\n                          description: \"When the user was last updated\"\n                        }\n                      },\n                      required: [\n                        \"id\",\n                        \"email\",\n                        \"name\",\n                        \"emailVerified\",\n                        \"createdAt\",\n                        \"updatedAt\"\n                      ]\n                    }\n                  },\n                  required: [\"user\"]\n                  // token is optional\n                }\n              }\n            }\n          },\n          \"422\": {\n            description: \"Unprocessable Entity. User already exists or failed to create user.\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    message: {\n                      type: \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.emailAndPassword?.enabled || ctx.context.options.emailAndPassword?.disableSignUp) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: \"Email and password sign up is not enabled\"\n      });\n    }\n    const body = ctx.body;\n    const {\n      name,\n      email,\n      password,\n      image,\n      callbackURL,\n      rememberMe,\n      ...additionalFields\n    } = body;\n    const isValidEmail = zod_v4__WEBPACK_IMPORTED_MODULE_3__.email().safeParse(email);\n    if (!isValidEmail.success) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.B.INVALID_EMAIL\n      });\n    }\n    const minPasswordLength = ctx.context.password.config.minPasswordLength;\n    if (password.length < minPasswordLength) {\n      ctx.context.logger.error(\"Password is too short\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.B.PASSWORD_TOO_SHORT\n      });\n    }\n    const maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n    if (password.length > maxPasswordLength) {\n      ctx.context.logger.error(\"Password is too long\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.B.PASSWORD_TOO_LONG\n      });\n    }\n    const dbUser = await ctx.context.internalAdapter.findUserByEmail(email);\n    if (dbUser?.user) {\n      ctx.context.logger.info(`Sign-up attempt for existing email: ${email}`);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNPROCESSABLE_ENTITY\", {\n        message: _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.B.USER_ALREADY_EXISTS\n      });\n    }\n    const additionalData = (0,_shared_better_auth_Dcv8PS7T_mjs__WEBPACK_IMPORTED_MODULE_5__.h)(\n      ctx.context.options,\n      additionalFields\n    );\n    const hash = await ctx.context.password.hash(password);\n    let createdUser;\n    try {\n      createdUser = await ctx.context.internalAdapter.createUser(\n        {\n          email: email.toLowerCase(),\n          name,\n          image,\n          ...additionalData,\n          emailVerified: false\n        },\n        ctx\n      );\n      if (!createdUser) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n          message: _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.B.FAILED_TO_CREATE_USER\n        });\n      }\n    } catch (e) {\n      if (_shared_better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_6__.b) {\n        ctx.context.logger.error(\"Failed to create user\", e);\n      }\n      if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_0__.APIError) {\n        throw e;\n      }\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNPROCESSABLE_ENTITY\", {\n        message: _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.B.FAILED_TO_CREATE_USER,\n        details: e\n      });\n    }\n    if (!createdUser) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNPROCESSABLE_ENTITY\", {\n        message: _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.B.FAILED_TO_CREATE_USER\n      });\n    }\n    await ctx.context.internalAdapter.linkAccount(\n      {\n        userId: createdUser.id,\n        providerId: \"credential\",\n        accountId: createdUser.id,\n        password: hash\n      },\n      ctx\n    );\n    if (ctx.context.options.emailVerification?.sendOnSignUp || ctx.context.options.emailAndPassword.requireEmailVerification) {\n      const token = await (0,_shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.k)(\n        ctx.context.secret,\n        createdUser.email,\n        void 0,\n        ctx.context.options.emailVerification?.expiresIn\n      );\n      const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${body.callbackURL || \"/\"}`;\n      await ctx.context.options.emailVerification?.sendVerificationEmail?.(\n        {\n          user: createdUser,\n          url,\n          token\n        },\n        ctx.request\n      );\n    }\n    if (ctx.context.options.emailAndPassword.autoSignIn === false || ctx.context.options.emailAndPassword.requireEmailVerification) {\n      return ctx.json({\n        token: null,\n        user: {\n          id: createdUser.id,\n          email: createdUser.email,\n          name: createdUser.name,\n          image: createdUser.image,\n          emailVerified: createdUser.emailVerified,\n          createdAt: createdUser.createdAt,\n          updatedAt: createdUser.updatedAt\n        }\n      });\n    }\n    const session = await ctx.context.internalAdapter.createSession(\n      createdUser.id,\n      ctx,\n      rememberMe === false\n    );\n    if (!session) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.B.FAILED_TO_CREATE_SESSION\n      });\n    }\n    await (0,_shared_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_4__.s)(\n      ctx,\n      {\n        session,\n        user: createdUser\n      },\n      rememberMe === false\n    );\n    return ctx.json({\n      token: session.token,\n      user: {\n        id: createdUser.id,\n        email: createdUser.email,\n        name: createdUser.name,\n        image: createdUser.image,\n        emailVerified: createdUser.emailVerified,\n        createdAt: createdUser.createdAt,\n        updatedAt: createdUser.updatedAt\n      }\n    });\n  }\n);\n\nfunction shouldRateLimit(max, window, rateLimitData) {\n  const now = Date.now();\n  const windowInMs = window * 1e3;\n  const timeSinceLastRequest = now - rateLimitData.lastRequest;\n  return timeSinceLastRequest < windowInMs && rateLimitData.count >= max;\n}\nfunction rateLimitResponse(retryAfter) {\n  return new Response(\n    JSON.stringify({\n      message: \"Too many requests. Please try again later.\"\n    }),\n    {\n      status: 429,\n      statusText: \"Too Many Requests\",\n      headers: {\n        \"X-Retry-After\": retryAfter.toString()\n      }\n    }\n  );\n}\nfunction getRetryAfter(lastRequest, window) {\n  const now = Date.now();\n  const windowInMs = window * 1e3;\n  return Math.ceil((lastRequest + windowInMs - now) / 1e3);\n}\nfunction createDBStorage(ctx) {\n  const model = \"rateLimit\";\n  const db = ctx.adapter;\n  return {\n    get: async (key) => {\n      const res = await db.findMany({\n        model,\n        where: [{ field: \"key\", value: key }]\n      });\n      const data = res[0];\n      if (typeof data?.lastRequest === \"bigint\") {\n        data.lastRequest = Number(data.lastRequest);\n      }\n      return data;\n    },\n    set: async (key, value, _update) => {\n      try {\n        if (_update) {\n          await db.updateMany({\n            model,\n            where: [{ field: \"key\", value: key }],\n            update: {\n              count: value.count,\n              lastRequest: value.lastRequest\n            }\n          });\n        } else {\n          await db.create({\n            model,\n            data: {\n              key,\n              count: value.count,\n              lastRequest: value.lastRequest\n            }\n          });\n        }\n      } catch (e) {\n        ctx.logger.error(\"Error setting rate limit\", e);\n      }\n    }\n  };\n}\nconst memory = /* @__PURE__ */ new Map();\nfunction getRateLimitStorage(ctx) {\n  if (ctx.options.rateLimit?.customStorage) {\n    return ctx.options.rateLimit.customStorage;\n  }\n  if (ctx.rateLimit.storage === \"secondary-storage\") {\n    return {\n      get: async (key) => {\n        const data = await ctx.options.secondaryStorage?.get(key);\n        return data ? (0,_shared_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_8__.s)(data) : void 0;\n      },\n      set: async (key, value) => {\n        await ctx.options.secondaryStorage?.set?.(key, JSON.stringify(value));\n      }\n    };\n  }\n  const storage = ctx.rateLimit.storage;\n  if (storage === \"memory\") {\n    return {\n      async get(key) {\n        return memory.get(key);\n      },\n      async set(key, value, _update) {\n        memory.set(key, value);\n      }\n    };\n  }\n  return createDBStorage(ctx);\n}\nasync function onRequestRateLimit(req, ctx) {\n  if (!ctx.rateLimit.enabled) {\n    return;\n  }\n  const path = new URL(req.url).pathname.replace(\n    ctx.options.basePath || \"/api/auth\",\n    \"\"\n  );\n  let window = ctx.rateLimit.window;\n  let max = ctx.rateLimit.max;\n  const ip = (0,_shared_better_auth_O2VtDkDK_mjs__WEBPACK_IMPORTED_MODULE_9__.g)(req, ctx.options);\n  if (!ip) {\n    return;\n  }\n  const key = ip + path;\n  const specialRules = getDefaultSpecialRules();\n  const specialRule = specialRules.find((rule) => rule.pathMatcher(path));\n  if (specialRule) {\n    window = specialRule.window;\n    max = specialRule.max;\n  }\n  for (const plugin of ctx.options.plugins || []) {\n    if (plugin.rateLimit) {\n      const matchedRule = plugin.rateLimit.find(\n        (rule) => rule.pathMatcher(path)\n      );\n      if (matchedRule) {\n        window = matchedRule.window;\n        max = matchedRule.max;\n        break;\n      }\n    }\n  }\n  if (ctx.rateLimit.customRules) {\n    const _path = Object.keys(ctx.rateLimit.customRules).find((p) => {\n      if (p.includes(\"*\")) {\n        const isMatch = (0,_shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.w)(p)(path);\n        return isMatch;\n      }\n      return p === path;\n    });\n    if (_path) {\n      const customRule = ctx.rateLimit.customRules[_path];\n      const resolved = typeof customRule === \"function\" ? await customRule(req) : customRule;\n      if (resolved) {\n        window = resolved.window;\n        max = resolved.max;\n      }\n      if (resolved === false) {\n        return;\n      }\n    }\n  }\n  const storage = getRateLimitStorage(ctx);\n  const data = await storage.get(key);\n  const now = Date.now();\n  if (!data) {\n    await storage.set(key, {\n      key,\n      count: 1,\n      lastRequest: now\n    });\n  } else {\n    const timeSinceLastRequest = now - data.lastRequest;\n    if (shouldRateLimit(max, window, data)) {\n      const retryAfter = getRetryAfter(data.lastRequest, window);\n      return rateLimitResponse(retryAfter);\n    } else if (timeSinceLastRequest > window * 1e3) {\n      await storage.set(\n        key,\n        {\n          ...data,\n          count: 1,\n          lastRequest: now\n        },\n        true\n      );\n    } else {\n      await storage.set(\n        key,\n        {\n          ...data,\n          count: data.count + 1,\n          lastRequest: now\n        },\n        true\n      );\n    }\n  }\n}\nfunction getDefaultSpecialRules() {\n  const specialRules = [\n    {\n      pathMatcher(path) {\n        return path.startsWith(\"/sign-in\") || path.startsWith(\"/sign-up\") || path.startsWith(\"/change-password\") || path.startsWith(\"/change-email\");\n      },\n      window: 10,\n      max: 3\n    }\n  ];\n  return specialRules;\n}\n\nfunction checkEndpointConflicts(options, logger2) {\n  const endpointRegistry = /* @__PURE__ */ new Map();\n  options.plugins?.forEach((plugin) => {\n    if (plugin.endpoints) {\n      for (const [key, endpoint] of Object.entries(plugin.endpoints)) {\n        if (endpoint && \"path\" in endpoint) {\n          const path = endpoint.path;\n          if (!endpointRegistry.has(path)) {\n            endpointRegistry.set(path, []);\n          }\n          endpointRegistry.get(path).push({\n            pluginId: plugin.id,\n            endpointKey: key\n          });\n        }\n      }\n    }\n  });\n  const conflicts = [];\n  for (const [path, entries] of endpointRegistry.entries()) {\n    if (entries.length > 1) {\n      const uniquePlugins = [...new Set(entries.map((e) => e.pluginId))];\n      conflicts.push({\n        path,\n        plugins: uniquePlugins\n      });\n    }\n  }\n  if (conflicts.length > 0) {\n    const conflictMessages = conflicts.map(\n      (conflict) => `  - \"${conflict.path}\" used by plugins: ${conflict.plugins.join(\", \")}`\n    ).join(\"\\n\");\n    logger2.error(\n      `Endpoint path conflicts detected! Multiple plugins are trying to use the same endpoint paths:\n${conflictMessages}\n\nTo resolve this, you can:\n\t1. Use only one of the conflicting plugins\n\t2. Configure the plugins to use different paths (if supported)\n`\n    );\n  }\n}\nfunction getEndpoints(ctx, options) {\n  const pluginEndpoints = options.plugins?.reduce(\n    (acc, plugin) => {\n      return {\n        ...acc,\n        ...plugin.endpoints\n      };\n    },\n    {}\n  );\n  const middlewares = options.plugins?.map(\n    (plugin) => plugin.middlewares?.map((m) => {\n      const middleware = (async (context) => {\n        const authContext = await ctx;\n        return m.middleware({\n          ...context,\n          context: {\n            ...authContext,\n            ...context.context\n          }\n        });\n      });\n      middleware.options = m.middleware.options;\n      return {\n        path: m.path,\n        middleware\n      };\n    })\n  ).filter((plugin) => plugin !== void 0).flat() || [];\n  const baseEndpoints = {\n    signInSocial: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.S,\n    callbackOAuth: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.R,\n    getSession: (0,_shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.b)(),\n    signOut: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.Q,\n    signUpEmail: signUpEmail(),\n    signInEmail: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.P,\n    forgetPassword: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.O,\n    resetPassword: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.N,\n    verifyEmail: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.M,\n    sendVerificationEmail: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.L,\n    changeEmail: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.K,\n    changePassword: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.J,\n    setPassword: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.I,\n    updateUser: (0,_shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.u)(),\n    deleteUser: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.G,\n    forgetPasswordCallback: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.F,\n    requestPasswordReset: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.E,\n    requestPasswordResetCallback: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.D,\n    listSessions: (0,_shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.l)(),\n    revokeSession: _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.e,\n    revokeSessions: _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.d,\n    revokeOtherSessions: _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_2__.r,\n    linkSocialAccount: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.C,\n    listUserAccounts: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.B,\n    deleteUserCallback: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.A,\n    unlinkAccount: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.z,\n    refreshToken: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.y,\n    getAccessToken: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.x,\n    accountInfo: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.q\n  };\n  const endpoints = {\n    ...baseEndpoints,\n    ...pluginEndpoints,\n    ok: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.n,\n    error: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.m\n  };\n  const api = (0,_shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.t)(endpoints, ctx);\n  return {\n    api,\n    middlewares\n  };\n}\nconst router = (ctx, options) => {\n  const { api, middlewares } = getEndpoints(ctx, options);\n  const basePath = new URL(ctx.baseURL).pathname;\n  return (0,better_call__WEBPACK_IMPORTED_MODULE_0__.createRouter)(api, {\n    routerContext: ctx,\n    openapi: {\n      disabled: true\n    },\n    basePath,\n    routerMiddleware: [\n      {\n        path: \"/**\",\n        middleware: _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_1__.l\n      },\n      ...middlewares\n    ],\n    async onRequest(req) {\n      const disabledPaths = ctx.options.disabledPaths || [];\n      const path = new URL(req.url).pathname.replace(basePath, \"\");\n      if (disabledPaths.includes(path)) {\n        return new Response(\"Not Found\", { status: 404 });\n      }\n      for (const plugin of ctx.options.plugins || []) {\n        if (plugin.onRequest) {\n          const response = await plugin.onRequest(req, ctx);\n          if (response && \"response\" in response) {\n            return response.response;\n          }\n        }\n      }\n      return onRequestRateLimit(req, ctx);\n    },\n    async onResponse(res) {\n      for (const plugin of ctx.options.plugins || []) {\n        if (plugin.onResponse) {\n          const response = await plugin.onResponse(res, ctx);\n          if (response) {\n            return response.response;\n          }\n        }\n      }\n      return res;\n    },\n    onError(e) {\n      if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_0__.APIError && e.status === \"FOUND\") {\n        return;\n      }\n      if (options.onAPIError?.throw) {\n        throw e;\n      }\n      if (options.onAPIError?.onError) {\n        options.onAPIError.onError(e, ctx);\n        return;\n      }\n      const optLogLevel = options.logger?.level;\n      const log = optLogLevel === \"error\" || optLogLevel === \"warn\" || optLogLevel === \"debug\" ? _shared_better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_7__.a : void 0;\n      if (options.logger?.disabled !== true) {\n        if (e && typeof e === \"object\" && \"message\" in e && typeof e.message === \"string\") {\n          if (e.message.includes(\"no column\") || e.message.includes(\"column\") || e.message.includes(\"relation\") || e.message.includes(\"table\") || e.message.includes(\"does not exist\")) {\n            ctx.logger?.error(e.message);\n            return;\n          }\n        }\n        if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_0__.APIError) {\n          if (e.status === \"INTERNAL_SERVER_ERROR\") {\n            ctx.logger.error(e.status, e);\n          }\n          log?.error(e.message);\n        } else {\n          ctx.logger?.error(\n            e && typeof e === \"object\" && \"name\" in e ? e.name : \"\",\n            e\n          );\n        }\n      }\n    }\n  });\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9hcGkvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFxRDtBQUNkO0FBQ3FuQjtBQUN4akI7QUFDdUc7QUFDd0M7QUFDdk47QUFDK0M7QUFDRjtBQUNEO0FBQ1A7QUFDTztBQUNSO0FBQ3BCO0FBQ1g7QUFDRTtBQUNOO0FBQ0s7QUFDRDtBQUNuQjtBQUNtQjtBQUNMO0FBQ0k7QUFDQTtBQUNZO0FBQ0E7QUFDVDtBQUNOO0FBQ2U7QUFDdkI7QUFDdUI7QUFDWDtBQUNFO0FBQ3JCOztBQUVkLDBCQUEwQixtRUFBa0I7QUFDNUM7QUFDQTtBQUNBO0FBQ0EsVUFBVSwwQ0FBUSxDQUFDLDBDQUFRLElBQUksdUNBQUs7QUFDcEM7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUI7QUFDekI7QUFDQTtBQUNBO0FBQ0EseUJBQXlCO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFB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QVk7QUFDckI7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLCtEQUFxQjtBQUN6QyxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkNBQTJDLGFBQWE7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSx1QkFBdUIsaURBQVE7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpR0FBaUcsOERBQU07QUFDdkc7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsaURBQVE7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7O0FBRThsQiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcZGlzdFxcYXBpXFxpbmRleC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQVBJRXJyb3IsIGNyZWF0ZVJvdXRlciB9IGZyb20gJ2JldHRlci1jYWxsJztcbmV4cG9ydCB7IEFQSUVycm9yIH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuaW1wb3J0IHsgayBhcyBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuLCB3IGFzIHdpbGRjYXJkTWF0Y2gsIHUgYXMgdXBkYXRlVXNlciwgdCBhcyB0b0F1dGhFbmRwb2ludHMsIGwgYXMgb3JpZ2luQ2hlY2tNaWRkbGV3YXJlLCBtIGFzIGVycm9yLCBuIGFzIG9rLCBxIGFzIGFjY291bnRJbmZvLCB4IGFzIGdldEFjY2Vzc1Rva2VuLCB5IGFzIHJlZnJlc2hUb2tlbiwgeiBhcyB1bmxpbmtBY2NvdW50LCBBIGFzIGRlbGV0ZVVzZXJDYWxsYmFjaywgQiBhcyBsaXN0VXNlckFjY291bnRzLCBDIGFzIGxpbmtTb2NpYWxBY2NvdW50LCBEIGFzIHJlcXVlc3RQYXNzd29yZFJlc2V0Q2FsbGJhY2ssIEUgYXMgcmVxdWVzdFBhc3N3b3JkUmVzZXQsIEYgYXMgZm9yZ2V0UGFzc3dvcmRDYWxsYmFjaywgRyBhcyBkZWxldGVVc2VyLCBJIGFzIHNldFBhc3N3b3JkLCBKIGFzIGNoYW5nZVBhc3N3b3JkLCBLIGFzIGNoYW5nZUVtYWlsLCBMIGFzIHNlbmRWZXJpZmljYXRpb25FbWFpbCwgTSBhcyB2ZXJpZnlFbWFpbCwgTiBhcyByZXNldFBhc3N3b3JkLCBPIGFzIGZvcmdldFBhc3N3b3JkLCBQIGFzIHNpZ25JbkVtYWlsLCBRIGFzIHNpZ25PdXQsIFIgYXMgY2FsbGJhY2tPQXV0aCwgUyBhcyBzaWduSW5Tb2NpYWwgfSBmcm9tICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguQ2V3amJvWVAubWpzJztcbmV4cG9ydCB7IG8gYXMgb3JpZ2luQ2hlY2ssIFQgYXMgc2VuZFZlcmlmaWNhdGlvbkVtYWlsRm4gfSBmcm9tICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguQ2V3amJvWVAubWpzJztcbmltcG9ydCB7IGEgYXMgY3JlYXRlQXV0aEVuZHBvaW50LCBCIGFzIEJBU0VfRVJST1JfQ09ERVMsIGwgYXMgbGlzdFNlc3Npb25zLCBiIGFzIGdldFNlc3Npb24sIHIgYXMgcmV2b2tlT3RoZXJTZXNzaW9ucywgZCBhcyByZXZva2VTZXNzaW9ucywgZSBhcyByZXZva2VTZXNzaW9uIH0gZnJvbSAnLi4vc2hhcmVkL2JldHRlci1hdXRoLkRWNUVIZVlHLm1qcyc7XG5leHBvcnQgeyBjIGFzIGNyZWF0ZUF1dGhNaWRkbGV3YXJlLCBmIGFzIGZyZXNoU2Vzc2lvbk1pZGRsZXdhcmUsIGcgYXMgZ2V0U2Vzc2lvbkZyb21DdHgsIGggYXMgZ2V0U2Vzc2lvblF1ZXJ5U2NoZW1hLCBvIGFzIG9wdGlvbnNNaWRkbGV3YXJlLCBpIGFzIHJlcXVlc3RPbmx5U2Vzc2lvbk1pZGRsZXdhcmUsIHMgYXMgc2Vzc2lvbk1pZGRsZXdhcmUgfSBmcm9tICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguRFY1RUhlWUcubWpzJztcbmltcG9ydCAqIGFzIHogZnJvbSAnem9kL3Y0JztcbmltcG9ydCB7IHMgYXMgc2V0U2Vzc2lvbkNvb2tpZSB9IGZyb20gJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5VZlZXQXJJQi5tanMnO1xuaW1wb3J0IHsgaCBhcyBwYXJzZVVzZXJJbnB1dCB9IGZyb20gJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5EY3Y4UFM3VC5tanMnO1xuaW1wb3J0IHsgYiBhcyBpc0RldmVsb3BtZW50IH0gZnJvbSAnLi4vc2hhcmVkL2JldHRlci1hdXRoLkNNUTNyQS1JLm1qcyc7XG5pbXBvcnQgeyBhIGFzIGxvZ2dlciB9IGZyb20gJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5CakJseWJ2LS5tanMnO1xuaW1wb3J0IHsgcyBhcyBzYWZlSlNPTlBhcnNlIH0gZnJvbSAnLi4vc2hhcmVkL2JldHRlci1hdXRoLkJaWktOMWc3Lm1qcyc7XG5pbXBvcnQgeyBnIGFzIGdldElwIH0gZnJvbSAnLi4vc2hhcmVkL2JldHRlci1hdXRoLk8yVnREa0RLLm1qcyc7XG5pbXBvcnQgJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5DVzZEOWVTeC5tanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaGFzaCc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9iYXNlNjQnO1xuaW1wb3J0ICcuLi9jcnlwdG8vaW5kZXgubWpzJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvY2hhY2hhLmpzJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvdXRpbHMuanMnO1xuaW1wb3J0ICdqb3NlJztcbmltcG9ydCAnQG5vYmxlL2hhc2hlcy9zY3J5cHQuanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaGV4JztcbmltcG9ydCAnQG5vYmxlL2hhc2hlcy91dGlscy5qcyc7XG5pbXBvcnQgJy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5EZHpTSmYtbi5tanMnO1xuaW1wb3J0ICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguQjRRb3hkZ2MubWpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL3JhbmRvbSc7XG5pbXBvcnQgJ0BiZXR0ZXItZmV0Y2gvZmV0Y2gnO1xuaW1wb3J0ICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguQ3VTX2VEZEsubWpzJztcbmltcG9ydCAnam9zZS9lcnJvcnMnO1xuaW1wb3J0ICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguQlVQUFJYZksubWpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2htYWMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvYmluYXJ5JztcbmltcG9ydCAnZGVmdSc7XG5cbmNvbnN0IHNpZ25VcEVtYWlsID0gKCkgPT4gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9zaWduLXVwL2VtYWlsXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoucmVjb3JkKHouc3RyaW5nKCksIHouYW55KCkpLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICAkSW5mZXI6IHtcbiAgICAgICAgYm9keToge31cbiAgICAgIH0sXG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlNpZ24gdXAgYSB1c2VyIHVzaW5nIGVtYWlsIGFuZCBwYXNzd29yZFwiLFxuICAgICAgICByZXF1ZXN0Qm9keToge1xuICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgbmFtZToge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgbmFtZSBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgZW1haWw6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGVtYWlsIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICBwYXNzd29yZDoge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgcGFzc3dvcmQgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIGltYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBwcm9maWxlIGltYWdlIFVSTCBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgY2FsbGJhY2tVUkw6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byB1c2UgZm9yIGVtYWlsIHZlcmlmaWNhdGlvbiBjYWxsYmFja1wiXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVtZW1iZXJNZToge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiSWYgdGhpcyBpcyBmYWxzZSwgdGhlIHNlc3Npb24gd2lsbCBub3QgYmUgcmVtZW1iZXJlZC4gRGVmYXVsdCBpcyBgdHJ1ZWAuXCJcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJuYW1lXCIsIFwiZW1haWxcIiwgXCJwYXNzd29yZFwiXVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzZnVsbHkgY3JlYXRlZCB1c2VyXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICB0b2tlbjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgbnVsbGFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiQXV0aGVudGljYXRpb24gdG9rZW4gZm9yIHRoZSBzZXNzaW9uXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHVuaXF1ZSBpZGVudGlmaWVyIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBlbWFpbDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwiZW1haWxcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGVtYWlsIGFkZHJlc3Mgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG5hbWUgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogXCJ1cmlcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbGFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBwcm9maWxlIGltYWdlIFVSTCBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiV2hldGhlciB0aGUgZW1haWwgaGFzIGJlZW4gdmVyaWZpZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwiZGF0ZS10aW1lXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIldoZW4gdGhlIHVzZXIgd2FzIGNyZWF0ZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwiZGF0ZS10aW1lXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIldoZW4gdGhlIHVzZXIgd2FzIGxhc3QgdXBkYXRlZFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1xuICAgICAgICAgICAgICAgICAgICAgICAgXCJpZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbWFpbFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJuYW1lXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImVtYWlsVmVyaWZpZWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiY3JlYXRlZEF0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcInVwZGF0ZWRBdFwiXG4gICAgICAgICAgICAgICAgICAgICAgXVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInVzZXJcIl1cbiAgICAgICAgICAgICAgICAgIC8vIHRva2VuIGlzIG9wdGlvbmFsXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBcIjQyMlwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVbnByb2Nlc3NhYmxlIEVudGl0eS4gVXNlciBhbHJlYWR5IGV4aXN0cyBvciBmYWlsZWQgdG8gY3JlYXRlIHVzZXIuXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/LmVuYWJsZWQgfHwgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5kaXNhYmxlU2lnblVwKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiRW1haWwgYW5kIHBhc3N3b3JkIHNpZ24gdXAgaXMgbm90IGVuYWJsZWRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGJvZHkgPSBjdHguYm9keTtcbiAgICBjb25zdCB7XG4gICAgICBuYW1lLFxuICAgICAgZW1haWwsXG4gICAgICBwYXNzd29yZCxcbiAgICAgIGltYWdlLFxuICAgICAgY2FsbGJhY2tVUkwsXG4gICAgICByZW1lbWJlck1lLFxuICAgICAgLi4uYWRkaXRpb25hbEZpZWxkc1xuICAgIH0gPSBib2R5O1xuICAgIGNvbnN0IGlzVmFsaWRFbWFpbCA9IHouZW1haWwoKS5zYWZlUGFyc2UoZW1haWwpO1xuICAgIGlmICghaXNWYWxpZEVtYWlsLnN1Y2Nlc3MpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX0VNQUlMXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgbWluUGFzc3dvcmRMZW5ndGggPSBjdHguY29udGV4dC5wYXNzd29yZC5jb25maWcubWluUGFzc3dvcmRMZW5ndGg7XG4gICAgaWYgKHBhc3N3b3JkLmxlbmd0aCA8IG1pblBhc3N3b3JkTGVuZ3RoKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJQYXNzd29yZCBpcyB0b28gc2hvcnRcIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuUEFTU1dPUkRfVE9PX1NIT1JUXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgbWF4UGFzc3dvcmRMZW5ndGggPSBjdHguY29udGV4dC5wYXNzd29yZC5jb25maWcubWF4UGFzc3dvcmRMZW5ndGg7XG4gICAgaWYgKHBhc3N3b3JkLmxlbmd0aCA+IG1heFBhc3N3b3JkTGVuZ3RoKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJQYXNzd29yZCBpcyB0b28gbG9uZ1wiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5QQVNTV09SRF9UT09fTE9OR1xuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGRiVXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwoZW1haWwpO1xuICAgIGlmIChkYlVzZXI/LnVzZXIpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5pbmZvKGBTaWduLXVwIGF0dGVtcHQgZm9yIGV4aXN0aW5nIGVtYWlsOiAke2VtYWlsfWApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5QUk9DRVNTQUJMRV9FTlRJVFlcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlVTRVJfQUxSRUFEWV9FWElTVFNcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhZGRpdGlvbmFsRGF0YSA9IHBhcnNlVXNlcklucHV0KFxuICAgICAgY3R4LmNvbnRleHQub3B0aW9ucyxcbiAgICAgIGFkZGl0aW9uYWxGaWVsZHNcbiAgICApO1xuICAgIGNvbnN0IGhhc2ggPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC5oYXNoKHBhc3N3b3JkKTtcbiAgICBsZXQgY3JlYXRlZFVzZXI7XG4gICAgdHJ5IHtcbiAgICAgIGNyZWF0ZWRVc2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVVzZXIoXG4gICAgICAgIHtcbiAgICAgICAgICBlbWFpbDogZW1haWwudG9Mb3dlckNhc2UoKSxcbiAgICAgICAgICBuYW1lLFxuICAgICAgICAgIGltYWdlLFxuICAgICAgICAgIC4uLmFkZGl0aW9uYWxEYXRhLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IGZhbHNlXG4gICAgICAgIH0sXG4gICAgICAgIGN0eFxuICAgICAgKTtcbiAgICAgIGlmICghY3JlYXRlZFVzZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX0NSRUFURV9VU0VSXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGlmIChpc0RldmVsb3BtZW50KSB7XG4gICAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBjcmVhdGUgdXNlclwiLCBlKTtcbiAgICAgIH1cbiAgICAgIGlmIChlIGluc3RhbmNlb2YgQVBJRXJyb3IpIHtcbiAgICAgICAgdGhyb3cgZTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOUFJPQ0VTU0FCTEVfRU5USVRZXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fQ1JFQVRFX1VTRVIsXG4gICAgICAgIGRldGFpbHM6IGVcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoIWNyZWF0ZWRVc2VyKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTlBST0NFU1NBQkxFX0VOVElUWVwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX0NSRUFURV9VU0VSXG4gICAgICB9KTtcbiAgICB9XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmxpbmtBY2NvdW50KFxuICAgICAge1xuICAgICAgICB1c2VySWQ6IGNyZWF0ZWRVc2VyLmlkLFxuICAgICAgICBwcm92aWRlcklkOiBcImNyZWRlbnRpYWxcIixcbiAgICAgICAgYWNjb3VudElkOiBjcmVhdGVkVXNlci5pZCxcbiAgICAgICAgcGFzc3dvcmQ6IGhhc2hcbiAgICAgIH0sXG4gICAgICBjdHhcbiAgICApO1xuICAgIGlmIChjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5zZW5kT25TaWduVXAgfHwgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkLnJlcXVpcmVFbWFpbFZlcmlmaWNhdGlvbikge1xuICAgICAgY29uc3QgdG9rZW4gPSBhd2FpdCBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuKFxuICAgICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICAgIGNyZWF0ZWRVc2VyLmVtYWlsLFxuICAgICAgICB2b2lkIDAsXG4gICAgICAgIGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LmV4cGlyZXNJblxuICAgICAgKTtcbiAgICAgIGNvbnN0IHVybCA9IGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L3ZlcmlmeS1lbWFpbD90b2tlbj0ke3Rva2VufSZjYWxsYmFja1VSTD0ke2JvZHkuY2FsbGJhY2tVUkwgfHwgXCIvXCJ9YDtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LnNlbmRWZXJpZmljYXRpb25FbWFpbD8uKFxuICAgICAgICB7XG4gICAgICAgICAgdXNlcjogY3JlYXRlZFVzZXIsXG4gICAgICAgICAgdXJsLFxuICAgICAgICAgIHRva2VuXG4gICAgICAgIH0sXG4gICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICApO1xuICAgIH1cbiAgICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkLmF1dG9TaWduSW4gPT09IGZhbHNlIHx8IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZC5yZXF1aXJlRW1haWxWZXJpZmljYXRpb24pIHtcbiAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgIHRva2VuOiBudWxsLFxuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IGNyZWF0ZWRVc2VyLmlkLFxuICAgICAgICAgIGVtYWlsOiBjcmVhdGVkVXNlci5lbWFpbCxcbiAgICAgICAgICBuYW1lOiBjcmVhdGVkVXNlci5uYW1lLFxuICAgICAgICAgIGltYWdlOiBjcmVhdGVkVXNlci5pbWFnZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBjcmVhdGVkVXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICAgIGNyZWF0ZWRBdDogY3JlYXRlZFVzZXIuY3JlYXRlZEF0LFxuICAgICAgICAgIHVwZGF0ZWRBdDogY3JlYXRlZFVzZXIudXBkYXRlZEF0XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24oXG4gICAgICBjcmVhdGVkVXNlci5pZCxcbiAgICAgIGN0eCxcbiAgICAgIHJlbWVtYmVyTWUgPT09IGZhbHNlXG4gICAgKTtcbiAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fQ1JFQVRFX1NFU1NJT05cbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKFxuICAgICAgY3R4LFxuICAgICAge1xuICAgICAgICBzZXNzaW9uLFxuICAgICAgICB1c2VyOiBjcmVhdGVkVXNlclxuICAgICAgfSxcbiAgICAgIHJlbWVtYmVyTWUgPT09IGZhbHNlXG4gICAgKTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgdG9rZW46IHNlc3Npb24udG9rZW4sXG4gICAgICB1c2VyOiB7XG4gICAgICAgIGlkOiBjcmVhdGVkVXNlci5pZCxcbiAgICAgICAgZW1haWw6IGNyZWF0ZWRVc2VyLmVtYWlsLFxuICAgICAgICBuYW1lOiBjcmVhdGVkVXNlci5uYW1lLFxuICAgICAgICBpbWFnZTogY3JlYXRlZFVzZXIuaW1hZ2UsXG4gICAgICAgIGVtYWlsVmVyaWZpZWQ6IGNyZWF0ZWRVc2VyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgIGNyZWF0ZWRBdDogY3JlYXRlZFVzZXIuY3JlYXRlZEF0LFxuICAgICAgICB1cGRhdGVkQXQ6IGNyZWF0ZWRVc2VyLnVwZGF0ZWRBdFxuICAgICAgfVxuICAgIH0pO1xuICB9XG4pO1xuXG5mdW5jdGlvbiBzaG91bGRSYXRlTGltaXQobWF4LCB3aW5kb3csIHJhdGVMaW1pdERhdGEpIHtcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgY29uc3Qgd2luZG93SW5NcyA9IHdpbmRvdyAqIDFlMztcbiAgY29uc3QgdGltZVNpbmNlTGFzdFJlcXVlc3QgPSBub3cgLSByYXRlTGltaXREYXRhLmxhc3RSZXF1ZXN0O1xuICByZXR1cm4gdGltZVNpbmNlTGFzdFJlcXVlc3QgPCB3aW5kb3dJbk1zICYmIHJhdGVMaW1pdERhdGEuY291bnQgPj0gbWF4O1xufVxuZnVuY3Rpb24gcmF0ZUxpbWl0UmVzcG9uc2UocmV0cnlBZnRlcikge1xuICByZXR1cm4gbmV3IFJlc3BvbnNlKFxuICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIG1lc3NhZ2U6IFwiVG9vIG1hbnkgcmVxdWVzdHMuIFBsZWFzZSB0cnkgYWdhaW4gbGF0ZXIuXCJcbiAgICB9KSxcbiAgICB7XG4gICAgICBzdGF0dXM6IDQyOSxcbiAgICAgIHN0YXR1c1RleHQ6IFwiVG9vIE1hbnkgUmVxdWVzdHNcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgXCJYLVJldHJ5LUFmdGVyXCI6IHJldHJ5QWZ0ZXIudG9TdHJpbmcoKVxuICAgICAgfVxuICAgIH1cbiAgKTtcbn1cbmZ1bmN0aW9uIGdldFJldHJ5QWZ0ZXIobGFzdFJlcXVlc3QsIHdpbmRvdykge1xuICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICBjb25zdCB3aW5kb3dJbk1zID0gd2luZG93ICogMWUzO1xuICByZXR1cm4gTWF0aC5jZWlsKChsYXN0UmVxdWVzdCArIHdpbmRvd0luTXMgLSBub3cpIC8gMWUzKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZURCU3RvcmFnZShjdHgpIHtcbiAgY29uc3QgbW9kZWwgPSBcInJhdGVMaW1pdFwiO1xuICBjb25zdCBkYiA9IGN0eC5hZGFwdGVyO1xuICByZXR1cm4ge1xuICAgIGdldDogYXN5bmMgKGtleSkgPT4ge1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgZGIuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbCxcbiAgICAgICAgd2hlcmU6IFt7IGZpZWxkOiBcImtleVwiLCB2YWx1ZToga2V5IH1dXG4gICAgICB9KTtcbiAgICAgIGNvbnN0IGRhdGEgPSByZXNbMF07XG4gICAgICBpZiAodHlwZW9mIGRhdGE/Lmxhc3RSZXF1ZXN0ID09PSBcImJpZ2ludFwiKSB7XG4gICAgICAgIGRhdGEubGFzdFJlcXVlc3QgPSBOdW1iZXIoZGF0YS5sYXN0UmVxdWVzdCk7XG4gICAgICB9XG4gICAgICByZXR1cm4gZGF0YTtcbiAgICB9LFxuICAgIHNldDogYXN5bmMgKGtleSwgdmFsdWUsIF91cGRhdGUpID0+IHtcbiAgICAgIHRyeSB7XG4gICAgICAgIGlmIChfdXBkYXRlKSB7XG4gICAgICAgICAgYXdhaXQgZGIudXBkYXRlTWFueSh7XG4gICAgICAgICAgICBtb2RlbCxcbiAgICAgICAgICAgIHdoZXJlOiBbeyBmaWVsZDogXCJrZXlcIiwgdmFsdWU6IGtleSB9XSxcbiAgICAgICAgICAgIHVwZGF0ZToge1xuICAgICAgICAgICAgICBjb3VudDogdmFsdWUuY291bnQsXG4gICAgICAgICAgICAgIGxhc3RSZXF1ZXN0OiB2YWx1ZS5sYXN0UmVxdWVzdFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGF3YWl0IGRiLmNyZWF0ZSh7XG4gICAgICAgICAgICBtb2RlbCxcbiAgICAgICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAgICAga2V5LFxuICAgICAgICAgICAgICBjb3VudDogdmFsdWUuY291bnQsXG4gICAgICAgICAgICAgIGxhc3RSZXF1ZXN0OiB2YWx1ZS5sYXN0UmVxdWVzdFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgIGN0eC5sb2dnZXIuZXJyb3IoXCJFcnJvciBzZXR0aW5nIHJhdGUgbGltaXRcIiwgZSk7XG4gICAgICB9XG4gICAgfVxuICB9O1xufVxuY29uc3QgbWVtb3J5ID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbmZ1bmN0aW9uIGdldFJhdGVMaW1pdFN0b3JhZ2UoY3R4KSB7XG4gIGlmIChjdHgub3B0aW9ucy5yYXRlTGltaXQ/LmN1c3RvbVN0b3JhZ2UpIHtcbiAgICByZXR1cm4gY3R4Lm9wdGlvbnMucmF0ZUxpbWl0LmN1c3RvbVN0b3JhZ2U7XG4gIH1cbiAgaWYgKGN0eC5yYXRlTGltaXQuc3RvcmFnZSA9PT0gXCJzZWNvbmRhcnktc3RvcmFnZVwiKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGdldDogYXN5bmMgKGtleSkgPT4ge1xuICAgICAgICBjb25zdCBkYXRhID0gYXdhaXQgY3R4Lm9wdGlvbnMuc2Vjb25kYXJ5U3RvcmFnZT8uZ2V0KGtleSk7XG4gICAgICAgIHJldHVybiBkYXRhID8gc2FmZUpTT05QYXJzZShkYXRhKSA6IHZvaWQgMDtcbiAgICAgIH0sXG4gICAgICBzZXQ6IGFzeW5jIChrZXksIHZhbHVlKSA9PiB7XG4gICAgICAgIGF3YWl0IGN0eC5vcHRpb25zLnNlY29uZGFyeVN0b3JhZ2U/LnNldD8uKGtleSwgSlNPTi5zdHJpbmdpZnkodmFsdWUpKTtcbiAgICAgIH1cbiAgICB9O1xuICB9XG4gIGNvbnN0IHN0b3JhZ2UgPSBjdHgucmF0ZUxpbWl0LnN0b3JhZ2U7XG4gIGlmIChzdG9yYWdlID09PSBcIm1lbW9yeVwiKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGFzeW5jIGdldChrZXkpIHtcbiAgICAgICAgcmV0dXJuIG1lbW9yeS5nZXQoa2V5KTtcbiAgICAgIH0sXG4gICAgICBhc3luYyBzZXQoa2V5LCB2YWx1ZSwgX3VwZGF0ZSkge1xuICAgICAgICBtZW1vcnkuc2V0KGtleSwgdmFsdWUpO1xuICAgICAgfVxuICAgIH07XG4gIH1cbiAgcmV0dXJuIGNyZWF0ZURCU3RvcmFnZShjdHgpO1xufVxuYXN5bmMgZnVuY3Rpb24gb25SZXF1ZXN0UmF0ZUxpbWl0KHJlcSwgY3R4KSB7XG4gIGlmICghY3R4LnJhdGVMaW1pdC5lbmFibGVkKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IHBhdGggPSBuZXcgVVJMKHJlcS51cmwpLnBhdGhuYW1lLnJlcGxhY2UoXG4gICAgY3R4Lm9wdGlvbnMuYmFzZVBhdGggfHwgXCIvYXBpL2F1dGhcIixcbiAgICBcIlwiXG4gICk7XG4gIGxldCB3aW5kb3cgPSBjdHgucmF0ZUxpbWl0LndpbmRvdztcbiAgbGV0IG1heCA9IGN0eC5yYXRlTGltaXQubWF4O1xuICBjb25zdCBpcCA9IGdldElwKHJlcSwgY3R4Lm9wdGlvbnMpO1xuICBpZiAoIWlwKSB7XG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGtleSA9IGlwICsgcGF0aDtcbiAgY29uc3Qgc3BlY2lhbFJ1bGVzID0gZ2V0RGVmYXVsdFNwZWNpYWxSdWxlcygpO1xuICBjb25zdCBzcGVjaWFsUnVsZSA9IHNwZWNpYWxSdWxlcy5maW5kKChydWxlKSA9PiBydWxlLnBhdGhNYXRjaGVyKHBhdGgpKTtcbiAgaWYgKHNwZWNpYWxSdWxlKSB7XG4gICAgd2luZG93ID0gc3BlY2lhbFJ1bGUud2luZG93O1xuICAgIG1heCA9IHNwZWNpYWxSdWxlLm1heDtcbiAgfVxuICBmb3IgKGNvbnN0IHBsdWdpbiBvZiBjdHgub3B0aW9ucy5wbHVnaW5zIHx8IFtdKSB7XG4gICAgaWYgKHBsdWdpbi5yYXRlTGltaXQpIHtcbiAgICAgIGNvbnN0IG1hdGNoZWRSdWxlID0gcGx1Z2luLnJhdGVMaW1pdC5maW5kKFxuICAgICAgICAocnVsZSkgPT4gcnVsZS5wYXRoTWF0Y2hlcihwYXRoKVxuICAgICAgKTtcbiAgICAgIGlmIChtYXRjaGVkUnVsZSkge1xuICAgICAgICB3aW5kb3cgPSBtYXRjaGVkUnVsZS53aW5kb3c7XG4gICAgICAgIG1heCA9IG1hdGNoZWRSdWxlLm1heDtcbiAgICAgICAgYnJlYWs7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGlmIChjdHgucmF0ZUxpbWl0LmN1c3RvbVJ1bGVzKSB7XG4gICAgY29uc3QgX3BhdGggPSBPYmplY3Qua2V5cyhjdHgucmF0ZUxpbWl0LmN1c3RvbVJ1bGVzKS5maW5kKChwKSA9PiB7XG4gICAgICBpZiAocC5pbmNsdWRlcyhcIipcIikpIHtcbiAgICAgICAgY29uc3QgaXNNYXRjaCA9IHdpbGRjYXJkTWF0Y2gocCkocGF0aCk7XG4gICAgICAgIHJldHVybiBpc01hdGNoO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHAgPT09IHBhdGg7XG4gICAgfSk7XG4gICAgaWYgKF9wYXRoKSB7XG4gICAgICBjb25zdCBjdXN0b21SdWxlID0gY3R4LnJhdGVMaW1pdC5jdXN0b21SdWxlc1tfcGF0aF07XG4gICAgICBjb25zdCByZXNvbHZlZCA9IHR5cGVvZiBjdXN0b21SdWxlID09PSBcImZ1bmN0aW9uXCIgPyBhd2FpdCBjdXN0b21SdWxlKHJlcSkgOiBjdXN0b21SdWxlO1xuICAgICAgaWYgKHJlc29sdmVkKSB7XG4gICAgICAgIHdpbmRvdyA9IHJlc29sdmVkLndpbmRvdztcbiAgICAgICAgbWF4ID0gcmVzb2x2ZWQubWF4O1xuICAgICAgfVxuICAgICAgaWYgKHJlc29sdmVkID09PSBmYWxzZSkge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGNvbnN0IHN0b3JhZ2UgPSBnZXRSYXRlTGltaXRTdG9yYWdlKGN0eCk7XG4gIGNvbnN0IGRhdGEgPSBhd2FpdCBzdG9yYWdlLmdldChrZXkpO1xuICBjb25zdCBub3cgPSBEYXRlLm5vdygpO1xuICBpZiAoIWRhdGEpIHtcbiAgICBhd2FpdCBzdG9yYWdlLnNldChrZXksIHtcbiAgICAgIGtleSxcbiAgICAgIGNvdW50OiAxLFxuICAgICAgbGFzdFJlcXVlc3Q6IG5vd1xuICAgIH0pO1xuICB9IGVsc2Uge1xuICAgIGNvbnN0IHRpbWVTaW5jZUxhc3RSZXF1ZXN0ID0gbm93IC0gZGF0YS5sYXN0UmVxdWVzdDtcbiAgICBpZiAoc2hvdWxkUmF0ZUxpbWl0KG1heCwgd2luZG93LCBkYXRhKSkge1xuICAgICAgY29uc3QgcmV0cnlBZnRlciA9IGdldFJldHJ5QWZ0ZXIoZGF0YS5sYXN0UmVxdWVzdCwgd2luZG93KTtcbiAgICAgIHJldHVybiByYXRlTGltaXRSZXNwb25zZShyZXRyeUFmdGVyKTtcbiAgICB9IGVsc2UgaWYgKHRpbWVTaW5jZUxhc3RSZXF1ZXN0ID4gd2luZG93ICogMWUzKSB7XG4gICAgICBhd2FpdCBzdG9yYWdlLnNldChcbiAgICAgICAga2V5LFxuICAgICAgICB7XG4gICAgICAgICAgLi4uZGF0YSxcbiAgICAgICAgICBjb3VudDogMSxcbiAgICAgICAgICBsYXN0UmVxdWVzdDogbm93XG4gICAgICAgIH0sXG4gICAgICAgIHRydWVcbiAgICAgICk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGF3YWl0IHN0b3JhZ2Uuc2V0KFxuICAgICAgICBrZXksXG4gICAgICAgIHtcbiAgICAgICAgICAuLi5kYXRhLFxuICAgICAgICAgIGNvdW50OiBkYXRhLmNvdW50ICsgMSxcbiAgICAgICAgICBsYXN0UmVxdWVzdDogbm93XG4gICAgICAgIH0sXG4gICAgICAgIHRydWVcbiAgICAgICk7XG4gICAgfVxuICB9XG59XG5mdW5jdGlvbiBnZXREZWZhdWx0U3BlY2lhbFJ1bGVzKCkge1xuICBjb25zdCBzcGVjaWFsUnVsZXMgPSBbXG4gICAge1xuICAgICAgcGF0aE1hdGNoZXIocGF0aCkge1xuICAgICAgICByZXR1cm4gcGF0aC5zdGFydHNXaXRoKFwiL3NpZ24taW5cIikgfHwgcGF0aC5zdGFydHNXaXRoKFwiL3NpZ24tdXBcIikgfHwgcGF0aC5zdGFydHNXaXRoKFwiL2NoYW5nZS1wYXNzd29yZFwiKSB8fCBwYXRoLnN0YXJ0c1dpdGgoXCIvY2hhbmdlLWVtYWlsXCIpO1xuICAgICAgfSxcbiAgICAgIHdpbmRvdzogMTAsXG4gICAgICBtYXg6IDNcbiAgICB9XG4gIF07XG4gIHJldHVybiBzcGVjaWFsUnVsZXM7XG59XG5cbmZ1bmN0aW9uIGNoZWNrRW5kcG9pbnRDb25mbGljdHMob3B0aW9ucywgbG9nZ2VyMikge1xuICBjb25zdCBlbmRwb2ludFJlZ2lzdHJ5ID0gLyogQF9fUFVSRV9fICovIG5ldyBNYXAoKTtcbiAgb3B0aW9ucy5wbHVnaW5zPy5mb3JFYWNoKChwbHVnaW4pID0+IHtcbiAgICBpZiAocGx1Z2luLmVuZHBvaW50cykge1xuICAgICAgZm9yIChjb25zdCBba2V5LCBlbmRwb2ludF0gb2YgT2JqZWN0LmVudHJpZXMocGx1Z2luLmVuZHBvaW50cykpIHtcbiAgICAgICAgaWYgKGVuZHBvaW50ICYmIFwicGF0aFwiIGluIGVuZHBvaW50KSB7XG4gICAgICAgICAgY29uc3QgcGF0aCA9IGVuZHBvaW50LnBhdGg7XG4gICAgICAgICAgaWYgKCFlbmRwb2ludFJlZ2lzdHJ5LmhhcyhwYXRoKSkge1xuICAgICAgICAgICAgZW5kcG9pbnRSZWdpc3RyeS5zZXQocGF0aCwgW10pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBlbmRwb2ludFJlZ2lzdHJ5LmdldChwYXRoKS5wdXNoKHtcbiAgICAgICAgICAgIHBsdWdpbklkOiBwbHVnaW4uaWQsXG4gICAgICAgICAgICBlbmRwb2ludEtleToga2V5XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuICBjb25zdCBjb25mbGljdHMgPSBbXTtcbiAgZm9yIChjb25zdCBbcGF0aCwgZW50cmllc10gb2YgZW5kcG9pbnRSZWdpc3RyeS5lbnRyaWVzKCkpIHtcbiAgICBpZiAoZW50cmllcy5sZW5ndGggPiAxKSB7XG4gICAgICBjb25zdCB1bmlxdWVQbHVnaW5zID0gWy4uLm5ldyBTZXQoZW50cmllcy5tYXAoKGUpID0+IGUucGx1Z2luSWQpKV07XG4gICAgICBjb25mbGljdHMucHVzaCh7XG4gICAgICAgIHBhdGgsXG4gICAgICAgIHBsdWdpbnM6IHVuaXF1ZVBsdWdpbnNcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBpZiAoY29uZmxpY3RzLmxlbmd0aCA+IDApIHtcbiAgICBjb25zdCBjb25mbGljdE1lc3NhZ2VzID0gY29uZmxpY3RzLm1hcChcbiAgICAgIChjb25mbGljdCkgPT4gYCAgLSBcIiR7Y29uZmxpY3QucGF0aH1cIiB1c2VkIGJ5IHBsdWdpbnM6ICR7Y29uZmxpY3QucGx1Z2lucy5qb2luKFwiLCBcIil9YFxuICAgICkuam9pbihcIlxcblwiKTtcbiAgICBsb2dnZXIyLmVycm9yKFxuICAgICAgYEVuZHBvaW50IHBhdGggY29uZmxpY3RzIGRldGVjdGVkISBNdWx0aXBsZSBwbHVnaW5zIGFyZSB0cnlpbmcgdG8gdXNlIHRoZSBzYW1lIGVuZHBvaW50IHBhdGhzOlxuJHtjb25mbGljdE1lc3NhZ2VzfVxuXG5UbyByZXNvbHZlIHRoaXMsIHlvdSBjYW46XG5cdDEuIFVzZSBvbmx5IG9uZSBvZiB0aGUgY29uZmxpY3RpbmcgcGx1Z2luc1xuXHQyLiBDb25maWd1cmUgdGhlIHBsdWdpbnMgdG8gdXNlIGRpZmZlcmVudCBwYXRocyAoaWYgc3VwcG9ydGVkKVxuYFxuICAgICk7XG4gIH1cbn1cbmZ1bmN0aW9uIGdldEVuZHBvaW50cyhjdHgsIG9wdGlvbnMpIHtcbiAgY29uc3QgcGx1Z2luRW5kcG9pbnRzID0gb3B0aW9ucy5wbHVnaW5zPy5yZWR1Y2UoXG4gICAgKGFjYywgcGx1Z2luKSA9PiB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICAuLi5hY2MsXG4gICAgICAgIC4uLnBsdWdpbi5lbmRwb2ludHNcbiAgICAgIH07XG4gICAgfSxcbiAgICB7fVxuICApO1xuICBjb25zdCBtaWRkbGV3YXJlcyA9IG9wdGlvbnMucGx1Z2lucz8ubWFwKFxuICAgIChwbHVnaW4pID0+IHBsdWdpbi5taWRkbGV3YXJlcz8ubWFwKChtKSA9PiB7XG4gICAgICBjb25zdCBtaWRkbGV3YXJlID0gKGFzeW5jIChjb250ZXh0KSA9PiB7XG4gICAgICAgIGNvbnN0IGF1dGhDb250ZXh0ID0gYXdhaXQgY3R4O1xuICAgICAgICByZXR1cm4gbS5taWRkbGV3YXJlKHtcbiAgICAgICAgICAuLi5jb250ZXh0LFxuICAgICAgICAgIGNvbnRleHQ6IHtcbiAgICAgICAgICAgIC4uLmF1dGhDb250ZXh0LFxuICAgICAgICAgICAgLi4uY29udGV4dC5jb250ZXh0XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH0pO1xuICAgICAgbWlkZGxld2FyZS5vcHRpb25zID0gbS5taWRkbGV3YXJlLm9wdGlvbnM7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBwYXRoOiBtLnBhdGgsXG4gICAgICAgIG1pZGRsZXdhcmVcbiAgICAgIH07XG4gICAgfSlcbiAgKS5maWx0ZXIoKHBsdWdpbikgPT4gcGx1Z2luICE9PSB2b2lkIDApLmZsYXQoKSB8fCBbXTtcbiAgY29uc3QgYmFzZUVuZHBvaW50cyA9IHtcbiAgICBzaWduSW5Tb2NpYWwsXG4gICAgY2FsbGJhY2tPQXV0aCxcbiAgICBnZXRTZXNzaW9uOiBnZXRTZXNzaW9uKCksXG4gICAgc2lnbk91dCxcbiAgICBzaWduVXBFbWFpbDogc2lnblVwRW1haWwoKSxcbiAgICBzaWduSW5FbWFpbCxcbiAgICBmb3JnZXRQYXNzd29yZCxcbiAgICByZXNldFBhc3N3b3JkLFxuICAgIHZlcmlmeUVtYWlsLFxuICAgIHNlbmRWZXJpZmljYXRpb25FbWFpbCxcbiAgICBjaGFuZ2VFbWFpbCxcbiAgICBjaGFuZ2VQYXNzd29yZCxcbiAgICBzZXRQYXNzd29yZCxcbiAgICB1cGRhdGVVc2VyOiB1cGRhdGVVc2VyKCksXG4gICAgZGVsZXRlVXNlcixcbiAgICBmb3JnZXRQYXNzd29yZENhbGxiYWNrLFxuICAgIHJlcXVlc3RQYXNzd29yZFJlc2V0LFxuICAgIHJlcXVlc3RQYXNzd29yZFJlc2V0Q2FsbGJhY2ssXG4gICAgbGlzdFNlc3Npb25zOiBsaXN0U2Vzc2lvbnMoKSxcbiAgICByZXZva2VTZXNzaW9uLFxuICAgIHJldm9rZVNlc3Npb25zLFxuICAgIHJldm9rZU90aGVyU2Vzc2lvbnMsXG4gICAgbGlua1NvY2lhbEFjY291bnQsXG4gICAgbGlzdFVzZXJBY2NvdW50cyxcbiAgICBkZWxldGVVc2VyQ2FsbGJhY2ssXG4gICAgdW5saW5rQWNjb3VudCxcbiAgICByZWZyZXNoVG9rZW4sXG4gICAgZ2V0QWNjZXNzVG9rZW4sXG4gICAgYWNjb3VudEluZm9cbiAgfTtcbiAgY29uc3QgZW5kcG9pbnRzID0ge1xuICAgIC4uLmJhc2VFbmRwb2ludHMsXG4gICAgLi4ucGx1Z2luRW5kcG9pbnRzLFxuICAgIG9rLFxuICAgIGVycm9yXG4gIH07XG4gIGNvbnN0IGFwaSA9IHRvQXV0aEVuZHBvaW50cyhlbmRwb2ludHMsIGN0eCk7XG4gIHJldHVybiB7XG4gICAgYXBpLFxuICAgIG1pZGRsZXdhcmVzXG4gIH07XG59XG5jb25zdCByb3V0ZXIgPSAoY3R4LCBvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHsgYXBpLCBtaWRkbGV3YXJlcyB9ID0gZ2V0RW5kcG9pbnRzKGN0eCwgb3B0aW9ucyk7XG4gIGNvbnN0IGJhc2VQYXRoID0gbmV3IFVSTChjdHguYmFzZVVSTCkucGF0aG5hbWU7XG4gIHJldHVybiBjcmVhdGVSb3V0ZXIoYXBpLCB7XG4gICAgcm91dGVyQ29udGV4dDogY3R4LFxuICAgIG9wZW5hcGk6IHtcbiAgICAgIGRpc2FibGVkOiB0cnVlXG4gICAgfSxcbiAgICBiYXNlUGF0aCxcbiAgICByb3V0ZXJNaWRkbGV3YXJlOiBbXG4gICAgICB7XG4gICAgICAgIHBhdGg6IFwiLyoqXCIsXG4gICAgICAgIG1pZGRsZXdhcmU6IG9yaWdpbkNoZWNrTWlkZGxld2FyZVxuICAgICAgfSxcbiAgICAgIC4uLm1pZGRsZXdhcmVzXG4gICAgXSxcbiAgICBhc3luYyBvblJlcXVlc3QocmVxKSB7XG4gICAgICBjb25zdCBkaXNhYmxlZFBhdGhzID0gY3R4Lm9wdGlvbnMuZGlzYWJsZWRQYXRocyB8fCBbXTtcbiAgICAgIGNvbnN0IHBhdGggPSBuZXcgVVJMKHJlcS51cmwpLnBhdGhuYW1lLnJlcGxhY2UoYmFzZVBhdGgsIFwiXCIpO1xuICAgICAgaWYgKGRpc2FibGVkUGF0aHMuaW5jbHVkZXMocGF0aCkpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBSZXNwb25zZShcIk5vdCBGb3VuZFwiLCB7IHN0YXR1czogNDA0IH0pO1xuICAgICAgfVxuICAgICAgZm9yIChjb25zdCBwbHVnaW4gb2YgY3R4Lm9wdGlvbnMucGx1Z2lucyB8fCBbXSkge1xuICAgICAgICBpZiAocGx1Z2luLm9uUmVxdWVzdCkge1xuICAgICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcGx1Z2luLm9uUmVxdWVzdChyZXEsIGN0eCk7XG4gICAgICAgICAgaWYgKHJlc3BvbnNlICYmIFwicmVzcG9uc2VcIiBpbiByZXNwb25zZSkge1xuICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlLnJlc3BvbnNlO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgcmV0dXJuIG9uUmVxdWVzdFJhdGVMaW1pdChyZXEsIGN0eCk7XG4gICAgfSxcbiAgICBhc3luYyBvblJlc3BvbnNlKHJlcykge1xuICAgICAgZm9yIChjb25zdCBwbHVnaW4gb2YgY3R4Lm9wdGlvbnMucGx1Z2lucyB8fCBbXSkge1xuICAgICAgICBpZiAocGx1Z2luLm9uUmVzcG9uc2UpIHtcbiAgICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHBsdWdpbi5vblJlc3BvbnNlKHJlcywgY3R4KTtcbiAgICAgICAgICBpZiAocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIHJldHVybiByZXNwb25zZS5yZXNwb25zZTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiByZXM7XG4gICAgfSxcbiAgICBvbkVycm9yKGUpIHtcbiAgICAgIGlmIChlIGluc3RhbmNlb2YgQVBJRXJyb3IgJiYgZS5zdGF0dXMgPT09IFwiRk9VTkRcIikge1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy5vbkFQSUVycm9yPy50aHJvdykge1xuICAgICAgICB0aHJvdyBlO1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMub25BUElFcnJvcj8ub25FcnJvcikge1xuICAgICAgICBvcHRpb25zLm9uQVBJRXJyb3Iub25FcnJvcihlLCBjdHgpO1xuICAgICAgICByZXR1cm47XG4gICAgICB9XG4gICAgICBjb25zdCBvcHRMb2dMZXZlbCA9IG9wdGlvbnMubG9nZ2VyPy5sZXZlbDtcbiAgICAgIGNvbnN0IGxvZyA9IG9wdExvZ0xldmVsID09PSBcImVycm9yXCIgfHwgb3B0TG9nTGV2ZWwgPT09IFwid2FyblwiIHx8IG9wdExvZ0xldmVsID09PSBcImRlYnVnXCIgPyBsb2dnZXIgOiB2b2lkIDA7XG4gICAgICBpZiAob3B0aW9ucy5sb2dnZXI/LmRpc2FibGVkICE9PSB0cnVlKSB7XG4gICAgICAgIGlmIChlICYmIHR5cGVvZiBlID09PSBcIm9iamVjdFwiICYmIFwibWVzc2FnZVwiIGluIGUgJiYgdHlwZW9mIGUubWVzc2FnZSA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgIGlmIChlLm1lc3NhZ2UuaW5jbHVkZXMoXCJubyBjb2x1bW5cIikgfHwgZS5tZXNzYWdlLmluY2x1ZGVzKFwiY29sdW1uXCIpIHx8IGUubWVzc2FnZS5pbmNsdWRlcyhcInJlbGF0aW9uXCIpIHx8IGUubWVzc2FnZS5pbmNsdWRlcyhcInRhYmxlXCIpIHx8IGUubWVzc2FnZS5pbmNsdWRlcyhcImRvZXMgbm90IGV4aXN0XCIpKSB7XG4gICAgICAgICAgICBjdHgubG9nZ2VyPy5lcnJvcihlLm1lc3NhZ2UpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAoZSBpbnN0YW5jZW9mIEFQSUVycm9yKSB7XG4gICAgICAgICAgaWYgKGUuc3RhdHVzID09PSBcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiKSB7XG4gICAgICAgICAgICBjdHgubG9nZ2VyLmVycm9yKGUuc3RhdHVzLCBlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgbG9nPy5lcnJvcihlLm1lc3NhZ2UpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGN0eC5sb2dnZXI/LmVycm9yKFxuICAgICAgICAgICAgZSAmJiB0eXBlb2YgZSA9PT0gXCJvYmplY3RcIiAmJiBcIm5hbWVcIiBpbiBlID8gZS5uYW1lIDogXCJcIixcbiAgICAgICAgICAgIGVcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9KTtcbn07XG5cbmV4cG9ydCB7IGFjY291bnRJbmZvLCBjYWxsYmFja09BdXRoLCBjaGFuZ2VFbWFpbCwgY2hhbmdlUGFzc3dvcmQsIGNoZWNrRW5kcG9pbnRDb25mbGljdHMsIGNyZWF0ZUF1dGhFbmRwb2ludCwgY3JlYXRlRW1haWxWZXJpZmljYXRpb25Ub2tlbiwgZGVsZXRlVXNlciwgZGVsZXRlVXNlckNhbGxiYWNrLCBlcnJvciwgZm9yZ2V0UGFzc3dvcmQsIGZvcmdldFBhc3N3b3JkQ2FsbGJhY2ssIGdldEFjY2Vzc1Rva2VuLCBnZXRFbmRwb2ludHMsIGdldFNlc3Npb24sIGxpbmtTb2NpYWxBY2NvdW50LCBsaXN0U2Vzc2lvbnMsIGxpc3RVc2VyQWNjb3VudHMsIG9rLCBvcmlnaW5DaGVja01pZGRsZXdhcmUsIHJlZnJlc2hUb2tlbiwgcmVxdWVzdFBhc3N3b3JkUmVzZXQsIHJlcXVlc3RQYXNzd29yZFJlc2V0Q2FsbGJhY2ssIHJlc2V0UGFzc3dvcmQsIHJldm9rZU90aGVyU2Vzc2lvbnMsIHJldm9rZVNlc3Npb24sIHJldm9rZVNlc3Npb25zLCByb3V0ZXIsIHNlbmRWZXJpZmljYXRpb25FbWFpbCwgc2V0UGFzc3dvcmQsIHNpZ25JbkVtYWlsLCBzaWduSW5Tb2NpYWwsIHNpZ25PdXQsIHNpZ25VcEVtYWlsLCB1bmxpbmtBY2NvdW50LCB1cGRhdGVVc2VyLCB2ZXJpZnlFbWFpbCB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/api/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/chunks/bun-sqlite-dialect.mjs":
/*!*********************************************************************!*\
  !*** ./node_modules/better-auth/dist/chunks/bun-sqlite-dialect.mjs ***!
  \*********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   BunSqliteAdapter: () => (/* binding */ BunSqliteAdapter),\n/* harmony export */   BunSqliteDialect: () => (/* binding */ BunSqliteDialect),\n/* harmony export */   BunSqliteDriver: () => (/* binding */ BunSqliteDriver),\n/* harmony export */   BunSqliteIntrospector: () => (/* binding */ BunSqliteIntrospector),\n/* harmony export */   BunSqliteQueryCompiler: () => (/* binding */ BunSqliteQueryCompiler)\n/* harmony export */ });\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/query-compiler/compiled-query.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/migration/migrator.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/raw-builder/sql.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/query-compiler/default-query-compiler.js\");\n\n\nclass BunSqliteAdapter {\n  get supportsCreateIfNotExists() {\n    return true;\n  }\n  get supportsTransactionalDdl() {\n    return false;\n  }\n  get supportsReturning() {\n    return true;\n  }\n  async acquireMigrationLock() {\n  }\n  async releaseMigrationLock() {\n  }\n  get supportsOutput() {\n    return true;\n  }\n}\nclass BunSqliteDriver {\n  #config;\n  #connectionMutex = new ConnectionMutex();\n  #db;\n  #connection;\n  constructor(config) {\n    this.#config = { ...config };\n  }\n  async init() {\n    this.#db = this.#config.database;\n    this.#connection = new BunSqliteConnection(this.#db);\n    if (this.#config.onCreateConnection) {\n      await this.#config.onCreateConnection(this.#connection);\n    }\n  }\n  async acquireConnection() {\n    await this.#connectionMutex.lock();\n    return this.#connection;\n  }\n  async beginTransaction(connection) {\n    await connection.executeQuery(kysely__WEBPACK_IMPORTED_MODULE_0__.CompiledQuery.raw(\"begin\"));\n  }\n  async commitTransaction(connection) {\n    await connection.executeQuery(kysely__WEBPACK_IMPORTED_MODULE_0__.CompiledQuery.raw(\"commit\"));\n  }\n  async rollbackTransaction(connection) {\n    await connection.executeQuery(kysely__WEBPACK_IMPORTED_MODULE_0__.CompiledQuery.raw(\"rollback\"));\n  }\n  async releaseConnection() {\n    this.#connectionMutex.unlock();\n  }\n  async destroy() {\n    this.#db?.close();\n  }\n}\nclass BunSqliteConnection {\n  #db;\n  constructor(db) {\n    this.#db = db;\n  }\n  executeQuery(compiledQuery) {\n    const { sql: sql2, parameters } = compiledQuery;\n    const stmt = this.#db.prepare(sql2);\n    return Promise.resolve({\n      rows: stmt.all(parameters)\n    });\n  }\n  async *streamQuery() {\n    throw new Error(\"Streaming query is not supported by SQLite driver.\");\n  }\n}\nclass ConnectionMutex {\n  #promise;\n  #resolve;\n  async lock() {\n    while (this.#promise) {\n      await this.#promise;\n    }\n    this.#promise = new Promise((resolve) => {\n      this.#resolve = resolve;\n    });\n  }\n  unlock() {\n    const resolve = this.#resolve;\n    this.#promise = void 0;\n    this.#resolve = void 0;\n    resolve?.();\n  }\n}\nclass BunSqliteIntrospector {\n  #db;\n  constructor(db) {\n    this.#db = db;\n  }\n  async getSchemas() {\n    return [];\n  }\n  async getTables(options = { withInternalKyselyTables: false }) {\n    let query = this.#db.selectFrom(\"sqlite_schema\").where(\"type\", \"=\", \"table\").where(\"name\", \"not like\", \"sqlite_%\").select(\"name\").$castTo();\n    if (!options.withInternalKyselyTables) {\n      query = query.where(\"name\", \"!=\", kysely__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_MIGRATION_TABLE).where(\"name\", \"!=\", kysely__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_MIGRATION_LOCK_TABLE);\n    }\n    const tables = await query.execute();\n    return Promise.all(tables.map(({ name }) => this.#getTableMetadata(name)));\n  }\n  async getMetadata(options) {\n    return {\n      tables: await this.getTables(options)\n    };\n  }\n  async #getTableMetadata(table) {\n    const db = this.#db;\n    const createSql = await db.selectFrom(\"sqlite_master\").where(\"name\", \"=\", table).select(\"sql\").$castTo().execute();\n    const autoIncrementCol = createSql[0]?.sql?.split(/[\\(\\),]/)?.find((it) => it.toLowerCase().includes(\"autoincrement\"))?.split(/\\s+/)?.[0]?.replace(/[\"`]/g, \"\");\n    const columns = await db.selectFrom(\n      (0,kysely__WEBPACK_IMPORTED_MODULE_2__.sql)`pragma_table_info(${table})`.as(\"table_info\")\n    ).select([\"name\", \"type\", \"notnull\", \"dflt_value\"]).execute();\n    return {\n      name: table,\n      columns: columns.map((col) => ({\n        name: col.name,\n        dataType: col.type,\n        isNullable: !col.notnull,\n        isAutoIncrementing: col.name === autoIncrementCol,\n        hasDefaultValue: col.dflt_value != null\n      })),\n      isView: true\n    };\n  }\n}\nclass BunSqliteQueryCompiler extends kysely__WEBPACK_IMPORTED_MODULE_3__.DefaultQueryCompiler {\n  getCurrentParameterPlaceholder() {\n    return \"?\";\n  }\n  getLeftIdentifierWrapper() {\n    return '\"';\n  }\n  getRightIdentifierWrapper() {\n    return '\"';\n  }\n  getAutoIncrement() {\n    return \"autoincrement\";\n  }\n}\nclass BunSqliteDialect {\n  #config;\n  constructor(config) {\n    this.#config = { ...config };\n  }\n  createDriver() {\n    return new BunSqliteDriver(this.#config);\n  }\n  createQueryCompiler() {\n    return new BunSqliteQueryCompiler();\n  }\n  createAdapter() {\n    return new BunSqliteAdapter();\n  }\n  createIntrospector(db) {\n    return new BunSqliteIntrospector(db);\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVua3MvYnVuLXNxbGl0ZS1kaWFsZWN0Lm1qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBeUg7O0FBRXpIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyxpREFBYTtBQUMvQztBQUNBO0FBQ0Esa0NBQWtDLGlEQUFhO0FBQy9DO0FBQ0E7QUFDQSxrQ0FBa0MsaURBQWE7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVksd0JBQXdCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLGlDQUFpQztBQUMvRDtBQUNBO0FBQ0Esd0NBQXdDLDJEQUF1QixzQkFBc0IsZ0VBQTRCO0FBQ2pIO0FBQ0E7QUFDQSxxQ0FBcUMsTUFBTTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSwyQ0FBRyxxQkFBcUIsTUFBTTtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQ0FBcUMsd0RBQW9CO0FBQ3pEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRThHIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxjaHVua3NcXGJ1bi1zcWxpdGUtZGlhbGVjdC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcGlsZWRRdWVyeSwgRGVmYXVsdFF1ZXJ5Q29tcGlsZXIsIERFRkFVTFRfTUlHUkFUSU9OX1RBQkxFLCBERUZBVUxUX01JR1JBVElPTl9MT0NLX1RBQkxFLCBzcWwgfSBmcm9tICdreXNlbHknO1xuXG5jbGFzcyBCdW5TcWxpdGVBZGFwdGVyIHtcbiAgZ2V0IHN1cHBvcnRzQ3JlYXRlSWZOb3RFeGlzdHMoKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgZ2V0IHN1cHBvcnRzVHJhbnNhY3Rpb25hbERkbCgpIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbiAgZ2V0IHN1cHBvcnRzUmV0dXJuaW5nKCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG4gIGFzeW5jIGFjcXVpcmVNaWdyYXRpb25Mb2NrKCkge1xuICB9XG4gIGFzeW5jIHJlbGVhc2VNaWdyYXRpb25Mb2NrKCkge1xuICB9XG4gIGdldCBzdXBwb3J0c091dHB1dCgpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxufVxuY2xhc3MgQnVuU3FsaXRlRHJpdmVyIHtcbiAgI2NvbmZpZztcbiAgI2Nvbm5lY3Rpb25NdXRleCA9IG5ldyBDb25uZWN0aW9uTXV0ZXgoKTtcbiAgI2RiO1xuICAjY29ubmVjdGlvbjtcbiAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgdGhpcy4jY29uZmlnID0geyAuLi5jb25maWcgfTtcbiAgfVxuICBhc3luYyBpbml0KCkge1xuICAgIHRoaXMuI2RiID0gdGhpcy4jY29uZmlnLmRhdGFiYXNlO1xuICAgIHRoaXMuI2Nvbm5lY3Rpb24gPSBuZXcgQnVuU3FsaXRlQ29ubmVjdGlvbih0aGlzLiNkYik7XG4gICAgaWYgKHRoaXMuI2NvbmZpZy5vbkNyZWF0ZUNvbm5lY3Rpb24pIHtcbiAgICAgIGF3YWl0IHRoaXMuI2NvbmZpZy5vbkNyZWF0ZUNvbm5lY3Rpb24odGhpcy4jY29ubmVjdGlvbik7XG4gICAgfVxuICB9XG4gIGFzeW5jIGFjcXVpcmVDb25uZWN0aW9uKCkge1xuICAgIGF3YWl0IHRoaXMuI2Nvbm5lY3Rpb25NdXRleC5sb2NrKCk7XG4gICAgcmV0dXJuIHRoaXMuI2Nvbm5lY3Rpb247XG4gIH1cbiAgYXN5bmMgYmVnaW5UcmFuc2FjdGlvbihjb25uZWN0aW9uKSB7XG4gICAgYXdhaXQgY29ubmVjdGlvbi5leGVjdXRlUXVlcnkoQ29tcGlsZWRRdWVyeS5yYXcoXCJiZWdpblwiKSk7XG4gIH1cbiAgYXN5bmMgY29tbWl0VHJhbnNhY3Rpb24oY29ubmVjdGlvbikge1xuICAgIGF3YWl0IGNvbm5lY3Rpb24uZXhlY3V0ZVF1ZXJ5KENvbXBpbGVkUXVlcnkucmF3KFwiY29tbWl0XCIpKTtcbiAgfVxuICBhc3luYyByb2xsYmFja1RyYW5zYWN0aW9uKGNvbm5lY3Rpb24pIHtcbiAgICBhd2FpdCBjb25uZWN0aW9uLmV4ZWN1dGVRdWVyeShDb21waWxlZFF1ZXJ5LnJhdyhcInJvbGxiYWNrXCIpKTtcbiAgfVxuICBhc3luYyByZWxlYXNlQ29ubmVjdGlvbigpIHtcbiAgICB0aGlzLiNjb25uZWN0aW9uTXV0ZXgudW5sb2NrKCk7XG4gIH1cbiAgYXN5bmMgZGVzdHJveSgpIHtcbiAgICB0aGlzLiNkYj8uY2xvc2UoKTtcbiAgfVxufVxuY2xhc3MgQnVuU3FsaXRlQ29ubmVjdGlvbiB7XG4gICNkYjtcbiAgY29uc3RydWN0b3IoZGIpIHtcbiAgICB0aGlzLiNkYiA9IGRiO1xuICB9XG4gIGV4ZWN1dGVRdWVyeShjb21waWxlZFF1ZXJ5KSB7XG4gICAgY29uc3QgeyBzcWw6IHNxbDIsIHBhcmFtZXRlcnMgfSA9IGNvbXBpbGVkUXVlcnk7XG4gICAgY29uc3Qgc3RtdCA9IHRoaXMuI2RiLnByZXBhcmUoc3FsMik7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICByb3dzOiBzdG10LmFsbChwYXJhbWV0ZXJzKVxuICAgIH0pO1xuICB9XG4gIGFzeW5jICpzdHJlYW1RdWVyeSgpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJTdHJlYW1pbmcgcXVlcnkgaXMgbm90IHN1cHBvcnRlZCBieSBTUUxpdGUgZHJpdmVyLlwiKTtcbiAgfVxufVxuY2xhc3MgQ29ubmVjdGlvbk11dGV4IHtcbiAgI3Byb21pc2U7XG4gICNyZXNvbHZlO1xuICBhc3luYyBsb2NrKCkge1xuICAgIHdoaWxlICh0aGlzLiNwcm9taXNlKSB7XG4gICAgICBhd2FpdCB0aGlzLiNwcm9taXNlO1xuICAgIH1cbiAgICB0aGlzLiNwcm9taXNlID0gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHtcbiAgICAgIHRoaXMuI3Jlc29sdmUgPSByZXNvbHZlO1xuICAgIH0pO1xuICB9XG4gIHVubG9jaygpIHtcbiAgICBjb25zdCByZXNvbHZlID0gdGhpcy4jcmVzb2x2ZTtcbiAgICB0aGlzLiNwcm9taXNlID0gdm9pZCAwO1xuICAgIHRoaXMuI3Jlc29sdmUgPSB2b2lkIDA7XG4gICAgcmVzb2x2ZT8uKCk7XG4gIH1cbn1cbmNsYXNzIEJ1blNxbGl0ZUludHJvc3BlY3RvciB7XG4gICNkYjtcbiAgY29uc3RydWN0b3IoZGIpIHtcbiAgICB0aGlzLiNkYiA9IGRiO1xuICB9XG4gIGFzeW5jIGdldFNjaGVtYXMoKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIGFzeW5jIGdldFRhYmxlcyhvcHRpb25zID0geyB3aXRoSW50ZXJuYWxLeXNlbHlUYWJsZXM6IGZhbHNlIH0pIHtcbiAgICBsZXQgcXVlcnkgPSB0aGlzLiNkYi5zZWxlY3RGcm9tKFwic3FsaXRlX3NjaGVtYVwiKS53aGVyZShcInR5cGVcIiwgXCI9XCIsIFwidGFibGVcIikud2hlcmUoXCJuYW1lXCIsIFwibm90IGxpa2VcIiwgXCJzcWxpdGVfJVwiKS5zZWxlY3QoXCJuYW1lXCIpLiRjYXN0VG8oKTtcbiAgICBpZiAoIW9wdGlvbnMud2l0aEludGVybmFsS3lzZWx5VGFibGVzKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKFwibmFtZVwiLCBcIiE9XCIsIERFRkFVTFRfTUlHUkFUSU9OX1RBQkxFKS53aGVyZShcIm5hbWVcIiwgXCIhPVwiLCBERUZBVUxUX01JR1JBVElPTl9MT0NLX1RBQkxFKTtcbiAgICB9XG4gICAgY29uc3QgdGFibGVzID0gYXdhaXQgcXVlcnkuZXhlY3V0ZSgpO1xuICAgIHJldHVybiBQcm9taXNlLmFsbCh0YWJsZXMubWFwKCh7IG5hbWUgfSkgPT4gdGhpcy4jZ2V0VGFibGVNZXRhZGF0YShuYW1lKSkpO1xuICB9XG4gIGFzeW5jIGdldE1ldGFkYXRhKG9wdGlvbnMpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdGFibGVzOiBhd2FpdCB0aGlzLmdldFRhYmxlcyhvcHRpb25zKVxuICAgIH07XG4gIH1cbiAgYXN5bmMgI2dldFRhYmxlTWV0YWRhdGEodGFibGUpIHtcbiAgICBjb25zdCBkYiA9IHRoaXMuI2RiO1xuICAgIGNvbnN0IGNyZWF0ZVNxbCA9IGF3YWl0IGRiLnNlbGVjdEZyb20oXCJzcWxpdGVfbWFzdGVyXCIpLndoZXJlKFwibmFtZVwiLCBcIj1cIiwgdGFibGUpLnNlbGVjdChcInNxbFwiKS4kY2FzdFRvKCkuZXhlY3V0ZSgpO1xuICAgIGNvbnN0IGF1dG9JbmNyZW1lbnRDb2wgPSBjcmVhdGVTcWxbMF0/LnNxbD8uc3BsaXQoL1tcXChcXCksXS8pPy5maW5kKChpdCkgPT4gaXQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImF1dG9pbmNyZW1lbnRcIikpPy5zcGxpdCgvXFxzKy8pPy5bMF0/LnJlcGxhY2UoL1tcImBdL2csIFwiXCIpO1xuICAgIGNvbnN0IGNvbHVtbnMgPSBhd2FpdCBkYi5zZWxlY3RGcm9tKFxuICAgICAgc3FsYHByYWdtYV90YWJsZV9pbmZvKCR7dGFibGV9KWAuYXMoXCJ0YWJsZV9pbmZvXCIpXG4gICAgKS5zZWxlY3QoW1wibmFtZVwiLCBcInR5cGVcIiwgXCJub3RudWxsXCIsIFwiZGZsdF92YWx1ZVwiXSkuZXhlY3V0ZSgpO1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0YWJsZSxcbiAgICAgIGNvbHVtbnM6IGNvbHVtbnMubWFwKChjb2wpID0+ICh7XG4gICAgICAgIG5hbWU6IGNvbC5uYW1lLFxuICAgICAgICBkYXRhVHlwZTogY29sLnR5cGUsXG4gICAgICAgIGlzTnVsbGFibGU6ICFjb2wubm90bnVsbCxcbiAgICAgICAgaXNBdXRvSW5jcmVtZW50aW5nOiBjb2wubmFtZSA9PT0gYXV0b0luY3JlbWVudENvbCxcbiAgICAgICAgaGFzRGVmYXVsdFZhbHVlOiBjb2wuZGZsdF92YWx1ZSAhPSBudWxsXG4gICAgICB9KSksXG4gICAgICBpc1ZpZXc6IHRydWVcbiAgICB9O1xuICB9XG59XG5jbGFzcyBCdW5TcWxpdGVRdWVyeUNvbXBpbGVyIGV4dGVuZHMgRGVmYXVsdFF1ZXJ5Q29tcGlsZXIge1xuICBnZXRDdXJyZW50UGFyYW1ldGVyUGxhY2Vob2xkZXIoKSB7XG4gICAgcmV0dXJuIFwiP1wiO1xuICB9XG4gIGdldExlZnRJZGVudGlmaWVyV3JhcHBlcigpIHtcbiAgICByZXR1cm4gJ1wiJztcbiAgfVxuICBnZXRSaWdodElkZW50aWZpZXJXcmFwcGVyKCkge1xuICAgIHJldHVybiAnXCInO1xuICB9XG4gIGdldEF1dG9JbmNyZW1lbnQoKSB7XG4gICAgcmV0dXJuIFwiYXV0b2luY3JlbWVudFwiO1xuICB9XG59XG5jbGFzcyBCdW5TcWxpdGVEaWFsZWN0IHtcbiAgI2NvbmZpZztcbiAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgdGhpcy4jY29uZmlnID0geyAuLi5jb25maWcgfTtcbiAgfVxuICBjcmVhdGVEcml2ZXIoKSB7XG4gICAgcmV0dXJuIG5ldyBCdW5TcWxpdGVEcml2ZXIodGhpcy4jY29uZmlnKTtcbiAgfVxuICBjcmVhdGVRdWVyeUNvbXBpbGVyKCkge1xuICAgIHJldHVybiBuZXcgQnVuU3FsaXRlUXVlcnlDb21waWxlcigpO1xuICB9XG4gIGNyZWF0ZUFkYXB0ZXIoKSB7XG4gICAgcmV0dXJuIG5ldyBCdW5TcWxpdGVBZGFwdGVyKCk7XG4gIH1cbiAgY3JlYXRlSW50cm9zcGVjdG9yKGRiKSB7XG4gICAgcmV0dXJuIG5ldyBCdW5TcWxpdGVJbnRyb3NwZWN0b3IoZGIpO1xuICB9XG59XG5cbmV4cG9ydCB7IEJ1blNxbGl0ZUFkYXB0ZXIsIEJ1blNxbGl0ZURpYWxlY3QsIEJ1blNxbGl0ZURyaXZlciwgQnVuU3FsaXRlSW50cm9zcGVjdG9yLCBCdW5TcWxpdGVRdWVyeUNvbXBpbGVyIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/chunks/bun-sqlite-dialect.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/chunks/node-sqlite-dialect.mjs":
/*!**********************************************************************!*\
  !*** ./node_modules/better-auth/dist/chunks/node-sqlite-dialect.mjs ***!
  \**********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   NodeSqliteAdapter: () => (/* binding */ NodeSqliteAdapter),\n/* harmony export */   NodeSqliteDialect: () => (/* binding */ NodeSqliteDialect),\n/* harmony export */   NodeSqliteDriver: () => (/* binding */ NodeSqliteDriver),\n/* harmony export */   NodeSqliteIntrospector: () => (/* binding */ NodeSqliteIntrospector),\n/* harmony export */   NodeSqliteQueryCompiler: () => (/* binding */ NodeSqliteQueryCompiler)\n/* harmony export */ });\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/query-compiler/compiled-query.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/migration/migrator.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/raw-builder/sql.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/query-compiler/default-query-compiler.js\");\n\n\nclass NodeSqliteAdapter {\n  get supportsCreateIfNotExists() {\n    return true;\n  }\n  get supportsTransactionalDdl() {\n    return false;\n  }\n  get supportsReturning() {\n    return true;\n  }\n  async acquireMigrationLock() {\n  }\n  async releaseMigrationLock() {\n  }\n  get supportsOutput() {\n    return true;\n  }\n}\nclass NodeSqliteDriver {\n  #config;\n  #connectionMutex = new ConnectionMutex();\n  #db;\n  #connection;\n  constructor(config) {\n    this.#config = { ...config };\n  }\n  async init() {\n    this.#db = this.#config.database;\n    this.#connection = new NodeSqliteConnection(this.#db);\n    if (this.#config.onCreateConnection) {\n      await this.#config.onCreateConnection(this.#connection);\n    }\n  }\n  async acquireConnection() {\n    await this.#connectionMutex.lock();\n    return this.#connection;\n  }\n  async beginTransaction(connection) {\n    await connection.executeQuery(kysely__WEBPACK_IMPORTED_MODULE_0__.CompiledQuery.raw(\"begin\"));\n  }\n  async commitTransaction(connection) {\n    await connection.executeQuery(kysely__WEBPACK_IMPORTED_MODULE_0__.CompiledQuery.raw(\"commit\"));\n  }\n  async rollbackTransaction(connection) {\n    await connection.executeQuery(kysely__WEBPACK_IMPORTED_MODULE_0__.CompiledQuery.raw(\"rollback\"));\n  }\n  async releaseConnection() {\n    this.#connectionMutex.unlock();\n  }\n  async destroy() {\n    this.#db?.close();\n  }\n}\nclass NodeSqliteConnection {\n  #db;\n  constructor(db) {\n    this.#db = db;\n  }\n  executeQuery(compiledQuery) {\n    const { sql: sql2, parameters } = compiledQuery;\n    const stmt = this.#db.prepare(sql2);\n    const rows = stmt.all(...parameters);\n    return Promise.resolve({\n      rows\n    });\n  }\n  async *streamQuery() {\n    throw new Error(\"Streaming query is not supported by SQLite driver.\");\n  }\n}\nclass ConnectionMutex {\n  #promise;\n  #resolve;\n  async lock() {\n    while (this.#promise) {\n      await this.#promise;\n    }\n    this.#promise = new Promise((resolve) => {\n      this.#resolve = resolve;\n    });\n  }\n  unlock() {\n    const resolve = this.#resolve;\n    this.#promise = void 0;\n    this.#resolve = void 0;\n    resolve?.();\n  }\n}\nclass NodeSqliteIntrospector {\n  #db;\n  constructor(db) {\n    this.#db = db;\n  }\n  async getSchemas() {\n    return [];\n  }\n  async getTables(options = { withInternalKyselyTables: false }) {\n    let query = this.#db.selectFrom(\"sqlite_schema\").where(\"type\", \"=\", \"table\").where(\"name\", \"not like\", \"sqlite_%\").select(\"name\").$castTo();\n    if (!options.withInternalKyselyTables) {\n      query = query.where(\"name\", \"!=\", kysely__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_MIGRATION_TABLE).where(\"name\", \"!=\", kysely__WEBPACK_IMPORTED_MODULE_1__.DEFAULT_MIGRATION_LOCK_TABLE);\n    }\n    const tables = await query.execute();\n    return Promise.all(tables.map(({ name }) => this.#getTableMetadata(name)));\n  }\n  async getMetadata(options) {\n    return {\n      tables: await this.getTables(options)\n    };\n  }\n  async #getTableMetadata(table) {\n    const db = this.#db;\n    const createSql = await db.selectFrom(\"sqlite_master\").where(\"name\", \"=\", table).select(\"sql\").$castTo().execute();\n    const autoIncrementCol = createSql[0]?.sql?.split(/[\\(\\),]/)?.find((it) => it.toLowerCase().includes(\"autoincrement\"))?.split(/\\s+/)?.[0]?.replace(/[\"`]/g, \"\");\n    const columns = await db.selectFrom(\n      (0,kysely__WEBPACK_IMPORTED_MODULE_2__.sql)`pragma_table_info(${table})`.as(\"table_info\")\n    ).select([\"name\", \"type\", \"notnull\", \"dflt_value\"]).execute();\n    return {\n      name: table,\n      columns: columns.map((col) => ({\n        name: col.name,\n        dataType: col.type,\n        isNullable: !col.notnull,\n        isAutoIncrementing: col.name === autoIncrementCol,\n        hasDefaultValue: col.dflt_value != null\n      })),\n      isView: true\n    };\n  }\n}\nclass NodeSqliteQueryCompiler extends kysely__WEBPACK_IMPORTED_MODULE_3__.DefaultQueryCompiler {\n  getCurrentParameterPlaceholder() {\n    return \"?\";\n  }\n  getLeftIdentifierWrapper() {\n    return '\"';\n  }\n  getRightIdentifierWrapper() {\n    return '\"';\n  }\n  getAutoIncrement() {\n    return \"autoincrement\";\n  }\n}\nclass NodeSqliteDialect {\n  #config;\n  constructor(config) {\n    this.#config = { ...config };\n  }\n  createDriver() {\n    return new NodeSqliteDriver(this.#config);\n  }\n  createQueryCompiler() {\n    return new NodeSqliteQueryCompiler();\n  }\n  createAdapter() {\n    return new NodeSqliteAdapter();\n  }\n  createIntrospector(db) {\n    return new NodeSqliteIntrospector(db);\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jaHVua3Mvbm9kZS1zcWxpdGUtZGlhbGVjdC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQXlIOztBQUV6SDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsaURBQWE7QUFDL0M7QUFDQTtBQUNBLGtDQUFrQyxpREFBYTtBQUMvQztBQUNBO0FBQ0Esa0NBQWtDLGlEQUFhO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxZQUFZLHdCQUF3QjtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOEJBQThCLGlDQUFpQztBQUMvRDtBQUNBO0FBQ0Esd0NBQXdDLDJEQUF1QixzQkFBc0IsZ0VBQTRCO0FBQ2pIO0FBQ0E7QUFDQSxxQ0FBcUMsTUFBTTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTSwyQ0FBRyxxQkFBcUIsTUFBTTtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0Msd0RBQW9CO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRW1IIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxjaHVua3NcXG5vZGUtc3FsaXRlLWRpYWxlY3QubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBpbGVkUXVlcnksIERlZmF1bHRRdWVyeUNvbXBpbGVyLCBERUZBVUxUX01JR1JBVElPTl9UQUJMRSwgREVGQVVMVF9NSUdSQVRJT05fTE9DS19UQUJMRSwgc3FsIH0gZnJvbSAna3lzZWx5JztcblxuY2xhc3MgTm9kZVNxbGl0ZUFkYXB0ZXIge1xuICBnZXQgc3VwcG9ydHNDcmVhdGVJZk5vdEV4aXN0cygpIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuICBnZXQgc3VwcG9ydHNUcmFuc2FjdGlvbmFsRGRsKCkge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxuICBnZXQgc3VwcG9ydHNSZXR1cm5pbmcoKSB7XG4gICAgcmV0dXJuIHRydWU7XG4gIH1cbiAgYXN5bmMgYWNxdWlyZU1pZ3JhdGlvbkxvY2soKSB7XG4gIH1cbiAgYXN5bmMgcmVsZWFzZU1pZ3JhdGlvbkxvY2soKSB7XG4gIH1cbiAgZ2V0IHN1cHBvcnRzT3V0cHV0KCkge1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59XG5jbGFzcyBOb2RlU3FsaXRlRHJpdmVyIHtcbiAgI2NvbmZpZztcbiAgI2Nvbm5lY3Rpb25NdXRleCA9IG5ldyBDb25uZWN0aW9uTXV0ZXgoKTtcbiAgI2RiO1xuICAjY29ubmVjdGlvbjtcbiAgY29uc3RydWN0b3IoY29uZmlnKSB7XG4gICAgdGhpcy4jY29uZmlnID0geyAuLi5jb25maWcgfTtcbiAgfVxuICBhc3luYyBpbml0KCkge1xuICAgIHRoaXMuI2RiID0gdGhpcy4jY29uZmlnLmRhdGFiYXNlO1xuICAgIHRoaXMuI2Nvbm5lY3Rpb24gPSBuZXcgTm9kZVNxbGl0ZUNvbm5lY3Rpb24odGhpcy4jZGIpO1xuICAgIGlmICh0aGlzLiNjb25maWcub25DcmVhdGVDb25uZWN0aW9uKSB7XG4gICAgICBhd2FpdCB0aGlzLiNjb25maWcub25DcmVhdGVDb25uZWN0aW9uKHRoaXMuI2Nvbm5lY3Rpb24pO1xuICAgIH1cbiAgfVxuICBhc3luYyBhY3F1aXJlQ29ubmVjdGlvbigpIHtcbiAgICBhd2FpdCB0aGlzLiNjb25uZWN0aW9uTXV0ZXgubG9jaygpO1xuICAgIHJldHVybiB0aGlzLiNjb25uZWN0aW9uO1xuICB9XG4gIGFzeW5jIGJlZ2luVHJhbnNhY3Rpb24oY29ubmVjdGlvbikge1xuICAgIGF3YWl0IGNvbm5lY3Rpb24uZXhlY3V0ZVF1ZXJ5KENvbXBpbGVkUXVlcnkucmF3KFwiYmVnaW5cIikpO1xuICB9XG4gIGFzeW5jIGNvbW1pdFRyYW5zYWN0aW9uKGNvbm5lY3Rpb24pIHtcbiAgICBhd2FpdCBjb25uZWN0aW9uLmV4ZWN1dGVRdWVyeShDb21waWxlZFF1ZXJ5LnJhdyhcImNvbW1pdFwiKSk7XG4gIH1cbiAgYXN5bmMgcm9sbGJhY2tUcmFuc2FjdGlvbihjb25uZWN0aW9uKSB7XG4gICAgYXdhaXQgY29ubmVjdGlvbi5leGVjdXRlUXVlcnkoQ29tcGlsZWRRdWVyeS5yYXcoXCJyb2xsYmFja1wiKSk7XG4gIH1cbiAgYXN5bmMgcmVsZWFzZUNvbm5lY3Rpb24oKSB7XG4gICAgdGhpcy4jY29ubmVjdGlvbk11dGV4LnVubG9jaygpO1xuICB9XG4gIGFzeW5jIGRlc3Ryb3koKSB7XG4gICAgdGhpcy4jZGI/LmNsb3NlKCk7XG4gIH1cbn1cbmNsYXNzIE5vZGVTcWxpdGVDb25uZWN0aW9uIHtcbiAgI2RiO1xuICBjb25zdHJ1Y3RvcihkYikge1xuICAgIHRoaXMuI2RiID0gZGI7XG4gIH1cbiAgZXhlY3V0ZVF1ZXJ5KGNvbXBpbGVkUXVlcnkpIHtcbiAgICBjb25zdCB7IHNxbDogc3FsMiwgcGFyYW1ldGVycyB9ID0gY29tcGlsZWRRdWVyeTtcbiAgICBjb25zdCBzdG10ID0gdGhpcy4jZGIucHJlcGFyZShzcWwyKTtcbiAgICBjb25zdCByb3dzID0gc3RtdC5hbGwoLi4ucGFyYW1ldGVycyk7XG4gICAgcmV0dXJuIFByb21pc2UucmVzb2x2ZSh7XG4gICAgICByb3dzXG4gICAgfSk7XG4gIH1cbiAgYXN5bmMgKnN0cmVhbVF1ZXJ5KCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIlN0cmVhbWluZyBxdWVyeSBpcyBub3Qgc3VwcG9ydGVkIGJ5IFNRTGl0ZSBkcml2ZXIuXCIpO1xuICB9XG59XG5jbGFzcyBDb25uZWN0aW9uTXV0ZXgge1xuICAjcHJvbWlzZTtcbiAgI3Jlc29sdmU7XG4gIGFzeW5jIGxvY2soKSB7XG4gICAgd2hpbGUgKHRoaXMuI3Byb21pc2UpIHtcbiAgICAgIGF3YWl0IHRoaXMuI3Byb21pc2U7XG4gICAgfVxuICAgIHRoaXMuI3Byb21pc2UgPSBuZXcgUHJvbWlzZSgocmVzb2x2ZSkgPT4ge1xuICAgICAgdGhpcy4jcmVzb2x2ZSA9IHJlc29sdmU7XG4gICAgfSk7XG4gIH1cbiAgdW5sb2NrKCkge1xuICAgIGNvbnN0IHJlc29sdmUgPSB0aGlzLiNyZXNvbHZlO1xuICAgIHRoaXMuI3Byb21pc2UgPSB2b2lkIDA7XG4gICAgdGhpcy4jcmVzb2x2ZSA9IHZvaWQgMDtcbiAgICByZXNvbHZlPy4oKTtcbiAgfVxufVxuY2xhc3MgTm9kZVNxbGl0ZUludHJvc3BlY3RvciB7XG4gICNkYjtcbiAgY29uc3RydWN0b3IoZGIpIHtcbiAgICB0aGlzLiNkYiA9IGRiO1xuICB9XG4gIGFzeW5jIGdldFNjaGVtYXMoKSB7XG4gICAgcmV0dXJuIFtdO1xuICB9XG4gIGFzeW5jIGdldFRhYmxlcyhvcHRpb25zID0geyB3aXRoSW50ZXJuYWxLeXNlbHlUYWJsZXM6IGZhbHNlIH0pIHtcbiAgICBsZXQgcXVlcnkgPSB0aGlzLiNkYi5zZWxlY3RGcm9tKFwic3FsaXRlX3NjaGVtYVwiKS53aGVyZShcInR5cGVcIiwgXCI9XCIsIFwidGFibGVcIikud2hlcmUoXCJuYW1lXCIsIFwibm90IGxpa2VcIiwgXCJzcWxpdGVfJVwiKS5zZWxlY3QoXCJuYW1lXCIpLiRjYXN0VG8oKTtcbiAgICBpZiAoIW9wdGlvbnMud2l0aEludGVybmFsS3lzZWx5VGFibGVzKSB7XG4gICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKFwibmFtZVwiLCBcIiE9XCIsIERFRkFVTFRfTUlHUkFUSU9OX1RBQkxFKS53aGVyZShcIm5hbWVcIiwgXCIhPVwiLCBERUZBVUxUX01JR1JBVElPTl9MT0NLX1RBQkxFKTtcbiAgICB9XG4gICAgY29uc3QgdGFibGVzID0gYXdhaXQgcXVlcnkuZXhlY3V0ZSgpO1xuICAgIHJldHVybiBQcm9taXNlLmFsbCh0YWJsZXMubWFwKCh7IG5hbWUgfSkgPT4gdGhpcy4jZ2V0VGFibGVNZXRhZGF0YShuYW1lKSkpO1xuICB9XG4gIGFzeW5jIGdldE1ldGFkYXRhKG9wdGlvbnMpIHtcbiAgICByZXR1cm4ge1xuICAgICAgdGFibGVzOiBhd2FpdCB0aGlzLmdldFRhYmxlcyhvcHRpb25zKVxuICAgIH07XG4gIH1cbiAgYXN5bmMgI2dldFRhYmxlTWV0YWRhdGEodGFibGUpIHtcbiAgICBjb25zdCBkYiA9IHRoaXMuI2RiO1xuICAgIGNvbnN0IGNyZWF0ZVNxbCA9IGF3YWl0IGRiLnNlbGVjdEZyb20oXCJzcWxpdGVfbWFzdGVyXCIpLndoZXJlKFwibmFtZVwiLCBcIj1cIiwgdGFibGUpLnNlbGVjdChcInNxbFwiKS4kY2FzdFRvKCkuZXhlY3V0ZSgpO1xuICAgIGNvbnN0IGF1dG9JbmNyZW1lbnRDb2wgPSBjcmVhdGVTcWxbMF0/LnNxbD8uc3BsaXQoL1tcXChcXCksXS8pPy5maW5kKChpdCkgPT4gaXQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcImF1dG9pbmNyZW1lbnRcIikpPy5zcGxpdCgvXFxzKy8pPy5bMF0/LnJlcGxhY2UoL1tcImBdL2csIFwiXCIpO1xuICAgIGNvbnN0IGNvbHVtbnMgPSBhd2FpdCBkYi5zZWxlY3RGcm9tKFxuICAgICAgc3FsYHByYWdtYV90YWJsZV9pbmZvKCR7dGFibGV9KWAuYXMoXCJ0YWJsZV9pbmZvXCIpXG4gICAgKS5zZWxlY3QoW1wibmFtZVwiLCBcInR5cGVcIiwgXCJub3RudWxsXCIsIFwiZGZsdF92YWx1ZVwiXSkuZXhlY3V0ZSgpO1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiB0YWJsZSxcbiAgICAgIGNvbHVtbnM6IGNvbHVtbnMubWFwKChjb2wpID0+ICh7XG4gICAgICAgIG5hbWU6IGNvbC5uYW1lLFxuICAgICAgICBkYXRhVHlwZTogY29sLnR5cGUsXG4gICAgICAgIGlzTnVsbGFibGU6ICFjb2wubm90bnVsbCxcbiAgICAgICAgaXNBdXRvSW5jcmVtZW50aW5nOiBjb2wubmFtZSA9PT0gYXV0b0luY3JlbWVudENvbCxcbiAgICAgICAgaGFzRGVmYXVsdFZhbHVlOiBjb2wuZGZsdF92YWx1ZSAhPSBudWxsXG4gICAgICB9KSksXG4gICAgICBpc1ZpZXc6IHRydWVcbiAgICB9O1xuICB9XG59XG5jbGFzcyBOb2RlU3FsaXRlUXVlcnlDb21waWxlciBleHRlbmRzIERlZmF1bHRRdWVyeUNvbXBpbGVyIHtcbiAgZ2V0Q3VycmVudFBhcmFtZXRlclBsYWNlaG9sZGVyKCkge1xuICAgIHJldHVybiBcIj9cIjtcbiAgfVxuICBnZXRMZWZ0SWRlbnRpZmllcldyYXBwZXIoKSB7XG4gICAgcmV0dXJuICdcIic7XG4gIH1cbiAgZ2V0UmlnaHRJZGVudGlmaWVyV3JhcHBlcigpIHtcbiAgICByZXR1cm4gJ1wiJztcbiAgfVxuICBnZXRBdXRvSW5jcmVtZW50KCkge1xuICAgIHJldHVybiBcImF1dG9pbmNyZW1lbnRcIjtcbiAgfVxufVxuY2xhc3MgTm9kZVNxbGl0ZURpYWxlY3Qge1xuICAjY29uZmlnO1xuICBjb25zdHJ1Y3Rvcihjb25maWcpIHtcbiAgICB0aGlzLiNjb25maWcgPSB7IC4uLmNvbmZpZyB9O1xuICB9XG4gIGNyZWF0ZURyaXZlcigpIHtcbiAgICByZXR1cm4gbmV3IE5vZGVTcWxpdGVEcml2ZXIodGhpcy4jY29uZmlnKTtcbiAgfVxuICBjcmVhdGVRdWVyeUNvbXBpbGVyKCkge1xuICAgIHJldHVybiBuZXcgTm9kZVNxbGl0ZVF1ZXJ5Q29tcGlsZXIoKTtcbiAgfVxuICBjcmVhdGVBZGFwdGVyKCkge1xuICAgIHJldHVybiBuZXcgTm9kZVNxbGl0ZUFkYXB0ZXIoKTtcbiAgfVxuICBjcmVhdGVJbnRyb3NwZWN0b3IoZGIpIHtcbiAgICByZXR1cm4gbmV3IE5vZGVTcWxpdGVJbnRyb3NwZWN0b3IoZGIpO1xuICB9XG59XG5cbmV4cG9ydCB7IE5vZGVTcWxpdGVBZGFwdGVyLCBOb2RlU3FsaXRlRGlhbGVjdCwgTm9kZVNxbGl0ZURyaXZlciwgTm9kZVNxbGl0ZUludHJvc3BlY3RvciwgTm9kZVNxbGl0ZVF1ZXJ5Q29tcGlsZXIgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/chunks/node-sqlite-dialect.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/crypto/index.mjs":
/*!********************************************************!*\
  !*** ./node_modules/better-auth/dist/crypto/index.mjs ***!
  \********************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   compareHash: () => (/* binding */ compareHash),\n/* harmony export */   constantTimeEqual: () => (/* binding */ constantTimeEqual),\n/* harmony export */   generateRandomString: () => (/* reexport safe */ _shared_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_5__.g),\n/* harmony export */   hashPassword: () => (/* binding */ hashPassword),\n/* harmony export */   hashToBase64: () => (/* binding */ hashToBase64),\n/* harmony export */   signJWT: () => (/* binding */ signJWT),\n/* harmony export */   symmetricDecrypt: () => (/* binding */ symmetricDecrypt),\n/* harmony export */   symmetricEncrypt: () => (/* binding */ symmetricEncrypt),\n/* harmony export */   verifyPassword: () => (/* binding */ verifyPassword)\n/* harmony export */ });\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _noble_ciphers_chacha_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @noble/ciphers/chacha.js */ \"(rsc)/./node_modules/@noble/ciphers/chacha.js\");\n/* harmony import */ var _noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @noble/ciphers/utils.js */ \"(rsc)/./node_modules/@noble/ciphers/utils.js\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jwt/sign.js\");\n/* harmony import */ var _noble_hashes_scrypt_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @noble/hashes/scrypt.js */ \"(rsc)/./node_modules/@noble/hashes/scrypt.js\");\n/* harmony import */ var _better_auth_utils__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-auth/utils */ \"(rsc)/./node_modules/@better-auth/utils/dist/index.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @noble/hashes/utils.js */ \"(rsc)/./node_modules/@noble/hashes/utils.js\");\n/* harmony import */ var _shared_better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../shared/better-auth.DdzSJf-n.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DdzSJf-n.mjs\");\n/* harmony import */ var _shared_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../shared/better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\nasync function signJWT(payload, secret, expiresIn = 3600) {\n  const jwt = await new jose__WEBPACK_IMPORTED_MODULE_7__.SignJWT(payload).setProtectedHeader({ alg: \"HS256\" }).setIssuedAt().setExpirationTime(Math.floor(Date.now() / 1e3) + expiresIn).sign(new TextEncoder().encode(secret));\n  return jwt;\n}\n\nfunction constantTimeEqual(a, b) {\n  const aBuffer = new Uint8Array(a);\n  const bBuffer = new Uint8Array(b);\n  let c = aBuffer.length ^ bBuffer.length;\n  const length = Math.max(aBuffer.length, bBuffer.length);\n  for (let i = 0; i < length; i++) {\n    c |= (i < aBuffer.length ? aBuffer[i] : 0) ^ (i < bBuffer.length ? bBuffer[i] : 0);\n  }\n  return c === 0;\n}\n\nasync function hashToBase64(data) {\n  const buffer = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(data);\n  return _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_1__.base64.encode(buffer);\n}\nasync function compareHash(data, hash) {\n  const buffer = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(\n    typeof data === \"string\" ? new TextEncoder().encode(data) : data\n  );\n  const hashBuffer = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_1__.base64.decode(hash);\n  return constantTimeEqual(buffer, hashBuffer);\n}\n\nconst config = {\n  N: 16384,\n  r: 16,\n  p: 1,\n  dkLen: 64\n};\nasync function generateKey(password, salt) {\n  return await (0,_noble_hashes_scrypt_js__WEBPACK_IMPORTED_MODULE_8__.scryptAsync)(password.normalize(\"NFKC\"), salt, {\n    N: config.N,\n    p: config.p,\n    r: config.r,\n    dkLen: config.dkLen,\n    maxmem: 128 * config.N * config.r * 2\n  });\n}\nconst hashPassword = async (password) => {\n  const salt = _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_3__.hex.encode((0,_better_auth_utils__WEBPACK_IMPORTED_MODULE_2__.getRandomValues)(new Uint8Array(16)));\n  const key = await generateKey(password, salt);\n  return `${salt}:${_better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_3__.hex.encode(key)}`;\n};\nconst verifyPassword = async ({\n  hash,\n  password\n}) => {\n  const [salt, key] = hash.split(\":\");\n  if (!salt || !key) {\n    throw new _shared_better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_4__.B(\"Invalid password hash\");\n  }\n  const targetKey = await generateKey(password, salt);\n  return constantTimeEqual(targetKey, (0,_noble_hashes_utils_js__WEBPACK_IMPORTED_MODULE_9__.hexToBytes)(key));\n};\n\nconst symmetricEncrypt = async ({\n  key,\n  data\n}) => {\n  const keyAsBytes = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(key);\n  const dataAsBytes = (0,_noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_10__.utf8ToBytes)(data);\n  const chacha = (0,_noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_10__.managedNonce)(_noble_ciphers_chacha_js__WEBPACK_IMPORTED_MODULE_11__.xchacha20poly1305)(new Uint8Array(keyAsBytes));\n  return (0,_noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_10__.bytesToHex)(chacha.encrypt(dataAsBytes));\n};\nconst symmetricDecrypt = async ({\n  key,\n  data\n}) => {\n  const keyAsBytes = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_0__.createHash)(\"SHA-256\").digest(key);\n  const dataAsBytes = (0,_noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_10__.hexToBytes)(data);\n  const chacha = (0,_noble_ciphers_utils_js__WEBPACK_IMPORTED_MODULE_10__.managedNonce)(_noble_ciphers_chacha_js__WEBPACK_IMPORTED_MODULE_11__.xchacha20poly1305)(new Uint8Array(keyAsBytes));\n  return new TextDecoder().decode(chacha.decrypt(dataAsBytes));\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jcnlwdG8vaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFxRDtBQUNRO0FBQytDO0FBQ3pEO0FBQ3BCO0FBQ3VCO0FBQ0Q7QUFDUjtBQUNPO0FBQ3NCO0FBQ0s7QUFDNUM7O0FBRW5DO0FBQ0Esd0JBQXdCLHlDQUFPLCtCQUErQixjQUFjO0FBQzVFO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQixZQUFZO0FBQzlCO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0EsdUJBQXVCLG1FQUFVO0FBQ2pDLFNBQVMsNkRBQU07QUFDZjtBQUNBO0FBQ0EsdUJBQXVCLG1FQUFVO0FBQ2pDO0FBQ0E7QUFDQSxxQkFBcUIsNkRBQU07QUFDM0I7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUsb0VBQVc7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0EsZUFBZSx1REFBRyxRQUFRLG1FQUFlO0FBQ3pDO0FBQ0EsWUFBWSxLQUFLLEdBQUcsdURBQUcsYUFBYTtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0EsY0FBYywrREFBZTtBQUM3QjtBQUNBO0FBQ0Esc0NBQXNDLGtFQUFVO0FBQ2hEOztBQUVBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRCwyQkFBMkIsbUVBQVU7QUFDckMsc0JBQXNCLHFFQUFXO0FBQ2pDLGlCQUFpQixzRUFBWSxDQUFDLHdFQUFpQjtBQUMvQyxTQUFTLG9FQUFVO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQztBQUNELDJCQUEyQixtRUFBVTtBQUNyQyxzQkFBc0Isb0VBQVk7QUFDbEMsaUJBQWlCLHNFQUFZLENBQUMsd0VBQWlCO0FBQy9DO0FBQ0E7O0FBRW1JIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxjcnlwdG9cXGluZGV4Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVIYXNoIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2hhc2gnO1xuaW1wb3J0IHsgeGNoYWNoYTIwcG9seTEzMDUgfSBmcm9tICdAbm9ibGUvY2lwaGVycy9jaGFjaGEuanMnO1xuaW1wb3J0IHsgdXRmOFRvQnl0ZXMsIG1hbmFnZWROb25jZSwgYnl0ZXNUb0hleCwgaGV4VG9CeXRlcyBhcyBoZXhUb0J5dGVzJDEgfSBmcm9tICdAbm9ibGUvY2lwaGVycy91dGlscy5qcyc7XG5pbXBvcnQgeyBiYXNlNjQgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCB7IFNpZ25KV1QgfSBmcm9tICdqb3NlJztcbmltcG9ydCB7IHNjcnlwdEFzeW5jIH0gZnJvbSAnQG5vYmxlL2hhc2hlcy9zY3J5cHQuanMnO1xuaW1wb3J0IHsgZ2V0UmFuZG9tVmFsdWVzIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzJztcbmltcG9ydCB7IGhleCB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9oZXgnO1xuaW1wb3J0IHsgaGV4VG9CeXRlcyB9IGZyb20gJ0Bub2JsZS9oYXNoZXMvdXRpbHMuanMnO1xuaW1wb3J0IHsgQiBhcyBCZXR0ZXJBdXRoRXJyb3IgfSBmcm9tICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguRGR6U0pmLW4ubWpzJztcbmV4cG9ydCB7IGcgYXMgZ2VuZXJhdGVSYW5kb21TdHJpbmcgfSBmcm9tICcuLi9zaGFyZWQvYmV0dGVyLWF1dGguQjRRb3hkZ2MubWpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL3JhbmRvbSc7XG5cbmFzeW5jIGZ1bmN0aW9uIHNpZ25KV1QocGF5bG9hZCwgc2VjcmV0LCBleHBpcmVzSW4gPSAzNjAwKSB7XG4gIGNvbnN0IGp3dCA9IGF3YWl0IG5ldyBTaWduSldUKHBheWxvYWQpLnNldFByb3RlY3RlZEhlYWRlcih7IGFsZzogXCJIUzI1NlwiIH0pLnNldElzc3VlZEF0KCkuc2V0RXhwaXJhdGlvblRpbWUoTWF0aC5mbG9vcihEYXRlLm5vdygpIC8gMWUzKSArIGV4cGlyZXNJbikuc2lnbihuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoc2VjcmV0KSk7XG4gIHJldHVybiBqd3Q7XG59XG5cbmZ1bmN0aW9uIGNvbnN0YW50VGltZUVxdWFsKGEsIGIpIHtcbiAgY29uc3QgYUJ1ZmZlciA9IG5ldyBVaW50OEFycmF5KGEpO1xuICBjb25zdCBiQnVmZmVyID0gbmV3IFVpbnQ4QXJyYXkoYik7XG4gIGxldCBjID0gYUJ1ZmZlci5sZW5ndGggXiBiQnVmZmVyLmxlbmd0aDtcbiAgY29uc3QgbGVuZ3RoID0gTWF0aC5tYXgoYUJ1ZmZlci5sZW5ndGgsIGJCdWZmZXIubGVuZ3RoKTtcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgIGMgfD0gKGkgPCBhQnVmZmVyLmxlbmd0aCA/IGFCdWZmZXJbaV0gOiAwKSBeIChpIDwgYkJ1ZmZlci5sZW5ndGggPyBiQnVmZmVyW2ldIDogMCk7XG4gIH1cbiAgcmV0dXJuIGMgPT09IDA7XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGhhc2hUb0Jhc2U2NChkYXRhKSB7XG4gIGNvbnN0IGJ1ZmZlciA9IGF3YWl0IGNyZWF0ZUhhc2goXCJTSEEtMjU2XCIpLmRpZ2VzdChkYXRhKTtcbiAgcmV0dXJuIGJhc2U2NC5lbmNvZGUoYnVmZmVyKTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGNvbXBhcmVIYXNoKGRhdGEsIGhhc2gpIHtcbiAgY29uc3QgYnVmZmVyID0gYXdhaXQgY3JlYXRlSGFzaChcIlNIQS0yNTZcIikuZGlnZXN0KFxuICAgIHR5cGVvZiBkYXRhID09PSBcInN0cmluZ1wiID8gbmV3IFRleHRFbmNvZGVyKCkuZW5jb2RlKGRhdGEpIDogZGF0YVxuICApO1xuICBjb25zdCBoYXNoQnVmZmVyID0gYmFzZTY0LmRlY29kZShoYXNoKTtcbiAgcmV0dXJuIGNvbnN0YW50VGltZUVxdWFsKGJ1ZmZlciwgaGFzaEJ1ZmZlcik7XG59XG5cbmNvbnN0IGNvbmZpZyA9IHtcbiAgTjogMTYzODQsXG4gIHI6IDE2LFxuICBwOiAxLFxuICBka0xlbjogNjRcbn07XG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZUtleShwYXNzd29yZCwgc2FsdCkge1xuICByZXR1cm4gYXdhaXQgc2NyeXB0QXN5bmMocGFzc3dvcmQubm9ybWFsaXplKFwiTkZLQ1wiKSwgc2FsdCwge1xuICAgIE46IGNvbmZpZy5OLFxuICAgIHA6IGNvbmZpZy5wLFxuICAgIHI6IGNvbmZpZy5yLFxuICAgIGRrTGVuOiBjb25maWcuZGtMZW4sXG4gICAgbWF4bWVtOiAxMjggKiBjb25maWcuTiAqIGNvbmZpZy5yICogMlxuICB9KTtcbn1cbmNvbnN0IGhhc2hQYXNzd29yZCA9IGFzeW5jIChwYXNzd29yZCkgPT4ge1xuICBjb25zdCBzYWx0ID0gaGV4LmVuY29kZShnZXRSYW5kb21WYWx1ZXMobmV3IFVpbnQ4QXJyYXkoMTYpKSk7XG4gIGNvbnN0IGtleSA9IGF3YWl0IGdlbmVyYXRlS2V5KHBhc3N3b3JkLCBzYWx0KTtcbiAgcmV0dXJuIGAke3NhbHR9OiR7aGV4LmVuY29kZShrZXkpfWA7XG59O1xuY29uc3QgdmVyaWZ5UGFzc3dvcmQgPSBhc3luYyAoe1xuICBoYXNoLFxuICBwYXNzd29yZFxufSkgPT4ge1xuICBjb25zdCBbc2FsdCwga2V5XSA9IGhhc2guc3BsaXQoXCI6XCIpO1xuICBpZiAoIXNhbHQgfHwgIWtleSkge1xuICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJJbnZhbGlkIHBhc3N3b3JkIGhhc2hcIik7XG4gIH1cbiAgY29uc3QgdGFyZ2V0S2V5ID0gYXdhaXQgZ2VuZXJhdGVLZXkocGFzc3dvcmQsIHNhbHQpO1xuICByZXR1cm4gY29uc3RhbnRUaW1lRXF1YWwodGFyZ2V0S2V5LCBoZXhUb0J5dGVzKGtleSkpO1xufTtcblxuY29uc3Qgc3ltbWV0cmljRW5jcnlwdCA9IGFzeW5jICh7XG4gIGtleSxcbiAgZGF0YVxufSkgPT4ge1xuICBjb25zdCBrZXlBc0J5dGVzID0gYXdhaXQgY3JlYXRlSGFzaChcIlNIQS0yNTZcIikuZGlnZXN0KGtleSk7XG4gIGNvbnN0IGRhdGFBc0J5dGVzID0gdXRmOFRvQnl0ZXMoZGF0YSk7XG4gIGNvbnN0IGNoYWNoYSA9IG1hbmFnZWROb25jZSh4Y2hhY2hhMjBwb2x5MTMwNSkobmV3IFVpbnQ4QXJyYXkoa2V5QXNCeXRlcykpO1xuICByZXR1cm4gYnl0ZXNUb0hleChjaGFjaGEuZW5jcnlwdChkYXRhQXNCeXRlcykpO1xufTtcbmNvbnN0IHN5bW1ldHJpY0RlY3J5cHQgPSBhc3luYyAoe1xuICBrZXksXG4gIGRhdGFcbn0pID0+IHtcbiAgY29uc3Qga2V5QXNCeXRlcyA9IGF3YWl0IGNyZWF0ZUhhc2goXCJTSEEtMjU2XCIpLmRpZ2VzdChrZXkpO1xuICBjb25zdCBkYXRhQXNCeXRlcyA9IGhleFRvQnl0ZXMkMShkYXRhKTtcbiAgY29uc3QgY2hhY2hhID0gbWFuYWdlZE5vbmNlKHhjaGFjaGEyMHBvbHkxMzA1KShuZXcgVWludDhBcnJheShrZXlBc0J5dGVzKSk7XG4gIHJldHVybiBuZXcgVGV4dERlY29kZXIoKS5kZWNvZGUoY2hhY2hhLmRlY3J5cHQoZGF0YUFzQnl0ZXMpKTtcbn07XG5cbmV4cG9ydCB7IGNvbXBhcmVIYXNoLCBjb25zdGFudFRpbWVFcXVhbCwgaGFzaFBhc3N3b3JkLCBoYXNoVG9CYXNlNjQsIHNpZ25KV1QsIHN5bW1ldHJpY0RlY3J5cHQsIHN5bW1ldHJpY0VuY3J5cHQsIHZlcmlmeVBhc3N3b3JkIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/crypto/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/index.mjs":
/*!*************************************************!*\
  !*** ./node_modules/better-auth/dist/index.mjs ***!
  \*************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   APIError: () => (/* reexport safe */ better_call__WEBPACK_IMPORTED_MODULE_6__.APIError),\n/* harmony export */   BetterAuthError: () => (/* reexport safe */ _shared_better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_1__.B),\n/* harmony export */   HIDE_METADATA: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_3__.H),\n/* harmony export */   MissingDependencyError: () => (/* reexport safe */ _shared_better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_1__.M),\n/* harmony export */   betterAuth: () => (/* reexport safe */ _shared_better_auth_CujFcMib_mjs__WEBPACK_IMPORTED_MODULE_0__.b),\n/* harmony export */   capitalizeFirstLetter: () => (/* reexport safe */ _shared_better_auth_D_2CmEwz_mjs__WEBPACK_IMPORTED_MODULE_2__.c),\n/* harmony export */   createLogger: () => (/* reexport safe */ _shared_better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_5__.c),\n/* harmony export */   createTelemetry: () => (/* reexport safe */ _shared_better_auth_CujFcMib_mjs__WEBPACK_IMPORTED_MODULE_0__.c),\n/* harmony export */   generateId: () => (/* reexport safe */ _shared_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_4__.g),\n/* harmony export */   generateState: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_3__.g),\n/* harmony export */   getTelemetryAuthConfig: () => (/* reexport safe */ _shared_better_auth_CujFcMib_mjs__WEBPACK_IMPORTED_MODULE_0__.g),\n/* harmony export */   levels: () => (/* reexport safe */ _shared_better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_5__.l),\n/* harmony export */   logger: () => (/* reexport safe */ _shared_better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_5__.a),\n/* harmony export */   parseState: () => (/* reexport safe */ _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_3__.p),\n/* harmony export */   shouldPublishLog: () => (/* reexport safe */ _shared_better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_5__.s)\n/* harmony export */ });\n/* harmony import */ var _shared_better_auth_CujFcMib_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./shared/better-auth.CujFcMib.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CujFcMib.mjs\");\n/* harmony import */ var _shared_better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./shared/better-auth.DdzSJf-n.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DdzSJf-n.mjs\");\n/* harmony import */ var _shared_better_auth_D_2CmEwz_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./shared/better-auth.D-2CmEwz.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.D-2CmEwz.mjs\");\n/* harmony import */ var _shared_better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./shared/better-auth.CewjboYP.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CewjboYP.mjs\");\n/* harmony import */ var _shared_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./shared/better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var _shared_better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./shared/better-auth.BjBlybv-.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BjBlybv-.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var _shared_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./shared/better-auth.DV5EHeYG.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DV5EHeYG.mjs\");\n/* harmony import */ var zod_v4__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! zod/v4 */ \"(rsc)/./node_modules/zod/v4/index.js\");\n/* harmony import */ var _shared_better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./shared/better-auth.CMQ3rA-I.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CMQ3rA-I.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @better-auth/utils/binary */ \"(rsc)/./node_modules/@better-auth/utils/dist/binary.mjs\");\n/* harmony import */ var _shared_better_auth_Dcv8PS7T_mjs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./shared/better-auth.Dcv8PS7T.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.Dcv8PS7T.mjs\");\n/* harmony import */ var _api_index_mjs__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./api/index.mjs */ \"(rsc)/./node_modules/better-auth/dist/api/index.mjs\");\n/* harmony import */ var _shared_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./shared/better-auth.UfVWArIB.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.UfVWArIB.mjs\");\n/* harmony import */ var _shared_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./shared/better-auth.CW6D9eSx.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\");\n/* harmony import */ var _shared_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./shared/better-auth.BZZKN1g7.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BZZKN1g7.mjs\");\n/* harmony import */ var _shared_better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./shared/better-auth.CuS_eDdK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CuS_eDdK.mjs\");\n/* harmony import */ var _shared_better_auth_O2VtDkDK_mjs__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! ./shared/better-auth.O2VtDkDK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.O2VtDkDK.mjs\");\n/* harmony import */ var defu__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! defu */ \"(rsc)/./node_modules/defu/dist/defu.mjs\");\n/* harmony import */ var _crypto_index_mjs__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! ./crypto/index.mjs */ \"(rsc)/./node_modules/better-auth/dist/crypto/index.mjs\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! @better-auth/utils */ \"(rsc)/./node_modules/@better-auth/utils/dist/index.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _shared_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! ./shared/better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var _shared_better_auth_DV0Lly8_mjs__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! ./shared/better-auth.DV0Lly8-.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DV0Lly8-.mjs\");\n/* harmony import */ var _shared_better_auth_B_PTVODM_mjs__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! ./shared/better-auth.B_PTVODM.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B_PTVODM.mjs\");\n/* harmony import */ var _shared_better_auth_BduPtJy8_mjs__WEBPACK_IMPORTED_MODULE_29__ = __webpack_require__(/*! ./shared/better-auth.BduPtJy8.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BduPtJy8.mjs\");\n/* harmony import */ var _shared_better_auth_DOXaXTC6_mjs__WEBPACK_IMPORTED_MODULE_30__ = __webpack_require__(/*! ./shared/better-auth.DOXaXTC6.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DOXaXTC6.mjs\");\n/* harmony import */ var _shared_better_auth_7ZeACU2v_mjs__WEBPACK_IMPORTED_MODULE_31__ = __webpack_require__(/*! ./shared/better-auth.7ZeACU2v.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.7ZeACU2v.mjs\");\n/* harmony import */ var _shared_better_auth_YwDQhoPc_mjs__WEBPACK_IMPORTED_MODULE_32__ = __webpack_require__(/*! ./shared/better-auth.YwDQhoPc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.YwDQhoPc.mjs\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_33__ = __webpack_require__(/*! @better-fetch/fetch */ \"(rsc)/./node_modules/@better-fetch/fetch/dist/index.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9pbmRleC5tanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUF1SDtBQUNqQjtBQUN2QjtBQUM2QjtBQUN4QztBQUNtRDtBQUNoRjtBQUNJO0FBQzNCO0FBQzJCO0FBQ1I7QUFDRjtBQUNFO0FBQ1E7QUFDbEI7QUFDa0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUM3QjtBQUNjO0FBQ0s7QUFDQztBQUNEO0FBQ25CO0FBQ21CO0FBQ0w7QUFDSTtBQUNBO0FBQ1c7QUFDUjtBQUNRO0FBQ0E7QUFDQTtBQUMzQjtBQUMyQjtBQUNBO0FBQ0E7QUFDZDtBQUNSIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxpbmRleC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IHsgYiBhcyBiZXR0ZXJBdXRoLCBjIGFzIGNyZWF0ZVRlbGVtZXRyeSwgZyBhcyBnZXRUZWxlbWV0cnlBdXRoQ29uZmlnIH0gZnJvbSAnLi9zaGFyZWQvYmV0dGVyLWF1dGguQ3VqRmNNaWIubWpzJztcbmV4cG9ydCB7IEIgYXMgQmV0dGVyQXV0aEVycm9yLCBNIGFzIE1pc3NpbmdEZXBlbmRlbmN5RXJyb3IgfSBmcm9tICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5EZHpTSmYtbi5tanMnO1xuZXhwb3J0IHsgYyBhcyBjYXBpdGFsaXplRmlyc3RMZXR0ZXIgfSBmcm9tICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5ELTJDbUV3ei5tanMnO1xuZXhwb3J0IHsgSCBhcyBISURFX01FVEFEQVRBLCBnIGFzIGdlbmVyYXRlU3RhdGUsIHAgYXMgcGFyc2VTdGF0ZSB9IGZyb20gJy4vc2hhcmVkL2JldHRlci1hdXRoLkNld2pib1lQLm1qcyc7XG5leHBvcnQgeyBnIGFzIGdlbmVyYXRlSWQgfSBmcm9tICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5CVVBQUlhmSy5tanMnO1xuZXhwb3J0IHsgYyBhcyBjcmVhdGVMb2dnZXIsIGwgYXMgbGV2ZWxzLCBhIGFzIGxvZ2dlciwgcyBhcyBzaG91bGRQdWJsaXNoTG9nIH0gZnJvbSAnLi9zaGFyZWQvYmV0dGVyLWF1dGguQmpCbHlidi0ubWpzJztcbmV4cG9ydCB7IEFQSUVycm9yIH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuaW1wb3J0ICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5EVjVFSGVZRy5tanMnO1xuaW1wb3J0ICd6b2QvdjQnO1xuaW1wb3J0ICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5DTVEzckEtSS5tanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2htYWMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvYmluYXJ5JztcbmltcG9ydCAnLi9zaGFyZWQvYmV0dGVyLWF1dGguRGN2OFBTN1QubWpzJztcbmltcG9ydCAnLi9hcGkvaW5kZXgubWpzJztcbmltcG9ydCAnLi9zaGFyZWQvYmV0dGVyLWF1dGguVWZWV0FySUIubWpzJztcbmltcG9ydCAnLi9zaGFyZWQvYmV0dGVyLWF1dGguQ1c2RDllU3gubWpzJztcbmltcG9ydCAnLi9zaGFyZWQvYmV0dGVyLWF1dGguQlpaS04xZzcubWpzJztcbmltcG9ydCAnLi9zaGFyZWQvYmV0dGVyLWF1dGguQ3VTX2VEZEsubWpzJztcbmltcG9ydCAnLi9zaGFyZWQvYmV0dGVyLWF1dGguTzJWdERrREsubWpzJztcbmltcG9ydCAnZGVmdSc7XG5pbXBvcnQgJy4vY3J5cHRvL2luZGV4Lm1qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9oYXNoJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvY2hhY2hhLmpzJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvdXRpbHMuanMnO1xuaW1wb3J0ICdqb3NlJztcbmltcG9ydCAnQG5vYmxlL2hhc2hlcy9zY3J5cHQuanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaGV4JztcbmltcG9ydCAnQG5vYmxlL2hhc2hlcy91dGlscy5qcyc7XG5pbXBvcnQgJy4vc2hhcmVkL2JldHRlci1hdXRoLkI0UW94ZGdjLm1qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9yYW5kb20nO1xuaW1wb3J0ICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5EVjBMbHk4LS5tanMnO1xuaW1wb3J0ICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5CX1BUVk9ETS5tanMnO1xuaW1wb3J0ICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5CZHVQdEp5OC5tanMnO1xuaW1wb3J0ICdreXNlbHknO1xuaW1wb3J0ICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5ET1hhWFRDNi5tanMnO1xuaW1wb3J0ICcuL3NoYXJlZC9iZXR0ZXItYXV0aC43WmVBQ1Uydi5tanMnO1xuaW1wb3J0ICcuL3NoYXJlZC9iZXR0ZXItYXV0aC5Zd0RRaG9QYy5tanMnO1xuaW1wb3J0ICdAYmV0dGVyLWZldGNoL2ZldGNoJztcbmltcG9ydCAnam9zZS9lcnJvcnMnO1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/index.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.7ZeACU2v.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.7ZeACU2v.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   m: () => (/* binding */ memoryAdapter)\n/* harmony export */ });\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var zod_v4__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! zod/v4 */ \"(rsc)/./node_modules/zod/v4/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/utils */ \"(rsc)/./node_modules/@better-auth/utils/dist/index.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./better-auth.BjBlybv-.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BjBlybv-.mjs\");\n/* harmony import */ var _better_auth_DOXaXTC6_mjs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./better-auth.DOXaXTC6.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DOXaXTC6.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst memoryAdapter = (db, config) => (0,_better_auth_DOXaXTC6_mjs__WEBPACK_IMPORTED_MODULE_9__.c)({\n  config: {\n    adapterId: \"memory\",\n    adapterName: \"Memory Adapter\",\n    usePlural: false,\n    debugLogs: config?.debugLogs || false,\n    customTransformInput(props) {\n      if (props.options.advanced?.database?.useNumberId && props.field === \"id\" && props.action === \"create\") {\n        return db[props.model].length + 1;\n      }\n      return props.data;\n    }\n  },\n  adapter: ({ getFieldName, options, debugLog }) => {\n    function convertWhereClause(where, model) {\n      const table = db[model];\n      if (!table) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_8__.a.error(\n          `[MemoryAdapter] Model ${model} not found in the DB`,\n          Object.keys(db)\n        );\n        throw new Error(`Model ${model} not found`);\n      }\n      return table.filter((record) => {\n        return where.every((clause) => {\n          let { field, value, operator } = clause;\n          if (operator === \"in\") {\n            if (!Array.isArray(value)) {\n              throw new Error(\"Value must be an array\");\n            }\n            return value.includes(record[field]);\n          } else if (operator === \"not_in\") {\n            if (!Array.isArray(value)) {\n              throw new Error(\"Value must be an array\");\n            }\n            return !value.includes(record[field]);\n          } else if (operator === \"contains\") {\n            return record[field].includes(value);\n          } else if (operator === \"starts_with\") {\n            return record[field].startsWith(value);\n          } else if (operator === \"ends_with\") {\n            return record[field].endsWith(value);\n          } else {\n            return record[field] === value;\n          }\n        });\n      });\n    }\n    return {\n      create: async ({ model, data }) => {\n        if (options.advanced?.database?.useNumberId) {\n          data.id = db[model].length + 1;\n        }\n        if (!db[model]) {\n          db[model] = [];\n        }\n        db[model].push(data);\n        return data;\n      },\n      findOne: async ({ model, where }) => {\n        const res = convertWhereClause(where, model);\n        const record = res[0] || null;\n        return record;\n      },\n      findMany: async ({ model, where, sortBy, limit, offset }) => {\n        let table = db[model];\n        if (where) {\n          table = convertWhereClause(where, model);\n        }\n        if (sortBy) {\n          table = table.sort((a, b) => {\n            const field = getFieldName({ model, field: sortBy.field });\n            if (sortBy.direction === \"asc\") {\n              return a[field] > b[field] ? 1 : -1;\n            } else {\n              return a[field] < b[field] ? 1 : -1;\n            }\n          });\n        }\n        if (offset !== void 0) {\n          table = table.slice(offset);\n        }\n        if (limit !== void 0) {\n          table = table.slice(0, limit);\n        }\n        return table;\n      },\n      count: async ({ model }) => {\n        return db[model].length;\n      },\n      update: async ({ model, where, update }) => {\n        const res = convertWhereClause(where, model);\n        res.forEach((record) => {\n          Object.assign(record, update);\n        });\n        return res[0] || null;\n      },\n      delete: async ({ model, where }) => {\n        const table = db[model];\n        const res = convertWhereClause(where, model);\n        db[model] = table.filter((record) => !res.includes(record));\n      },\n      deleteMany: async ({ model, where }) => {\n        const table = db[model];\n        const res = convertWhereClause(where, model);\n        let count = 0;\n        db[model] = table.filter((record) => {\n          if (res.includes(record)) {\n            count++;\n            return false;\n          }\n          return !res.includes(record);\n        });\n        return count;\n      },\n      updateMany({ model, where, update }) {\n        const res = convertWhereClause(where, model);\n        res.forEach((record) => {\n          Object.assign(record, update);\n        });\n        return res[0] || null;\n      }\n    };\n  }\n});\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguN1plQUNVMnYubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7O0FBQW1DO0FBQ25CO0FBQ0s7QUFDWTtBQUNDO0FBQ0Q7QUFDRTtBQUNyQjtBQUNtQjtBQUNMO0FBQ0k7QUFDQTtBQUNJO0FBQ3FCO0FBQ087O0FBRWhFLHNDQUFzQyw0REFBYTtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILGNBQWMsaUNBQWlDO0FBQy9DO0FBQ0E7QUFDQTtBQUNBLFFBQVEsdURBQU07QUFDZCxtQ0FBbUMsT0FBTztBQUMxQztBQUNBO0FBQ0EsaUNBQWlDLE9BQU87QUFDeEM7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLHlCQUF5QjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWTtBQUNaO0FBQ0EsWUFBWTtBQUNaO0FBQ0EsWUFBWTtBQUNaO0FBQ0EsWUFBWTtBQUNaO0FBQ0E7QUFDQSxTQUFTO0FBQ1QsT0FBTztBQUNQO0FBQ0E7QUFDQSx1QkFBdUIsYUFBYTtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLHdCQUF3QixjQUFjO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCx5QkFBeUIscUNBQXFDO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5Qyw0QkFBNEI7QUFDckU7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0EsV0FBVztBQUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1Asc0JBQXNCLE9BQU87QUFDN0I7QUFDQSxPQUFPO0FBQ1AsdUJBQXVCLHNCQUFzQjtBQUM3QztBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxPQUFPO0FBQ1AsdUJBQXVCLGNBQWM7QUFDckM7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLDJCQUEyQixjQUFjO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLE9BQU87QUFDUCxtQkFBbUIsc0JBQXNCO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7O0FBRTZCIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxzaGFyZWRcXGJldHRlci1hdXRoLjdaZUFDVTJ2Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9yYW5kb20nO1xuaW1wb3J0ICd6b2QvdjQnO1xuaW1wb3J0ICdiZXR0ZXItY2FsbCc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9oYXNoJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvY2hhY2hhLmpzJztcbmltcG9ydCAnQG5vYmxlL2NpcGhlcnMvdXRpbHMuanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCAnam9zZSc7XG5pbXBvcnQgJ0Bub2JsZS9oYXNoZXMvc2NyeXB0LmpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2hleCc7XG5pbXBvcnQgJ0Bub2JsZS9oYXNoZXMvdXRpbHMuanMnO1xuaW1wb3J0ICcuL2JldHRlci1hdXRoLkI0UW94ZGdjLm1qcyc7XG5pbXBvcnQgeyBhIGFzIGxvZ2dlciB9IGZyb20gJy4vYmV0dGVyLWF1dGguQmpCbHlidi0ubWpzJztcbmltcG9ydCB7IGMgYXMgY3JlYXRlQWRhcHRlciB9IGZyb20gJy4vYmV0dGVyLWF1dGguRE9YYVhUQzYubWpzJztcblxuY29uc3QgbWVtb3J5QWRhcHRlciA9IChkYiwgY29uZmlnKSA9PiBjcmVhdGVBZGFwdGVyKHtcbiAgY29uZmlnOiB7XG4gICAgYWRhcHRlcklkOiBcIm1lbW9yeVwiLFxuICAgIGFkYXB0ZXJOYW1lOiBcIk1lbW9yeSBBZGFwdGVyXCIsXG4gICAgdXNlUGx1cmFsOiBmYWxzZSxcbiAgICBkZWJ1Z0xvZ3M6IGNvbmZpZz8uZGVidWdMb2dzIHx8IGZhbHNlLFxuICAgIGN1c3RvbVRyYW5zZm9ybUlucHV0KHByb3BzKSB7XG4gICAgICBpZiAocHJvcHMub3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkICYmIHByb3BzLmZpZWxkID09PSBcImlkXCIgJiYgcHJvcHMuYWN0aW9uID09PSBcImNyZWF0ZVwiKSB7XG4gICAgICAgIHJldHVybiBkYltwcm9wcy5tb2RlbF0ubGVuZ3RoICsgMTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBwcm9wcy5kYXRhO1xuICAgIH1cbiAgfSxcbiAgYWRhcHRlcjogKHsgZ2V0RmllbGROYW1lLCBvcHRpb25zLCBkZWJ1Z0xvZyB9KSA9PiB7XG4gICAgZnVuY3Rpb24gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCBtb2RlbCkge1xuICAgICAgY29uc3QgdGFibGUgPSBkYlttb2RlbF07XG4gICAgICBpZiAoIXRhYmxlKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcbiAgICAgICAgICBgW01lbW9yeUFkYXB0ZXJdIE1vZGVsICR7bW9kZWx9IG5vdCBmb3VuZCBpbiB0aGUgREJgLFxuICAgICAgICAgIE9iamVjdC5rZXlzKGRiKVxuICAgICAgICApO1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYE1vZGVsICR7bW9kZWx9IG5vdCBmb3VuZGApO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRhYmxlLmZpbHRlcigocmVjb3JkKSA9PiB7XG4gICAgICAgIHJldHVybiB3aGVyZS5ldmVyeSgoY2xhdXNlKSA9PiB7XG4gICAgICAgICAgbGV0IHsgZmllbGQsIHZhbHVlLCBvcGVyYXRvciB9ID0gY2xhdXNlO1xuICAgICAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJpblwiKSB7XG4gICAgICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcihcIlZhbHVlIG11c3QgYmUgYW4gYXJyYXlcIik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdmFsdWUuaW5jbHVkZXMocmVjb3JkW2ZpZWxkXSk7XG4gICAgICAgICAgfSBlbHNlIGlmIChvcGVyYXRvciA9PT0gXCJub3RfaW5cIikge1xuICAgICAgICAgICAgaWYgKCFBcnJheS5pc0FycmF5KHZhbHVlKSkge1xuICAgICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXCJWYWx1ZSBtdXN0IGJlIGFuIGFycmF5XCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuICF2YWx1ZS5pbmNsdWRlcyhyZWNvcmRbZmllbGRdKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKG9wZXJhdG9yID09PSBcImNvbnRhaW5zXCIpIHtcbiAgICAgICAgICAgIHJldHVybiByZWNvcmRbZmllbGRdLmluY2x1ZGVzKHZhbHVlKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKG9wZXJhdG9yID09PSBcInN0YXJ0c193aXRoXCIpIHtcbiAgICAgICAgICAgIHJldHVybiByZWNvcmRbZmllbGRdLnN0YXJ0c1dpdGgodmFsdWUpO1xuICAgICAgICAgIH0gZWxzZSBpZiAob3BlcmF0b3IgPT09IFwiZW5kc193aXRoXCIpIHtcbiAgICAgICAgICAgIHJldHVybiByZWNvcmRbZmllbGRdLmVuZHNXaXRoKHZhbHVlKTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHJlY29yZFtmaWVsZF0gPT09IHZhbHVlO1xuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIGNyZWF0ZTogYXN5bmMgKHsgbW9kZWwsIGRhdGEgfSkgPT4ge1xuICAgICAgICBpZiAob3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkKSB7XG4gICAgICAgICAgZGF0YS5pZCA9IGRiW21vZGVsXS5sZW5ndGggKyAxO1xuICAgICAgICB9XG4gICAgICAgIGlmICghZGJbbW9kZWxdKSB7XG4gICAgICAgICAgZGJbbW9kZWxdID0gW107XG4gICAgICAgIH1cbiAgICAgICAgZGJbbW9kZWxdLnB1c2goZGF0YSk7XG4gICAgICAgIHJldHVybiBkYXRhO1xuICAgICAgfSxcbiAgICAgIGZpbmRPbmU6IGFzeW5jICh7IG1vZGVsLCB3aGVyZSB9KSA9PiB7XG4gICAgICAgIGNvbnN0IHJlcyA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpO1xuICAgICAgICBjb25zdCByZWNvcmQgPSByZXNbMF0gfHwgbnVsbDtcbiAgICAgICAgcmV0dXJuIHJlY29yZDtcbiAgICAgIH0sXG4gICAgICBmaW5kTWFueTogYXN5bmMgKHsgbW9kZWwsIHdoZXJlLCBzb3J0QnksIGxpbWl0LCBvZmZzZXQgfSkgPT4ge1xuICAgICAgICBsZXQgdGFibGUgPSBkYlttb2RlbF07XG4gICAgICAgIGlmICh3aGVyZSkge1xuICAgICAgICAgIHRhYmxlID0gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCBtb2RlbCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNvcnRCeSkge1xuICAgICAgICAgIHRhYmxlID0gdGFibGUuc29ydCgoYSwgYikgPT4ge1xuICAgICAgICAgICAgY29uc3QgZmllbGQgPSBnZXRGaWVsZE5hbWUoeyBtb2RlbCwgZmllbGQ6IHNvcnRCeS5maWVsZCB9KTtcbiAgICAgICAgICAgIGlmIChzb3J0QnkuZGlyZWN0aW9uID09PSBcImFzY1wiKSB7XG4gICAgICAgICAgICAgIHJldHVybiBhW2ZpZWxkXSA+IGJbZmllbGRdID8gMSA6IC0xO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgcmV0dXJuIGFbZmllbGRdIDwgYltmaWVsZF0gPyAxIDogLTE7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9mZnNldCAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgdGFibGUgPSB0YWJsZS5zbGljZShvZmZzZXQpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChsaW1pdCAhPT0gdm9pZCAwKSB7XG4gICAgICAgICAgdGFibGUgPSB0YWJsZS5zbGljZSgwLCBsaW1pdCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHRhYmxlO1xuICAgICAgfSxcbiAgICAgIGNvdW50OiBhc3luYyAoeyBtb2RlbCB9KSA9PiB7XG4gICAgICAgIHJldHVybiBkYlttb2RlbF0ubGVuZ3RoO1xuICAgICAgfSxcbiAgICAgIHVwZGF0ZTogYXN5bmMgKHsgbW9kZWwsIHdoZXJlLCB1cGRhdGUgfSkgPT4ge1xuICAgICAgICBjb25zdCByZXMgPSBjb252ZXJ0V2hlcmVDbGF1c2Uod2hlcmUsIG1vZGVsKTtcbiAgICAgICAgcmVzLmZvckVhY2goKHJlY29yZCkgPT4ge1xuICAgICAgICAgIE9iamVjdC5hc3NpZ24ocmVjb3JkLCB1cGRhdGUpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHJlc1swXSB8fCBudWxsO1xuICAgICAgfSxcbiAgICAgIGRlbGV0ZTogYXN5bmMgKHsgbW9kZWwsIHdoZXJlIH0pID0+IHtcbiAgICAgICAgY29uc3QgdGFibGUgPSBkYlttb2RlbF07XG4gICAgICAgIGNvbnN0IHJlcyA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpO1xuICAgICAgICBkYlttb2RlbF0gPSB0YWJsZS5maWx0ZXIoKHJlY29yZCkgPT4gIXJlcy5pbmNsdWRlcyhyZWNvcmQpKTtcbiAgICAgIH0sXG4gICAgICBkZWxldGVNYW55OiBhc3luYyAoeyBtb2RlbCwgd2hlcmUgfSkgPT4ge1xuICAgICAgICBjb25zdCB0YWJsZSA9IGRiW21vZGVsXTtcbiAgICAgICAgY29uc3QgcmVzID0gY29udmVydFdoZXJlQ2xhdXNlKHdoZXJlLCBtb2RlbCk7XG4gICAgICAgIGxldCBjb3VudCA9IDA7XG4gICAgICAgIGRiW21vZGVsXSA9IHRhYmxlLmZpbHRlcigocmVjb3JkKSA9PiB7XG4gICAgICAgICAgaWYgKHJlcy5pbmNsdWRlcyhyZWNvcmQpKSB7XG4gICAgICAgICAgICBjb3VudCsrO1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gIXJlcy5pbmNsdWRlcyhyZWNvcmQpO1xuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIGNvdW50O1xuICAgICAgfSxcbiAgICAgIHVwZGF0ZU1hbnkoeyBtb2RlbCwgd2hlcmUsIHVwZGF0ZSB9KSB7XG4gICAgICAgIGNvbnN0IHJlcyA9IGNvbnZlcnRXaGVyZUNsYXVzZSh3aGVyZSwgbW9kZWwpO1xuICAgICAgICByZXMuZm9yRWFjaCgocmVjb3JkKSA9PiB7XG4gICAgICAgICAgT2JqZWN0LmFzc2lnbihyZWNvcmQsIHVwZGF0ZSk7XG4gICAgICAgIH0pO1xuICAgICAgICByZXR1cm4gcmVzWzBdIHx8IG51bGw7XG4gICAgICB9XG4gICAgfTtcbiAgfVxufSk7XG5cbmV4cG9ydCB7IG1lbW9yeUFkYXB0ZXIgYXMgbSB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.7ZeACU2v.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   g: () => (/* binding */ generateRandomString)\n/* harmony export */ });\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n\n\nconst generateRandomString = (0,_better_auth_utils_random__WEBPACK_IMPORTED_MODULE_0__.createRandomStringGenerator)(\n  \"a-z\",\n  \"0-9\",\n  \"A-Z\",\n  \"-_\"\n);\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQjRRb3hkZ2MubWpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXdFOztBQUV4RSw2QkFBNkIsc0ZBQTJCO0FBQ3hEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXFDIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxzaGFyZWRcXGJldHRlci1hdXRoLkI0UW94ZGdjLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVSYW5kb21TdHJpbmdHZW5lcmF0b3IgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvcmFuZG9tJztcblxuY29uc3QgZ2VuZXJhdGVSYW5kb21TdHJpbmcgPSBjcmVhdGVSYW5kb21TdHJpbmdHZW5lcmF0b3IoXG4gIFwiYS16XCIsXG4gIFwiMC05XCIsXG4gIFwiQS1aXCIsXG4gIFwiLV9cIlxuKTtcblxuZXhwb3J0IHsgZ2VuZXJhdGVSYW5kb21TdHJpbmcgYXMgZyB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   g: () => (/* binding */ generateId)\n/* harmony export */ });\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n\n\nconst generateId = (size) => {\n  return (0,_better_auth_utils_random__WEBPACK_IMPORTED_MODULE_0__.createRandomStringGenerator)(\"a-z\", \"A-Z\", \"0-9\")(size || 32);\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQlVQUFJYZksubWpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXdFOztBQUV4RTtBQUNBLFNBQVMsc0ZBQTJCO0FBQ3BDOztBQUUyQiIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcZGlzdFxcc2hhcmVkXFxiZXR0ZXItYXV0aC5CVVBQUlhmSy5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgY3JlYXRlUmFuZG9tU3RyaW5nR2VuZXJhdG9yIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL3JhbmRvbSc7XG5cbmNvbnN0IGdlbmVyYXRlSWQgPSAoc2l6ZSkgPT4ge1xuICByZXR1cm4gY3JlYXRlUmFuZG9tU3RyaW5nR2VuZXJhdG9yKFwiYS16XCIsIFwiQS1aXCIsIFwiMC05XCIpKHNpemUgfHwgMzIpO1xufTtcblxuZXhwb3J0IHsgZ2VuZXJhdGVJZCBhcyBnIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.BZZKN1g7.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.BZZKN1g7.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   s: () => (/* binding */ safeJSONParse)\n/* harmony export */ });\n/* harmony import */ var _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./better-auth.BjBlybv-.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BjBlybv-.mjs\");\n\n\nfunction safeJSONParse(data) {\n  function reviver(_, value) {\n    if (typeof value === \"string\") {\n      const iso8601Regex = /^\\d{4}-\\d{2}-\\d{2}T\\d{2}:\\d{2}:\\d{2}(?:\\.\\d+)?Z$/;\n      if (iso8601Regex.test(value)) {\n        const date = new Date(value);\n        if (!isNaN(date.getTime())) {\n          return date;\n        }\n      }\n    }\n    return value;\n  }\n  try {\n    if (typeof data !== \"string\") {\n      return data;\n    }\n    return JSON.parse(data, reviver);\n  } catch (e) {\n    _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_0__.a.error(\"Error parsing JSON\", { error: e });\n    return null;\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQlpaS04xZzcubWpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXlEOztBQUV6RDtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MsRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsSUFBSSxFQUFFO0FBQ2hFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0osSUFBSSx1REFBTSwrQkFBK0IsVUFBVTtBQUNuRDtBQUNBO0FBQ0E7O0FBRThCIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxzaGFyZWRcXGJldHRlci1hdXRoLkJaWktOMWc3Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBhIGFzIGxvZ2dlciB9IGZyb20gJy4vYmV0dGVyLWF1dGguQmpCbHlidi0ubWpzJztcblxuZnVuY3Rpb24gc2FmZUpTT05QYXJzZShkYXRhKSB7XG4gIGZ1bmN0aW9uIHJldml2ZXIoXywgdmFsdWUpIHtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICBjb25zdCBpc284NjAxUmVnZXggPSAvXlxcZHs0fS1cXGR7Mn0tXFxkezJ9VFxcZHsyfTpcXGR7Mn06XFxkezJ9KD86XFwuXFxkKyk/WiQvO1xuICAgICAgaWYgKGlzbzg2MDFSZWdleC50ZXN0KHZhbHVlKSkge1xuICAgICAgICBjb25zdCBkYXRlID0gbmV3IERhdGUodmFsdWUpO1xuICAgICAgICBpZiAoIWlzTmFOKGRhdGUuZ2V0VGltZSgpKSkge1xuICAgICAgICAgIHJldHVybiBkYXRlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxuICB0cnkge1xuICAgIGlmICh0eXBlb2YgZGF0YSAhPT0gXCJzdHJpbmdcIikge1xuICAgICAgcmV0dXJuIGRhdGE7XG4gICAgfVxuICAgIHJldHVybiBKU09OLnBhcnNlKGRhdGEsIHJldml2ZXIpO1xuICB9IGNhdGNoIChlKSB7XG4gICAgbG9nZ2VyLmVycm9yKFwiRXJyb3IgcGFyc2luZyBKU09OXCIsIHsgZXJyb3I6IGUgfSk7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cblxuZXhwb3J0IHsgc2FmZUpTT05QYXJzZSBhcyBzIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.BZZKN1g7.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.B_PTVODM.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.B_PTVODM.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   g: () => (/* binding */ getAuthTables)\n/* harmony export */ });\nconst getAuthTables = (options) => {\n  const pluginSchema = (options.plugins ?? []).reduce(\n    (acc, plugin) => {\n      const schema = plugin.schema;\n      if (!schema) return acc;\n      for (const [key, value] of Object.entries(schema)) {\n        acc[key] = {\n          fields: {\n            ...acc[key]?.fields,\n            ...value.fields\n          },\n          modelName: value.modelName || key\n        };\n      }\n      return acc;\n    },\n    {}\n  );\n  const shouldAddRateLimitTable = options.rateLimit?.storage === \"database\";\n  const rateLimitTable = {\n    rateLimit: {\n      modelName: options.rateLimit?.modelName || \"rateLimit\",\n      fields: {\n        key: {\n          type: \"string\",\n          fieldName: options.rateLimit?.fields?.key || \"key\"\n        },\n        count: {\n          type: \"number\",\n          fieldName: options.rateLimit?.fields?.count || \"count\"\n        },\n        lastRequest: {\n          type: \"number\",\n          bigint: true,\n          fieldName: options.rateLimit?.fields?.lastRequest || \"lastRequest\"\n        }\n      }\n    }\n  };\n  const { user, session, account, ...pluginTables } = pluginSchema;\n  const sessionTable = {\n    session: {\n      modelName: options.session?.modelName || \"session\",\n      fields: {\n        expiresAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.session?.fields?.expiresAt || \"expiresAt\"\n        },\n        token: {\n          type: \"string\",\n          required: true,\n          fieldName: options.session?.fields?.token || \"token\",\n          unique: true\n        },\n        createdAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.session?.fields?.createdAt || \"createdAt\",\n          defaultValue: () => /* @__PURE__ */ new Date()\n        },\n        updatedAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.session?.fields?.updatedAt || \"updatedAt\",\n          onUpdate: () => /* @__PURE__ */ new Date()\n        },\n        ipAddress: {\n          type: \"string\",\n          required: false,\n          fieldName: options.session?.fields?.ipAddress || \"ipAddress\"\n        },\n        userAgent: {\n          type: \"string\",\n          required: false,\n          fieldName: options.session?.fields?.userAgent || \"userAgent\"\n        },\n        userId: {\n          type: \"string\",\n          fieldName: options.session?.fields?.userId || \"userId\",\n          references: {\n            model: options.user?.modelName || \"user\",\n            field: \"id\",\n            onDelete: \"cascade\"\n          },\n          required: true\n        },\n        ...session?.fields,\n        ...options.session?.additionalFields\n      },\n      order: 2\n    }\n  };\n  return {\n    user: {\n      modelName: options.user?.modelName || \"user\",\n      fields: {\n        name: {\n          type: \"string\",\n          required: true,\n          fieldName: options.user?.fields?.name || \"name\",\n          sortable: true\n        },\n        email: {\n          type: \"string\",\n          unique: true,\n          required: true,\n          fieldName: options.user?.fields?.email || \"email\",\n          sortable: true\n        },\n        emailVerified: {\n          type: \"boolean\",\n          defaultValue: false,\n          required: true,\n          fieldName: options.user?.fields?.emailVerified || \"emailVerified\"\n        },\n        image: {\n          type: \"string\",\n          required: false,\n          fieldName: options.user?.fields?.image || \"image\"\n        },\n        createdAt: {\n          type: \"date\",\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          required: true,\n          fieldName: options.user?.fields?.createdAt || \"createdAt\"\n        },\n        updatedAt: {\n          type: \"date\",\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          onUpdate: () => /* @__PURE__ */ new Date(),\n          required: true,\n          fieldName: options.user?.fields?.updatedAt || \"updatedAt\"\n        },\n        ...user?.fields,\n        ...options.user?.additionalFields\n      },\n      order: 1\n    },\n    //only add session table if it's not stored in secondary storage\n    ...!options.secondaryStorage || options.session?.storeSessionInDatabase ? sessionTable : {},\n    account: {\n      modelName: options.account?.modelName || \"account\",\n      fields: {\n        accountId: {\n          type: \"string\",\n          required: true,\n          fieldName: options.account?.fields?.accountId || \"accountId\"\n        },\n        providerId: {\n          type: \"string\",\n          required: true,\n          fieldName: options.account?.fields?.providerId || \"providerId\"\n        },\n        userId: {\n          type: \"string\",\n          references: {\n            model: options.user?.modelName || \"user\",\n            field: \"id\",\n            onDelete: \"cascade\"\n          },\n          required: true,\n          fieldName: options.account?.fields?.userId || \"userId\"\n        },\n        accessToken: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.accessToken || \"accessToken\"\n        },\n        refreshToken: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.refreshToken || \"refreshToken\"\n        },\n        idToken: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.idToken || \"idToken\"\n        },\n        accessTokenExpiresAt: {\n          type: \"date\",\n          required: false,\n          fieldName: options.account?.fields?.accessTokenExpiresAt || \"accessTokenExpiresAt\"\n        },\n        refreshTokenExpiresAt: {\n          type: \"date\",\n          required: false,\n          fieldName: options.account?.fields?.accessTokenExpiresAt || \"refreshTokenExpiresAt\"\n        },\n        scope: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.scope || \"scope\"\n        },\n        password: {\n          type: \"string\",\n          required: false,\n          fieldName: options.account?.fields?.password || \"password\"\n        },\n        createdAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.account?.fields?.createdAt || \"createdAt\",\n          defaultValue: () => /* @__PURE__ */ new Date()\n        },\n        updatedAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.account?.fields?.updatedAt || \"updatedAt\",\n          onUpdate: () => /* @__PURE__ */ new Date()\n        },\n        ...account?.fields\n      },\n      order: 3\n    },\n    verification: {\n      modelName: options.verification?.modelName || \"verification\",\n      fields: {\n        identifier: {\n          type: \"string\",\n          required: true,\n          fieldName: options.verification?.fields?.identifier || \"identifier\"\n        },\n        value: {\n          type: \"string\",\n          required: true,\n          fieldName: options.verification?.fields?.value || \"value\"\n        },\n        expiresAt: {\n          type: \"date\",\n          required: true,\n          fieldName: options.verification?.fields?.expiresAt || \"expiresAt\"\n        },\n        createdAt: {\n          type: \"date\",\n          required: true,\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          fieldName: options.verification?.fields?.createdAt || \"createdAt\"\n        },\n        updatedAt: {\n          type: \"date\",\n          required: true,\n          defaultValue: () => /* @__PURE__ */ new Date(),\n          onUpdate: () => /* @__PURE__ */ new Date(),\n          fieldName: options.verification?.fields?.updatedAt || \"updatedAt\"\n        }\n      },\n      order: 4\n    },\n    ...pluginTables,\n    ...shouldAddRateLimitTable ? rateLimitTable : {}\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQl9QVFZPRE0ubWpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsMENBQTBDO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBLCtGQUErRjtBQUMvRjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTs7QUFFOEIiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXGRpc3RcXHNoYXJlZFxcYmV0dGVyLWF1dGguQl9QVFZPRE0ubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IGdldEF1dGhUYWJsZXMgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCBwbHVnaW5TY2hlbWEgPSAob3B0aW9ucy5wbHVnaW5zID8/IFtdKS5yZWR1Y2UoXG4gICAgKGFjYywgcGx1Z2luKSA9PiB7XG4gICAgICBjb25zdCBzY2hlbWEgPSBwbHVnaW4uc2NoZW1hO1xuICAgICAgaWYgKCFzY2hlbWEpIHJldHVybiBhY2M7XG4gICAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhzY2hlbWEpKSB7XG4gICAgICAgIGFjY1trZXldID0ge1xuICAgICAgICAgIGZpZWxkczoge1xuICAgICAgICAgICAgLi4uYWNjW2tleV0/LmZpZWxkcyxcbiAgICAgICAgICAgIC4uLnZhbHVlLmZpZWxkc1xuICAgICAgICAgIH0sXG4gICAgICAgICAgbW9kZWxOYW1lOiB2YWx1ZS5tb2RlbE5hbWUgfHwga2V5XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4gYWNjO1xuICAgIH0sXG4gICAge31cbiAgKTtcbiAgY29uc3Qgc2hvdWxkQWRkUmF0ZUxpbWl0VGFibGUgPSBvcHRpb25zLnJhdGVMaW1pdD8uc3RvcmFnZSA9PT0gXCJkYXRhYmFzZVwiO1xuICBjb25zdCByYXRlTGltaXRUYWJsZSA9IHtcbiAgICByYXRlTGltaXQ6IHtcbiAgICAgIG1vZGVsTmFtZTogb3B0aW9ucy5yYXRlTGltaXQ/Lm1vZGVsTmFtZSB8fCBcInJhdGVMaW1pdFwiLFxuICAgICAgZmllbGRzOiB7XG4gICAgICAgIGtleToge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnJhdGVMaW1pdD8uZmllbGRzPy5rZXkgfHwgXCJrZXlcIlxuICAgICAgICB9LFxuICAgICAgICBjb3VudDoge1xuICAgICAgICAgIHR5cGU6IFwibnVtYmVyXCIsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnJhdGVMaW1pdD8uZmllbGRzPy5jb3VudCB8fCBcImNvdW50XCJcbiAgICAgICAgfSxcbiAgICAgICAgbGFzdFJlcXVlc3Q6IHtcbiAgICAgICAgICB0eXBlOiBcIm51bWJlclwiLFxuICAgICAgICAgIGJpZ2ludDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMucmF0ZUxpbWl0Py5maWVsZHM/Lmxhc3RSZXF1ZXN0IHx8IFwibGFzdFJlcXVlc3RcIlxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9O1xuICBjb25zdCB7IHVzZXIsIHNlc3Npb24sIGFjY291bnQsIC4uLnBsdWdpblRhYmxlcyB9ID0gcGx1Z2luU2NoZW1hO1xuICBjb25zdCBzZXNzaW9uVGFibGUgPSB7XG4gICAgc2Vzc2lvbjoge1xuICAgICAgbW9kZWxOYW1lOiBvcHRpb25zLnNlc3Npb24/Lm1vZGVsTmFtZSB8fCBcInNlc3Npb25cIixcbiAgICAgIGZpZWxkczoge1xuICAgICAgICBleHBpcmVzQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuc2Vzc2lvbj8uZmllbGRzPy5leHBpcmVzQXQgfHwgXCJleHBpcmVzQXRcIlxuICAgICAgICB9LFxuICAgICAgICB0b2tlbjoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnNlc3Npb24/LmZpZWxkcz8udG9rZW4gfHwgXCJ0b2tlblwiLFxuICAgICAgICAgIHVuaXF1ZTogdHJ1ZVxuICAgICAgICB9LFxuICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuc2Vzc2lvbj8uZmllbGRzPy5jcmVhdGVkQXQgfHwgXCJjcmVhdGVkQXRcIixcbiAgICAgICAgICBkZWZhdWx0VmFsdWU6ICgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpXG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZWRBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5zZXNzaW9uPy5maWVsZHM/LnVwZGF0ZWRBdCB8fCBcInVwZGF0ZWRBdFwiLFxuICAgICAgICAgIG9uVXBkYXRlOiAoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKVxuICAgICAgICB9LFxuICAgICAgICBpcEFkZHJlc3M6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuc2Vzc2lvbj8uZmllbGRzPy5pcEFkZHJlc3MgfHwgXCJpcEFkZHJlc3NcIlxuICAgICAgICB9LFxuICAgICAgICB1c2VyQWdlbnQ6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuc2Vzc2lvbj8uZmllbGRzPy51c2VyQWdlbnQgfHwgXCJ1c2VyQWdlbnRcIlxuICAgICAgICB9LFxuICAgICAgICB1c2VySWQ6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5zZXNzaW9uPy5maWVsZHM/LnVzZXJJZCB8fCBcInVzZXJJZFwiLFxuICAgICAgICAgIHJlZmVyZW5jZXM6IHtcbiAgICAgICAgICAgIG1vZGVsOiBvcHRpb25zLnVzZXI/Lm1vZGVsTmFtZSB8fCBcInVzZXJcIixcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICBvbkRlbGV0ZTogXCJjYXNjYWRlXCJcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIC4uLnNlc3Npb24/LmZpZWxkcyxcbiAgICAgICAgLi4ub3B0aW9ucy5zZXNzaW9uPy5hZGRpdGlvbmFsRmllbGRzXG4gICAgICB9LFxuICAgICAgb3JkZXI6IDJcbiAgICB9XG4gIH07XG4gIHJldHVybiB7XG4gICAgdXNlcjoge1xuICAgICAgbW9kZWxOYW1lOiBvcHRpb25zLnVzZXI/Lm1vZGVsTmFtZSB8fCBcInVzZXJcIixcbiAgICAgIGZpZWxkczoge1xuICAgICAgICBuYW1lOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudXNlcj8uZmllbGRzPy5uYW1lIHx8IFwibmFtZVwiLFxuICAgICAgICAgIHNvcnRhYmxlOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIGVtYWlsOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICB1bmlxdWU6IHRydWUsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnVzZXI/LmZpZWxkcz8uZW1haWwgfHwgXCJlbWFpbFwiLFxuICAgICAgICAgIHNvcnRhYmxlOiB0cnVlXG4gICAgICAgIH0sXG4gICAgICAgIGVtYWlsVmVyaWZpZWQ6IHtcbiAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICBkZWZhdWx0VmFsdWU6IGZhbHNlLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy51c2VyPy5maWVsZHM/LmVtYWlsVmVyaWZpZWQgfHwgXCJlbWFpbFZlcmlmaWVkXCJcbiAgICAgICAgfSxcbiAgICAgICAgaW1hZ2U6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudXNlcj8uZmllbGRzPy5pbWFnZSB8fCBcImltYWdlXCJcbiAgICAgICAgfSxcbiAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgZGVmYXVsdFZhbHVlOiAoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudXNlcj8uZmllbGRzPy5jcmVhdGVkQXQgfHwgXCJjcmVhdGVkQXRcIlxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGVkQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICBkZWZhdWx0VmFsdWU6ICgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIG9uVXBkYXRlOiAoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudXNlcj8uZmllbGRzPy51cGRhdGVkQXQgfHwgXCJ1cGRhdGVkQXRcIlxuICAgICAgICB9LFxuICAgICAgICAuLi51c2VyPy5maWVsZHMsXG4gICAgICAgIC4uLm9wdGlvbnMudXNlcj8uYWRkaXRpb25hbEZpZWxkc1xuICAgICAgfSxcbiAgICAgIG9yZGVyOiAxXG4gICAgfSxcbiAgICAvL29ubHkgYWRkIHNlc3Npb24gdGFibGUgaWYgaXQncyBub3Qgc3RvcmVkIGluIHNlY29uZGFyeSBzdG9yYWdlXG4gICAgLi4uIW9wdGlvbnMuc2Vjb25kYXJ5U3RvcmFnZSB8fCBvcHRpb25zLnNlc3Npb24/LnN0b3JlU2Vzc2lvbkluRGF0YWJhc2UgPyBzZXNzaW9uVGFibGUgOiB7fSxcbiAgICBhY2NvdW50OiB7XG4gICAgICBtb2RlbE5hbWU6IG9wdGlvbnMuYWNjb3VudD8ubW9kZWxOYW1lIHx8IFwiYWNjb3VudFwiLFxuICAgICAgZmllbGRzOiB7XG4gICAgICAgIGFjY291bnRJZDoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8uYWNjb3VudElkIHx8IFwiYWNjb3VudElkXCJcbiAgICAgICAgfSxcbiAgICAgICAgcHJvdmlkZXJJZDoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8ucHJvdmlkZXJJZCB8fCBcInByb3ZpZGVySWRcIlxuICAgICAgICB9LFxuICAgICAgICB1c2VySWQ6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlZmVyZW5jZXM6IHtcbiAgICAgICAgICAgIG1vZGVsOiBvcHRpb25zLnVzZXI/Lm1vZGVsTmFtZSB8fCBcInVzZXJcIixcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICBvbkRlbGV0ZTogXCJjYXNjYWRlXCJcbiAgICAgICAgICB9LFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LnVzZXJJZCB8fCBcInVzZXJJZFwiXG4gICAgICAgIH0sXG4gICAgICAgIGFjY2Vzc1Rva2VuOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8uYWNjZXNzVG9rZW4gfHwgXCJhY2Nlc3NUb2tlblwiXG4gICAgICAgIH0sXG4gICAgICAgIHJlZnJlc2hUb2tlbjoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LnJlZnJlc2hUb2tlbiB8fCBcInJlZnJlc2hUb2tlblwiXG4gICAgICAgIH0sXG4gICAgICAgIGlkVG9rZW46IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiBmYWxzZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuYWNjb3VudD8uZmllbGRzPy5pZFRva2VuIHx8IFwiaWRUb2tlblwiXG4gICAgICAgIH0sXG4gICAgICAgIGFjY2Vzc1Rva2VuRXhwaXJlc0F0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LmFjY2Vzc1Rva2VuRXhwaXJlc0F0IHx8IFwiYWNjZXNzVG9rZW5FeHBpcmVzQXRcIlxuICAgICAgICB9LFxuICAgICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLmFjY291bnQ/LmZpZWxkcz8uYWNjZXNzVG9rZW5FeHBpcmVzQXQgfHwgXCJyZWZyZXNoVG9rZW5FeHBpcmVzQXRcIlxuICAgICAgICB9LFxuICAgICAgICBzY29wZToge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LnNjb3BlIHx8IFwic2NvcGVcIlxuICAgICAgICB9LFxuICAgICAgICBwYXNzd29yZDoge1xuICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IGZhbHNlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LnBhc3N3b3JkIHx8IFwicGFzc3dvcmRcIlxuICAgICAgICB9LFxuICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICB0eXBlOiBcImRhdGVcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMuYWNjb3VudD8uZmllbGRzPy5jcmVhdGVkQXQgfHwgXCJjcmVhdGVkQXRcIixcbiAgICAgICAgICBkZWZhdWx0VmFsdWU6ICgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpXG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZWRBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5hY2NvdW50Py5maWVsZHM/LnVwZGF0ZWRBdCB8fCBcInVwZGF0ZWRBdFwiLFxuICAgICAgICAgIG9uVXBkYXRlOiAoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKVxuICAgICAgICB9LFxuICAgICAgICAuLi5hY2NvdW50Py5maWVsZHNcbiAgICAgIH0sXG4gICAgICBvcmRlcjogM1xuICAgIH0sXG4gICAgdmVyaWZpY2F0aW9uOiB7XG4gICAgICBtb2RlbE5hbWU6IG9wdGlvbnMudmVyaWZpY2F0aW9uPy5tb2RlbE5hbWUgfHwgXCJ2ZXJpZmljYXRpb25cIixcbiAgICAgIGZpZWxkczoge1xuICAgICAgICBpZGVudGlmaWVyOiB7XG4gICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudmVyaWZpY2F0aW9uPy5maWVsZHM/LmlkZW50aWZpZXIgfHwgXCJpZGVudGlmaWVyXCJcbiAgICAgICAgfSxcbiAgICAgICAgdmFsdWU6IHtcbiAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy52ZXJpZmljYXRpb24/LmZpZWxkcz8udmFsdWUgfHwgXCJ2YWx1ZVwiXG4gICAgICAgIH0sXG4gICAgICAgIGV4cGlyZXNBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy52ZXJpZmljYXRpb24/LmZpZWxkcz8uZXhwaXJlc0F0IHx8IFwiZXhwaXJlc0F0XCJcbiAgICAgICAgfSxcbiAgICAgICAgY3JlYXRlZEF0OiB7XG4gICAgICAgICAgdHlwZTogXCJkYXRlXCIsXG4gICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgZGVmYXVsdFZhbHVlOiAoKSA9PiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICBmaWVsZE5hbWU6IG9wdGlvbnMudmVyaWZpY2F0aW9uPy5maWVsZHM/LmNyZWF0ZWRBdCB8fCBcImNyZWF0ZWRBdFwiXG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZWRBdDoge1xuICAgICAgICAgIHR5cGU6IFwiZGF0ZVwiLFxuICAgICAgICAgIHJlcXVpcmVkOiB0cnVlLFxuICAgICAgICAgIGRlZmF1bHRWYWx1ZTogKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgb25VcGRhdGU6ICgpID0+IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy52ZXJpZmljYXRpb24/LmZpZWxkcz8udXBkYXRlZEF0IHx8IFwidXBkYXRlZEF0XCJcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIG9yZGVyOiA0XG4gICAgfSxcbiAgICAuLi5wbHVnaW5UYWJsZXMsXG4gICAgLi4uc2hvdWxkQWRkUmF0ZUxpbWl0VGFibGUgPyByYXRlTGltaXRUYWJsZSA6IHt9XG4gIH07XG59O1xuXG5leHBvcnQgeyBnZXRBdXRoVGFibGVzIGFzIGcgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.B_PTVODM.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.BduPtJy8.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.BduPtJy8.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   c: () => (/* binding */ createKyselyAdapter),\n/* harmony export */   g: () => (/* binding */ getKyselyDatabaseType),\n/* harmony export */   k: () => (/* binding */ kyselyAdapter)\n/* harmony export */ });\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/dialect/sqlite/sqlite-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/dialect/mysql/mysql-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/dialect/postgres/postgres-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/dialect/mssql/mssql-dialect.js\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/kysely.js\");\n/* harmony import */ var _better_auth_DOXaXTC6_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./better-auth.DOXaXTC6.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DOXaXTC6.mjs\");\n\n\n\nfunction getKyselyDatabaseType(db) {\n  if (!db) {\n    return null;\n  }\n  if (\"dialect\" in db) {\n    return getKyselyDatabaseType(db.dialect);\n  }\n  if (\"createDriver\" in db) {\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_1__.SqliteDialect) {\n      return \"sqlite\";\n    }\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_2__.MysqlDialect) {\n      return \"mysql\";\n    }\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_3__.PostgresDialect) {\n      return \"postgres\";\n    }\n    if (db instanceof kysely__WEBPACK_IMPORTED_MODULE_4__.MssqlDialect) {\n      return \"mssql\";\n    }\n  }\n  if (\"aggregate\" in db) {\n    return \"sqlite\";\n  }\n  if (\"getConnection\" in db) {\n    return \"mysql\";\n  }\n  if (\"connect\" in db) {\n    return \"postgres\";\n  }\n  if (\"fileControl\" in db) {\n    return \"sqlite\";\n  }\n  if (\"open\" in db && \"close\" in db && \"prepare\" in db) {\n    return \"sqlite\";\n  }\n  return null;\n}\nconst createKyselyAdapter = async (config) => {\n  const db = config.database;\n  if (!db) {\n    return {\n      kysely: null,\n      databaseType: null\n    };\n  }\n  if (\"db\" in db) {\n    return {\n      kysely: db.db,\n      databaseType: db.type\n    };\n  }\n  if (\"dialect\" in db) {\n    return {\n      kysely: new kysely__WEBPACK_IMPORTED_MODULE_5__.Kysely({ dialect: db.dialect }),\n      databaseType: db.type\n    };\n  }\n  let dialect = void 0;\n  const databaseType = getKyselyDatabaseType(db);\n  if (\"createDriver\" in db) {\n    dialect = db;\n  }\n  if (\"aggregate\" in db && !(\"createSession\" in db)) {\n    dialect = new kysely__WEBPACK_IMPORTED_MODULE_1__.SqliteDialect({\n      database: db\n    });\n  }\n  if (\"getConnection\" in db) {\n    dialect = new kysely__WEBPACK_IMPORTED_MODULE_2__.MysqlDialect(db);\n  }\n  if (\"connect\" in db) {\n    dialect = new kysely__WEBPACK_IMPORTED_MODULE_3__.PostgresDialect({\n      pool: db\n    });\n  }\n  if (\"fileControl\" in db) {\n    const { BunSqliteDialect } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/better-auth\").then(__webpack_require__.bind(__webpack_require__, /*! ../chunks/bun-sqlite-dialect.mjs */ \"(rsc)/./node_modules/better-auth/dist/chunks/bun-sqlite-dialect.mjs\"));\n    dialect = new BunSqliteDialect({\n      database: db\n    });\n  }\n  if (\"createSession\" in db && typeof window === \"undefined\") {\n    let DatabaseSync = void 0;\n    try {\n      let nodeSqlite = \"node:sqlite\";\n      ({ DatabaseSync } = await import(\n        /* @vite-ignore */\n        /* webpackIgnore: true */\n        nodeSqlite\n      ));\n    } catch (error) {\n      if (error !== null && typeof error === \"object\" && \"code\" in error && error.code !== \"ERR_UNKNOWN_BUILTIN_MODULE\") {\n        throw error;\n      }\n    }\n    if (DatabaseSync && db instanceof DatabaseSync) {\n      const { NodeSqliteDialect } = await __webpack_require__.e(/*! import() */ \"vendor-chunks/better-auth\").then(__webpack_require__.bind(__webpack_require__, /*! ../chunks/node-sqlite-dialect.mjs */ \"(rsc)/./node_modules/better-auth/dist/chunks/node-sqlite-dialect.mjs\"));\n      dialect = new NodeSqliteDialect({\n        database: db\n      });\n    }\n  }\n  return {\n    kysely: dialect ? new kysely__WEBPACK_IMPORTED_MODULE_5__.Kysely({ dialect }) : null,\n    databaseType\n  };\n};\n\nconst kyselyAdapter = (db, config) => (0,_better_auth_DOXaXTC6_mjs__WEBPACK_IMPORTED_MODULE_0__.c)({\n  config: {\n    adapterId: \"kysely\",\n    adapterName: \"Kysely Adapter\",\n    usePlural: config?.usePlural,\n    debugLogs: config?.debugLogs,\n    supportsBooleans: config?.type === \"sqlite\" || config?.type === \"mssql\" || !config?.type ? false : true,\n    supportsDates: config?.type === \"sqlite\" || config?.type === \"mssql\" || !config?.type ? false : true,\n    supportsJSON: false\n  },\n  adapter: ({ getFieldName, schema }) => {\n    const withReturning = async (values, builder, model, where) => {\n      let res;\n      if (config?.type === \"mysql\") {\n        await builder.execute();\n        const field = values.id ? \"id\" : where.length > 0 && where[0].field ? where[0].field : \"id\";\n        if (!values.id && where.length === 0) {\n          res = await db.selectFrom(model).selectAll().orderBy(getFieldName({ model, field }), \"desc\").limit(1).executeTakeFirst();\n          return res;\n        }\n        const value = values[field] || where[0].value;\n        res = await db.selectFrom(model).selectAll().orderBy(getFieldName({ model, field }), \"desc\").where(getFieldName({ model, field }), \"=\", value).limit(1).executeTakeFirst();\n        return res;\n      }\n      if (config?.type === \"mssql\") {\n        res = await builder.outputAll(\"inserted\").executeTakeFirst();\n        return res;\n      }\n      res = await builder.returningAll().executeTakeFirst();\n      return res;\n    };\n    function transformValueToDB(value, model, field) {\n      if (field === \"id\") {\n        return value;\n      }\n      const { type = \"sqlite\" } = config || {};\n      let f = schema[model]?.fields[field];\n      if (!f) {\n        f = Object.values(schema).find((f2) => f2.modelName === model);\n      }\n      if (f.type === \"boolean\" && (type === \"sqlite\" || type === \"mssql\") && value !== null && value !== void 0) {\n        return value ? 1 : 0;\n      }\n      if (f.type === \"date\" && value && value instanceof Date) {\n        return type === \"sqlite\" ? value.toISOString() : value;\n      }\n      return value;\n    }\n    function convertWhereClause(model, w) {\n      if (!w)\n        return {\n          and: null,\n          or: null\n        };\n      const conditions = {\n        and: [],\n        or: []\n      };\n      w.forEach((condition) => {\n        let {\n          field: _field,\n          value,\n          operator = \"=\",\n          connector = \"AND\"\n        } = condition;\n        const field = getFieldName({ model, field: _field });\n        value = transformValueToDB(value, model, _field);\n        const expr = (eb) => {\n          if (operator.toLowerCase() === \"in\") {\n            return eb(field, \"in\", Array.isArray(value) ? value : [value]);\n          }\n          if (operator.toLowerCase() === \"not_in\") {\n            return eb(\n              field,\n              \"not in\",\n              Array.isArray(value) ? value : [value]\n            );\n          }\n          if (operator === \"contains\") {\n            return eb(field, \"like\", `%${value}%`);\n          }\n          if (operator === \"starts_with\") {\n            return eb(field, \"like\", `${value}%`);\n          }\n          if (operator === \"ends_with\") {\n            return eb(field, \"like\", `%${value}`);\n          }\n          if (operator === \"eq\") {\n            return eb(field, \"=\", value);\n          }\n          if (operator === \"ne\") {\n            return eb(field, \"<>\", value);\n          }\n          if (operator === \"gt\") {\n            return eb(field, \">\", value);\n          }\n          if (operator === \"gte\") {\n            return eb(field, \">=\", value);\n          }\n          if (operator === \"lt\") {\n            return eb(field, \"<\", value);\n          }\n          if (operator === \"lte\") {\n            return eb(field, \"<=\", value);\n          }\n          return eb(field, operator, value);\n        };\n        if (connector === \"OR\") {\n          conditions.or.push(expr);\n        } else {\n          conditions.and.push(expr);\n        }\n      });\n      return {\n        and: conditions.and.length ? conditions.and : null,\n        or: conditions.or.length ? conditions.or : null\n      };\n    }\n    return {\n      async create({ data, model }) {\n        const builder = db.insertInto(model).values(data);\n        return await withReturning(data, builder, model, []);\n      },\n      async findOne({ model, where, select }) {\n        const { and, or } = convertWhereClause(model, where);\n        let query = db.selectFrom(model).selectAll();\n        if (and) {\n          query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n        }\n        if (or) {\n          query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n        }\n        const res = await query.executeTakeFirst();\n        if (!res) return null;\n        return res;\n      },\n      async findMany({ model, where, limit, offset, sortBy }) {\n        const { and, or } = convertWhereClause(model, where);\n        let query = db.selectFrom(model);\n        if (and) {\n          query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n        }\n        if (or) {\n          query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n        }\n        if (config?.type === \"mssql\") {\n          if (!offset) {\n            query = query.top(limit || 100);\n          }\n        } else {\n          query = query.limit(limit || 100);\n        }\n        if (sortBy) {\n          query = query.orderBy(\n            getFieldName({ model, field: sortBy.field }),\n            sortBy.direction\n          );\n        }\n        if (offset) {\n          if (config?.type === \"mssql\") {\n            if (!sortBy) {\n              query = query.orderBy(getFieldName({ model, field: \"id\" }));\n            }\n            query = query.offset(offset).fetch(limit || 100);\n          } else {\n            query = query.offset(offset);\n          }\n        }\n        const res = await query.selectAll().execute();\n        if (!res) return [];\n        return res;\n      },\n      async update({ model, where, update: values }) {\n        const { and, or } = convertWhereClause(model, where);\n        let query = db.updateTable(model).set(values);\n        if (and) {\n          query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n        }\n        if (or) {\n          query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n        }\n        return await withReturning(values, query, model, where);\n      },\n      async updateMany({ model, where, update: values }) {\n        const { and, or } = convertWhereClause(model, where);\n        let query = db.updateTable(model).set(values);\n        if (and) {\n          query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n        }\n        if (or) {\n          query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n        }\n        const res = await query.execute();\n        return res.length;\n      },\n      async count({ model, where }) {\n        const { and, or } = convertWhereClause(model, where);\n        let query = db.selectFrom(model).select(db.fn.count(\"id\").as(\"count\"));\n        if (and) {\n          query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n        }\n        if (or) {\n          query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n        }\n        const res = await query.execute();\n        return res[0].count;\n      },\n      async delete({ model, where }) {\n        const { and, or } = convertWhereClause(model, where);\n        let query = db.deleteFrom(model);\n        if (and) {\n          query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n        }\n        if (or) {\n          query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n        }\n        await query.execute();\n      },\n      async deleteMany({ model, where }) {\n        const { and, or } = convertWhereClause(model, where);\n        let query = db.deleteFrom(model);\n        if (and) {\n          query = query.where((eb) => eb.and(and.map((expr) => expr(eb))));\n        }\n        if (or) {\n          query = query.where((eb) => eb.or(or.map((expr) => expr(eb))));\n        }\n        return (await query.execute()).length;\n      },\n      options: config\n    };\n  }\n});\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQmR1UHRKeTgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUE0RjtBQUM1Qjs7QUFFaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixpREFBYTtBQUNuQztBQUNBO0FBQ0Esc0JBQXNCLGdEQUFZO0FBQ2xDO0FBQ0E7QUFDQSxzQkFBc0IsbURBQWU7QUFDckM7QUFDQTtBQUNBLHNCQUFzQixnREFBWTtBQUNsQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsMENBQU0sR0FBRyxxQkFBcUI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLGlEQUFhO0FBQy9CO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxrQkFBa0IsZ0RBQVk7QUFDOUI7QUFDQTtBQUNBLGtCQUFrQixtREFBZTtBQUNqQztBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0EsWUFBWSxtQkFBbUIsUUFBUSxxT0FBMEM7QUFDakY7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUyxlQUFlO0FBQ3hCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTTtBQUNOO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLG9CQUFvQixRQUFRLHVPQUEyQztBQUNyRjtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiwwQ0FBTSxHQUFHLFNBQVM7QUFDNUM7QUFDQTtBQUNBOztBQUVBLHNDQUFzQyw0REFBYTtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNILGNBQWMsc0JBQXNCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhFQUE4RSxjQUFjO0FBQzVGO0FBQ0E7QUFDQTtBQUNBLDRFQUE0RSxjQUFjLGdDQUFnQyxjQUFjO0FBQ3hJO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxrQkFBa0I7QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1YscUNBQXFDLHNCQUFzQjtBQUMzRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHlDQUF5QyxNQUFNO0FBQy9DO0FBQ0E7QUFDQSx3Q0FBd0MsTUFBTTtBQUM5QztBQUNBO0FBQ0EseUNBQXlDLE1BQU07QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQixhQUFhO0FBQ2xDO0FBQ0E7QUFDQSxPQUFPO0FBQ1Asc0JBQXNCLHNCQUFzQjtBQUM1QyxnQkFBZ0IsVUFBVTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCx1QkFBdUIscUNBQXFDO0FBQzVELGdCQUFnQixVQUFVO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVO0FBQ1Y7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsNEJBQTRCO0FBQ3ZEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1EQUFtRCxvQkFBb0I7QUFDdkU7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1AscUJBQXFCLDhCQUE4QjtBQUNuRCxnQkFBZ0IsVUFBVTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLHlCQUF5Qiw4QkFBOEI7QUFDdkQsZ0JBQWdCLFVBQVU7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLG9CQUFvQixjQUFjO0FBQ2xDLGdCQUFnQixVQUFVO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxxQkFBcUIsY0FBYztBQUNuQyxnQkFBZ0IsVUFBVTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQLHlCQUF5QixjQUFjO0FBQ3ZDLGdCQUFnQixVQUFVO0FBQzFCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EsQ0FBQzs7QUFFbUYiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXGRpc3RcXHNoYXJlZFxcYmV0dGVyLWF1dGguQmR1UHRKeTgubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFNxbGl0ZURpYWxlY3QsIE15c3FsRGlhbGVjdCwgUG9zdGdyZXNEaWFsZWN0LCBNc3NxbERpYWxlY3QsIEt5c2VseSB9IGZyb20gJ2t5c2VseSc7XG5pbXBvcnQgeyBjIGFzIGNyZWF0ZUFkYXB0ZXIgfSBmcm9tICcuL2JldHRlci1hdXRoLkRPWGFYVEM2Lm1qcyc7XG5cbmZ1bmN0aW9uIGdldEt5c2VseURhdGFiYXNlVHlwZShkYikge1xuICBpZiAoIWRiKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgaWYgKFwiZGlhbGVjdFwiIGluIGRiKSB7XG4gICAgcmV0dXJuIGdldEt5c2VseURhdGFiYXNlVHlwZShkYi5kaWFsZWN0KTtcbiAgfVxuICBpZiAoXCJjcmVhdGVEcml2ZXJcIiBpbiBkYikge1xuICAgIGlmIChkYiBpbnN0YW5jZW9mIFNxbGl0ZURpYWxlY3QpIHtcbiAgICAgIHJldHVybiBcInNxbGl0ZVwiO1xuICAgIH1cbiAgICBpZiAoZGIgaW5zdGFuY2VvZiBNeXNxbERpYWxlY3QpIHtcbiAgICAgIHJldHVybiBcIm15c3FsXCI7XG4gICAgfVxuICAgIGlmIChkYiBpbnN0YW5jZW9mIFBvc3RncmVzRGlhbGVjdCkge1xuICAgICAgcmV0dXJuIFwicG9zdGdyZXNcIjtcbiAgICB9XG4gICAgaWYgKGRiIGluc3RhbmNlb2YgTXNzcWxEaWFsZWN0KSB7XG4gICAgICByZXR1cm4gXCJtc3NxbFwiO1xuICAgIH1cbiAgfVxuICBpZiAoXCJhZ2dyZWdhdGVcIiBpbiBkYikge1xuICAgIHJldHVybiBcInNxbGl0ZVwiO1xuICB9XG4gIGlmIChcImdldENvbm5lY3Rpb25cIiBpbiBkYikge1xuICAgIHJldHVybiBcIm15c3FsXCI7XG4gIH1cbiAgaWYgKFwiY29ubmVjdFwiIGluIGRiKSB7XG4gICAgcmV0dXJuIFwicG9zdGdyZXNcIjtcbiAgfVxuICBpZiAoXCJmaWxlQ29udHJvbFwiIGluIGRiKSB7XG4gICAgcmV0dXJuIFwic3FsaXRlXCI7XG4gIH1cbiAgaWYgKFwib3BlblwiIGluIGRiICYmIFwiY2xvc2VcIiBpbiBkYiAmJiBcInByZXBhcmVcIiBpbiBkYikge1xuICAgIHJldHVybiBcInNxbGl0ZVwiO1xuICB9XG4gIHJldHVybiBudWxsO1xufVxuY29uc3QgY3JlYXRlS3lzZWx5QWRhcHRlciA9IGFzeW5jIChjb25maWcpID0+IHtcbiAgY29uc3QgZGIgPSBjb25maWcuZGF0YWJhc2U7XG4gIGlmICghZGIpIHtcbiAgICByZXR1cm4ge1xuICAgICAga3lzZWx5OiBudWxsLFxuICAgICAgZGF0YWJhc2VUeXBlOiBudWxsXG4gICAgfTtcbiAgfVxuICBpZiAoXCJkYlwiIGluIGRiKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGt5c2VseTogZGIuZGIsXG4gICAgICBkYXRhYmFzZVR5cGU6IGRiLnR5cGVcbiAgICB9O1xuICB9XG4gIGlmIChcImRpYWxlY3RcIiBpbiBkYikge1xuICAgIHJldHVybiB7XG4gICAgICBreXNlbHk6IG5ldyBLeXNlbHkoeyBkaWFsZWN0OiBkYi5kaWFsZWN0IH0pLFxuICAgICAgZGF0YWJhc2VUeXBlOiBkYi50eXBlXG4gICAgfTtcbiAgfVxuICBsZXQgZGlhbGVjdCA9IHZvaWQgMDtcbiAgY29uc3QgZGF0YWJhc2VUeXBlID0gZ2V0S3lzZWx5RGF0YWJhc2VUeXBlKGRiKTtcbiAgaWYgKFwiY3JlYXRlRHJpdmVyXCIgaW4gZGIpIHtcbiAgICBkaWFsZWN0ID0gZGI7XG4gIH1cbiAgaWYgKFwiYWdncmVnYXRlXCIgaW4gZGIgJiYgIShcImNyZWF0ZVNlc3Npb25cIiBpbiBkYikpIHtcbiAgICBkaWFsZWN0ID0gbmV3IFNxbGl0ZURpYWxlY3Qoe1xuICAgICAgZGF0YWJhc2U6IGRiXG4gICAgfSk7XG4gIH1cbiAgaWYgKFwiZ2V0Q29ubmVjdGlvblwiIGluIGRiKSB7XG4gICAgZGlhbGVjdCA9IG5ldyBNeXNxbERpYWxlY3QoZGIpO1xuICB9XG4gIGlmIChcImNvbm5lY3RcIiBpbiBkYikge1xuICAgIGRpYWxlY3QgPSBuZXcgUG9zdGdyZXNEaWFsZWN0KHtcbiAgICAgIHBvb2w6IGRiXG4gICAgfSk7XG4gIH1cbiAgaWYgKFwiZmlsZUNvbnRyb2xcIiBpbiBkYikge1xuICAgIGNvbnN0IHsgQnVuU3FsaXRlRGlhbGVjdCB9ID0gYXdhaXQgaW1wb3J0KCcuLi9jaHVua3MvYnVuLXNxbGl0ZS1kaWFsZWN0Lm1qcycpO1xuICAgIGRpYWxlY3QgPSBuZXcgQnVuU3FsaXRlRGlhbGVjdCh7XG4gICAgICBkYXRhYmFzZTogZGJcbiAgICB9KTtcbiAgfVxuICBpZiAoXCJjcmVhdGVTZXNzaW9uXCIgaW4gZGIgJiYgdHlwZW9mIHdpbmRvdyA9PT0gXCJ1bmRlZmluZWRcIikge1xuICAgIGxldCBEYXRhYmFzZVN5bmMgPSB2b2lkIDA7XG4gICAgdHJ5IHtcbiAgICAgIGxldCBub2RlU3FsaXRlID0gXCJub2RlOnNxbGl0ZVwiO1xuICAgICAgKHsgRGF0YWJhc2VTeW5jIH0gPSBhd2FpdCBpbXBvcnQoXG4gICAgICAgIC8qIEB2aXRlLWlnbm9yZSAqL1xuICAgICAgICAvKiB3ZWJwYWNrSWdub3JlOiB0cnVlICovXG4gICAgICAgIG5vZGVTcWxpdGVcbiAgICAgICkpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBpZiAoZXJyb3IgIT09IG51bGwgJiYgdHlwZW9mIGVycm9yID09PSBcIm9iamVjdFwiICYmIFwiY29kZVwiIGluIGVycm9yICYmIGVycm9yLmNvZGUgIT09IFwiRVJSX1VOS05PV05fQlVJTFRJTl9NT0RVTEVcIikge1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH1cbiAgICB9XG4gICAgaWYgKERhdGFiYXNlU3luYyAmJiBkYiBpbnN0YW5jZW9mIERhdGFiYXNlU3luYykge1xuICAgICAgY29uc3QgeyBOb2RlU3FsaXRlRGlhbGVjdCB9ID0gYXdhaXQgaW1wb3J0KCcuLi9jaHVua3Mvbm9kZS1zcWxpdGUtZGlhbGVjdC5tanMnKTtcbiAgICAgIGRpYWxlY3QgPSBuZXcgTm9kZVNxbGl0ZURpYWxlY3Qoe1xuICAgICAgICBkYXRhYmFzZTogZGJcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICByZXR1cm4ge1xuICAgIGt5c2VseTogZGlhbGVjdCA/IG5ldyBLeXNlbHkoeyBkaWFsZWN0IH0pIDogbnVsbCxcbiAgICBkYXRhYmFzZVR5cGVcbiAgfTtcbn07XG5cbmNvbnN0IGt5c2VseUFkYXB0ZXIgPSAoZGIsIGNvbmZpZykgPT4gY3JlYXRlQWRhcHRlcih7XG4gIGNvbmZpZzoge1xuICAgIGFkYXB0ZXJJZDogXCJreXNlbHlcIixcbiAgICBhZGFwdGVyTmFtZTogXCJLeXNlbHkgQWRhcHRlclwiLFxuICAgIHVzZVBsdXJhbDogY29uZmlnPy51c2VQbHVyYWwsXG4gICAgZGVidWdMb2dzOiBjb25maWc/LmRlYnVnTG9ncyxcbiAgICBzdXBwb3J0c0Jvb2xlYW5zOiBjb25maWc/LnR5cGUgPT09IFwic3FsaXRlXCIgfHwgY29uZmlnPy50eXBlID09PSBcIm1zc3FsXCIgfHwgIWNvbmZpZz8udHlwZSA/IGZhbHNlIDogdHJ1ZSxcbiAgICBzdXBwb3J0c0RhdGVzOiBjb25maWc/LnR5cGUgPT09IFwic3FsaXRlXCIgfHwgY29uZmlnPy50eXBlID09PSBcIm1zc3FsXCIgfHwgIWNvbmZpZz8udHlwZSA/IGZhbHNlIDogdHJ1ZSxcbiAgICBzdXBwb3J0c0pTT046IGZhbHNlXG4gIH0sXG4gIGFkYXB0ZXI6ICh7IGdldEZpZWxkTmFtZSwgc2NoZW1hIH0pID0+IHtcbiAgICBjb25zdCB3aXRoUmV0dXJuaW5nID0gYXN5bmMgKHZhbHVlcywgYnVpbGRlciwgbW9kZWwsIHdoZXJlKSA9PiB7XG4gICAgICBsZXQgcmVzO1xuICAgICAgaWYgKGNvbmZpZz8udHlwZSA9PT0gXCJteXNxbFwiKSB7XG4gICAgICAgIGF3YWl0IGJ1aWxkZXIuZXhlY3V0ZSgpO1xuICAgICAgICBjb25zdCBmaWVsZCA9IHZhbHVlcy5pZCA/IFwiaWRcIiA6IHdoZXJlLmxlbmd0aCA+IDAgJiYgd2hlcmVbMF0uZmllbGQgPyB3aGVyZVswXS5maWVsZCA6IFwiaWRcIjtcbiAgICAgICAgaWYgKCF2YWx1ZXMuaWQgJiYgd2hlcmUubGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgcmVzID0gYXdhaXQgZGIuc2VsZWN0RnJvbShtb2RlbCkuc2VsZWN0QWxsKCkub3JkZXJCeShnZXRGaWVsZE5hbWUoeyBtb2RlbCwgZmllbGQgfSksIFwiZGVzY1wiKS5saW1pdCgxKS5leGVjdXRlVGFrZUZpcnN0KCk7XG4gICAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB2YWx1ZSA9IHZhbHVlc1tmaWVsZF0gfHwgd2hlcmVbMF0udmFsdWU7XG4gICAgICAgIHJlcyA9IGF3YWl0IGRiLnNlbGVjdEZyb20obW9kZWwpLnNlbGVjdEFsbCgpLm9yZGVyQnkoZ2V0RmllbGROYW1lKHsgbW9kZWwsIGZpZWxkIH0pLCBcImRlc2NcIikud2hlcmUoZ2V0RmllbGROYW1lKHsgbW9kZWwsIGZpZWxkIH0pLCBcIj1cIiwgdmFsdWUpLmxpbWl0KDEpLmV4ZWN1dGVUYWtlRmlyc3QoKTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgIH1cbiAgICAgIGlmIChjb25maWc/LnR5cGUgPT09IFwibXNzcWxcIikge1xuICAgICAgICByZXMgPSBhd2FpdCBidWlsZGVyLm91dHB1dEFsbChcImluc2VydGVkXCIpLmV4ZWN1dGVUYWtlRmlyc3QoKTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgIH1cbiAgICAgIHJlcyA9IGF3YWl0IGJ1aWxkZXIucmV0dXJuaW5nQWxsKCkuZXhlY3V0ZVRha2VGaXJzdCgpO1xuICAgICAgcmV0dXJuIHJlcztcbiAgICB9O1xuICAgIGZ1bmN0aW9uIHRyYW5zZm9ybVZhbHVlVG9EQih2YWx1ZSwgbW9kZWwsIGZpZWxkKSB7XG4gICAgICBpZiAoZmllbGQgPT09IFwiaWRcIikge1xuICAgICAgICByZXR1cm4gdmFsdWU7XG4gICAgICB9XG4gICAgICBjb25zdCB7IHR5cGUgPSBcInNxbGl0ZVwiIH0gPSBjb25maWcgfHwge307XG4gICAgICBsZXQgZiA9IHNjaGVtYVttb2RlbF0/LmZpZWxkc1tmaWVsZF07XG4gICAgICBpZiAoIWYpIHtcbiAgICAgICAgZiA9IE9iamVjdC52YWx1ZXMoc2NoZW1hKS5maW5kKChmMikgPT4gZjIubW9kZWxOYW1lID09PSBtb2RlbCk7XG4gICAgICB9XG4gICAgICBpZiAoZi50eXBlID09PSBcImJvb2xlYW5cIiAmJiAodHlwZSA9PT0gXCJzcWxpdGVcIiB8fCB0eXBlID09PSBcIm1zc3FsXCIpICYmIHZhbHVlICE9PSBudWxsICYmIHZhbHVlICE9PSB2b2lkIDApIHtcbiAgICAgICAgcmV0dXJuIHZhbHVlID8gMSA6IDA7XG4gICAgICB9XG4gICAgICBpZiAoZi50eXBlID09PSBcImRhdGVcIiAmJiB2YWx1ZSAmJiB2YWx1ZSBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgICAgcmV0dXJuIHR5cGUgPT09IFwic3FsaXRlXCIgPyB2YWx1ZS50b0lTT1N0cmluZygpIDogdmFsdWU7XG4gICAgICB9XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIGZ1bmN0aW9uIGNvbnZlcnRXaGVyZUNsYXVzZShtb2RlbCwgdykge1xuICAgICAgaWYgKCF3KVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGFuZDogbnVsbCxcbiAgICAgICAgICBvcjogbnVsbFxuICAgICAgICB9O1xuICAgICAgY29uc3QgY29uZGl0aW9ucyA9IHtcbiAgICAgICAgYW5kOiBbXSxcbiAgICAgICAgb3I6IFtdXG4gICAgICB9O1xuICAgICAgdy5mb3JFYWNoKChjb25kaXRpb24pID0+IHtcbiAgICAgICAgbGV0IHtcbiAgICAgICAgICBmaWVsZDogX2ZpZWxkLFxuICAgICAgICAgIHZhbHVlLFxuICAgICAgICAgIG9wZXJhdG9yID0gXCI9XCIsXG4gICAgICAgICAgY29ubmVjdG9yID0gXCJBTkRcIlxuICAgICAgICB9ID0gY29uZGl0aW9uO1xuICAgICAgICBjb25zdCBmaWVsZCA9IGdldEZpZWxkTmFtZSh7IG1vZGVsLCBmaWVsZDogX2ZpZWxkIH0pO1xuICAgICAgICB2YWx1ZSA9IHRyYW5zZm9ybVZhbHVlVG9EQih2YWx1ZSwgbW9kZWwsIF9maWVsZCk7XG4gICAgICAgIGNvbnN0IGV4cHIgPSAoZWIpID0+IHtcbiAgICAgICAgICBpZiAob3BlcmF0b3IudG9Mb3dlckNhc2UoKSA9PT0gXCJpblwiKSB7XG4gICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIFwiaW5cIiwgQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyB2YWx1ZSA6IFt2YWx1ZV0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob3BlcmF0b3IudG9Mb3dlckNhc2UoKSA9PT0gXCJub3RfaW5cIikge1xuICAgICAgICAgICAgcmV0dXJuIGViKFxuICAgICAgICAgICAgICBmaWVsZCxcbiAgICAgICAgICAgICAgXCJub3QgaW5cIixcbiAgICAgICAgICAgICAgQXJyYXkuaXNBcnJheSh2YWx1ZSkgPyB2YWx1ZSA6IFt2YWx1ZV1cbiAgICAgICAgICAgICk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJjb250YWluc1wiKSB7XG4gICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIFwibGlrZVwiLCBgJSR7dmFsdWV9JWApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob3BlcmF0b3IgPT09IFwic3RhcnRzX3dpdGhcIikge1xuICAgICAgICAgICAgcmV0dXJuIGViKGZpZWxkLCBcImxpa2VcIiwgYCR7dmFsdWV9JWApO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAob3BlcmF0b3IgPT09IFwiZW5kc193aXRoXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBlYihmaWVsZCwgXCJsaWtlXCIsIGAlJHt2YWx1ZX1gKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9wZXJhdG9yID09PSBcImVxXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBlYihmaWVsZCwgXCI9XCIsIHZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9wZXJhdG9yID09PSBcIm5lXCIpIHtcbiAgICAgICAgICAgIHJldHVybiBlYihmaWVsZCwgXCI8PlwiLCB2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJndFwiKSB7XG4gICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIFwiPlwiLCB2YWx1ZSk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChvcGVyYXRvciA9PT0gXCJndGVcIikge1xuICAgICAgICAgICAgcmV0dXJuIGViKGZpZWxkLCBcIj49XCIsIHZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9wZXJhdG9yID09PSBcImx0XCIpIHtcbiAgICAgICAgICAgIHJldHVybiBlYihmaWVsZCwgXCI8XCIsIHZhbHVlKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKG9wZXJhdG9yID09PSBcImx0ZVwiKSB7XG4gICAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIFwiPD1cIiwgdmFsdWUpO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZWIoZmllbGQsIG9wZXJhdG9yLCB2YWx1ZSk7XG4gICAgICAgIH07XG4gICAgICAgIGlmIChjb25uZWN0b3IgPT09IFwiT1JcIikge1xuICAgICAgICAgIGNvbmRpdGlvbnMub3IucHVzaChleHByKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBjb25kaXRpb25zLmFuZC5wdXNoKGV4cHIpO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIGFuZDogY29uZGl0aW9ucy5hbmQubGVuZ3RoID8gY29uZGl0aW9ucy5hbmQgOiBudWxsLFxuICAgICAgICBvcjogY29uZGl0aW9ucy5vci5sZW5ndGggPyBjb25kaXRpb25zLm9yIDogbnVsbFxuICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIHtcbiAgICAgIGFzeW5jIGNyZWF0ZSh7IGRhdGEsIG1vZGVsIH0pIHtcbiAgICAgICAgY29uc3QgYnVpbGRlciA9IGRiLmluc2VydEludG8obW9kZWwpLnZhbHVlcyhkYXRhKTtcbiAgICAgICAgcmV0dXJuIGF3YWl0IHdpdGhSZXR1cm5pbmcoZGF0YSwgYnVpbGRlciwgbW9kZWwsIFtdKTtcbiAgICAgIH0sXG4gICAgICBhc3luYyBmaW5kT25lKHsgbW9kZWwsIHdoZXJlLCBzZWxlY3QgfSkge1xuICAgICAgICBjb25zdCB7IGFuZCwgb3IgfSA9IGNvbnZlcnRXaGVyZUNsYXVzZShtb2RlbCwgd2hlcmUpO1xuICAgICAgICBsZXQgcXVlcnkgPSBkYi5zZWxlY3RGcm9tKG1vZGVsKS5zZWxlY3RBbGwoKTtcbiAgICAgICAgaWYgKGFuZCkge1xuICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5hbmQoYW5kLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9yKSB7XG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLm9yKG9yLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVzID0gYXdhaXQgcXVlcnkuZXhlY3V0ZVRha2VGaXJzdCgpO1xuICAgICAgICBpZiAoIXJlcykgcmV0dXJuIG51bGw7XG4gICAgICAgIHJldHVybiByZXM7XG4gICAgICB9LFxuICAgICAgYXN5bmMgZmluZE1hbnkoeyBtb2RlbCwgd2hlcmUsIGxpbWl0LCBvZmZzZXQsIHNvcnRCeSB9KSB7XG4gICAgICAgIGNvbnN0IHsgYW5kLCBvciB9ID0gY29udmVydFdoZXJlQ2xhdXNlKG1vZGVsLCB3aGVyZSk7XG4gICAgICAgIGxldCBxdWVyeSA9IGRiLnNlbGVjdEZyb20obW9kZWwpO1xuICAgICAgICBpZiAoYW5kKSB7XG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLmFuZChhbmQubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3IpIHtcbiAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIub3Iob3IubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoY29uZmlnPy50eXBlID09PSBcIm1zc3FsXCIpIHtcbiAgICAgICAgICBpZiAoIW9mZnNldCkge1xuICAgICAgICAgICAgcXVlcnkgPSBxdWVyeS50b3AobGltaXQgfHwgMTAwKTtcbiAgICAgICAgICB9XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS5saW1pdChsaW1pdCB8fCAxMDApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChzb3J0QnkpIHtcbiAgICAgICAgICBxdWVyeSA9IHF1ZXJ5Lm9yZGVyQnkoXG4gICAgICAgICAgICBnZXRGaWVsZE5hbWUoeyBtb2RlbCwgZmllbGQ6IHNvcnRCeS5maWVsZCB9KSxcbiAgICAgICAgICAgIHNvcnRCeS5kaXJlY3Rpb25cbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvZmZzZXQpIHtcbiAgICAgICAgICBpZiAoY29uZmlnPy50eXBlID09PSBcIm1zc3FsXCIpIHtcbiAgICAgICAgICAgIGlmICghc29ydEJ5KSB7XG4gICAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkub3JkZXJCeShnZXRGaWVsZE5hbWUoeyBtb2RlbCwgZmllbGQ6IFwiaWRcIiB9KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBxdWVyeSA9IHF1ZXJ5Lm9mZnNldChvZmZzZXQpLmZldGNoKGxpbWl0IHx8IDEwMCk7XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkub2Zmc2V0KG9mZnNldCk7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHF1ZXJ5LnNlbGVjdEFsbCgpLmV4ZWN1dGUoKTtcbiAgICAgICAgaWYgKCFyZXMpIHJldHVybiBbXTtcbiAgICAgICAgcmV0dXJuIHJlcztcbiAgICAgIH0sXG4gICAgICBhc3luYyB1cGRhdGUoeyBtb2RlbCwgd2hlcmUsIHVwZGF0ZTogdmFsdWVzIH0pIHtcbiAgICAgICAgY29uc3QgeyBhbmQsIG9yIH0gPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgICAgbGV0IHF1ZXJ5ID0gZGIudXBkYXRlVGFibGUobW9kZWwpLnNldCh2YWx1ZXMpO1xuICAgICAgICBpZiAoYW5kKSB7XG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLmFuZChhbmQubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3IpIHtcbiAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIub3Iob3IubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYXdhaXQgd2l0aFJldHVybmluZyh2YWx1ZXMsIHF1ZXJ5LCBtb2RlbCwgd2hlcmUpO1xuICAgICAgfSxcbiAgICAgIGFzeW5jIHVwZGF0ZU1hbnkoeyBtb2RlbCwgd2hlcmUsIHVwZGF0ZTogdmFsdWVzIH0pIHtcbiAgICAgICAgY29uc3QgeyBhbmQsIG9yIH0gPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgICAgbGV0IHF1ZXJ5ID0gZGIudXBkYXRlVGFibGUobW9kZWwpLnNldCh2YWx1ZXMpO1xuICAgICAgICBpZiAoYW5kKSB7XG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLmFuZChhbmQubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAob3IpIHtcbiAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIub3Iob3IubWFwKChleHByKSA9PiBleHByKGViKSkpKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCByZXMgPSBhd2FpdCBxdWVyeS5leGVjdXRlKCk7XG4gICAgICAgIHJldHVybiByZXMubGVuZ3RoO1xuICAgICAgfSxcbiAgICAgIGFzeW5jIGNvdW50KHsgbW9kZWwsIHdoZXJlIH0pIHtcbiAgICAgICAgY29uc3QgeyBhbmQsIG9yIH0gPSBjb252ZXJ0V2hlcmVDbGF1c2UobW9kZWwsIHdoZXJlKTtcbiAgICAgICAgbGV0IHF1ZXJ5ID0gZGIuc2VsZWN0RnJvbShtb2RlbCkuc2VsZWN0KGRiLmZuLmNvdW50KFwiaWRcIikuYXMoXCJjb3VudFwiKSk7XG4gICAgICAgIGlmIChhbmQpIHtcbiAgICAgICAgICBxdWVyeSA9IHF1ZXJ5LndoZXJlKChlYikgPT4gZWIuYW5kKGFuZC5tYXAoKGV4cHIpID0+IGV4cHIoZWIpKSkpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChvcikge1xuICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5vcihvci5tYXAoKGV4cHIpID0+IGV4cHIoZWIpKSkpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IHF1ZXJ5LmV4ZWN1dGUoKTtcbiAgICAgICAgcmV0dXJuIHJlc1swXS5jb3VudDtcbiAgICAgIH0sXG4gICAgICBhc3luYyBkZWxldGUoeyBtb2RlbCwgd2hlcmUgfSkge1xuICAgICAgICBjb25zdCB7IGFuZCwgb3IgfSA9IGNvbnZlcnRXaGVyZUNsYXVzZShtb2RlbCwgd2hlcmUpO1xuICAgICAgICBsZXQgcXVlcnkgPSBkYi5kZWxldGVGcm9tKG1vZGVsKTtcbiAgICAgICAgaWYgKGFuZCkge1xuICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5hbmQoYW5kLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9yKSB7XG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLm9yKG9yLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgcXVlcnkuZXhlY3V0ZSgpO1xuICAgICAgfSxcbiAgICAgIGFzeW5jIGRlbGV0ZU1hbnkoeyBtb2RlbCwgd2hlcmUgfSkge1xuICAgICAgICBjb25zdCB7IGFuZCwgb3IgfSA9IGNvbnZlcnRXaGVyZUNsYXVzZShtb2RlbCwgd2hlcmUpO1xuICAgICAgICBsZXQgcXVlcnkgPSBkYi5kZWxldGVGcm9tKG1vZGVsKTtcbiAgICAgICAgaWYgKGFuZCkge1xuICAgICAgICAgIHF1ZXJ5ID0gcXVlcnkud2hlcmUoKGViKSA9PiBlYi5hbmQoYW5kLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKG9yKSB7XG4gICAgICAgICAgcXVlcnkgPSBxdWVyeS53aGVyZSgoZWIpID0+IGViLm9yKG9yLm1hcCgoZXhwcikgPT4gZXhwcihlYikpKSk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIChhd2FpdCBxdWVyeS5leGVjdXRlKCkpLmxlbmd0aDtcbiAgICAgIH0sXG4gICAgICBvcHRpb25zOiBjb25maWdcbiAgICB9O1xuICB9XG59KTtcblxuZXhwb3J0IHsgY3JlYXRlS3lzZWx5QWRhcHRlciBhcyBjLCBnZXRLeXNlbHlEYXRhYmFzZVR5cGUgYXMgZywga3lzZWx5QWRhcHRlciBhcyBrIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.BduPtJy8.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.BjBlybv-.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.BjBlybv-.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ logger),\n/* harmony export */   c: () => (/* binding */ createLogger),\n/* harmony export */   l: () => (/* binding */ levels),\n/* harmony export */   s: () => (/* binding */ shouldPublishLog)\n/* harmony export */ });\nconst levels = [\"info\", \"success\", \"warn\", \"error\", \"debug\"];\nfunction shouldPublishLog(currentLogLevel, logLevel) {\n  return levels.indexOf(logLevel) <= levels.indexOf(currentLogLevel);\n}\nconst colors = {\n  reset: \"\\x1B[0m\",\n  bright: \"\\x1B[1m\",\n  dim: \"\\x1B[2m\",\n  fg: {\n    red: \"\\x1B[31m\",\n    green: \"\\x1B[32m\",\n    yellow: \"\\x1B[33m\",\n    blue: \"\\x1B[34m\",\n    magenta: \"\\x1B[35m\"}};\nconst levelColors = {\n  info: colors.fg.blue,\n  success: colors.fg.green,\n  warn: colors.fg.yellow,\n  error: colors.fg.red,\n  debug: colors.fg.magenta\n};\nconst formatMessage = (level, message) => {\n  const timestamp = (/* @__PURE__ */ new Date()).toISOString();\n  return `${colors.dim}${timestamp}${colors.reset} ${levelColors[level]}${level.toUpperCase()}${colors.reset} ${colors.bright}[Better Auth]:${colors.reset} ${message}`;\n};\nconst createLogger = (options) => {\n  const enabled = options?.disabled !== true;\n  const logLevel = options?.level ?? \"error\";\n  const LogFunc = (level, message, args = []) => {\n    if (!enabled || !shouldPublishLog(logLevel, level)) {\n      return;\n    }\n    const formattedMessage = formatMessage(level, message);\n    if (!options || typeof options.log !== \"function\") {\n      if (level === \"error\") {\n        console.error(formattedMessage, ...args);\n      } else if (level === \"warn\") {\n        console.warn(formattedMessage, ...args);\n      } else {\n        console.log(formattedMessage, ...args);\n      }\n      return;\n    }\n    options.log(level === \"success\" ? \"info\" : level, message, ...args);\n  };\n  const logger2 = Object.fromEntries(\n    levels.map((level) => [\n      level,\n      (...[message, ...args]) => LogFunc(level, message, args)\n    ])\n  );\n  return {\n    ...logger2,\n    get level() {\n      return logLevel;\n    }\n  };\n};\nconst logger = createLogger();\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQmpCbHlidi0ubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxXQUFXLEVBQUUsVUFBVSxFQUFFLGNBQWMsRUFBRSxtQkFBbUIsRUFBRSxvQkFBb0IsRUFBRSxjQUFjLEVBQUUsY0FBYyxnQkFBZ0IsY0FBYyxFQUFFLFFBQVE7QUFDdEs7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsUUFBUTtBQUNSO0FBQ0EsUUFBUTtBQUNSO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRThFIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxzaGFyZWRcXGJldHRlci1hdXRoLkJqQmx5YnYtLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBsZXZlbHMgPSBbXCJpbmZvXCIsIFwic3VjY2Vzc1wiLCBcIndhcm5cIiwgXCJlcnJvclwiLCBcImRlYnVnXCJdO1xuZnVuY3Rpb24gc2hvdWxkUHVibGlzaExvZyhjdXJyZW50TG9nTGV2ZWwsIGxvZ0xldmVsKSB7XG4gIHJldHVybiBsZXZlbHMuaW5kZXhPZihsb2dMZXZlbCkgPD0gbGV2ZWxzLmluZGV4T2YoY3VycmVudExvZ0xldmVsKTtcbn1cbmNvbnN0IGNvbG9ycyA9IHtcbiAgcmVzZXQ6IFwiXFx4MUJbMG1cIixcbiAgYnJpZ2h0OiBcIlxceDFCWzFtXCIsXG4gIGRpbTogXCJcXHgxQlsybVwiLFxuICBmZzoge1xuICAgIHJlZDogXCJcXHgxQlszMW1cIixcbiAgICBncmVlbjogXCJcXHgxQlszMm1cIixcbiAgICB5ZWxsb3c6IFwiXFx4MUJbMzNtXCIsXG4gICAgYmx1ZTogXCJcXHgxQlszNG1cIixcbiAgICBtYWdlbnRhOiBcIlxceDFCWzM1bVwifX07XG5jb25zdCBsZXZlbENvbG9ycyA9IHtcbiAgaW5mbzogY29sb3JzLmZnLmJsdWUsXG4gIHN1Y2Nlc3M6IGNvbG9ycy5mZy5ncmVlbixcbiAgd2FybjogY29sb3JzLmZnLnllbGxvdyxcbiAgZXJyb3I6IGNvbG9ycy5mZy5yZWQsXG4gIGRlYnVnOiBjb2xvcnMuZmcubWFnZW50YVxufTtcbmNvbnN0IGZvcm1hdE1lc3NhZ2UgPSAobGV2ZWwsIG1lc3NhZ2UpID0+IHtcbiAgY29uc3QgdGltZXN0YW1wID0gKC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKS50b0lTT1N0cmluZygpO1xuICByZXR1cm4gYCR7Y29sb3JzLmRpbX0ke3RpbWVzdGFtcH0ke2NvbG9ycy5yZXNldH0gJHtsZXZlbENvbG9yc1tsZXZlbF19JHtsZXZlbC50b1VwcGVyQ2FzZSgpfSR7Y29sb3JzLnJlc2V0fSAke2NvbG9ycy5icmlnaHR9W0JldHRlciBBdXRoXToke2NvbG9ycy5yZXNldH0gJHttZXNzYWdlfWA7XG59O1xuY29uc3QgY3JlYXRlTG9nZ2VyID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgZW5hYmxlZCA9IG9wdGlvbnM/LmRpc2FibGVkICE9PSB0cnVlO1xuICBjb25zdCBsb2dMZXZlbCA9IG9wdGlvbnM/LmxldmVsID8/IFwiZXJyb3JcIjtcbiAgY29uc3QgTG9nRnVuYyA9IChsZXZlbCwgbWVzc2FnZSwgYXJncyA9IFtdKSA9PiB7XG4gICAgaWYgKCFlbmFibGVkIHx8ICFzaG91bGRQdWJsaXNoTG9nKGxvZ0xldmVsLCBsZXZlbCkpIHtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgZm9ybWF0dGVkTWVzc2FnZSA9IGZvcm1hdE1lc3NhZ2UobGV2ZWwsIG1lc3NhZ2UpO1xuICAgIGlmICghb3B0aW9ucyB8fCB0eXBlb2Ygb3B0aW9ucy5sb2cgIT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgaWYgKGxldmVsID09PSBcImVycm9yXCIpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihmb3JtYXR0ZWRNZXNzYWdlLCAuLi5hcmdzKTtcbiAgICAgIH0gZWxzZSBpZiAobGV2ZWwgPT09IFwid2FyblwiKSB7XG4gICAgICAgIGNvbnNvbGUud2Fybihmb3JtYXR0ZWRNZXNzYWdlLCAuLi5hcmdzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGNvbnNvbGUubG9nKGZvcm1hdHRlZE1lc3NhZ2UsIC4uLmFyZ3MpO1xuICAgICAgfVxuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBvcHRpb25zLmxvZyhsZXZlbCA9PT0gXCJzdWNjZXNzXCIgPyBcImluZm9cIiA6IGxldmVsLCBtZXNzYWdlLCAuLi5hcmdzKTtcbiAgfTtcbiAgY29uc3QgbG9nZ2VyMiA9IE9iamVjdC5mcm9tRW50cmllcyhcbiAgICBsZXZlbHMubWFwKChsZXZlbCkgPT4gW1xuICAgICAgbGV2ZWwsXG4gICAgICAoLi4uW21lc3NhZ2UsIC4uLmFyZ3NdKSA9PiBMb2dGdW5jKGxldmVsLCBtZXNzYWdlLCBhcmdzKVxuICAgIF0pXG4gICk7XG4gIHJldHVybiB7XG4gICAgLi4ubG9nZ2VyMixcbiAgICBnZXQgbGV2ZWwoKSB7XG4gICAgICByZXR1cm4gbG9nTGV2ZWw7XG4gICAgfVxuICB9O1xufTtcbmNvbnN0IGxvZ2dlciA9IGNyZWF0ZUxvZ2dlcigpO1xuXG5leHBvcnQgeyBsb2dnZXIgYXMgYSwgY3JlYXRlTG9nZ2VyIGFzIGMsIGxldmVscyBhcyBsLCBzaG91bGRQdWJsaXNoTG9nIGFzIHMgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.BjBlybv-.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.CMQ3rA-I.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.CMQ3rA-I.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   E: () => (/* binding */ ENV),\n/* harmony export */   a: () => (/* binding */ isProduction),\n/* harmony export */   b: () => (/* binding */ isDevelopment),\n/* harmony export */   c: () => (/* binding */ getBooleanEnvVar),\n/* harmony export */   e: () => (/* binding */ env),\n/* harmony export */   g: () => (/* binding */ getEnvVar),\n/* harmony export */   i: () => (/* binding */ isTest)\n/* harmony export */ });\nconst _envShim = /* @__PURE__ */ Object.create(null);\nconst _getEnv = (useShim) => globalThis.process?.env || //@ts-expect-error\nglobalThis.Deno?.env.toObject() || //@ts-expect-error\nglobalThis.__env__ || (useShim ? _envShim : globalThis);\nconst env = new Proxy(_envShim, {\n  get(_, prop) {\n    const env2 = _getEnv();\n    return env2[prop] ?? _envShim[prop];\n  },\n  has(_, prop) {\n    const env2 = _getEnv();\n    return prop in env2 || prop in _envShim;\n  },\n  set(_, prop, value) {\n    const env2 = _getEnv(true);\n    env2[prop] = value;\n    return true;\n  },\n  deleteProperty(_, prop) {\n    if (!prop) {\n      return false;\n    }\n    const env2 = _getEnv(true);\n    delete env2[prop];\n    return true;\n  },\n  ownKeys() {\n    const env2 = _getEnv(true);\n    return Object.keys(env2);\n  }\n});\nfunction toBoolean(val) {\n  return val ? val !== \"false\" : false;\n}\nconst nodeENV = typeof process !== \"undefined\" && process.env && \"development\" || \"\";\nconst isProduction = nodeENV === \"production\";\nconst isDevelopment = nodeENV === \"dev\" || nodeENV === \"development\";\nconst isTest = () => nodeENV === \"test\" || toBoolean(env.TEST);\nfunction getEnvVar(key, fallback) {\n  if (typeof process !== \"undefined\" && process.env) {\n    return process.env[key] ?? fallback;\n  }\n  if (typeof Deno !== \"undefined\") {\n    return Deno.env.get(key) ?? fallback;\n  }\n  if (typeof Bun !== \"undefined\") {\n    return Bun.env[key] ?? fallback;\n  }\n  return fallback;\n}\nfunction getBooleanEnvVar(key, fallback = true) {\n  const value = getEnvVar(key);\n  if (!value) return fallback;\n  return value !== \"0\" && value.toLowerCase() !== \"false\" && value !== \"\";\n}\nconst ENV = {\n  get BETTER_AUTH_TELEMETRY_ENDPOINT() {\n    return getEnvVar(\n      \"BETTER_AUTH_TELEMETRY_ENDPOINT\",\n      \"https://telemetry.better-auth.com/v1/track\"\n    );\n  }\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQ01RM3JBLUkubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxpRUFBaUUsYUFBb0I7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXlIIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxzaGFyZWRcXGJldHRlci1hdXRoLkNNUTNyQS1JLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBfZW52U2hpbSA9IC8qIEBfX1BVUkVfXyAqLyBPYmplY3QuY3JlYXRlKG51bGwpO1xuY29uc3QgX2dldEVudiA9ICh1c2VTaGltKSA9PiBnbG9iYWxUaGlzLnByb2Nlc3M/LmVudiB8fCAvL0B0cy1leHBlY3QtZXJyb3Jcbmdsb2JhbFRoaXMuRGVubz8uZW52LnRvT2JqZWN0KCkgfHwgLy9AdHMtZXhwZWN0LWVycm9yXG5nbG9iYWxUaGlzLl9fZW52X18gfHwgKHVzZVNoaW0gPyBfZW52U2hpbSA6IGdsb2JhbFRoaXMpO1xuY29uc3QgZW52ID0gbmV3IFByb3h5KF9lbnZTaGltLCB7XG4gIGdldChfLCBwcm9wKSB7XG4gICAgY29uc3QgZW52MiA9IF9nZXRFbnYoKTtcbiAgICByZXR1cm4gZW52Mltwcm9wXSA/PyBfZW52U2hpbVtwcm9wXTtcbiAgfSxcbiAgaGFzKF8sIHByb3ApIHtcbiAgICBjb25zdCBlbnYyID0gX2dldEVudigpO1xuICAgIHJldHVybiBwcm9wIGluIGVudjIgfHwgcHJvcCBpbiBfZW52U2hpbTtcbiAgfSxcbiAgc2V0KF8sIHByb3AsIHZhbHVlKSB7XG4gICAgY29uc3QgZW52MiA9IF9nZXRFbnYodHJ1ZSk7XG4gICAgZW52Mltwcm9wXSA9IHZhbHVlO1xuICAgIHJldHVybiB0cnVlO1xuICB9LFxuICBkZWxldGVQcm9wZXJ0eShfLCBwcm9wKSB7XG4gICAgaWYgKCFwcm9wKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IGVudjIgPSBfZ2V0RW52KHRydWUpO1xuICAgIGRlbGV0ZSBlbnYyW3Byb3BdO1xuICAgIHJldHVybiB0cnVlO1xuICB9LFxuICBvd25LZXlzKCkge1xuICAgIGNvbnN0IGVudjIgPSBfZ2V0RW52KHRydWUpO1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhlbnYyKTtcbiAgfVxufSk7XG5mdW5jdGlvbiB0b0Jvb2xlYW4odmFsKSB7XG4gIHJldHVybiB2YWwgPyB2YWwgIT09IFwiZmFsc2VcIiA6IGZhbHNlO1xufVxuY29uc3Qgbm9kZUVOViA9IHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WIHx8IFwiXCI7XG5jb25zdCBpc1Byb2R1Y3Rpb24gPSBub2RlRU5WID09PSBcInByb2R1Y3Rpb25cIjtcbmNvbnN0IGlzRGV2ZWxvcG1lbnQgPSBub2RlRU5WID09PSBcImRldlwiIHx8IG5vZGVFTlYgPT09IFwiZGV2ZWxvcG1lbnRcIjtcbmNvbnN0IGlzVGVzdCA9ICgpID0+IG5vZGVFTlYgPT09IFwidGVzdFwiIHx8IHRvQm9vbGVhbihlbnYuVEVTVCk7XG5mdW5jdGlvbiBnZXRFbnZWYXIoa2V5LCBmYWxsYmFjaykge1xuICBpZiAodHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2Vzcy5lbnYpIHtcbiAgICByZXR1cm4gcHJvY2Vzcy5lbnZba2V5XSA/PyBmYWxsYmFjaztcbiAgfVxuICBpZiAodHlwZW9mIERlbm8gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICByZXR1cm4gRGVuby5lbnYuZ2V0KGtleSkgPz8gZmFsbGJhY2s7XG4gIH1cbiAgaWYgKHR5cGVvZiBCdW4gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICByZXR1cm4gQnVuLmVudltrZXldID8/IGZhbGxiYWNrO1xuICB9XG4gIHJldHVybiBmYWxsYmFjaztcbn1cbmZ1bmN0aW9uIGdldEJvb2xlYW5FbnZWYXIoa2V5LCBmYWxsYmFjayA9IHRydWUpIHtcbiAgY29uc3QgdmFsdWUgPSBnZXRFbnZWYXIoa2V5KTtcbiAgaWYgKCF2YWx1ZSkgcmV0dXJuIGZhbGxiYWNrO1xuICByZXR1cm4gdmFsdWUgIT09IFwiMFwiICYmIHZhbHVlLnRvTG93ZXJDYXNlKCkgIT09IFwiZmFsc2VcIiAmJiB2YWx1ZSAhPT0gXCJcIjtcbn1cbmNvbnN0IEVOViA9IHtcbiAgZ2V0IEJFVFRFUl9BVVRIX1RFTEVNRVRSWV9FTkRQT0lOVCgpIHtcbiAgICByZXR1cm4gZ2V0RW52VmFyKFxuICAgICAgXCJCRVRURVJfQVVUSF9URUxFTUVUUllfRU5EUE9JTlRcIixcbiAgICAgIFwiaHR0cHM6Ly90ZWxlbWV0cnkuYmV0dGVyLWF1dGguY29tL3YxL3RyYWNrXCJcbiAgICApO1xuICB9XG59O1xuXG5leHBvcnQgeyBFTlYgYXMgRSwgaXNQcm9kdWN0aW9uIGFzIGEsIGlzRGV2ZWxvcG1lbnQgYXMgYiwgZ2V0Qm9vbGVhbkVudlZhciBhcyBjLCBlbnYgYXMgZSwgZ2V0RW52VmFyIGFzIGcsIGlzVGVzdCBhcyBpIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.CMQ3rA-I.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   g: () => (/* binding */ getDate)\n/* harmony export */ });\nconst getDate = (span, unit = \"ms\") => {\n  return new Date(Date.now() + (unit === \"sec\" ? span * 1e3 : span));\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQ1c2RDllU3gubWpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7O0FBRXdCIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxzaGFyZWRcXGJldHRlci1hdXRoLkNXNkQ5ZVN4Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBnZXREYXRlID0gKHNwYW4sIHVuaXQgPSBcIm1zXCIpID0+IHtcbiAgcmV0dXJuIG5ldyBEYXRlKERhdGUubm93KCkgKyAodW5pdCA9PT0gXCJzZWNcIiA/IHNwYW4gKiAxZTMgOiBzcGFuKSk7XG59O1xuXG5leHBvcnQgeyBnZXREYXRlIGFzIGcgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.CewjboYP.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.CewjboYP.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   $: () => (/* binding */ getCognitoPublicKey),\n/* harmony export */   A: () => (/* binding */ deleteUserCallback),\n/* harmony export */   B: () => (/* binding */ listUserAccounts),\n/* harmony export */   C: () => (/* binding */ linkSocialAccount),\n/* harmony export */   D: () => (/* binding */ requestPasswordResetCallback),\n/* harmony export */   E: () => (/* binding */ requestPasswordReset),\n/* harmony export */   F: () => (/* binding */ forgetPasswordCallback),\n/* harmony export */   G: () => (/* binding */ deleteUser),\n/* harmony export */   H: () => (/* binding */ HIDE_METADATA),\n/* harmony export */   I: () => (/* binding */ setPassword),\n/* harmony export */   J: () => (/* binding */ changePassword),\n/* harmony export */   K: () => (/* binding */ changeEmail),\n/* harmony export */   L: () => (/* binding */ sendVerificationEmail),\n/* harmony export */   M: () => (/* binding */ verifyEmail),\n/* harmony export */   N: () => (/* binding */ resetPassword),\n/* harmony export */   O: () => (/* binding */ forgetPassword),\n/* harmony export */   P: () => (/* binding */ signInEmail),\n/* harmony export */   Q: () => (/* binding */ signOut),\n/* harmony export */   R: () => (/* binding */ callbackOAuth),\n/* harmony export */   S: () => (/* binding */ signInSocial),\n/* harmony export */   T: () => (/* binding */ sendVerificationEmailFn),\n/* harmony export */   U: () => (/* binding */ socialProviders),\n/* harmony export */   V: () => (/* binding */ socialProviderList),\n/* harmony export */   W: () => (/* binding */ SocialProviderListEnum),\n/* harmony export */   X: () => (/* binding */ apple),\n/* harmony export */   Y: () => (/* binding */ getApplePublicKey),\n/* harmony export */   Z: () => (/* binding */ atlassian),\n/* harmony export */   _: () => (/* binding */ cognito),\n/* harmony export */   a: () => (/* binding */ createAuthorizationCodeRequest),\n/* harmony export */   a0: () => (/* binding */ discord),\n/* harmony export */   a1: () => (/* binding */ dropbox),\n/* harmony export */   a2: () => (/* binding */ facebook),\n/* harmony export */   a3: () => (/* binding */ figma),\n/* harmony export */   a4: () => (/* binding */ github),\n/* harmony export */   a5: () => (/* binding */ linear),\n/* harmony export */   a6: () => (/* binding */ linkedin),\n/* harmony export */   a7: () => (/* binding */ gitlab),\n/* harmony export */   a8: () => (/* binding */ google),\n/* harmony export */   a9: () => (/* binding */ kick),\n/* harmony export */   aa: () => (/* binding */ microsoft),\n/* harmony export */   ab: () => (/* binding */ notion),\n/* harmony export */   ac: () => (/* binding */ reddit),\n/* harmony export */   ad: () => (/* binding */ roblox),\n/* harmony export */   ae: () => (/* binding */ salesforce),\n/* harmony export */   af: () => (/* binding */ spotify),\n/* harmony export */   ag: () => (/* binding */ tiktok),\n/* harmony export */   ah: () => (/* binding */ twitch),\n/* harmony export */   ai: () => (/* binding */ twitter),\n/* harmony export */   aj: () => (/* binding */ vk),\n/* harmony export */   ak: () => (/* binding */ zoom),\n/* harmony export */   al: () => (/* binding */ huggingface),\n/* harmony export */   am: () => (/* binding */ slack),\n/* harmony export */   an: () => (/* binding */ kakao),\n/* harmony export */   ao: () => (/* binding */ naver),\n/* harmony export */   ap: () => (/* binding */ line),\n/* harmony export */   aq: () => (/* binding */ paypal),\n/* harmony export */   b: () => (/* binding */ validateToken),\n/* harmony export */   c: () => (/* binding */ createAuthorizationURL),\n/* harmony export */   d: () => (/* binding */ createRefreshAccessTokenRequest),\n/* harmony export */   e: () => (/* binding */ generateCodeChallenge),\n/* harmony export */   f: () => (/* binding */ getOAuth2Tokens),\n/* harmony export */   g: () => (/* binding */ generateState),\n/* harmony export */   h: () => (/* binding */ encodeOAuthParameter),\n/* harmony export */   i: () => (/* binding */ decryptOAuthToken),\n/* harmony export */   j: () => (/* binding */ handleOAuthUserInfo),\n/* harmony export */   k: () => (/* binding */ createEmailVerificationToken),\n/* harmony export */   l: () => (/* binding */ originCheckMiddleware),\n/* harmony export */   m: () => (/* binding */ error),\n/* harmony export */   n: () => (/* binding */ ok),\n/* harmony export */   o: () => (/* binding */ originCheck),\n/* harmony export */   p: () => (/* binding */ parseState),\n/* harmony export */   q: () => (/* binding */ accountInfo),\n/* harmony export */   r: () => (/* binding */ refreshAccessToken),\n/* harmony export */   s: () => (/* binding */ setTokenUtil),\n/* harmony export */   t: () => (/* binding */ toAuthEndpoints),\n/* harmony export */   u: () => (/* binding */ updateUser),\n/* harmony export */   v: () => (/* binding */ validateAuthorizationCode),\n/* harmony export */   w: () => (/* binding */ wildcardMatch),\n/* harmony export */   x: () => (/* binding */ getAccessToken),\n/* harmony export */   y: () => (/* binding */ refreshToken),\n/* harmony export */   z: () => (/* binding */ unlinkAccount)\n/* harmony export */ });\n/* harmony import */ var zod_v4__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod/v4 */ \"(rsc)/./node_modules/zod/v4/index.js\");\n/* harmony import */ var _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./better-auth.DV5EHeYG.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DV5EHeYG.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./better-auth.CW6D9eSx.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _crypto_index_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../crypto/index.mjs */ \"(rsc)/./node_modules/better-auth/dist/crypto/index.mjs\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @better-fetch/fetch */ \"(rsc)/./node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jwt/verify.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_25__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/decode_protected_header.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_26__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/decode_jwt.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_27__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/key/import.js\");\n/* harmony import */ var jose__WEBPACK_IMPORTED_MODULE_28__ = __webpack_require__(/*! jose */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jwks/remote.js\");\n/* harmony import */ var _better_auth_utils__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @better-auth/utils */ \"(rsc)/./node_modules/@better-auth/utils/dist/index.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./better-auth.CuS_eDdK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CuS_eDdK.mjs\");\n/* harmony import */ var _better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./better-auth.UfVWArIB.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.UfVWArIB.mjs\");\n/* harmony import */ var jose_errors__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! jose/errors */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/errors.js\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./better-auth.BjBlybv-.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BjBlybv-.mjs\");\n/* harmony import */ var _better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./better-auth.BZZKN1g7.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BZZKN1g7.mjs\");\n/* harmony import */ var _better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var _better_auth_Dcv8PS7T_mjs__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./better-auth.Dcv8PS7T.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.Dcv8PS7T.mjs\");\n/* harmony import */ var _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./better-auth.CMQ3rA-I.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CMQ3rA-I.mjs\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! @better-auth/utils/binary */ \"(rsc)/./node_modules/@better-auth/utils/dist/binary.mjs\");\n/* harmony import */ var defu__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! defu */ \"(rsc)/./node_modules/defu/dist/defu.mjs\");\n/* harmony import */ var _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! ./better-auth.DdzSJf-n.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DdzSJf-n.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction escapeRegExpChar(char) {\n  if (char === \"-\" || char === \"^\" || char === \"$\" || char === \"+\" || char === \".\" || char === \"(\" || char === \")\" || char === \"|\" || char === \"[\" || char === \"]\" || char === \"{\" || char === \"}\" || char === \"*\" || char === \"?\" || char === \"\\\\\") {\n    return `\\\\${char}`;\n  } else {\n    return char;\n  }\n}\nfunction escapeRegExpString(str) {\n  let result = \"\";\n  for (let i = 0; i < str.length; i++) {\n    result += escapeRegExpChar(str[i]);\n  }\n  return result;\n}\nfunction transform(pattern, separator = true) {\n  if (Array.isArray(pattern)) {\n    let regExpPatterns = pattern.map((p) => `^${transform(p, separator)}$`);\n    return `(?:${regExpPatterns.join(\"|\")})`;\n  }\n  let separatorSplitter = \"\";\n  let separatorMatcher = \"\";\n  let wildcard = \".\";\n  if (separator === true) {\n    separatorSplitter = \"/\";\n    separatorMatcher = \"[/\\\\\\\\]\";\n    wildcard = \"[^/\\\\\\\\]\";\n  } else if (separator) {\n    separatorSplitter = separator;\n    separatorMatcher = escapeRegExpString(separatorSplitter);\n    if (separatorMatcher.length > 1) {\n      separatorMatcher = `(?:${separatorMatcher})`;\n      wildcard = `((?!${separatorMatcher}).)`;\n    } else {\n      wildcard = `[^${separatorMatcher}]`;\n    }\n  }\n  let requiredSeparator = separator ? `${separatorMatcher}+?` : \"\";\n  let optionalSeparator = separator ? `${separatorMatcher}*?` : \"\";\n  let segments = separator ? pattern.split(separatorSplitter) : [pattern];\n  let result = \"\";\n  for (let s = 0; s < segments.length; s++) {\n    let segment = segments[s];\n    let nextSegment = segments[s + 1];\n    let currentSeparator = \"\";\n    if (!segment && s > 0) {\n      continue;\n    }\n    if (separator) {\n      if (s === segments.length - 1) {\n        currentSeparator = optionalSeparator;\n      } else if (nextSegment !== \"**\") {\n        currentSeparator = requiredSeparator;\n      } else {\n        currentSeparator = \"\";\n      }\n    }\n    if (separator && segment === \"**\") {\n      if (currentSeparator) {\n        result += s === 0 ? \"\" : currentSeparator;\n        result += `(?:${wildcard}*?${currentSeparator})*?`;\n      }\n      continue;\n    }\n    for (let c = 0; c < segment.length; c++) {\n      let char = segment[c];\n      if (char === \"\\\\\") {\n        if (c < segment.length - 1) {\n          result += escapeRegExpChar(segment[c + 1]);\n          c++;\n        }\n      } else if (char === \"?\") {\n        result += wildcard;\n      } else if (char === \"*\") {\n        result += `${wildcard}*?`;\n      } else {\n        result += escapeRegExpChar(char);\n      }\n    }\n    result += currentSeparator;\n  }\n  return result;\n}\nfunction isMatch(regexp, sample) {\n  if (typeof sample !== \"string\") {\n    throw new TypeError(`Sample must be a string, but ${typeof sample} given`);\n  }\n  return regexp.test(sample);\n}\nfunction wildcardMatch(pattern, options) {\n  if (typeof pattern !== \"string\" && !Array.isArray(pattern)) {\n    throw new TypeError(\n      `The first argument must be a single pattern string or an array of patterns, but ${typeof pattern} given`\n    );\n  }\n  if (typeof options === \"string\" || typeof options === \"boolean\") {\n    options = { separator: options };\n  }\n  if (arguments.length === 2 && !(typeof options === \"undefined\" || typeof options === \"object\" && options !== null && !Array.isArray(options))) {\n    throw new TypeError(\n      `The second argument must be an options object or a string/boolean separator, but ${typeof options} given`\n    );\n  }\n  options = options || {};\n  if (options.separator === \"\\\\\") {\n    throw new Error(\n      \"\\\\ is not a valid separator because it is used for escaping. Try setting the separator to `true` instead\"\n    );\n  }\n  let regexpPattern = transform(pattern, options.separator);\n  let regexp = new RegExp(`^${regexpPattern}$`, options.flags);\n  let fn = isMatch.bind(null, regexp);\n  fn.options = options;\n  fn.pattern = pattern;\n  fn.regexp = regexp;\n  return fn;\n}\n\nconst originCheckMiddleware = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.c)(async (ctx) => {\n  if (ctx.request?.method !== \"POST\" || !ctx.request) {\n    return;\n  }\n  const { body, query, context } = ctx;\n  const originHeader = ctx.headers?.get(\"origin\") || ctx.headers?.get(\"referer\") || \"\";\n  const callbackURL = body?.callbackURL || query?.callbackURL;\n  const redirectURL = body?.redirectTo;\n  const errorCallbackURL = body?.errorCallbackURL;\n  const newUserCallbackURL = body?.newUserCallbackURL;\n  const trustedOrigins = Array.isArray(context.options.trustedOrigins) ? context.trustedOrigins : [\n    ...context.trustedOrigins,\n    ...await context.options.trustedOrigins?.(ctx.request) || []\n  ];\n  const usesCookies = ctx.headers?.has(\"cookie\");\n  const matchesPattern = (url, pattern) => {\n    if (url.startsWith(\"/\")) {\n      return false;\n    }\n    if (pattern.includes(\"*\")) {\n      if (pattern.includes(\"://\")) {\n        return wildcardMatch(pattern)((0,_better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_11__.g)(url) || url);\n      }\n      return wildcardMatch(pattern)((0,_better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_11__.b)(url));\n    }\n    const protocol = (0,_better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_11__.c)(url);\n    return protocol === \"http:\" || protocol === \"https:\" || !protocol ? pattern === (0,_better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_11__.g)(url) : url.startsWith(pattern);\n  };\n  const validateURL = (url, label) => {\n    if (!url) {\n      return;\n    }\n    const isTrustedOrigin = trustedOrigins.some(\n      (origin) => matchesPattern(url, origin) || url?.startsWith(\"/\") && label !== \"origin\" && /^\\/(?!\\/|\\\\|%2f|%5c)[\\w\\-.\\+/@]*(?:\\?[\\w\\-.\\+/=&%@]*)?$/.test(url)\n    );\n    if (!isTrustedOrigin) {\n      ctx.context.logger.error(`Invalid ${label}: ${url}`);\n      ctx.context.logger.info(\n        `If it's a valid URL, please add ${url} to trustedOrigins in your auth config\n`,\n        `Current list of trustedOrigins: ${trustedOrigins}`\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"FORBIDDEN\", { message: `Invalid ${label}` });\n    }\n  };\n  if (usesCookies && !ctx.context.options.advanced?.disableCSRFCheck) {\n    validateURL(originHeader, \"origin\");\n  }\n  callbackURL && validateURL(callbackURL, \"callbackURL\");\n  redirectURL && validateURL(redirectURL, \"redirectURL\");\n  errorCallbackURL && validateURL(errorCallbackURL, \"errorCallbackURL\");\n  newUserCallbackURL && validateURL(newUserCallbackURL, \"newUserCallbackURL\");\n});\nconst originCheck = (getValue) => (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.c)(async (ctx) => {\n  if (!ctx.request) {\n    return;\n  }\n  const { context } = ctx;\n  const callbackURL = getValue(ctx);\n  const trustedOrigins = Array.isArray(\n    context.options.trustedOrigins\n  ) ? context.trustedOrigins : [\n    ...context.trustedOrigins,\n    ...await context.options.trustedOrigins?.(ctx.request) || []\n  ];\n  const matchesPattern = (url, pattern) => {\n    if (url.startsWith(\"/\")) {\n      return false;\n    }\n    if (pattern.includes(\"*\")) {\n      if (pattern.includes(\"://\")) {\n        return wildcardMatch(pattern)((0,_better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_11__.g)(url) || url);\n      }\n      return wildcardMatch(pattern)((0,_better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_11__.b)(url));\n    }\n    const protocol = (0,_better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_11__.c)(url);\n    return protocol === \"http:\" || protocol === \"https:\" || !protocol ? pattern === (0,_better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_11__.g)(url) : url.startsWith(pattern);\n  };\n  const validateURL = (url, label) => {\n    if (!url) {\n      return;\n    }\n    const isTrustedOrigin = trustedOrigins.some(\n      (origin) => matchesPattern(url, origin) || url?.startsWith(\"/\") && label !== \"origin\" && /^\\/(?!\\/|\\\\|%2f|%5c)[\\w\\-.\\+/@]*(?:\\?[\\w\\-.\\+/=&%@]*)?$/.test(\n        url\n      )\n    );\n    if (!isTrustedOrigin) {\n      ctx.context.logger.error(`Invalid ${label}: ${url}`);\n      ctx.context.logger.info(\n        `If it's a valid URL, please add ${url} to trustedOrigins in your auth config\n`,\n        `Current list of trustedOrigins: ${trustedOrigins}`\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"FORBIDDEN\", { message: `Invalid ${label}` });\n    }\n  };\n  const callbacks = Array.isArray(callbackURL) ? callbackURL : [callbackURL];\n  for (const url of callbacks) {\n    validateURL(url, \"callbackURL\");\n  }\n});\n\nasync function createEmailVerificationToken(secret, email, updateTo, expiresIn = 3600) {\n  const token = await (0,_crypto_index_mjs__WEBPACK_IMPORTED_MODULE_6__.signJWT)(\n    {\n      email: email.toLowerCase(),\n      updateTo\n    },\n    secret,\n    expiresIn\n  );\n  return token;\n}\nasync function sendVerificationEmailFn(ctx, user) {\n  if (!ctx.context.options.emailVerification?.sendVerificationEmail) {\n    ctx.context.logger.error(\"Verification email isn't enabled.\");\n    throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n      message: \"Verification email isn't enabled\"\n    });\n  }\n  const token = await createEmailVerificationToken(\n    ctx.context.secret,\n    user.email,\n    void 0,\n    ctx.context.options.emailVerification?.expiresIn\n  );\n  const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n  await ctx.context.options.emailVerification.sendVerificationEmail(\n    {\n      user,\n      url,\n      token\n    },\n    ctx.request\n  );\n}\nconst sendVerificationEmail = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/send-verification-email\",\n  {\n    method: \"POST\",\n    body: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      email: zod_v4__WEBPACK_IMPORTED_MODULE_0__.email().meta({\n        description: \"The email to send the verification email to\"\n      }),\n      callbackURL: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The URL to use for email verification callback\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Send a verification email to the user\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  email: {\n                    type: \"string\",\n                    description: \"The email to send the verification email to\",\n                    example: \"user@example.com\"\n                  },\n                  callbackURL: {\n                    type: \"string\",\n                    description: \"The URL to use for email verification callback\",\n                    example: \"https://example.com/callback\",\n                    nullable: true\n                  }\n                },\n                required: [\"email\"]\n              }\n            }\n          }\n        },\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if the email was sent successfully\",\n                      example: true\n                    }\n                  }\n                }\n              }\n            }\n          },\n          \"400\": {\n            description: \"Bad Request\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    message: {\n                      type: \"string\",\n                      description: \"Error message\",\n                      example: \"Verification email isn't enabled\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.emailVerification?.sendVerificationEmail) {\n      ctx.context.logger.error(\"Verification email isn't enabled.\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: \"Verification email isn't enabled\"\n      });\n    }\n    const { email } = ctx.body;\n    const session = await (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.g)(ctx);\n    if (!session) {\n      const user = await ctx.context.internalAdapter.findUserByEmail(email);\n      if (!user) {\n        return ctx.json({\n          status: true\n        });\n      }\n      await sendVerificationEmailFn(ctx, user.user);\n      return ctx.json({\n        status: true\n      });\n    }\n    if (session?.user.emailVerified) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: \"You can only send a verification email to an unverified email\"\n      });\n    }\n    if (session?.user.email !== email) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: \"You can only send a verification email to your own email\"\n      });\n    }\n    await sendVerificationEmailFn(ctx, session.user);\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst verifyEmail = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/verify-email\",\n  {\n    method: \"GET\",\n    query: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      token: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The token to verify the email\"\n      }),\n      callbackURL: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The URL to redirect to after email verification\"\n      }).optional()\n    }),\n    use: [originCheck((ctx) => ctx.query.callbackURL)],\n    metadata: {\n      openapi: {\n        description: \"Verify the email of the user\",\n        parameters: [\n          {\n            name: \"token\",\n            in: \"query\",\n            description: \"The token to verify the email\",\n            required: true,\n            schema: {\n              type: \"string\"\n            }\n          },\n          {\n            name: \"callbackURL\",\n            in: \"query\",\n            description: \"The URL to redirect to after email verification\",\n            required: false,\n            schema: {\n              type: \"string\"\n            }\n          }\n        ],\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    user: {\n                      type: \"object\",\n                      properties: {\n                        id: {\n                          type: \"string\",\n                          description: \"User ID\"\n                        },\n                        email: {\n                          type: \"string\",\n                          description: \"User email\"\n                        },\n                        name: {\n                          type: \"string\",\n                          description: \"User name\"\n                        },\n                        image: {\n                          type: \"string\",\n                          description: \"User image URL\"\n                        },\n                        emailVerified: {\n                          type: \"boolean\",\n                          description: \"Indicates if the user email is verified\"\n                        },\n                        createdAt: {\n                          type: \"string\",\n                          description: \"User creation date\"\n                        },\n                        updatedAt: {\n                          type: \"string\",\n                          description: \"User update date\"\n                        }\n                      },\n                      required: [\n                        \"id\",\n                        \"email\",\n                        \"name\",\n                        \"image\",\n                        \"emailVerified\",\n                        \"createdAt\",\n                        \"updatedAt\"\n                      ]\n                    },\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if the email was verified successfully\"\n                    }\n                  },\n                  required: [\"user\", \"status\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    function redirectOnError(error) {\n      if (ctx.query.callbackURL) {\n        if (ctx.query.callbackURL.includes(\"?\")) {\n          throw ctx.redirect(`${ctx.query.callbackURL}&error=${error}`);\n        }\n        throw ctx.redirect(`${ctx.query.callbackURL}?error=${error}`);\n      }\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"UNAUTHORIZED\", {\n        message: error\n      });\n    }\n    const { token } = ctx.query;\n    let jwt;\n    try {\n      jwt = await (0,jose__WEBPACK_IMPORTED_MODULE_23__.jwtVerify)(\n        token,\n        new TextEncoder().encode(ctx.context.secret),\n        {\n          algorithms: [\"HS256\"]\n        }\n      );\n    } catch (e) {\n      if (e instanceof jose_errors__WEBPACK_IMPORTED_MODULE_24__.JWTExpired) {\n        return redirectOnError(\"token_expired\");\n      }\n      return redirectOnError(\"invalid_token\");\n    }\n    const schema = zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      email: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().email(),\n      updateTo: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n    });\n    const parsed = schema.parse(jwt.payload);\n    const user = await ctx.context.internalAdapter.findUserByEmail(\n      parsed.email\n    );\n    if (!user) {\n      return redirectOnError(\"user_not_found\");\n    }\n    if (parsed.updateTo) {\n      const session = await (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.g)(ctx);\n      if (!session) {\n        if (ctx.query.callbackURL) {\n          throw ctx.redirect(`${ctx.query.callbackURL}?error=unauthorized`);\n        }\n        return redirectOnError(\"unauthorized\");\n      }\n      if (session.user.email !== parsed.email) {\n        if (ctx.query.callbackURL) {\n          throw ctx.redirect(`${ctx.query.callbackURL}?error=unauthorized`);\n        }\n        return redirectOnError(\"unauthorized\");\n      }\n      const updatedUser2 = await ctx.context.internalAdapter.updateUserByEmail(\n        parsed.email,\n        {\n          email: parsed.updateTo,\n          emailVerified: false\n        },\n        ctx\n      );\n      const newToken = await createEmailVerificationToken(\n        ctx.context.secret,\n        parsed.updateTo\n      );\n      await ctx.context.options.emailVerification?.sendVerificationEmail?.(\n        {\n          user: updatedUser2,\n          url: `${ctx.context.baseURL}/verify-email?token=${newToken}&callbackURL=${ctx.query.callbackURL || \"/\"}`,\n          token: newToken\n        },\n        ctx.request\n      );\n      await (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_12__.s)(ctx, {\n        session: session.session,\n        user: {\n          ...session.user,\n          email: parsed.updateTo,\n          emailVerified: false\n        }\n      });\n      if (ctx.query.callbackURL) {\n        throw ctx.redirect(ctx.query.callbackURL);\n      }\n      return ctx.json({\n        status: true,\n        user: {\n          id: updatedUser2.id,\n          email: updatedUser2.email,\n          name: updatedUser2.name,\n          image: updatedUser2.image,\n          emailVerified: updatedUser2.emailVerified,\n          createdAt: updatedUser2.createdAt,\n          updatedAt: updatedUser2.updatedAt\n        }\n      });\n    }\n    if (ctx.context.options.emailVerification?.onEmailVerification) {\n      await ctx.context.options.emailVerification.onEmailVerification(\n        user.user,\n        ctx.request\n      );\n    }\n    const updatedUser = await ctx.context.internalAdapter.updateUserByEmail(\n      parsed.email,\n      {\n        emailVerified: true\n      },\n      ctx\n    );\n    if (ctx.context.options.emailVerification?.afterEmailVerification) {\n      await ctx.context.options.emailVerification.afterEmailVerification(\n        updatedUser,\n        ctx.request\n      );\n    }\n    if (ctx.context.options.emailVerification?.autoSignInAfterVerification) {\n      const currentSession = await (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.g)(ctx);\n      if (!currentSession || currentSession.user.email !== parsed.email) {\n        const session = await ctx.context.internalAdapter.createSession(\n          user.user.id,\n          ctx\n        );\n        if (!session) {\n          throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"INTERNAL_SERVER_ERROR\", {\n            message: \"Failed to create session\"\n          });\n        }\n        await (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_12__.s)(ctx, {\n          session,\n          user: {\n            ...user.user,\n            emailVerified: true\n          }\n        });\n      } else {\n        await (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_12__.s)(ctx, {\n          session: currentSession.session,\n          user: {\n            ...currentSession.user,\n            emailVerified: true\n          }\n        });\n      }\n    }\n    if (ctx.query.callbackURL) {\n      throw ctx.redirect(ctx.query.callbackURL);\n    }\n    return ctx.json({\n      status: true,\n      user: null\n    });\n  }\n);\n\nconst HIDE_METADATA = {\n  isAction: false\n};\n\nasync function generateState(c, link) {\n  const callbackURL = c.body?.callbackURL || c.context.options.baseURL;\n  if (!callbackURL) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n      message: \"callbackURL is required\"\n    });\n  }\n  const codeVerifier = (0,_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_10__.g)(128);\n  const state = (0,_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_10__.g)(32);\n  const data = JSON.stringify({\n    callbackURL,\n    codeVerifier,\n    errorURL: c.body?.errorCallbackURL,\n    newUserURL: c.body?.newUserCallbackURL,\n    link,\n    /**\n     * This is the actual expiry time of the state\n     */\n    expiresAt: Date.now() + 10 * 60 * 1e3,\n    requestSignUp: c.body?.requestSignUp\n  });\n  const expiresAt = /* @__PURE__ */ new Date();\n  expiresAt.setMinutes(expiresAt.getMinutes() + 10);\n  const verification = await c.context.internalAdapter.createVerificationValue(\n    {\n      value: data,\n      identifier: state,\n      expiresAt\n    },\n    c\n  );\n  if (!verification) {\n    c.context.logger.error(\n      \"Unable to create verification. Make sure the database adapter is properly working and there is a verification table in the database\"\n    );\n    throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"INTERNAL_SERVER_ERROR\", {\n      message: \"Unable to create verification\"\n    });\n  }\n  return {\n    state: verification.identifier,\n    codeVerifier\n  };\n}\nasync function parseState(c) {\n  const state = c.query.state || c.body.state;\n  const data = await c.context.internalAdapter.findVerificationValue(state);\n  if (!data) {\n    c.context.logger.error(\"State Mismatch. Verification not found\", {\n      state\n    });\n    const errorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n    throw c.redirect(`${errorURL}?error=please_restart_the_process`);\n  }\n  const parsedData = zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n    callbackURL: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(),\n    codeVerifier: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(),\n    errorURL: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n    newUserURL: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n    expiresAt: zod_v4__WEBPACK_IMPORTED_MODULE_0__.number(),\n    link: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      email: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(),\n      userId: zod_v4__WEBPACK_IMPORTED_MODULE_0__.coerce.string()\n    }).optional(),\n    requestSignUp: zod_v4__WEBPACK_IMPORTED_MODULE_0__.boolean().optional()\n  }).parse(JSON.parse(data.value));\n  if (!parsedData.errorURL) {\n    parsedData.errorURL = `${c.context.baseURL}/error`;\n  }\n  if (parsedData.expiresAt < Date.now()) {\n    await c.context.internalAdapter.deleteVerificationValue(data.id);\n    const errorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n    throw c.redirect(`${errorURL}?error=please_restart_the_process`);\n  }\n  await c.context.internalAdapter.deleteVerificationValue(data.id);\n  return parsedData;\n}\n\nasync function generateCodeChallenge(codeVerifier) {\n  const codeChallengeBytes = await (0,_better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_4__.createHash)(\"SHA-256\").digest(codeVerifier);\n  return _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__.base64Url.encode(new Uint8Array(codeChallengeBytes), {\n    padding: false\n  });\n}\nfunction getOAuth2Tokens(data) {\n  return {\n    tokenType: data.token_type,\n    accessToken: data.access_token,\n    refreshToken: data.refresh_token,\n    accessTokenExpiresAt: data.expires_in ? (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_3__.g)(data.expires_in, \"sec\") : void 0,\n    refreshTokenExpiresAt: data.refresh_token_expires_in ? (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_3__.g)(data.refresh_token_expires_in, \"sec\") : void 0,\n    scopes: data?.scope ? typeof data.scope === \"string\" ? data.scope.split(\" \") : data.scope : [],\n    idToken: data.id_token\n  };\n}\nconst encodeOAuthParameter = (value) => encodeURIComponent(value).replace(/%20/g, \"+\");\nfunction decryptOAuthToken(token, ctx) {\n  if (!token) return token;\n  if (ctx.options.account?.encryptOAuthTokens) {\n    return (0,_crypto_index_mjs__WEBPACK_IMPORTED_MODULE_6__.symmetricDecrypt)({\n      key: ctx.secret,\n      data: token\n    });\n  }\n  return token;\n}\nfunction setTokenUtil(token, ctx) {\n  if (ctx.options.account?.encryptOAuthTokens && token) {\n    return (0,_crypto_index_mjs__WEBPACK_IMPORTED_MODULE_6__.symmetricEncrypt)({\n      key: ctx.secret,\n      data: token\n    });\n  }\n  return token;\n}\n\nasync function handleOAuthUserInfo(c, {\n  userInfo,\n  account,\n  callbackURL,\n  disableSignUp,\n  overrideUserInfo\n}) {\n  const dbUser = await c.context.internalAdapter.findOAuthUser(\n    userInfo.email.toLowerCase(),\n    account.accountId,\n    account.providerId\n  ).catch((e) => {\n    _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\n      \"Better auth was unable to query your database.\\nError: \",\n      e\n    );\n    const errorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n    throw c.redirect(`${errorURL}?error=internal_server_error`);\n  });\n  let user = dbUser?.user;\n  let isRegister = !user;\n  if (dbUser) {\n    const hasBeenLinked = dbUser.accounts.find(\n      (a) => a.providerId === account.providerId && a.accountId === account.accountId\n    );\n    if (!hasBeenLinked) {\n      const trustedProviders = c.context.options.account?.accountLinking?.trustedProviders;\n      const isTrustedProvider = trustedProviders?.includes(\n        account.providerId\n      );\n      if (!isTrustedProvider && !userInfo.emailVerified || c.context.options.account?.accountLinking?.enabled === false) {\n        if (_better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_18__.b) {\n          _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.warn(\n            `User already exist but account isn't linked to ${account.providerId}. To read more about how account linking works in Better Auth see https://www.better-auth.com/docs/concepts/users-accounts#account-linking.`\n          );\n        }\n        return {\n          error: \"account not linked\",\n          data: null\n        };\n      }\n      try {\n        await c.context.internalAdapter.linkAccount(\n          {\n            providerId: account.providerId,\n            accountId: userInfo.id.toString(),\n            userId: dbUser.user.id,\n            accessToken: await setTokenUtil(account.accessToken, c.context),\n            refreshToken: await setTokenUtil(account.refreshToken, c.context),\n            idToken: account.idToken,\n            accessTokenExpiresAt: account.accessTokenExpiresAt,\n            refreshTokenExpiresAt: account.refreshTokenExpiresAt,\n            scope: account.scope\n          },\n          c\n        );\n      } catch (e) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\"Unable to link account\", e);\n        return {\n          error: \"unable to link account\",\n          data: null\n        };\n      }\n    } else {\n      if (c.context.options.account?.updateAccountOnSignIn !== false) {\n        const updateData = Object.fromEntries(\n          Object.entries({\n            idToken: account.idToken,\n            accessToken: await setTokenUtil(account.accessToken, c.context),\n            refreshToken: await setTokenUtil(account.refreshToken, c.context),\n            accessTokenExpiresAt: account.accessTokenExpiresAt,\n            refreshTokenExpiresAt: account.refreshTokenExpiresAt,\n            scope: account.scope\n          }).filter(([_, value]) => value !== void 0)\n        );\n        if (Object.keys(updateData).length > 0) {\n          await c.context.internalAdapter.updateAccount(\n            hasBeenLinked.id,\n            updateData,\n            c\n          );\n        }\n      }\n    }\n    if (overrideUserInfo) {\n      const { id: _, ...restUserInfo } = userInfo;\n      await c.context.internalAdapter.updateUser(dbUser.user.id, {\n        ...restUserInfo,\n        email: userInfo.email.toLowerCase(),\n        emailVerified: userInfo.email.toLowerCase() === dbUser.user.email ? dbUser.user.emailVerified || userInfo.emailVerified : userInfo.emailVerified\n      });\n    }\n  } else {\n    if (disableSignUp) {\n      return {\n        error: \"signup disabled\",\n        data: null,\n        isRegister: false\n      };\n    }\n    try {\n      const { id: _, ...restUserInfo } = userInfo;\n      user = await c.context.internalAdapter.createOAuthUser(\n        {\n          ...restUserInfo,\n          email: userInfo.email.toLowerCase()\n        },\n        {\n          accessToken: await setTokenUtil(account.accessToken, c.context),\n          refreshToken: await setTokenUtil(account.refreshToken, c.context),\n          idToken: account.idToken,\n          accessTokenExpiresAt: account.accessTokenExpiresAt,\n          refreshTokenExpiresAt: account.refreshTokenExpiresAt,\n          scope: account.scope,\n          providerId: account.providerId,\n          accountId: userInfo.id.toString()\n        },\n        c\n      ).then((res) => res?.user);\n      if (!userInfo.emailVerified && user && c.context.options.emailVerification?.sendOnSignUp) {\n        const token = await createEmailVerificationToken(\n          c.context.secret,\n          user.email,\n          void 0,\n          c.context.options.emailVerification?.expiresIn\n        );\n        const url = `${c.context.baseURL}/verify-email?token=${token}&callbackURL=${callbackURL}`;\n        await c.context.options.emailVerification?.sendVerificationEmail?.(\n          {\n            user,\n            url,\n            token\n          },\n          c.request\n        );\n      }\n    } catch (e) {\n      _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(e);\n      if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_2__.APIError) {\n        return {\n          error: e.message,\n          data: null,\n          isRegister: false\n        };\n      }\n      return {\n        error: \"unable to create user\",\n        data: null,\n        isRegister: false\n      };\n    }\n  }\n  if (!user) {\n    return {\n      error: \"unable to create user\",\n      data: null,\n      isRegister: false\n    };\n  }\n  const session = await c.context.internalAdapter.createSession(user.id, c);\n  if (!session) {\n    return {\n      error: \"unable to create session\",\n      data: null,\n      isRegister: false\n    };\n  }\n  return {\n    data: {\n      session,\n      user\n    },\n    error: null,\n    isRegister\n  };\n}\n\nasync function createAuthorizationURL({\n  id,\n  options,\n  authorizationEndpoint,\n  state,\n  codeVerifier,\n  scopes,\n  claims,\n  redirectURI,\n  duration,\n  prompt,\n  accessType,\n  responseType,\n  display,\n  loginHint,\n  hd,\n  responseMode,\n  additionalParams,\n  scopeJoiner\n}) {\n  const url = new URL(authorizationEndpoint);\n  url.searchParams.set(\"response_type\", responseType || \"code\");\n  url.searchParams.set(\"client_id\", options.clientId);\n  url.searchParams.set(\"state\", state);\n  url.searchParams.set(\"scope\", scopes.join(scopeJoiner || \" \"));\n  url.searchParams.set(\"redirect_uri\", options.redirectURI || redirectURI);\n  duration && url.searchParams.set(\"duration\", duration);\n  display && url.searchParams.set(\"display\", display);\n  loginHint && url.searchParams.set(\"login_hint\", loginHint);\n  prompt && url.searchParams.set(\"prompt\", prompt);\n  hd && url.searchParams.set(\"hd\", hd);\n  accessType && url.searchParams.set(\"access_type\", accessType);\n  responseMode && url.searchParams.set(\"response_mode\", responseMode);\n  if (codeVerifier) {\n    const codeChallenge = await generateCodeChallenge(codeVerifier);\n    url.searchParams.set(\"code_challenge_method\", \"S256\");\n    url.searchParams.set(\"code_challenge\", codeChallenge);\n  }\n  if (claims) {\n    const claimsObj = claims.reduce(\n      (acc, claim) => {\n        acc[claim] = null;\n        return acc;\n      },\n      {}\n    );\n    url.searchParams.set(\n      \"claims\",\n      JSON.stringify({\n        id_token: { email: null, email_verified: null, ...claimsObj }\n      })\n    );\n  }\n  if (additionalParams) {\n    Object.entries(additionalParams).forEach(([key, value]) => {\n      url.searchParams.set(key, value);\n    });\n  }\n  return url;\n}\n\nfunction createAuthorizationCodeRequest({\n  code,\n  codeVerifier,\n  redirectURI,\n  options,\n  authentication,\n  deviceId,\n  headers,\n  additionalParams = {},\n  resource\n}) {\n  const body = new URLSearchParams();\n  const requestHeaders = {\n    \"content-type\": \"application/x-www-form-urlencoded\",\n    accept: \"application/json\",\n    \"user-agent\": \"better-auth\",\n    ...headers\n  };\n  body.set(\"grant_type\", \"authorization_code\");\n  body.set(\"code\", code);\n  codeVerifier && body.set(\"code_verifier\", codeVerifier);\n  options.clientKey && body.set(\"client_key\", options.clientKey);\n  deviceId && body.set(\"device_id\", deviceId);\n  body.set(\"redirect_uri\", options.redirectURI || redirectURI);\n  if (resource) {\n    if (typeof resource === \"string\") {\n      body.append(\"resource\", resource);\n    } else {\n      for (const _resource of resource) {\n        body.append(\"resource\", _resource);\n      }\n    }\n  }\n  if (authentication === \"basic\") {\n    const encodedCredentials = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__.base64.encode(\n      `${options.clientId}:${options.clientSecret ?? \"\"}`\n    );\n    requestHeaders[\"authorization\"] = `Basic ${encodedCredentials}`;\n  } else {\n    options.clientId && body.set(\"client_id\", options.clientId);\n    if (options.clientSecret) {\n      body.set(\"client_secret\", options.clientSecret);\n    }\n  }\n  for (const [key, value] of Object.entries(additionalParams)) {\n    if (!body.has(key)) body.append(key, value);\n  }\n  return {\n    body,\n    headers: requestHeaders\n  };\n}\nasync function validateAuthorizationCode({\n  code,\n  codeVerifier,\n  redirectURI,\n  options,\n  tokenEndpoint,\n  authentication,\n  deviceId,\n  headers,\n  additionalParams = {},\n  resource\n}) {\n  const { body, headers: requestHeaders } = createAuthorizationCodeRequest({\n    code,\n    codeVerifier,\n    redirectURI,\n    options,\n    authentication,\n    deviceId,\n    headers,\n    additionalParams,\n    resource\n  });\n  const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(tokenEndpoint, {\n    method: \"POST\",\n    body,\n    headers: requestHeaders\n  });\n  if (error) {\n    throw error;\n  }\n  const tokens = getOAuth2Tokens(data);\n  return tokens;\n}\nasync function validateToken(token, jwksEndpoint) {\n  const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(jwksEndpoint, {\n    method: \"GET\",\n    headers: {\n      accept: \"application/json\",\n      \"user-agent\": \"better-auth\"\n    }\n  });\n  if (error) {\n    throw error;\n  }\n  const keys = data[\"keys\"];\n  const header = JSON.parse(atob(token.split(\".\")[0]));\n  const key = keys.find((key2) => key2.kid === header.kid);\n  if (!key) {\n    throw new Error(\"Key not found\");\n  }\n  const verified = await (0,jose__WEBPACK_IMPORTED_MODULE_23__.jwtVerify)(token, key);\n  return verified;\n}\n\nfunction createRefreshAccessTokenRequest({\n  refreshToken,\n  options,\n  authentication,\n  extraParams,\n  resource\n}) {\n  const body = new URLSearchParams();\n  const headers = {\n    \"content-type\": \"application/x-www-form-urlencoded\",\n    accept: \"application/json\"\n  };\n  body.set(\"grant_type\", \"refresh_token\");\n  body.set(\"refresh_token\", refreshToken);\n  if (authentication === \"basic\") {\n    if (options.clientId) {\n      headers[\"authorization\"] = \"Basic \" + _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__.base64.encode(`${options.clientId}:${options.clientSecret ?? \"\"}`);\n    } else {\n      headers[\"authorization\"] = \"Basic \" + _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__.base64.encode(`:${options.clientSecret ?? \"\"}`);\n    }\n  } else {\n    options.clientId && body.set(\"client_id\", options.clientId);\n    if (options.clientSecret) {\n      body.set(\"client_secret\", options.clientSecret);\n    }\n  }\n  if (resource) {\n    if (typeof resource === \"string\") {\n      body.append(\"resource\", resource);\n    } else {\n      for (const _resource of resource) {\n        body.append(\"resource\", _resource);\n      }\n    }\n  }\n  if (extraParams) {\n    for (const [key, value] of Object.entries(extraParams)) {\n      body.set(key, value);\n    }\n  }\n  return {\n    body,\n    headers\n  };\n}\nasync function refreshAccessToken({\n  refreshToken,\n  options,\n  tokenEndpoint,\n  authentication,\n  extraParams\n}) {\n  const { body, headers } = createRefreshAccessTokenRequest({\n    refreshToken,\n    options,\n    authentication,\n    extraParams\n  });\n  const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(tokenEndpoint, {\n    method: \"POST\",\n    body,\n    headers\n  });\n  if (error) {\n    throw error;\n  }\n  const tokens = {\n    accessToken: data.access_token,\n    refreshToken: data.refresh_token,\n    tokenType: data.token_type,\n    scopes: data.scope?.split(\" \"),\n    idToken: data.id_token\n  };\n  if (data.expires_in) {\n    const now = /* @__PURE__ */ new Date();\n    tokens.accessTokenExpiresAt = new Date(\n      now.getTime() + data.expires_in * 1e3\n    );\n  }\n  return tokens;\n}\n\nconst apple = (options) => {\n  const tokenEndpoint = \"https://appleid.apple.com/auth/token\";\n  return {\n    id: \"apple\",\n    name: \"Apple\",\n    async createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scope = options.disableDefaultScope ? [] : [\"email\", \"name\"];\n      options.scope && _scope.push(...options.scope);\n      scopes && _scope.push(...scopes);\n      const url = await createAuthorizationURL({\n        id: \"apple\",\n        options,\n        authorizationEndpoint: \"https://appleid.apple.com/auth/authorize\",\n        scopes: _scope,\n        state,\n        redirectURI,\n        responseMode: \"form_post\",\n        responseType: \"code id_token\"\n      });\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      const decodedHeader = (0,jose__WEBPACK_IMPORTED_MODULE_25__.decodeProtectedHeader)(token);\n      const { kid, alg: jwtAlg } = decodedHeader;\n      if (!kid || !jwtAlg) return false;\n      const publicKey = await getApplePublicKey(kid);\n      const { payload: jwtClaims } = await (0,jose__WEBPACK_IMPORTED_MODULE_23__.jwtVerify)(token, publicKey, {\n        algorithms: [jwtAlg],\n        issuer: \"https://appleid.apple.com\",\n        audience: options.audience && options.audience.length ? options.audience : options.appBundleIdentifier ? options.appBundleIdentifier : options.clientId,\n        maxTokenAge: \"1h\"\n      });\n      [\"email_verified\", \"is_private_email\"].forEach((field) => {\n        if (jwtClaims[field] !== void 0) {\n          jwtClaims[field] = Boolean(jwtClaims[field]);\n        }\n      });\n      if (nonce && jwtClaims.nonce !== nonce) {\n        return false;\n      }\n      return !!jwtClaims;\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://appleid.apple.com/auth/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.idToken) {\n        return null;\n      }\n      const profile = (0,jose__WEBPACK_IMPORTED_MODULE_26__.decodeJwt)(token.idToken);\n      if (!profile) {\n        return null;\n      }\n      const name = token.user ? `${token.user.name?.firstName} ${token.user.name?.lastName}` : profile.name || profile.email;\n      const emailVerified = typeof profile.email_verified === \"boolean\" ? profile.email_verified : profile.email_verified === \"true\";\n      const enrichedProfile = {\n        ...profile,\n        name\n      };\n      const userMap = await options.mapProfileToUser?.(enrichedProfile);\n      return {\n        user: {\n          id: profile.sub,\n          name: enrichedProfile.name,\n          emailVerified,\n          email: profile.email,\n          ...userMap\n        },\n        data: enrichedProfile\n      };\n    },\n    options\n  };\n};\nconst getApplePublicKey = async (kid) => {\n  const APPLE_BASE_URL = \"https://appleid.apple.com\";\n  const JWKS_APPLE_URI = \"/auth/keys\";\n  const { data } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(`${APPLE_BASE_URL}${JWKS_APPLE_URI}`);\n  if (!data?.keys) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n      message: \"Keys not found\"\n    });\n  }\n  const jwk = data.keys.find((key) => key.kid === kid);\n  if (!jwk) {\n    throw new Error(`JWK with kid ${kid} not found`);\n  }\n  return await (0,jose__WEBPACK_IMPORTED_MODULE_27__.importJWK)(jwk, jwk.alg);\n};\n\nconst atlassian = (options) => {\n  return {\n    id: \"atlassian\",\n    name: \"Atlassian\",\n    async createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      if (!options.clientId || !options.clientSecret) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\"Client Id and Secret are required for Atlassian\");\n        throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_22__.B(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      if (!codeVerifier) {\n        throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_22__.B(\"codeVerifier is required for Atlassian\");\n      }\n      const _scopes = options.disableDefaultScope ? [] : [\"read:jira-user\", \"offline_access\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return createAuthorizationURL({\n        id: \"atlassian\",\n        options,\n        authorizationEndpoint: \"https://auth.atlassian.com/authorize\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI,\n        additionalParams: {\n          audience: \"api.atlassian.com\"\n        },\n        prompt: options.prompt\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://auth.atlassian.com/oauth/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://auth.atlassian.com/oauth/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.accessToken) {\n        return null;\n      }\n      try {\n        const { data: profile } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\"https://api.atlassian.com/me\", {\n          headers: { Authorization: `Bearer ${token.accessToken}` }\n        });\n        if (!profile) return null;\n        const userMap = await options.mapProfileToUser?.(profile);\n        return {\n          user: {\n            id: profile.account_id,\n            name: profile.name,\n            email: profile.email,\n            image: profile.picture,\n            emailVerified: false,\n            ...userMap\n          },\n          data: profile\n        };\n      } catch (error) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\"Failed to fetch user info from Figma:\", error);\n        return null;\n      }\n    },\n    options\n  };\n};\n\nconst cognito = (options) => {\n  if (!options.domain || !options.region || !options.userPoolId) {\n    _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\n      \"Domain, region and userPoolId are required for Amazon Cognito. Make sure to provide them in the options.\"\n    );\n    throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_22__.B(\"DOMAIN_AND_REGION_REQUIRED\");\n  }\n  const cleanDomain = options.domain.replace(/^https?:\\/\\//, \"\");\n  const authorizationEndpoint = `https://${cleanDomain}/oauth2/authorize`;\n  const tokenEndpoint = `https://${cleanDomain}/oauth2/token`;\n  const userInfoEndpoint = `https://${cleanDomain}/oauth2/userinfo`;\n  return {\n    id: \"cognito\",\n    name: \"Cognito\",\n    async createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      if (!options.clientId) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\n          \"ClientId is required for Amazon Cognito. Make sure to provide them in the options.\"\n        );\n        throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_22__.B(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      if (options.requireClientSecret && !options.clientSecret) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\n          \"Client Secret is required when requireClientSecret is true. Make sure to provide it in the options.\"\n        );\n        throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_22__.B(\"CLIENT_SECRET_REQUIRED\");\n      }\n      const _scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\", \"email\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      const url = await createAuthorizationURL({\n        id: \"cognito\",\n        options: {\n          ...options\n        },\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI,\n        prompt: options.prompt\n      });\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      try {\n        const decodedHeader = (0,jose__WEBPACK_IMPORTED_MODULE_25__.decodeProtectedHeader)(token);\n        const { kid, alg: jwtAlg } = decodedHeader;\n        if (!kid || !jwtAlg) return false;\n        const publicKey = await getCognitoPublicKey(\n          kid,\n          options.region,\n          options.userPoolId\n        );\n        const expectedIssuer = `https://cognito-idp.${options.region}.amazonaws.com/${options.userPoolId}`;\n        const { payload: jwtClaims } = await (0,jose__WEBPACK_IMPORTED_MODULE_23__.jwtVerify)(token, publicKey, {\n          algorithms: [jwtAlg],\n          issuer: expectedIssuer,\n          audience: options.clientId,\n          maxTokenAge: \"1h\"\n        });\n        if (nonce && jwtClaims.nonce !== nonce) {\n          return false;\n        }\n        return true;\n      } catch (error) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\"Failed to verify ID token:\", error);\n        return false;\n      }\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (token.idToken) {\n        try {\n          const profile = (0,jose__WEBPACK_IMPORTED_MODULE_26__.decodeJwt)(token.idToken);\n          if (!profile) {\n            return null;\n          }\n          const name = profile.name || profile.given_name || profile.username || profile.email;\n          const enrichedProfile = {\n            ...profile,\n            name\n          };\n          const userMap = await options.mapProfileToUser?.(enrichedProfile);\n          return {\n            user: {\n              id: profile.sub,\n              name: enrichedProfile.name,\n              email: profile.email,\n              image: profile.picture,\n              emailVerified: profile.email_verified,\n              ...userMap\n            },\n            data: enrichedProfile\n          };\n        } catch (error) {\n          _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\"Failed to decode ID token:\", error);\n        }\n      }\n      if (token.accessToken) {\n        try {\n          const { data: userInfo } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n            userInfoEndpoint,\n            {\n              headers: {\n                Authorization: `Bearer ${token.accessToken}`\n              }\n            }\n          );\n          if (userInfo) {\n            const userMap = await options.mapProfileToUser?.(userInfo);\n            return {\n              user: {\n                id: userInfo.sub,\n                name: userInfo.name || userInfo.given_name || userInfo.username,\n                email: userInfo.email,\n                image: userInfo.picture,\n                emailVerified: userInfo.email_verified,\n                ...userMap\n              },\n              data: userInfo\n            };\n          }\n        } catch (error) {\n          _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\"Failed to fetch user info from Cognito:\", error);\n        }\n      }\n      return null;\n    },\n    options\n  };\n};\nconst getCognitoPublicKey = async (kid, region, userPoolId) => {\n  const COGNITO_JWKS_URI = `https://cognito-idp.${region}.amazonaws.com/${userPoolId}/.well-known/jwks.json`;\n  try {\n    const { data } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(COGNITO_JWKS_URI);\n    if (!data?.keys) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: \"Keys not found\"\n      });\n    }\n    const jwk = data.keys.find((key) => key.kid === kid);\n    if (!jwk) {\n      throw new Error(`JWK with kid ${kid} not found`);\n    }\n    return await (0,jose__WEBPACK_IMPORTED_MODULE_27__.importJWK)(jwk, jwk.alg);\n  } catch (error) {\n    _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\"Failed to fetch Cognito public key:\", error);\n    throw error;\n  }\n};\n\nconst discord = (options) => {\n  return {\n    id: \"discord\",\n    name: \"Discord\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"identify\", \"email\"];\n      scopes && _scopes.push(...scopes);\n      options.scope && _scopes.push(...options.scope);\n      return new URL(\n        `https://discord.com/api/oauth2/authorize?scope=${_scopes.join(\n          \"+\"\n        )}&response_type=code&client_id=${options.clientId}&redirect_uri=${encodeURIComponent(\n          options.redirectURI || redirectURI\n        )}&state=${state}&prompt=${options.prompt || \"none\"}`\n      );\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://discord.com/api/oauth2/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://discord.com/api/oauth2/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        \"https://discord.com/api/users/@me\",\n        {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      if (profile.avatar === null) {\n        const defaultAvatarNumber = profile.discriminator === \"0\" ? Number(BigInt(profile.id) >> BigInt(22)) % 6 : parseInt(profile.discriminator) % 5;\n        profile.image_url = `https://cdn.discordapp.com/embed/avatars/${defaultAvatarNumber}.png`;\n      } else {\n        const format = profile.avatar.startsWith(\"a_\") ? \"gif\" : \"png\";\n        profile.image_url = `https://cdn.discordapp.com/avatars/${profile.id}/${profile.avatar}.${format}`;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.global_name || profile.username || \"\",\n          email: profile.email,\n          emailVerified: profile.verified,\n          image: profile.image_url,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst facebook = (options) => {\n  return {\n    id: \"facebook\",\n    name: \"Facebook\",\n    async createAuthorizationURL({ state, scopes, redirectURI, loginHint }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"email\", \"public_profile\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return await createAuthorizationURL({\n        id: \"facebook\",\n        options,\n        authorizationEndpoint: \"https://www.facebook.com/v21.0/dialog/oauth\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        loginHint,\n        additionalParams: options.configId ? {\n          config_id: options.configId\n        } : {}\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://graph.facebook.com/oauth/access_token\"\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      if (token.split(\".\").length === 3) {\n        try {\n          const { payload: jwtClaims } = await (0,jose__WEBPACK_IMPORTED_MODULE_23__.jwtVerify)(\n            token,\n            (0,jose__WEBPACK_IMPORTED_MODULE_28__.createRemoteJWKSet)(\n              // https://developers.facebook.com/docs/facebook-login/limited-login/token/#jwks\n              new URL(\n                \"https://limited.facebook.com/.well-known/oauth/openid/jwks/\"\n              )\n            ),\n            {\n              algorithms: [\"RS256\"],\n              audience: options.clientId,\n              issuer: \"https://www.facebook.com\"\n            }\n          );\n          if (nonce && jwtClaims.nonce !== nonce) {\n            return false;\n          }\n          return !!jwtClaims;\n        } catch (error) {\n          return false;\n        }\n      }\n      return true;\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://graph.facebook.com/v18.0/oauth/access_token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (token.idToken && token.idToken.split(\".\").length === 3) {\n        const profile2 = (0,jose__WEBPACK_IMPORTED_MODULE_26__.decodeJwt)(token.idToken);\n        const user = {\n          id: profile2.sub,\n          name: profile2.name,\n          email: profile2.email,\n          picture: {\n            data: {\n              url: profile2.picture,\n              height: 100,\n              width: 100,\n              is_silhouette: false\n            }\n          }\n        };\n        const userMap2 = await options.mapProfileToUser?.({\n          ...user,\n          email_verified: true\n        });\n        return {\n          user: {\n            ...user,\n            emailVerified: true,\n            ...userMap2\n          },\n          data: profile2\n        };\n      }\n      const fields = [\n        \"id\",\n        \"name\",\n        \"email\",\n        \"picture\",\n        ...options?.fields || []\n      ];\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        \"https://graph.facebook.com/me?fields=\" + fields.join(\",\"),\n        {\n          auth: {\n            type: \"Bearer\",\n            token: token.accessToken\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.name,\n          email: profile.email,\n          image: profile.picture.data.url,\n          emailVerified: profile.email_verified,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst figma = (options) => {\n  return {\n    id: \"figma\",\n    name: \"Figma\",\n    async createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      if (!options.clientId || !options.clientSecret) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\n          \"Client Id and Client Secret are required for Figma. Make sure to provide them in the options.\"\n        );\n        throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_22__.B(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      if (!codeVerifier) {\n        throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_22__.B(\"codeVerifier is required for Figma\");\n      }\n      const _scopes = options.disableDefaultScope ? [] : [\"file_read\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      const url = await createAuthorizationURL({\n        id: \"figma\",\n        options,\n        authorizationEndpoint: \"https://www.figma.com/oauth\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI\n      });\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://www.figma.com/api/oauth/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://www.figma.com/api/oauth/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      try {\n        const { data: profile } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n          \"https://api.figma.com/v1/me\",\n          {\n            headers: {\n              Authorization: `Bearer ${token.accessToken}`\n            }\n          }\n        );\n        if (!profile) {\n          _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\"Failed to fetch user from Figma\");\n          return null;\n        }\n        const userMap = await options.mapProfileToUser?.(profile);\n        return {\n          user: {\n            id: profile.id,\n            name: profile.handle,\n            email: profile.email,\n            image: profile.img_url,\n            emailVerified: !!profile.email,\n            ...userMap\n          },\n          data: profile\n        };\n      } catch (error) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\"Failed to fetch user info from Figma:\", error);\n        return null;\n      }\n    },\n    options\n  };\n};\n\nconst github = (options) => {\n  const tokenEndpoint = \"https://github.com/login/oauth/access_token\";\n  return {\n    id: \"github\",\n    name: \"GitHub\",\n    createAuthorizationURL({ state, scopes, loginHint, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"read:user\", \"user:email\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return createAuthorizationURL({\n        id: \"github\",\n        options,\n        authorizationEndpoint: \"https://github.com/login/oauth/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        loginHint,\n        prompt: options.prompt\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://github.com/login/oauth/access_token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        \"https://api.github.com/user\",\n        {\n          headers: {\n            \"User-Agent\": \"better-auth\",\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const { data: emails } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\"https://api.github.com/user/emails\", {\n        headers: {\n          Authorization: `Bearer ${token.accessToken}`,\n          \"User-Agent\": \"better-auth\"\n        }\n      });\n      if (!profile.email && emails) {\n        profile.email = (emails.find((e) => e.primary) ?? emails[0])?.email;\n      }\n      const emailVerified = emails?.find((e) => e.email === profile.email)?.verified ?? false;\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.name || profile.login,\n          email: profile.email,\n          image: profile.avatar_url,\n          emailVerified,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst google = (options) => {\n  return {\n    id: \"google\",\n    name: \"Google\",\n    async createAuthorizationURL({\n      state,\n      scopes,\n      codeVerifier,\n      redirectURI,\n      loginHint,\n      display\n    }) {\n      if (!options.clientId || !options.clientSecret) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\n          \"Client Id and Client Secret is required for Google. Make sure to provide them in the options.\"\n        );\n        throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_22__.B(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      if (!codeVerifier) {\n        throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_22__.B(\"codeVerifier is required for Google\");\n      }\n      const _scopes = options.disableDefaultScope ? [] : [\"email\", \"profile\", \"openid\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      const url = await createAuthorizationURL({\n        id: \"google\",\n        options,\n        authorizationEndpoint: \"https://accounts.google.com/o/oauth2/auth\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI,\n        prompt: options.prompt,\n        accessType: options.accessType,\n        display: display || options.display,\n        loginHint,\n        hd: options.hd,\n        additionalParams: {\n          include_granted_scopes: \"true\"\n        }\n      });\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://oauth2.googleapis.com/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://www.googleapis.com/oauth2/v4/token\"\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      const googlePublicKeyUrl = `https://www.googleapis.com/oauth2/v3/tokeninfo?id_token=${token}`;\n      const { data: tokenInfo } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(googlePublicKeyUrl);\n      if (!tokenInfo) {\n        return false;\n      }\n      const isValid = tokenInfo.aud === options.clientId && (tokenInfo.iss === \"https://accounts.google.com\" || tokenInfo.iss === \"accounts.google.com\");\n      return isValid;\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.idToken) {\n        return null;\n      }\n      const user = (0,jose__WEBPACK_IMPORTED_MODULE_26__.decodeJwt)(token.idToken);\n      const userMap = await options.mapProfileToUser?.(user);\n      return {\n        user: {\n          id: user.sub,\n          name: user.name,\n          email: user.email,\n          image: user.picture,\n          emailVerified: user.email_verified,\n          ...userMap\n        },\n        data: user\n      };\n    },\n    options\n  };\n};\n\nconst kick = (options) => {\n  return {\n    id: \"kick\",\n    name: \"Kick\",\n    createAuthorizationURL({ state, scopes, redirectURI, codeVerifier }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"user:read\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return createAuthorizationURL({\n        id: \"kick\",\n        redirectURI,\n        options,\n        authorizationEndpoint: \"https://id.kick.com/oauth/authorize\",\n        scopes: _scopes,\n        codeVerifier,\n        state\n      });\n    },\n    async validateAuthorizationCode({ code, redirectURI, codeVerifier }) {\n      return validateAuthorizationCode({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://id.kick.com/oauth/token\",\n        codeVerifier\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\"https://api.kick.com/public/v1/users\", {\n        method: \"GET\",\n        headers: {\n          Authorization: `Bearer ${token.accessToken}`\n        }\n      });\n      if (error) {\n        return null;\n      }\n      const profile = data.data[0];\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.user_id,\n          name: profile.name,\n          email: profile.email,\n          image: profile.profile_picture,\n          emailVerified: true,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst huggingface = (options) => {\n  return {\n    id: \"huggingface\",\n    name: \"Hugging Face\",\n    createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\", \"email\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return createAuthorizationURL({\n        id: \"huggingface\",\n        options,\n        authorizationEndpoint: \"https://huggingface.co/oauth/authorize\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://huggingface.co/oauth/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://huggingface.co/oauth/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        \"https://huggingface.co/oauth/userinfo\",\n        {\n          method: \"GET\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.sub,\n          name: profile.name || profile.preferred_username,\n          email: profile.email,\n          image: profile.picture,\n          emailVerified: profile.email_verified ?? false,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst microsoft = (options) => {\n  const tenant = options.tenantId || \"common\";\n  const authority = options.authority || \"https://login.microsoftonline.com\";\n  const authorizationEndpoint = `${authority}/${tenant}/oauth2/v2.0/authorize`;\n  const tokenEndpoint = `${authority}/${tenant}/oauth2/v2.0/token`;\n  return {\n    id: \"microsoft\",\n    name: \"Microsoft EntraID\",\n    createAuthorizationURL(data) {\n      const scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\", \"email\", \"User.Read\", \"offline_access\"];\n      options.scope && scopes.push(...options.scope);\n      data.scopes && scopes.push(...data.scopes);\n      return createAuthorizationURL({\n        id: \"microsoft\",\n        options,\n        authorizationEndpoint,\n        state: data.state,\n        codeVerifier: data.codeVerifier,\n        scopes,\n        redirectURI: data.redirectURI,\n        prompt: options.prompt,\n        loginHint: data.loginHint\n      });\n    },\n    validateAuthorizationCode({ code, codeVerifier, redirectURI }) {\n      return validateAuthorizationCode({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.idToken) {\n        return null;\n      }\n      const user = (0,jose__WEBPACK_IMPORTED_MODULE_26__.decodeJwt)(token.idToken);\n      const profilePhotoSize = options.profilePhotoSize || 48;\n      await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        `https://graph.microsoft.com/v1.0/me/photos/${profilePhotoSize}x${profilePhotoSize}/$value`,\n        {\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          },\n          async onResponse(context) {\n            if (options.disableProfilePhoto || !context.response.ok) {\n              return;\n            }\n            try {\n              const response = context.response.clone();\n              const pictureBuffer = await response.arrayBuffer();\n              const pictureBase64 = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__.base64.encode(pictureBuffer);\n              user.picture = `data:image/jpeg;base64, ${pictureBase64}`;\n            } catch (e) {\n              _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\n                e && typeof e === \"object\" && \"name\" in e ? e.name : \"\",\n                e\n              );\n            }\n          }\n        }\n      );\n      const userMap = await options.mapProfileToUser?.(user);\n      return {\n        user: {\n          id: user.sub,\n          name: user.name,\n          email: user.email,\n          image: user.picture,\n          emailVerified: true,\n          ...userMap\n        },\n        data: user\n      };\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      const scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\", \"email\", \"User.Read\", \"offline_access\"];\n      options.scope && scopes.push(...options.scope);\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientSecret: options.clientSecret\n        },\n        extraParams: {\n          scope: scopes.join(\" \")\n          // Include the scopes in request to microsoft\n        },\n        tokenEndpoint\n      });\n    },\n    options\n  };\n};\n\nconst slack = (options) => {\n  return {\n    id: \"slack\",\n    name: \"Slack\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\", \"email\"];\n      scopes && _scopes.push(...scopes);\n      options.scope && _scopes.push(...options.scope);\n      const url = new URL(\"https://slack.com/openid/connect/authorize\");\n      url.searchParams.set(\"scope\", _scopes.join(\" \"));\n      url.searchParams.set(\"response_type\", \"code\");\n      url.searchParams.set(\"client_id\", options.clientId);\n      url.searchParams.set(\"redirect_uri\", options.redirectURI || redirectURI);\n      url.searchParams.set(\"state\", state);\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://slack.com/api/openid.connect.token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://slack.com/api/openid.connect.token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        \"https://slack.com/api/openid.connect.userInfo\",\n        {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile[\"https://slack.com/user_id\"],\n          name: profile.name || \"\",\n          email: profile.email,\n          emailVerified: profile.email_verified,\n          image: profile.picture || profile[\"https://slack.com/user_image_512\"],\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst notion = (options) => {\n  const tokenEndpoint = \"https://api.notion.com/v1/oauth/token\";\n  return {\n    id: \"notion\",\n    name: \"Notion\",\n    createAuthorizationURL({ state, scopes, loginHint, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return createAuthorizationURL({\n        id: \"notion\",\n        options,\n        authorizationEndpoint: \"https://api.notion.com/v1/oauth/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        loginHint,\n        additionalParams: {\n          owner: \"user\"\n        }\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint,\n        authentication: \"basic\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\"https://api.notion.com/v1/users/me\", {\n        headers: {\n          Authorization: `Bearer ${token.accessToken}`,\n          \"Notion-Version\": \"2022-06-28\"\n        }\n      });\n      if (error || !profile) {\n        return null;\n      }\n      const userProfile = profile.bot?.owner?.user;\n      if (!userProfile) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(userProfile);\n      return {\n        user: {\n          id: userProfile.id,\n          name: userProfile.name || \"Notion User\",\n          email: userProfile.person?.email || null,\n          image: userProfile.avatar_url,\n          emailVerified: !!userProfile.person?.email,\n          ...userMap\n        },\n        data: userProfile\n      };\n    },\n    options\n  };\n};\n\nconst spotify = (options) => {\n  return {\n    id: \"spotify\",\n    name: \"Spotify\",\n    createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"user-read-email\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return createAuthorizationURL({\n        id: \"spotify\",\n        options,\n        authorizationEndpoint: \"https://accounts.spotify.com/authorize\",\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://accounts.spotify.com/api/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://accounts.spotify.com/api/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        \"https://api.spotify.com/v1/me\",\n        {\n          method: \"GET\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.display_name,\n          email: profile.email,\n          image: profile.images[0]?.url,\n          emailVerified: false,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst twitch = (options) => {\n  return {\n    id: \"twitch\",\n    name: \"Twitch\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"user:read:email\", \"openid\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return createAuthorizationURL({\n        id: \"twitch\",\n        redirectURI,\n        options,\n        authorizationEndpoint: \"https://id.twitch.tv/oauth2/authorize\",\n        scopes: _scopes,\n        state,\n        claims: options.claims || [\n          \"email\",\n          \"email_verified\",\n          \"preferred_username\",\n          \"picture\"\n        ]\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://id.twitch.tv/oauth2/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://id.twitch.tv/oauth2/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const idToken = token.idToken;\n      if (!idToken) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\"No idToken found in token\");\n        return null;\n      }\n      const profile = (0,jose__WEBPACK_IMPORTED_MODULE_26__.decodeJwt)(idToken);\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.sub,\n          name: profile.preferred_username,\n          email: profile.email,\n          image: profile.picture,\n          emailVerified: profile.email_verified,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst twitter = (options) => {\n  return {\n    id: \"twitter\",\n    name: \"Twitter\",\n    createAuthorizationURL(data) {\n      const _scopes = options.disableDefaultScope ? [] : [\"users.read\", \"tweet.read\", \"offline.access\", \"users.email\"];\n      options.scope && _scopes.push(...options.scope);\n      data.scopes && _scopes.push(...data.scopes);\n      return createAuthorizationURL({\n        id: \"twitter\",\n        options,\n        authorizationEndpoint: \"https://x.com/i/oauth2/authorize\",\n        scopes: _scopes,\n        state: data.state,\n        codeVerifier: data.codeVerifier,\n        redirectURI: data.redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        codeVerifier,\n        authentication: \"basic\",\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://api.x.com/2/oauth2/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        authentication: \"basic\",\n        tokenEndpoint: \"https://api.x.com/2/oauth2/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error: profileError } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        \"https://api.x.com/2/users/me?user.fields=profile_image_url\",\n        {\n          method: \"GET\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (profileError) {\n        return null;\n      }\n      const { data: emailData, error: emailError } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\"https://api.x.com/2/users/me?user.fields=confirmed_email\", {\n        method: \"GET\",\n        headers: {\n          Authorization: `Bearer ${token.accessToken}`\n        }\n      });\n      let emailVerified = false;\n      if (!emailError && emailData?.data?.confirmed_email) {\n        profile.data.email = emailData.data.confirmed_email;\n        emailVerified = true;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.data.id,\n          name: profile.data.name,\n          email: profile.data.email || profile.data.username || null,\n          image: profile.data.profile_image_url,\n          emailVerified,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst dropbox = (options) => {\n  const tokenEndpoint = \"https://api.dropboxapi.com/oauth2/token\";\n  return {\n    id: \"dropbox\",\n    name: \"Dropbox\",\n    createAuthorizationURL: async ({\n      state,\n      scopes,\n      codeVerifier,\n      redirectURI\n    }) => {\n      const _scopes = options.disableDefaultScope ? [] : [\"account_info.read\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      const additionalParams = {};\n      if (options.accessType) {\n        additionalParams.token_access_type = options.accessType;\n      }\n      return await createAuthorizationURL({\n        id: \"dropbox\",\n        options,\n        authorizationEndpoint: \"https://www.dropbox.com/oauth2/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        codeVerifier,\n        additionalParams\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return await validateAuthorizationCode({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://api.dropbox.com/oauth2/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        \"https://api.dropboxapi.com/2/users/get_current_account\",\n        {\n          method: \"POST\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.account_id,\n          name: profile.name?.display_name,\n          email: profile.email,\n          emailVerified: profile.email_verified || false,\n          image: profile.profile_photo_url,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst linear = (options) => {\n  const tokenEndpoint = \"https://api.linear.app/oauth/token\";\n  return {\n    id: \"linear\",\n    name: \"Linear\",\n    createAuthorizationURL({ state, scopes, loginHint, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"read\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return createAuthorizationURL({\n        id: \"linear\",\n        options,\n        authorizationEndpoint: \"https://linear.app/oauth/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        loginHint\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        \"https://api.linear.app/graphql\",\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/json\",\n            Authorization: `Bearer ${token.accessToken}`\n          },\n          body: JSON.stringify({\n            query: `\n\t\t\t\t\t\t\tquery {\n\t\t\t\t\t\t\t\tviewer {\n\t\t\t\t\t\t\t\t\tid\n\t\t\t\t\t\t\t\t\tname\n\t\t\t\t\t\t\t\t\temail\n\t\t\t\t\t\t\t\t\tavatarUrl\n\t\t\t\t\t\t\t\t\tactive\n\t\t\t\t\t\t\t\t\tcreatedAt\n\t\t\t\t\t\t\t\t\tupdatedAt\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t`\n          })\n        }\n      );\n      if (error || !profile?.data?.viewer) {\n        return null;\n      }\n      const userData = profile.data.viewer;\n      const userMap = await options.mapProfileToUser?.(userData);\n      return {\n        user: {\n          id: profile.data.viewer.id,\n          name: profile.data.viewer.name,\n          email: profile.data.viewer.email,\n          image: profile.data.viewer.avatarUrl,\n          emailVerified: true,\n          ...userMap\n        },\n        data: userData\n      };\n    },\n    options\n  };\n};\n\nconst linkedin = (options) => {\n  const authorizationEndpoint = \"https://www.linkedin.com/oauth/v2/authorization\";\n  const tokenEndpoint = \"https://www.linkedin.com/oauth/v2/accessToken\";\n  return {\n    id: \"linkedin\",\n    name: \"Linkedin\",\n    createAuthorizationURL: async ({\n      state,\n      scopes,\n      redirectURI,\n      loginHint\n    }) => {\n      const _scopes = options.disableDefaultScope ? [] : [\"profile\", \"email\", \"openid\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return await createAuthorizationURL({\n        id: \"linkedin\",\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        loginHint,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return await validateAuthorizationCode({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        \"https://api.linkedin.com/v2/userinfo\",\n        {\n          method: \"GET\",\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.sub,\n          name: profile.name,\n          email: profile.email,\n          emailVerified: profile.email_verified || false,\n          image: profile.picture,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst cleanDoubleSlashes = (input = \"\") => {\n  return input.split(\"://\").map((str) => str.replace(/\\/{2,}/g, \"/\")).join(\"://\");\n};\nconst issuerToEndpoints = (issuer) => {\n  let baseUrl = issuer || \"https://gitlab.com\";\n  return {\n    authorizationEndpoint: cleanDoubleSlashes(`${baseUrl}/oauth/authorize`),\n    tokenEndpoint: cleanDoubleSlashes(`${baseUrl}/oauth/token`),\n    userinfoEndpoint: cleanDoubleSlashes(`${baseUrl}/api/v4/user`)\n  };\n};\nconst gitlab = (options) => {\n  const { authorizationEndpoint, tokenEndpoint, userinfoEndpoint } = issuerToEndpoints(options.issuer);\n  const issuerId = \"gitlab\";\n  const issuerName = \"Gitlab\";\n  return {\n    id: issuerId,\n    name: issuerName,\n    createAuthorizationURL: async ({\n      state,\n      scopes,\n      codeVerifier,\n      loginHint,\n      redirectURI\n    }) => {\n      const _scopes = options.disableDefaultScope ? [] : [\"read_user\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return await createAuthorizationURL({\n        id: issuerId,\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        redirectURI,\n        codeVerifier,\n        loginHint\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI, codeVerifier }) => {\n      return validateAuthorizationCode({\n        code,\n        redirectURI,\n        options,\n        codeVerifier,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://gitlab.com/oauth/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        userinfoEndpoint,\n        { headers: { authorization: `Bearer ${token.accessToken}` } }\n      );\n      if (error || profile.state !== \"active\" || profile.locked) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.name ?? profile.username,\n          email: profile.email,\n          image: profile.avatar_url,\n          emailVerified: true,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst tiktok = (options) => {\n  return {\n    id: \"tiktok\",\n    name: \"TikTok\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"user.info.profile\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return new URL(\n        `https://www.tiktok.com/v2/auth/authorize?scope=${_scopes.join(\n          \",\"\n        )}&response_type=code&client_key=${options.clientKey}&client_secret=${options.clientSecret}&redirect_uri=${encodeURIComponent(\n          options.redirectURI || redirectURI\n        )}&state=${state}`\n      );\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        redirectURI: options.redirectURI || redirectURI,\n        options: {\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://open.tiktokapis.com/v2/oauth/token/\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://open.tiktokapis.com/v2/oauth/token/\",\n        authentication: \"post\",\n        extraParams: {\n          client_key: options.clientKey\n        }\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const fields = [\n        \"open_id\",\n        \"avatar_large_url\",\n        \"display_name\",\n        \"username\"\n      ];\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        `https://open.tiktokapis.com/v2/user/info/?fields=${fields.join(\",\")}`,\n        {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      return {\n        user: {\n          email: profile.data.user.email || profile.data.user.username,\n          id: profile.data.user.open_id,\n          name: profile.data.user.display_name || profile.data.user.username,\n          image: profile.data.user.avatar_large_url,\n          /** @note Tiktok does not provide emailVerified or even email*/\n          emailVerified: profile.data.user.email ? true : false\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst reddit = (options) => {\n  return {\n    id: \"reddit\",\n    name: \"Reddit\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"identity\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return createAuthorizationURL({\n        id: \"reddit\",\n        options,\n        authorizationEndpoint: \"https://www.reddit.com/api/v1/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI,\n        duration: options.duration\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      const body = new URLSearchParams({\n        grant_type: \"authorization_code\",\n        code,\n        redirect_uri: options.redirectURI || redirectURI\n      });\n      const headers = {\n        \"content-type\": \"application/x-www-form-urlencoded\",\n        accept: \"text/plain\",\n        \"user-agent\": \"better-auth\",\n        Authorization: `Basic ${_better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__.base64.encode(\n          `${options.clientId}:${options.clientSecret}`\n        )}`\n      };\n      const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        \"https://www.reddit.com/api/v1/access_token\",\n        {\n          method: \"POST\",\n          headers,\n          body: body.toString()\n        }\n      );\n      if (error) {\n        throw error;\n      }\n      return getOAuth2Tokens(data);\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        authentication: \"basic\",\n        tokenEndpoint: \"https://www.reddit.com/api/v1/access_token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        \"https://oauth.reddit.com/api/v1/me\",\n        {\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`,\n            \"User-Agent\": \"better-auth\"\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.name,\n          email: profile.oauth_client_id,\n          emailVerified: profile.has_verified_email,\n          image: profile.icon_img?.split(\"?\")[0],\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst roblox = (options) => {\n  return {\n    id: \"roblox\",\n    name: \"Roblox\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return new URL(\n        `https://apis.roblox.com/oauth/v1/authorize?scope=${_scopes.join(\n          \"+\"\n        )}&response_type=code&client_id=${options.clientId}&redirect_uri=${encodeURIComponent(\n          options.redirectURI || redirectURI\n        )}&state=${state}&prompt=${options.prompt || \"select_account consent\"}`\n      );\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        redirectURI: options.redirectURI || redirectURI,\n        options,\n        tokenEndpoint: \"https://apis.roblox.com/oauth/v1/token\",\n        authentication: \"post\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://apis.roblox.com/oauth/v1/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        \"https://apis.roblox.com/oauth/v1/userinfo\",\n        {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.sub,\n          name: profile.nickname || profile.preferred_username || \"\",\n          image: profile.picture,\n          email: profile.preferred_username || null,\n          // Roblox does not provide email\n          emailVerified: true,\n          ...userMap\n        },\n        data: {\n          ...profile\n        }\n      };\n    },\n    options\n  };\n};\n\nconst salesforce = (options) => {\n  const environment = options.environment ?? \"production\";\n  const isSandbox = environment === \"sandbox\";\n  const authorizationEndpoint = options.loginUrl ? `https://${options.loginUrl}/services/oauth2/authorize` : isSandbox ? \"https://test.salesforce.com/services/oauth2/authorize\" : \"https://login.salesforce.com/services/oauth2/authorize\";\n  const tokenEndpoint = options.loginUrl ? `https://${options.loginUrl}/services/oauth2/token` : isSandbox ? \"https://test.salesforce.com/services/oauth2/token\" : \"https://login.salesforce.com/services/oauth2/token\";\n  const userInfoEndpoint = options.loginUrl ? `https://${options.loginUrl}/services/oauth2/userinfo` : isSandbox ? \"https://test.salesforce.com/services/oauth2/userinfo\" : \"https://login.salesforce.com/services/oauth2/userinfo\";\n  return {\n    id: \"salesforce\",\n    name: \"Salesforce\",\n    async createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      if (!options.clientId || !options.clientSecret) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\n          \"Client Id and Client Secret are required for Salesforce. Make sure to provide them in the options.\"\n        );\n        throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_22__.B(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      if (!codeVerifier) {\n        throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_22__.B(\"codeVerifier is required for Salesforce\");\n      }\n      const _scopes = options.disableDefaultScope ? [] : [\"openid\", \"email\", \"profile\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return createAuthorizationURL({\n        id: \"salesforce\",\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI: options.redirectURI || redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        codeVerifier,\n        redirectURI: options.redirectURI || redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      try {\n        const { data: user } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n          userInfoEndpoint,\n          {\n            headers: {\n              Authorization: `Bearer ${token.accessToken}`\n            }\n          }\n        );\n        if (!user) {\n          _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\"Failed to fetch user info from Salesforce\");\n          return null;\n        }\n        const userMap = await options.mapProfileToUser?.(user);\n        return {\n          user: {\n            id: user.user_id,\n            name: user.name,\n            email: user.email,\n            image: user.photos?.picture || user.photos?.thumbnail,\n            emailVerified: user.email_verified ?? false,\n            ...userMap\n          },\n          data: user\n        };\n      } catch (error) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\"Failed to fetch user info from Salesforce:\", error);\n        return null;\n      }\n    },\n    options\n  };\n};\n\nconst vk = (options) => {\n  return {\n    id: \"vk\",\n    name: \"VK\",\n    async createAuthorizationURL({ state, scopes, codeVerifier, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"email\", \"phone\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      const authorizationEndpoint = \"https://id.vk.com/authorize\";\n      return createAuthorizationURL({\n        id: \"vk\",\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        redirectURI,\n        codeVerifier\n      });\n    },\n    validateAuthorizationCode: async ({\n      code,\n      codeVerifier,\n      redirectURI,\n      deviceId\n    }) => {\n      return validateAuthorizationCode({\n        code,\n        codeVerifier,\n        redirectURI: options.redirectURI || redirectURI,\n        options,\n        deviceId,\n        tokenEndpoint: \"https://id.vk.com/oauth2/auth\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://id.vk.com/oauth2/auth\"\n      });\n    },\n    async getUserInfo(data) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(data);\n      }\n      if (!data.accessToken) {\n        return null;\n      }\n      const formBody = new URLSearchParams({\n        access_token: data.accessToken,\n        client_id: options.clientId\n      }).toString();\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        \"https://id.vk.com/oauth2/user_info\",\n        {\n          method: \"POST\",\n          headers: {\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n          },\n          body: formBody\n        }\n      );\n      if (error) {\n        return null;\n      }\n      if (!profile.user.email) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.user.user_id,\n          first_name: profile.user.first_name,\n          last_name: profile.user.last_name,\n          email: profile.user.email,\n          image: profile.user.avatar,\n          /** @note VK does not provide emailVerified*/\n          emailVerified: !!profile.user.email,\n          birthday: profile.user.birthday,\n          sex: profile.user.sex,\n          name: `${profile.user.first_name} ${profile.user.last_name}`,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst zoom = (userOptions) => {\n  const options = {\n    pkce: true,\n    ...userOptions\n  };\n  return {\n    id: \"zoom\",\n    name: \"Zoom\",\n    createAuthorizationURL: async ({ state, redirectURI, codeVerifier }) => {\n      const params = new URLSearchParams({\n        response_type: \"code\",\n        redirect_uri: options.redirectURI ? options.redirectURI : redirectURI,\n        client_id: options.clientId,\n        state\n      });\n      if (options.pkce) {\n        const codeChallenge = await generateCodeChallenge(codeVerifier);\n        params.set(\"code_challenge_method\", \"S256\");\n        params.set(\"code_challenge\", codeChallenge);\n      }\n      const url = new URL(\"https://zoom.us/oauth/authorize\");\n      url.search = params.toString();\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, redirectURI, codeVerifier }) => {\n      return validateAuthorizationCode({\n        code,\n        redirectURI: options.redirectURI || redirectURI,\n        codeVerifier,\n        options,\n        tokenEndpoint: \"https://zoom.us/oauth/token\",\n        authentication: \"post\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        \"https://api.zoom.us/v2/users/me\",\n        {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      return {\n        user: {\n          id: profile.id,\n          name: profile.display_name,\n          image: profile.pic_url,\n          email: profile.email,\n          emailVerified: Boolean(profile.verified),\n          ...userMap\n        },\n        data: {\n          ...profile\n        }\n      };\n    }\n  };\n};\n\nconst kakao = (options) => {\n  return {\n    id: \"kakao\",\n    name: \"Kakao\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"account_email\", \"profile_image\", \"profile_nickname\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return createAuthorizationURL({\n        id: \"kakao\",\n        options,\n        authorizationEndpoint: \"https://kauth.kakao.com/oauth/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://kauth.kakao.com/oauth/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://kauth.kakao.com/oauth/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        \"https://kapi.kakao.com/v2/user/me\",\n        {\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error || !profile) {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      const account = profile.kakao_account || {};\n      const kakaoProfile = account.profile || {};\n      const user = {\n        id: String(profile.id),\n        name: kakaoProfile.nickname || account.name || void 0,\n        email: account.email,\n        image: kakaoProfile.profile_image_url || kakaoProfile.thumbnail_image_url,\n        emailVerified: !!account.is_email_valid && !!account.is_email_verified,\n        ...userMap\n      };\n      return {\n        user,\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst naver = (options) => {\n  return {\n    id: \"naver\",\n    name: \"Naver\",\n    createAuthorizationURL({ state, scopes, redirectURI }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"profile\", \"email\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return createAuthorizationURL({\n        id: \"naver\",\n        options,\n        authorizationEndpoint: \"https://nid.naver.com/oauth2.0/authorize\",\n        scopes: _scopes,\n        state,\n        redirectURI\n      });\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        redirectURI,\n        options,\n        tokenEndpoint: \"https://nid.naver.com/oauth2.0/token\"\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientKey: options.clientKey,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint: \"https://nid.naver.com/oauth2.0/token\"\n      });\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      const { data: profile, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        \"https://openapi.naver.com/v1/nid/me\",\n        {\n          headers: {\n            Authorization: `Bearer ${token.accessToken}`\n          }\n        }\n      );\n      if (error || !profile || profile.resultcode !== \"00\") {\n        return null;\n      }\n      const userMap = await options.mapProfileToUser?.(profile);\n      const res = profile.response || {};\n      const user = {\n        id: res.id,\n        name: res.name || res.nickname,\n        email: res.email,\n        image: res.profile_image,\n        emailVerified: false,\n        ...userMap\n      };\n      return {\n        user,\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst line = (options) => {\n  const authorizationEndpoint = \"https://access.line.me/oauth2/v2.1/authorize\";\n  const tokenEndpoint = \"https://api.line.me/oauth2/v2.1/token\";\n  const userInfoEndpoint = \"https://api.line.me/oauth2/v2.1/userinfo\";\n  const verifyIdTokenEndpoint = \"https://api.line.me/oauth2/v2.1/verify\";\n  return {\n    id: \"line\",\n    name: \"LINE\",\n    async createAuthorizationURL({\n      state,\n      scopes,\n      codeVerifier,\n      redirectURI,\n      loginHint\n    }) {\n      const _scopes = options.disableDefaultScope ? [] : [\"openid\", \"profile\", \"email\"];\n      options.scope && _scopes.push(...options.scope);\n      scopes && _scopes.push(...scopes);\n      return await createAuthorizationURL({\n        id: \"line\",\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI,\n        loginHint\n      });\n    },\n    validateAuthorizationCode: async ({ code, codeVerifier, redirectURI }) => {\n      return validateAuthorizationCode({\n        code,\n        codeVerifier,\n        redirectURI,\n        options,\n        tokenEndpoint\n      });\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      return refreshAccessToken({\n        refreshToken,\n        options: {\n          clientId: options.clientId,\n          clientSecret: options.clientSecret\n        },\n        tokenEndpoint\n      });\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      const body = new URLSearchParams();\n      body.set(\"id_token\", token);\n      body.set(\"client_id\", options.clientId);\n      if (nonce) body.set(\"nonce\", nonce);\n      const { data, error } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n        verifyIdTokenEndpoint,\n        {\n          method: \"POST\",\n          headers: {\n            \"content-type\": \"application/x-www-form-urlencoded\"\n          },\n          body\n        }\n      );\n      if (error || !data) {\n        return false;\n      }\n      if (data.aud !== options.clientId) return false;\n      if (nonce && data.nonce && data.nonce !== nonce) return false;\n      return true;\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      let profile = null;\n      if (token.idToken) {\n        try {\n          profile = (0,jose__WEBPACK_IMPORTED_MODULE_26__.decodeJwt)(token.idToken);\n        } catch {\n        }\n      }\n      if (!profile) {\n        const { data } = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(userInfoEndpoint, {\n          headers: {\n            authorization: `Bearer ${token.accessToken}`\n          }\n        });\n        profile = data || null;\n      }\n      if (!profile) return null;\n      const userMap = await options.mapProfileToUser?.(profile);\n      const id = profile.sub || profile.userId;\n      const name = profile.name || profile.displayName;\n      const image = profile.picture || profile.pictureUrl || void 0;\n      const email = profile.email;\n      return {\n        user: {\n          id,\n          name,\n          email,\n          image,\n          // LINE does not expose email verification status in ID token/userinfo\n          emailVerified: false,\n          ...userMap\n        },\n        data: profile\n      };\n    },\n    options\n  };\n};\n\nconst paypal = (options) => {\n  const environment = options.environment || \"sandbox\";\n  const isSandbox = environment === \"sandbox\";\n  const authorizationEndpoint = isSandbox ? \"https://www.sandbox.paypal.com/signin/authorize\" : \"https://www.paypal.com/signin/authorize\";\n  const tokenEndpoint = isSandbox ? \"https://api-m.sandbox.paypal.com/v1/oauth2/token\" : \"https://api-m.paypal.com/v1/oauth2/token\";\n  const userInfoEndpoint = isSandbox ? \"https://api-m.sandbox.paypal.com/v1/identity/oauth2/userinfo\" : \"https://api-m.paypal.com/v1/identity/oauth2/userinfo\";\n  return {\n    id: \"paypal\",\n    name: \"PayPal\",\n    async createAuthorizationURL({ state, codeVerifier, redirectURI }) {\n      if (!options.clientId || !options.clientSecret) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\n          \"Client Id and Client Secret is required for PayPal. Make sure to provide them in the options.\"\n        );\n        throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_22__.B(\"CLIENT_ID_AND_SECRET_REQUIRED\");\n      }\n      const _scopes = [];\n      const url = await createAuthorizationURL({\n        id: \"paypal\",\n        options,\n        authorizationEndpoint,\n        scopes: _scopes,\n        state,\n        codeVerifier,\n        redirectURI,\n        prompt: options.prompt\n      });\n      return url;\n    },\n    validateAuthorizationCode: async ({ code, redirectURI }) => {\n      const credentials = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__.base64.encode(\n        `${options.clientId}:${options.clientSecret}`\n      );\n      try {\n        const response = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(tokenEndpoint, {\n          method: \"POST\",\n          headers: {\n            Authorization: `Basic ${credentials}`,\n            Accept: \"application/json\",\n            \"Accept-Language\": \"en_US\",\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n          },\n          body: new URLSearchParams({\n            grant_type: \"authorization_code\",\n            code,\n            redirect_uri: redirectURI\n          }).toString()\n        });\n        if (!response.data) {\n          throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_22__.B(\"FAILED_TO_GET_ACCESS_TOKEN\");\n        }\n        const data = response.data;\n        const result = {\n          accessToken: data.access_token,\n          refreshToken: data.refresh_token,\n          accessTokenExpiresAt: data.expires_in ? new Date(Date.now() + data.expires_in * 1e3) : void 0,\n          idToken: data.id_token\n        };\n        return result;\n      } catch (error) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\"PayPal token exchange failed:\", error);\n        throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_22__.B(\"FAILED_TO_GET_ACCESS_TOKEN\");\n      }\n    },\n    refreshAccessToken: options.refreshAccessToken ? options.refreshAccessToken : async (refreshToken) => {\n      const credentials = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_5__.base64.encode(\n        `${options.clientId}:${options.clientSecret}`\n      );\n      try {\n        const response = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(tokenEndpoint, {\n          method: \"POST\",\n          headers: {\n            Authorization: `Basic ${credentials}`,\n            Accept: \"application/json\",\n            \"Accept-Language\": \"en_US\",\n            \"Content-Type\": \"application/x-www-form-urlencoded\"\n          },\n          body: new URLSearchParams({\n            grant_type: \"refresh_token\",\n            refresh_token: refreshToken\n          }).toString()\n        });\n        if (!response.data) {\n          throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_22__.B(\"FAILED_TO_REFRESH_ACCESS_TOKEN\");\n        }\n        const data = response.data;\n        return {\n          accessToken: data.access_token,\n          refreshToken: data.refresh_token,\n          accessTokenExpiresAt: data.expires_in ? new Date(Date.now() + data.expires_in * 1e3) : void 0\n        };\n      } catch (error) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\"PayPal token refresh failed:\", error);\n        throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_22__.B(\"FAILED_TO_REFRESH_ACCESS_TOKEN\");\n      }\n    },\n    async verifyIdToken(token, nonce) {\n      if (options.disableIdTokenSignIn) {\n        return false;\n      }\n      if (options.verifyIdToken) {\n        return options.verifyIdToken(token, nonce);\n      }\n      try {\n        const payload = (0,jose__WEBPACK_IMPORTED_MODULE_26__.decodeJwt)(token);\n        return !!payload.sub;\n      } catch (error) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\"Failed to verify PayPal ID token:\", error);\n        return false;\n      }\n    },\n    async getUserInfo(token) {\n      if (options.getUserInfo) {\n        return options.getUserInfo(token);\n      }\n      if (!token.accessToken) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\"Access token is required to fetch PayPal user info\");\n        return null;\n      }\n      try {\n        const response = await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_7__.betterFetch)(\n          `${userInfoEndpoint}?schema=paypalv1.1`,\n          {\n            headers: {\n              Authorization: `Bearer ${token.accessToken}`,\n              Accept: \"application/json\"\n            }\n          }\n        );\n        if (!response.data) {\n          _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\"Failed to fetch user info from PayPal\");\n          return null;\n        }\n        const userInfo = response.data;\n        const userMap = await options.mapProfileToUser?.(userInfo);\n        const result = {\n          user: {\n            id: userInfo.user_id,\n            name: userInfo.name,\n            email: userInfo.email,\n            image: userInfo.picture,\n            emailVerified: userInfo.email_verified,\n            ...userMap\n          },\n          data: userInfo\n        };\n        return result;\n      } catch (error) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.a.error(\"Failed to fetch user info from PayPal:\", error);\n        return null;\n      }\n    },\n    options\n  };\n};\n\nconst socialProviders = {\n  apple,\n  atlassian,\n  cognito,\n  discord,\n  facebook,\n  figma,\n  github,\n  microsoft,\n  google,\n  huggingface,\n  slack,\n  spotify,\n  twitch,\n  twitter,\n  dropbox,\n  kick,\n  linear,\n  linkedin,\n  gitlab,\n  tiktok,\n  reddit,\n  roblox,\n  salesforce,\n  vk,\n  zoom,\n  notion,\n  kakao,\n  naver,\n  line,\n  paypal\n};\nconst socialProviderList = Object.keys(socialProviders);\nconst SocialProviderListEnum = zod_v4__WEBPACK_IMPORTED_MODULE_0__[\"enum\"](socialProviderList).or(zod_v4__WEBPACK_IMPORTED_MODULE_0__.string());\n\nconst signInSocial = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/sign-in/social\",\n  {\n    method: \"POST\",\n    body: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      /**\n       * Callback URL to redirect to after the user\n       * has signed in.\n       */\n      callbackURL: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"Callback URL to redirect to after the user has signed in\"\n      }).optional(),\n      /**\n       * callback url to redirect if the user is newly registered.\n       *\n       * useful if you have different routes for existing users and new users\n       */\n      newUserCallbackURL: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n      /**\n       * Callback url to redirect to if an error happens\n       *\n       * If it's initiated from the client sdk this defaults to\n       * the current url.\n       */\n      errorCallbackURL: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"Callback URL to redirect to if an error happens\"\n      }).optional(),\n      /**\n       * OAuth2 provider to use`\n       */\n      provider: SocialProviderListEnum,\n      /**\n       * Disable automatic redirection to the provider\n       *\n       * This is useful if you want to handle the redirection\n       * yourself like in a popup or a different tab.\n       */\n      disableRedirect: zod_v4__WEBPACK_IMPORTED_MODULE_0__.boolean().meta({\n        description: \"Disable automatic redirection to the provider. Useful for handling the redirection yourself\"\n      }).optional(),\n      /**\n       * ID token from the provider\n       *\n       * This is used to sign in the user\n       * if the user is already signed in with the\n       * provider in the frontend.\n       *\n       * Only applicable if the provider supports\n       * it. Currently only `apple` and `google` is\n       * supported out of the box.\n       */\n      idToken: zod_v4__WEBPACK_IMPORTED_MODULE_0__.optional(\n        zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n          /**\n           * ID token from the provider\n           */\n          token: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n            description: \"ID token from the provider\"\n          }),\n          /**\n           * The nonce used to generate the token\n           */\n          nonce: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n            description: \"Nonce used to generate the token\"\n          }).optional(),\n          /**\n           * Access token from the provider\n           */\n          accessToken: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n            description: \"Access token from the provider\"\n          }).optional(),\n          /**\n           * Refresh token from the provider\n           */\n          refreshToken: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n            description: \"Refresh token from the provider\"\n          }).optional(),\n          /**\n           * Expiry date of the token\n           */\n          expiresAt: zod_v4__WEBPACK_IMPORTED_MODULE_0__.number().meta({\n            description: \"Expiry date of the token\"\n          }).optional()\n        })\n      ),\n      scopes: zod_v4__WEBPACK_IMPORTED_MODULE_0__.array(zod_v4__WEBPACK_IMPORTED_MODULE_0__.string()).meta({\n        description: \"Array of scopes to request from the provider. This will override the default scopes passed.\"\n      }).optional(),\n      /**\n       * Explicitly request sign-up\n       *\n       * Should be used to allow sign up when\n       * disableImplicitSignUp for this provider is\n       * true\n       */\n      requestSignUp: zod_v4__WEBPACK_IMPORTED_MODULE_0__.boolean().meta({\n        description: \"Explicitly request sign-up. Useful when disableImplicitSignUp is true for this provider\"\n      }).optional(),\n      /**\n       * The login hint to use for the authorization code request\n       */\n      loginHint: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The login hint to use for the authorization code request\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Sign in with a social provider\",\n        operationId: \"socialSignIn\",\n        responses: {\n          \"200\": {\n            description: \"Success - Returns either session details or redirect URL\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  // todo: we need support for multiple schema\n                  type: \"object\",\n                  description: \"Session response when idToken is provided\",\n                  properties: {\n                    redirect: {\n                      type: \"boolean\",\n                      enum: [false]\n                    },\n                    token: {\n                      type: \"string\",\n                      description: \"Session token\",\n                      url: {\n                        type: \"null\",\n                        nullable: true\n                      },\n                      user: {\n                        type: \"object\",\n                        properties: {\n                          id: { type: \"string\" },\n                          email: { type: \"string\" },\n                          name: {\n                            type: \"string\",\n                            nullable: true\n                          },\n                          image: {\n                            type: \"string\",\n                            nullable: true\n                          },\n                          emailVerified: {\n                            type: \"boolean\"\n                          },\n                          createdAt: {\n                            type: \"string\",\n                            format: \"date-time\"\n                          },\n                          updatedAt: {\n                            type: \"string\",\n                            format: \"date-time\"\n                          }\n                        },\n                        required: [\n                          \"id\",\n                          \"email\",\n                          \"emailVerified\",\n                          \"createdAt\",\n                          \"updatedAt\"\n                        ]\n                      }\n                    }\n                  },\n                  required: [\"redirect\", \"token\", \"user\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const provider = c.context.socialProviders.find(\n      (p) => p.id === c.body.provider\n    );\n    if (!provider) {\n      c.context.logger.error(\n        \"Provider not found. Make sure to add the provider in your auth config\",\n        {\n          provider: c.body.provider\n        }\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"NOT_FOUND\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.PROVIDER_NOT_FOUND\n      });\n    }\n    if (c.body.idToken) {\n      if (!provider.verifyIdToken) {\n        c.context.logger.error(\n          \"Provider does not support id token verification\",\n          {\n            provider: c.body.provider\n          }\n        );\n        throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"NOT_FOUND\", {\n          message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.ID_TOKEN_NOT_SUPPORTED\n        });\n      }\n      const { token, nonce } = c.body.idToken;\n      const valid = await provider.verifyIdToken(token, nonce);\n      if (!valid) {\n        c.context.logger.error(\"Invalid id token\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"UNAUTHORIZED\", {\n          message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.INVALID_TOKEN\n        });\n      }\n      const userInfo = await provider.getUserInfo({\n        idToken: token,\n        accessToken: c.body.idToken.accessToken,\n        refreshToken: c.body.idToken.refreshToken\n      });\n      if (!userInfo || !userInfo?.user) {\n        c.context.logger.error(\"Failed to get user info\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"UNAUTHORIZED\", {\n          message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.FAILED_TO_GET_USER_INFO\n        });\n      }\n      if (!userInfo.user.email) {\n        c.context.logger.error(\"User email not found\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"UNAUTHORIZED\", {\n          message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.USER_EMAIL_NOT_FOUND\n        });\n      }\n      const data = await handleOAuthUserInfo(c, {\n        userInfo: {\n          ...userInfo.user,\n          email: userInfo.user.email,\n          id: String(userInfo.user.id),\n          name: userInfo.user.name || \"\",\n          image: userInfo.user.image,\n          emailVerified: userInfo.user.emailVerified || false\n        },\n        account: {\n          providerId: provider.id,\n          accountId: String(userInfo.user.id),\n          accessToken: c.body.idToken.accessToken\n        },\n        callbackURL: c.body.callbackURL,\n        disableSignUp: provider.disableImplicitSignUp && !c.body.requestSignUp || provider.disableSignUp\n      });\n      if (data.error) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"UNAUTHORIZED\", {\n          message: data.error\n        });\n      }\n      await (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_12__.s)(c, data.data);\n      return c.json({\n        redirect: false,\n        token: data.data.session.token,\n        url: void 0,\n        user: {\n          id: data.data.user.id,\n          email: data.data.user.email,\n          name: data.data.user.name,\n          image: data.data.user.image,\n          emailVerified: data.data.user.emailVerified,\n          createdAt: data.data.user.createdAt,\n          updatedAt: data.data.user.updatedAt\n        }\n      });\n    }\n    const { codeVerifier, state } = await generateState(c);\n    const url = await provider.createAuthorizationURL({\n      state,\n      codeVerifier,\n      redirectURI: `${c.context.baseURL}/callback/${provider.id}`,\n      scopes: c.body.scopes,\n      loginHint: c.body.loginHint\n    });\n    return c.json({\n      url: url.toString(),\n      redirect: !c.body.disableRedirect\n    });\n  }\n);\nconst signInEmail = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/sign-in/email\",\n  {\n    method: \"POST\",\n    body: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      /**\n       * Email of the user\n       */\n      email: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"Email of the user\"\n      }),\n      /**\n       * Password of the user\n       */\n      password: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"Password of the user\"\n      }),\n      /**\n       * Callback URL to use as a redirect for email\n       * verification and for possible redirects\n       */\n      callbackURL: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"Callback URL to use as a redirect for email verification\"\n      }).optional(),\n      /**\n       * If this is false, the session will not be remembered\n       * @default true\n       */\n      rememberMe: zod_v4__WEBPACK_IMPORTED_MODULE_0__.boolean().meta({\n        description: \"If this is false, the session will not be remembered. Default is `true`.\"\n      }).default(true).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Sign in with email and password\",\n        responses: {\n          \"200\": {\n            description: \"Success - Returns either session details or redirect URL\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  // todo: we need support for multiple schema\n                  type: \"object\",\n                  description: \"Session response when idToken is provided\",\n                  properties: {\n                    redirect: {\n                      type: \"boolean\",\n                      enum: [false]\n                    },\n                    token: {\n                      type: \"string\",\n                      description: \"Session token\"\n                    },\n                    url: {\n                      type: \"null\",\n                      nullable: true\n                    },\n                    user: {\n                      type: \"object\",\n                      properties: {\n                        id: { type: \"string\" },\n                        email: { type: \"string\" },\n                        name: {\n                          type: \"string\",\n                          nullable: true\n                        },\n                        image: {\n                          type: \"string\",\n                          nullable: true\n                        },\n                        emailVerified: {\n                          type: \"boolean\"\n                        },\n                        createdAt: {\n                          type: \"string\",\n                          format: \"date-time\"\n                        },\n                        updatedAt: {\n                          type: \"string\",\n                          format: \"date-time\"\n                        }\n                      },\n                      required: [\n                        \"id\",\n                        \"email\",\n                        \"emailVerified\",\n                        \"createdAt\",\n                        \"updatedAt\"\n                      ]\n                    }\n                  },\n                  required: [\"redirect\", \"token\", \"user\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options?.emailAndPassword?.enabled) {\n      ctx.context.logger.error(\n        \"Email and password is not enabled. Make sure to enable it in the options on you `auth.ts` file. Check `https://better-auth.com/docs/authentication/email-password` for more!\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: \"Email and password is not enabled\"\n      });\n    }\n    const { email, password } = ctx.body;\n    const isValidEmail = zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().email().safeParse(email);\n    if (!isValidEmail.success) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.INVALID_EMAIL\n      });\n    }\n    const user = await ctx.context.internalAdapter.findUserByEmail(email, {\n      includeAccounts: true\n    });\n    if (!user) {\n      await ctx.context.password.hash(password);\n      ctx.context.logger.error(\"User not found\", { email });\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"UNAUTHORIZED\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    const credentialAccount = user.accounts.find(\n      (a) => a.providerId === \"credential\"\n    );\n    if (!credentialAccount) {\n      ctx.context.logger.error(\"Credential account not found\", { email });\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"UNAUTHORIZED\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    const currentPassword = credentialAccount?.password;\n    if (!currentPassword) {\n      ctx.context.logger.error(\"Password not found\", { email });\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"UNAUTHORIZED\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    const validPassword = await ctx.context.password.verify({\n      hash: currentPassword,\n      password\n    });\n    if (!validPassword) {\n      ctx.context.logger.error(\"Invalid password\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"UNAUTHORIZED\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.INVALID_EMAIL_OR_PASSWORD\n      });\n    }\n    if (ctx.context.options?.emailAndPassword?.requireEmailVerification && !user.user.emailVerified) {\n      if (!ctx.context.options?.emailVerification?.sendVerificationEmail) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"FORBIDDEN\", {\n          message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.EMAIL_NOT_VERIFIED\n        });\n      }\n      if (ctx.context.options?.emailVerification?.sendOnSignIn) {\n        const token = await createEmailVerificationToken(\n          ctx.context.secret,\n          user.user.email,\n          void 0,\n          ctx.context.options.emailVerification?.expiresIn\n        );\n        const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n        await ctx.context.options.emailVerification.sendVerificationEmail(\n          {\n            user: user.user,\n            url,\n            token\n          },\n          ctx.request\n        );\n      }\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"FORBIDDEN\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.EMAIL_NOT_VERIFIED\n      });\n    }\n    const session = await ctx.context.internalAdapter.createSession(\n      user.user.id,\n      ctx,\n      ctx.body.rememberMe === false\n    );\n    if (!session) {\n      ctx.context.logger.error(\"Failed to create session\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"UNAUTHORIZED\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.FAILED_TO_CREATE_SESSION\n      });\n    }\n    await (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_12__.s)(\n      ctx,\n      {\n        session,\n        user: user.user\n      },\n      ctx.body.rememberMe === false\n    );\n    return ctx.json({\n      redirect: !!ctx.body.callbackURL,\n      token: session.token,\n      url: ctx.body.callbackURL,\n      user: {\n        id: user.user.id,\n        email: user.user.email,\n        name: user.user.name,\n        image: user.user.image,\n        emailVerified: user.user.emailVerified,\n        createdAt: user.user.createdAt,\n        updatedAt: user.user.updatedAt\n      }\n    });\n  }\n);\n\nconst schema = zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n  code: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  error: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  device_id: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  error_description: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  state: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n  user: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n});\nconst callbackOAuth = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/callback/:id\",\n  {\n    method: [\"GET\", \"POST\"],\n    body: schema.optional(),\n    query: schema.optional(),\n    metadata: HIDE_METADATA\n  },\n  async (c) => {\n    let queryOrBody;\n    const defaultErrorURL = c.context.options.onAPIError?.errorURL || `${c.context.baseURL}/error`;\n    try {\n      if (c.method === \"GET\") {\n        queryOrBody = schema.parse(c.query);\n      } else if (c.method === \"POST\") {\n        queryOrBody = schema.parse(c.body);\n      } else {\n        throw new Error(\"Unsupported method\");\n      }\n    } catch (e) {\n      c.context.logger.error(\"INVALID_CALLBACK_REQUEST\", e);\n      throw c.redirect(`${defaultErrorURL}?error=invalid_callback_request`);\n    }\n    const { code, error, state, error_description, device_id } = queryOrBody;\n    if (error) {\n      throw c.redirect(\n        `${defaultErrorURL}?error=${error}&error_description=${error_description}`\n      );\n    }\n    if (!state) {\n      c.context.logger.error(\"State not found\", error);\n      throw c.redirect(`${defaultErrorURL}?error=state_not_found`);\n    }\n    const {\n      codeVerifier,\n      callbackURL,\n      link,\n      errorURL,\n      newUserURL,\n      requestSignUp\n    } = await parseState(c);\n    function redirectOnError(error2) {\n      let url = errorURL || defaultErrorURL;\n      if (url.includes(\"?\")) {\n        url = `${url}&error=${error2}`;\n      } else {\n        url = `${url}?error=${error2}`;\n      }\n      throw c.redirect(url);\n    }\n    if (!code) {\n      c.context.logger.error(\"Code not found\");\n      throw redirectOnError(\"no_code\");\n    }\n    const provider = c.context.socialProviders.find(\n      (p) => p.id === c.params.id\n    );\n    if (!provider) {\n      c.context.logger.error(\n        \"Oauth provider with id\",\n        c.params.id,\n        \"not found\"\n      );\n      throw redirectOnError(\"oauth_provider_not_found\");\n    }\n    let tokens;\n    try {\n      tokens = await provider.validateAuthorizationCode({\n        code,\n        codeVerifier,\n        deviceId: device_id,\n        redirectURI: `${c.context.baseURL}/callback/${provider.id}`\n      });\n    } catch (e) {\n      c.context.logger.error(\"\", e);\n      throw redirectOnError(\"invalid_code\");\n    }\n    const userInfo = await provider.getUserInfo({\n      ...tokens,\n      user: c.body?.user ? (0,_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_15__.s)(c.body.user) : void 0\n    }).then((res) => res?.user);\n    if (!userInfo) {\n      c.context.logger.error(\"Unable to get user info\");\n      return redirectOnError(\"unable_to_get_user_info\");\n    }\n    if (!callbackURL) {\n      c.context.logger.error(\"No callback URL found\");\n      throw redirectOnError(\"no_callback_url\");\n    }\n    if (link) {\n      const trustedProviders = c.context.options.account?.accountLinking?.trustedProviders;\n      const isTrustedProvider = trustedProviders?.includes(\n        provider.id\n      );\n      if (!isTrustedProvider && !userInfo.emailVerified || c.context.options.account?.accountLinking?.enabled === false) {\n        c.context.logger.error(\"Unable to link account - untrusted provider\");\n        return redirectOnError(\"unable_to_link_account\");\n      }\n      if (userInfo.email !== link.email && c.context.options.account?.accountLinking?.allowDifferentEmails !== true) {\n        return redirectOnError(\"email_doesn't_match\");\n      }\n      const existingAccount = await c.context.internalAdapter.findAccount(\n        String(userInfo.id)\n      );\n      if (existingAccount) {\n        if (existingAccount.userId.toString() !== link.userId.toString()) {\n          return redirectOnError(\"account_already_linked_to_different_user\");\n        }\n        const updateData = Object.fromEntries(\n          Object.entries({\n            accessToken: await setTokenUtil(tokens.accessToken, c.context),\n            refreshToken: await setTokenUtil(tokens.refreshToken, c.context),\n            idToken: tokens.idToken,\n            accessTokenExpiresAt: tokens.accessTokenExpiresAt,\n            refreshTokenExpiresAt: tokens.refreshTokenExpiresAt,\n            scope: tokens.scopes?.join(\",\")\n          }).filter(([_, value]) => value !== void 0)\n        );\n        await c.context.internalAdapter.updateAccount(\n          existingAccount.id,\n          updateData\n        );\n      } else {\n        const newAccount = await c.context.internalAdapter.createAccount(\n          {\n            userId: link.userId,\n            providerId: provider.id,\n            accountId: String(userInfo.id),\n            ...tokens,\n            accessToken: await setTokenUtil(tokens.accessToken, c.context),\n            refreshToken: await setTokenUtil(tokens.refreshToken, c.context),\n            scope: tokens.scopes?.join(\",\")\n          },\n          c\n        );\n        if (!newAccount) {\n          return redirectOnError(\"unable_to_link_account\");\n        }\n      }\n      let toRedirectTo2;\n      try {\n        const url = callbackURL;\n        toRedirectTo2 = url.toString();\n      } catch {\n        toRedirectTo2 = callbackURL;\n      }\n      throw c.redirect(toRedirectTo2);\n    }\n    if (!userInfo.email) {\n      c.context.logger.error(\n        \"Provider did not return email. This could be due to misconfiguration in the provider settings.\"\n      );\n      return redirectOnError(\"email_not_found\");\n    }\n    const result = await handleOAuthUserInfo(c, {\n      userInfo: {\n        ...userInfo,\n        id: String(userInfo.id),\n        email: userInfo.email,\n        name: userInfo.name || userInfo.email\n      },\n      account: {\n        providerId: provider.id,\n        accountId: String(userInfo.id),\n        ...tokens,\n        scope: tokens.scopes?.join(\",\")\n      },\n      callbackURL,\n      disableSignUp: provider.disableImplicitSignUp && !requestSignUp || provider.options?.disableSignUp,\n      overrideUserInfo: provider.options?.overrideUserInfoOnSignIn\n    });\n    if (result.error) {\n      c.context.logger.error(result.error.split(\" \").join(\"_\"));\n      return redirectOnError(result.error.split(\" \").join(\"_\"));\n    }\n    const { session, user } = result.data;\n    await (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_12__.s)(c, {\n      session,\n      user\n    });\n    let toRedirectTo;\n    try {\n      const url = result.isRegister ? newUserURL || callbackURL : callbackURL;\n      toRedirectTo = url.toString();\n    } catch {\n      toRedirectTo = result.isRegister ? newUserURL || callbackURL : callbackURL;\n    }\n    throw c.redirect(toRedirectTo);\n  }\n);\n\nconst signOut = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/sign-out\",\n  {\n    method: \"POST\",\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Sign out the current user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    success: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const sessionCookieToken = await ctx.getSignedCookie(\n      ctx.context.authCookies.sessionToken.name,\n      ctx.context.secret\n    );\n    if (!sessionCookieToken) {\n      (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_12__.d)(ctx);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.FAILED_TO_GET_SESSION\n      });\n    }\n    await ctx.context.internalAdapter.deleteSession(sessionCookieToken);\n    (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_12__.d)(ctx);\n    return ctx.json({\n      success: true\n    });\n  }\n);\n\nfunction redirectError(ctx, callbackURL, query) {\n  const url = callbackURL ? new URL(callbackURL, ctx.baseURL) : new URL(`${ctx.baseURL}/error`);\n  if (query)\n    Object.entries(query).forEach(([k, v]) => url.searchParams.set(k, v));\n  return url.href;\n}\nfunction redirectCallback(ctx, callbackURL, query) {\n  const url = new URL(callbackURL, ctx.baseURL);\n  if (query)\n    Object.entries(query).forEach(([k, v]) => url.searchParams.set(k, v));\n  return url.href;\n}\nconst requestPasswordReset = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/request-password-reset\",\n  {\n    method: \"POST\",\n    body: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      /**\n       * The email address of the user to send a password reset email to.\n       */\n      email: zod_v4__WEBPACK_IMPORTED_MODULE_0__.email().meta({\n        description: \"The email address of the user to send a password reset email to\"\n      }),\n      /**\n       * The URL to redirect the user to reset their password.\n       * If the token isn't valid or expired, it'll be redirected with a query parameter `?\n       * error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?\n       * token=VALID_TOKEN\n       */\n      redirectTo: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The URL to redirect the user to reset their password. If the token isn't valid or expired, it'll be redirected with a query parameter `?error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?token=VALID_TOKEN\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Send a password reset email to the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    },\n                    message: {\n                      type: \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.emailAndPassword?.sendResetPassword) {\n      ctx.context.logger.error(\n        \"Reset password isn't enabled.Please pass an emailAndPassword.sendResetPassword function in your auth config!\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: \"Reset password isn't enabled\"\n      });\n    }\n    const { email, redirectTo } = ctx.body;\n    const user = await ctx.context.internalAdapter.findUserByEmail(email, {\n      includeAccounts: true\n    });\n    if (!user) {\n      ctx.context.logger.error(\"Reset Password: User not found\", { email });\n      return ctx.json({\n        status: true,\n        message: \"If this email exists in our system, check your email for the reset link\"\n      });\n    }\n    const defaultExpiresIn = 60 * 60 * 1;\n    const expiresAt = (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_3__.g)(\n      ctx.context.options.emailAndPassword.resetPasswordTokenExpiresIn || defaultExpiresIn,\n      \"sec\"\n    );\n    const verificationToken = (0,_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_16__.g)(24);\n    await ctx.context.internalAdapter.createVerificationValue(\n      {\n        value: user.user.id,\n        identifier: `reset-password:${verificationToken}`,\n        expiresAt\n      },\n      ctx\n    );\n    const callbackURL = redirectTo ? encodeURIComponent(redirectTo) : \"\";\n    const url = `${ctx.context.baseURL}/reset-password/${verificationToken}?callbackURL=${callbackURL}`;\n    await ctx.context.options.emailAndPassword.sendResetPassword(\n      {\n        user: user.user,\n        url,\n        token: verificationToken\n      },\n      ctx.request\n    );\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst forgetPassword = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/forget-password\",\n  {\n    method: \"POST\",\n    body: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      /**\n       * The email address of the user to send a password reset email to.\n       */\n      email: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().email().meta({\n        description: \"The email address of the user to send a password reset email to\"\n      }),\n      /**\n       * The URL to redirect the user to reset their password.\n       * If the token isn't valid or expired, it'll be redirected with a query parameter `?\n       * error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?\n       * token=VALID_TOKEN\n       */\n      redirectTo: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The URL to redirect the user to reset their password. If the token isn't valid or expired, it'll be redirected with a query parameter `?error=INVALID_TOKEN`. If the token is valid, it'll be redirected with a query parameter `?token=VALID_TOKEN\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Send a password reset email to the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    },\n                    message: {\n                      type: \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.emailAndPassword?.sendResetPassword) {\n      ctx.context.logger.error(\n        \"Reset password isn't enabled.Please pass an emailAndPassword.sendResetPassword function in your auth config!\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: \"Reset password isn't enabled\"\n      });\n    }\n    const { email, redirectTo } = ctx.body;\n    const user = await ctx.context.internalAdapter.findUserByEmail(email, {\n      includeAccounts: true\n    });\n    if (!user) {\n      ctx.context.logger.error(\"Reset Password: User not found\", { email });\n      return ctx.json({\n        status: true,\n        message: \"If this email exists in our system, check your email for the reset link\"\n      });\n    }\n    const defaultExpiresIn = 60 * 60 * 1;\n    const expiresAt = (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_3__.g)(\n      ctx.context.options.emailAndPassword.resetPasswordTokenExpiresIn || defaultExpiresIn,\n      \"sec\"\n    );\n    const verificationToken = (0,_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_16__.g)(24);\n    await ctx.context.internalAdapter.createVerificationValue(\n      {\n        value: user.user.id,\n        identifier: `reset-password:${verificationToken}`,\n        expiresAt\n      },\n      ctx\n    );\n    const callbackURL = redirectTo ? encodeURIComponent(redirectTo) : \"\";\n    const url = `${ctx.context.baseURL}/reset-password/${verificationToken}?callbackURL=${callbackURL}`;\n    await ctx.context.options.emailAndPassword.sendResetPassword(\n      {\n        user: user.user,\n        url,\n        token: verificationToken\n      },\n      ctx.request\n    );\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst requestPasswordResetCallback = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/reset-password/:token\",\n  {\n    method: \"GET\",\n    query: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      callbackURL: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The URL to redirect the user to reset their password\"\n      })\n    }),\n    use: [originCheck((ctx) => ctx.query.callbackURL)],\n    metadata: {\n      openapi: {\n        description: \"Redirects the user to the callback URL with the token\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    token: {\n                      type: \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { token } = ctx.params;\n    const { callbackURL } = ctx.query;\n    if (!token || !callbackURL) {\n      throw ctx.redirect(\n        redirectError(ctx.context, callbackURL, { error: \"INVALID_TOKEN\" })\n      );\n    }\n    const verification = await ctx.context.internalAdapter.findVerificationValue(\n      `reset-password:${token}`\n    );\n    if (!verification || verification.expiresAt < /* @__PURE__ */ new Date()) {\n      throw ctx.redirect(\n        redirectError(ctx.context, callbackURL, { error: \"INVALID_TOKEN\" })\n      );\n    }\n    throw ctx.redirect(redirectCallback(ctx.context, callbackURL, { token }));\n  }\n);\nconst forgetPasswordCallback = requestPasswordResetCallback;\nconst resetPassword = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/reset-password\",\n  {\n    method: \"POST\",\n    query: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      token: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n    }).optional(),\n    body: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      newPassword: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The new password to set\"\n      }),\n      token: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The token to reset the password\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Reset the password for a user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const token = ctx.body.token || ctx.query?.token;\n    if (!token) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.INVALID_TOKEN\n      });\n    }\n    const { newPassword } = ctx.body;\n    const minLength = ctx.context.password?.config.minPasswordLength;\n    const maxLength = ctx.context.password?.config.maxPasswordLength;\n    if (newPassword.length < minLength) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.PASSWORD_TOO_SHORT\n      });\n    }\n    if (newPassword.length > maxLength) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.PASSWORD_TOO_LONG\n      });\n    }\n    const id = `reset-password:${token}`;\n    const verification = await ctx.context.internalAdapter.findVerificationValue(id);\n    if (!verification || verification.expiresAt < /* @__PURE__ */ new Date()) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.INVALID_TOKEN\n      });\n    }\n    const userId = verification.value;\n    const hashedPassword = await ctx.context.password.hash(newPassword);\n    const accounts = await ctx.context.internalAdapter.findAccounts(userId);\n    const account = accounts.find((ac) => ac.providerId === \"credential\");\n    if (!account) {\n      await ctx.context.internalAdapter.createAccount(\n        {\n          userId,\n          providerId: \"credential\",\n          password: hashedPassword,\n          accountId: userId\n        },\n        ctx\n      );\n    } else {\n      await ctx.context.internalAdapter.updatePassword(\n        userId,\n        hashedPassword,\n        ctx\n      );\n    }\n    await ctx.context.internalAdapter.deleteVerificationValue(verification.id);\n    if (ctx.context.options.emailAndPassword?.onPasswordReset) {\n      const user = await ctx.context.internalAdapter.findUserById(userId);\n      if (user) {\n        await ctx.context.options.emailAndPassword.onPasswordReset(\n          {\n            user\n          },\n          ctx.request\n        );\n      }\n    }\n    if (ctx.context.options.emailAndPassword?.revokeSessionsOnPasswordReset) {\n      await ctx.context.internalAdapter.deleteSessions(userId);\n    }\n    return ctx.json({\n      status: true\n    });\n  }\n);\n\nconst updateUser = () => (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/update-user\",\n  {\n    method: \"POST\",\n    body: zod_v4__WEBPACK_IMPORTED_MODULE_0__.record(\n      zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"Field name must be a string\"\n      }),\n      zod_v4__WEBPACK_IMPORTED_MODULE_0__.any()\n    ),\n    use: [_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.s],\n    metadata: {\n      $Infer: {\n        body: {}\n      },\n      openapi: {\n        description: \"Update the current user\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  name: {\n                    type: \"string\",\n                    description: \"The name of the user\"\n                  },\n                  image: {\n                    type: \"string\",\n                    description: \"The image of the user\"\n                  }\n                }\n              }\n            }\n          }\n        },\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if the update was successful\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const body = ctx.body;\n    if (body.email) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.EMAIL_CAN_NOT_BE_UPDATED\n      });\n    }\n    const { name, image, ...rest } = body;\n    const session = ctx.context.session;\n    if (image === void 0 && name === void 0 && Object.keys(rest).length === 0) {\n      return ctx.json({\n        status: true\n      });\n    }\n    const additionalFields = (0,_better_auth_Dcv8PS7T_mjs__WEBPACK_IMPORTED_MODULE_17__.h)(\n      ctx.context.options,\n      rest,\n      \"update\"\n    );\n    const user = await ctx.context.internalAdapter.updateUser(\n      session.user.id,\n      {\n        name,\n        image,\n        ...additionalFields\n      },\n      ctx\n    );\n    await (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_12__.s)(ctx, {\n      session: session.session,\n      user\n    });\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst changePassword = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/change-password\",\n  {\n    method: \"POST\",\n    body: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      /**\n       * The new password to set\n       */\n      newPassword: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The new password to set\"\n      }),\n      /**\n       * The current password of the user\n       */\n      currentPassword: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The current password is required\"\n      }),\n      /**\n       * revoke all sessions that are not the\n       * current one logged in by the user\n       */\n      revokeOtherSessions: zod_v4__WEBPACK_IMPORTED_MODULE_0__.boolean().meta({\n        description: \"Must be a boolean value\"\n      }).optional()\n    }),\n    use: [_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.s],\n    metadata: {\n      openapi: {\n        description: \"Change the password of the user\",\n        responses: {\n          \"200\": {\n            description: \"Password successfully changed\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    token: {\n                      type: \"string\",\n                      nullable: true,\n                      // Only present if revokeOtherSessions is true\n                      description: \"New session token if other sessions were revoked\"\n                    },\n                    user: {\n                      type: \"object\",\n                      properties: {\n                        id: {\n                          type: \"string\",\n                          description: \"The unique identifier of the user\"\n                        },\n                        email: {\n                          type: \"string\",\n                          format: \"email\",\n                          description: \"The email address of the user\"\n                        },\n                        name: {\n                          type: \"string\",\n                          description: \"The name of the user\"\n                        },\n                        image: {\n                          type: \"string\",\n                          format: \"uri\",\n                          nullable: true,\n                          description: \"The profile image URL of the user\"\n                        },\n                        emailVerified: {\n                          type: \"boolean\",\n                          description: \"Whether the email has been verified\"\n                        },\n                        createdAt: {\n                          type: \"string\",\n                          format: \"date-time\",\n                          description: \"When the user was created\"\n                        },\n                        updatedAt: {\n                          type: \"string\",\n                          format: \"date-time\",\n                          description: \"When the user was last updated\"\n                        }\n                      },\n                      required: [\n                        \"id\",\n                        \"email\",\n                        \"name\",\n                        \"emailVerified\",\n                        \"createdAt\",\n                        \"updatedAt\"\n                      ]\n                    }\n                  },\n                  required: [\"user\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { newPassword, currentPassword, revokeOtherSessions } = ctx.body;\n    const session = ctx.context.session;\n    const minPasswordLength = ctx.context.password.config.minPasswordLength;\n    if (newPassword.length < minPasswordLength) {\n      ctx.context.logger.error(\"Password is too short\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.PASSWORD_TOO_SHORT\n      });\n    }\n    const maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n    if (newPassword.length > maxPasswordLength) {\n      ctx.context.logger.error(\"Password is too long\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.PASSWORD_TOO_LONG\n      });\n    }\n    const accounts = await ctx.context.internalAdapter.findAccounts(\n      session.user.id\n    );\n    const account = accounts.find(\n      (account2) => account2.providerId === \"credential\" && account2.password\n    );\n    if (!account || !account.password) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.CREDENTIAL_ACCOUNT_NOT_FOUND\n      });\n    }\n    const passwordHash = await ctx.context.password.hash(newPassword);\n    const verify = await ctx.context.password.verify({\n      hash: account.password,\n      password: currentPassword\n    });\n    if (!verify) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.INVALID_PASSWORD\n      });\n    }\n    await ctx.context.internalAdapter.updateAccount(account.id, {\n      password: passwordHash\n    });\n    let token = null;\n    if (revokeOtherSessions) {\n      await ctx.context.internalAdapter.deleteSessions(session.user.id);\n      const newSession = await ctx.context.internalAdapter.createSession(\n        session.user.id,\n        ctx\n      );\n      if (!newSession) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"INTERNAL_SERVER_ERROR\", {\n          message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.FAILED_TO_GET_SESSION\n        });\n      }\n      await (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_12__.s)(ctx, {\n        session: newSession,\n        user: session.user\n      });\n      token = newSession.token;\n    }\n    return ctx.json({\n      token,\n      user: {\n        id: session.user.id,\n        email: session.user.email,\n        name: session.user.name,\n        image: session.user.image,\n        emailVerified: session.user.emailVerified,\n        createdAt: session.user.createdAt,\n        updatedAt: session.user.updatedAt\n      }\n    });\n  }\n);\nconst setPassword = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/set-password\",\n  {\n    method: \"POST\",\n    body: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      /**\n       * The new password to set\n       */\n      newPassword: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The new password to set is required\"\n      })\n    }),\n    metadata: {\n      SERVER_ONLY: true\n    },\n    use: [_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.s]\n  },\n  async (ctx) => {\n    const { newPassword } = ctx.body;\n    const session = ctx.context.session;\n    const minPasswordLength = ctx.context.password.config.minPasswordLength;\n    if (newPassword.length < minPasswordLength) {\n      ctx.context.logger.error(\"Password is too short\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.PASSWORD_TOO_SHORT\n      });\n    }\n    const maxPasswordLength = ctx.context.password.config.maxPasswordLength;\n    if (newPassword.length > maxPasswordLength) {\n      ctx.context.logger.error(\"Password is too long\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.PASSWORD_TOO_LONG\n      });\n    }\n    const accounts = await ctx.context.internalAdapter.findAccounts(\n      session.user.id\n    );\n    const account = accounts.find(\n      (account2) => account2.providerId === \"credential\" && account2.password\n    );\n    const passwordHash = await ctx.context.password.hash(newPassword);\n    if (!account) {\n      await ctx.context.internalAdapter.linkAccount(\n        {\n          userId: session.user.id,\n          providerId: \"credential\",\n          accountId: session.user.id,\n          password: passwordHash\n        },\n        ctx\n      );\n      return ctx.json({\n        status: true\n      });\n    }\n    throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n      message: \"user already has a password\"\n    });\n  }\n);\nconst deleteUser = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/delete-user\",\n  {\n    method: \"POST\",\n    use: [_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.s],\n    body: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      /**\n       * The callback URL to redirect to after the user is deleted\n       * this is only used on delete user callback\n       */\n      callbackURL: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The callback URL to redirect to after the user is deleted\"\n      }).optional(),\n      /**\n       * The password of the user. If the password isn't provided, session freshness\n       * will be checked.\n       */\n      password: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The password of the user is required to delete the user\"\n      }).optional(),\n      /**\n       * The token to delete the user. If the token is provided, the user will be deleted\n       */\n      token: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The token to delete the user is required\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Delete the user\",\n        responses: {\n          \"200\": {\n            description: \"User deletion processed successfully\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    success: {\n                      type: \"boolean\",\n                      description: \"Indicates if the operation was successful\"\n                    },\n                    message: {\n                      type: \"string\",\n                      enum: [\"User deleted\", \"Verification email sent\"],\n                      description: \"Status message of the deletion process\"\n                    }\n                  },\n                  required: [\"success\", \"message\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.user?.deleteUser?.enabled) {\n      ctx.context.logger.error(\n        \"Delete user is disabled. Enable it in the options\",\n        {\n          session: ctx.context.session\n        }\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"NOT_FOUND\");\n    }\n    const session = ctx.context.session;\n    if (ctx.body.password) {\n      const accounts = await ctx.context.internalAdapter.findAccounts(\n        session.user.id\n      );\n      const account = accounts.find(\n        (account2) => account2.providerId === \"credential\" && account2.password\n      );\n      if (!account || !account.password) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n          message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.CREDENTIAL_ACCOUNT_NOT_FOUND\n        });\n      }\n      const verify = await ctx.context.password.verify({\n        hash: account.password,\n        password: ctx.body.password\n      });\n      if (!verify) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n          message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.INVALID_PASSWORD\n        });\n      }\n    }\n    if (ctx.body.token) {\n      await deleteUserCallback({\n        ...ctx,\n        query: {\n          token: ctx.body.token\n        }\n      });\n      return ctx.json({\n        success: true,\n        message: \"User deleted\"\n      });\n    }\n    if (ctx.context.options.user.deleteUser?.sendDeleteAccountVerification) {\n      const token = (0,_better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_10__.g)(32, \"0-9\", \"a-z\");\n      await ctx.context.internalAdapter.createVerificationValue(\n        {\n          value: session.user.id,\n          identifier: `delete-account-${token}`,\n          expiresAt: new Date(\n            Date.now() + (ctx.context.options.user.deleteUser?.deleteTokenExpiresIn || 60 * 60 * 24) * 1e3\n          )\n        },\n        ctx\n      );\n      const url = `${ctx.context.baseURL}/delete-user/callback?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n      await ctx.context.options.user.deleteUser.sendDeleteAccountVerification(\n        {\n          user: session.user,\n          url,\n          token\n        },\n        ctx.request\n      );\n      return ctx.json({\n        success: true,\n        message: \"Verification email sent\"\n      });\n    }\n    if (!ctx.body.password && ctx.context.sessionConfig.freshAge !== 0) {\n      const currentAge = new Date(session.session.createdAt).getTime();\n      const freshAge = ctx.context.sessionConfig.freshAge * 1e3;\n      const now = Date.now();\n      if (now - currentAge > freshAge * 1e3) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n          message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.SESSION_EXPIRED\n        });\n      }\n    }\n    const beforeDelete = ctx.context.options.user.deleteUser?.beforeDelete;\n    if (beforeDelete) {\n      await beforeDelete(session.user, ctx.request);\n    }\n    await ctx.context.internalAdapter.deleteUser(session.user.id);\n    await ctx.context.internalAdapter.deleteSessions(session.user.id);\n    await ctx.context.internalAdapter.deleteAccounts(session.user.id);\n    (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_12__.d)(ctx);\n    const afterDelete = ctx.context.options.user.deleteUser?.afterDelete;\n    if (afterDelete) {\n      await afterDelete(session.user, ctx.request);\n    }\n    return ctx.json({\n      success: true,\n      message: \"User deleted\"\n    });\n  }\n);\nconst deleteUserCallback = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/delete-user/callback\",\n  {\n    method: \"GET\",\n    query: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      token: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The token to verify the deletion request\"\n      }),\n      callbackURL: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The URL to redirect to after deletion\"\n      }).optional()\n    }),\n    use: [originCheck((ctx) => ctx.query.callbackURL)],\n    metadata: {\n      openapi: {\n        description: \"Callback to complete user deletion with verification token\",\n        responses: {\n          \"200\": {\n            description: \"User successfully deleted\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    success: {\n                      type: \"boolean\",\n                      description: \"Indicates if the deletion was successful\"\n                    },\n                    message: {\n                      type: \"string\",\n                      enum: [\"User deleted\"],\n                      description: \"Confirmation message\"\n                    }\n                  },\n                  required: [\"success\", \"message\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.user?.deleteUser?.enabled) {\n      ctx.context.logger.error(\n        \"Delete user is disabled. Enable it in the options\"\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"NOT_FOUND\");\n    }\n    const session = await (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.g)(ctx);\n    if (!session) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"NOT_FOUND\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.FAILED_TO_GET_USER_INFO\n      });\n    }\n    const token = await ctx.context.internalAdapter.findVerificationValue(\n      `delete-account-${ctx.query.token}`\n    );\n    if (!token || token.expiresAt < /* @__PURE__ */ new Date()) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"NOT_FOUND\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.INVALID_TOKEN\n      });\n    }\n    if (token.value !== session.user.id) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"NOT_FOUND\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.INVALID_TOKEN\n      });\n    }\n    const beforeDelete = ctx.context.options.user.deleteUser?.beforeDelete;\n    if (beforeDelete) {\n      await beforeDelete(session.user, ctx.request);\n    }\n    await ctx.context.internalAdapter.deleteUser(session.user.id);\n    await ctx.context.internalAdapter.deleteSessions(session.user.id);\n    await ctx.context.internalAdapter.deleteAccounts(session.user.id);\n    await ctx.context.internalAdapter.deleteVerificationValue(token.id);\n    (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_12__.d)(ctx);\n    const afterDelete = ctx.context.options.user.deleteUser?.afterDelete;\n    if (afterDelete) {\n      await afterDelete(session.user, ctx.request);\n    }\n    if (ctx.query.callbackURL) {\n      throw ctx.redirect(ctx.query.callbackURL || \"/\");\n    }\n    return ctx.json({\n      success: true,\n      message: \"User deleted\"\n    });\n  }\n);\nconst changeEmail = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/change-email\",\n  {\n    method: \"POST\",\n    body: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      newEmail: zod_v4__WEBPACK_IMPORTED_MODULE_0__.email().meta({\n        description: \"The new email address to set must be a valid email address\"\n      }),\n      callbackURL: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The URL to redirect to after email verification\"\n      }).optional()\n    }),\n    use: [_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.s],\n    metadata: {\n      openapi: {\n        responses: {\n          \"200\": {\n            description: \"Email change request processed successfully\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if the request was successful\"\n                    },\n                    message: {\n                      type: \"string\",\n                      enum: [\"Email updated\", \"Verification email sent\"],\n                      description: \"Status message of the email change process\",\n                      nullable: true\n                    }\n                  },\n                  required: [\"status\"]\n                }\n              }\n            }\n          },\n          \"422\": {\n            description: \"Unprocessable Entity. Email already exists\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    message: {\n                      type: \"string\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    if (!ctx.context.options.user?.changeEmail?.enabled) {\n      ctx.context.logger.error(\"Change email is disabled.\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: \"Change email is disabled\"\n      });\n    }\n    const newEmail = ctx.body.newEmail.toLowerCase();\n    if (newEmail === ctx.context.session.user.email) {\n      ctx.context.logger.error(\"Email is the same\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: \"Email is the same\"\n      });\n    }\n    const existingUser = await ctx.context.internalAdapter.findUserByEmail(newEmail);\n    if (existingUser) {\n      ctx.context.logger.error(\"Email already exists\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: \"Couldn't update your email\"\n      });\n    }\n    if (ctx.context.session.user.emailVerified !== true) {\n      const existing = await ctx.context.internalAdapter.findUserByEmail(newEmail);\n      if (existing) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"UNPROCESSABLE_ENTITY\", {\n          message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.USER_ALREADY_EXISTS\n        });\n      }\n      await ctx.context.internalAdapter.updateUserByEmail(\n        ctx.context.session.user.email,\n        {\n          email: newEmail\n        },\n        ctx\n      );\n      await (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_12__.s)(ctx, {\n        session: ctx.context.session.session,\n        user: {\n          ...ctx.context.session.user,\n          email: newEmail\n        }\n      });\n      if (ctx.context.options.emailVerification?.sendVerificationEmail) {\n        const token2 = await createEmailVerificationToken(\n          ctx.context.secret,\n          newEmail,\n          void 0,\n          ctx.context.options.emailVerification?.expiresIn\n        );\n        const url2 = `${ctx.context.baseURL}/verify-email?token=${token2}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n        await ctx.context.options.emailVerification.sendVerificationEmail(\n          {\n            user: {\n              ...ctx.context.session.user,\n              email: newEmail\n            },\n            url: url2,\n            token: token2\n          },\n          ctx.request\n        );\n      }\n      return ctx.json({\n        status: true\n      });\n    }\n    if (!ctx.context.options.user.changeEmail.sendChangeEmailVerification) {\n      ctx.context.logger.error(\"Verification email isn't enabled.\");\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: \"Verification email isn't enabled\"\n      });\n    }\n    const token = await createEmailVerificationToken(\n      ctx.context.secret,\n      ctx.context.session.user.email,\n      newEmail,\n      ctx.context.options.emailVerification?.expiresIn\n    );\n    const url = `${ctx.context.baseURL}/verify-email?token=${token}&callbackURL=${ctx.body.callbackURL || \"/\"}`;\n    await ctx.context.options.user.changeEmail.sendChangeEmailVerification(\n      {\n        user: ctx.context.session.user,\n        newEmail,\n        url,\n        token\n      },\n      ctx.request\n    );\n    return ctx.json({\n      status: true\n    });\n  }\n);\n\nfunction sanitize(input) {\n  return input.replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#39;\");\n}\nconst html = (errorCode = \"Unknown\") => `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Authentication Error</title>\n    <style>\n        :root {\n            --bg-color: #f8f9fa;\n            --text-color: #212529;\n            --accent-color: #000000;\n            --error-color: #dc3545;\n            --border-color: #e9ecef;\n        }\n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;\n            background-color: var(--bg-color);\n            color: var(--text-color);\n            display: flex;\n            justify-content: center;\n            align-items: center;\n            height: 100vh;\n            margin: 0;\n            line-height: 1.5;\n        }\n        .error-container {\n            background-color: #ffffff;\n            border-radius: 12px;\n            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);\n            padding: 2.5rem;\n            text-align: center;\n            max-width: 90%;\n            width: 400px;\n        }\n        h1 {\n            color: var(--error-color);\n            font-size: 1.75rem;\n            margin-bottom: 1rem;\n            font-weight: 600;\n        }\n        p {\n            margin-bottom: 1.5rem;\n            color: #495057;\n        }\n        .btn {\n            background-color: var(--accent-color);\n            color: #ffffff;\n            text-decoration: none;\n            padding: 0.75rem 1.5rem;\n            border-radius: 6px;\n            transition: all 0.3s ease;\n            display: inline-block;\n            font-weight: 500;\n            border: 2px solid var(--accent-color);\n        }\n        .btn:hover {\n            background-color: #131721;\n        }\n        .error-code {\n            font-size: 0.875rem;\n            color: #6c757d;\n            margin-top: 1.5rem;\n            padding-top: 1.5rem;\n            border-top: 1px solid var(--border-color);\n        }\n        .icon {\n            font-size: 3rem;\n            margin-bottom: 1rem;\n        }\n    </style>\n</head>\n<body>\n    <div class=\"error-container\">\n        <div class=\"icon\">\\u26A0\\uFE0F</div>\n        <h1>Better Auth Error</h1>\n        <p>We encountered an issue while processing your request. Please try again or contact the application owner if the problem persists.</p>\n        <a href=\"/\" id=\"returnLink\" class=\"btn\">Return to Application</a>\n        <div class=\"error-code\">Error Code: <span id=\"errorCode\">${sanitize(\n  errorCode\n)}</span></div>\n    </div>\n</body>\n</html>`;\nconst error = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/error\",\n  {\n    method: \"GET\",\n    metadata: {\n      ...HIDE_METADATA,\n      openapi: {\n        description: \"Displays an error page\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"text/html\": {\n                schema: {\n                  type: \"string\",\n                  description: \"The HTML content of the error page\"\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const query = new URL(c.request?.url || \"\").searchParams.get(\"error\") || \"Unknown\";\n    return new Response(html(query), {\n      headers: {\n        \"Content-Type\": \"text/html\"\n      }\n    });\n  }\n);\n\nconst ok = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/ok\",\n  {\n    method: \"GET\",\n    metadata: {\n      ...HIDE_METADATA,\n      openapi: {\n        description: \"Check if the API is working\",\n        responses: {\n          \"200\": {\n            description: \"API is working\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    ok: {\n                      type: \"boolean\",\n                      description: \"Indicates if the API is working\"\n                    }\n                  },\n                  required: [\"ok\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    return ctx.json({\n      ok: true\n    });\n  }\n);\n\nconst listUserAccounts = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/list-accounts\",\n  {\n    method: \"GET\",\n    use: [_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.s],\n    metadata: {\n      openapi: {\n        description: \"List all accounts linked to the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"array\",\n                  items: {\n                    type: \"object\",\n                    properties: {\n                      id: {\n                        type: \"string\"\n                      },\n                      providerId: {\n                        type: \"string\"\n                      },\n                      createdAt: {\n                        type: \"string\",\n                        format: \"date-time\"\n                      },\n                      updatedAt: {\n                        type: \"string\",\n                        format: \"date-time\"\n                      },\n                      accountId: {\n                        type: \"string\"\n                      },\n                      scopes: {\n                        type: \"array\",\n                        items: {\n                          type: \"string\"\n                        }\n                      }\n                    },\n                    required: [\n                      \"id\",\n                      \"providerId\",\n                      \"createdAt\",\n                      \"updatedAt\",\n                      \"accountId\",\n                      \"scopes\"\n                    ]\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const session = c.context.session;\n    const accounts = await c.context.internalAdapter.findAccounts(\n      session.user.id\n    );\n    return c.json(\n      accounts.map((a) => ({\n        id: a.id,\n        providerId: a.providerId,\n        createdAt: a.createdAt,\n        updatedAt: a.updatedAt,\n        accountId: a.accountId,\n        scopes: a.scope?.split(\",\") || []\n      }))\n    );\n  }\n);\nconst linkSocialAccount = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/link-social\",\n  {\n    method: \"POST\",\n    requireHeaders: true,\n    body: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      /**\n       * Callback URL to redirect to after the user has signed in.\n       */\n      callbackURL: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The URL to redirect to after the user has signed in\"\n      }).optional(),\n      /**\n       * OAuth2 provider to use\n       */\n      provider: SocialProviderListEnum,\n      /**\n       * ID Token for direct authentication without redirect\n       */\n      idToken: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n        token: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(),\n        nonce: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n        accessToken: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n        refreshToken: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().optional(),\n        scopes: zod_v4__WEBPACK_IMPORTED_MODULE_0__.array(zod_v4__WEBPACK_IMPORTED_MODULE_0__.string()).optional()\n      }).optional(),\n      /**\n       * Whether to allow sign up for new users\n       */\n      requestSignUp: zod_v4__WEBPACK_IMPORTED_MODULE_0__.boolean().optional(),\n      /**\n       * Additional scopes to request when linking the account.\n       * This is useful for requesting additional permissions when\n       * linking a social account compared to the initial authentication.\n       */\n      scopes: zod_v4__WEBPACK_IMPORTED_MODULE_0__.array(zod_v4__WEBPACK_IMPORTED_MODULE_0__.string()).meta({\n        description: \"Additional scopes to request from the provider\"\n      }).optional(),\n      /**\n       * The URL to redirect to if there is an error during the link process.\n       */\n      errorCallbackURL: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The URL to redirect to if there is an error during the link process\"\n      }).optional(),\n      /**\n       * Disable automatic redirection to the provider\n       *\n       * This is useful if you want to handle the redirection\n       * yourself like in a popup or a different tab.\n       */\n      disableRedirect: zod_v4__WEBPACK_IMPORTED_MODULE_0__.boolean().meta({\n        description: \"Disable automatic redirection to the provider. Useful for handling the redirection yourself\"\n      }).optional()\n    }),\n    use: [_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.s],\n    metadata: {\n      openapi: {\n        description: \"Link a social account to the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    url: {\n                      type: \"string\",\n                      description: \"The authorization URL to redirect the user to\"\n                    },\n                    redirect: {\n                      type: \"boolean\",\n                      description: \"Indicates if the user should be redirected to the authorization URL\"\n                    },\n                    status: {\n                      type: \"boolean\"\n                    }\n                  },\n                  required: [\"redirect\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (c) => {\n    const session = c.context.session;\n    const provider = c.context.socialProviders.find(\n      (p) => p.id === c.body.provider\n    );\n    if (!provider) {\n      c.context.logger.error(\n        \"Provider not found. Make sure to add the provider in your auth config\",\n        {\n          provider: c.body.provider\n        }\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"NOT_FOUND\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.PROVIDER_NOT_FOUND\n      });\n    }\n    if (c.body.idToken) {\n      if (!provider.verifyIdToken) {\n        c.context.logger.error(\n          \"Provider does not support id token verification\",\n          {\n            provider: c.body.provider\n          }\n        );\n        throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"NOT_FOUND\", {\n          message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.ID_TOKEN_NOT_SUPPORTED\n        });\n      }\n      const { token, nonce } = c.body.idToken;\n      const valid = await provider.verifyIdToken(token, nonce);\n      if (!valid) {\n        c.context.logger.error(\"Invalid id token\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"UNAUTHORIZED\", {\n          message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.INVALID_TOKEN\n        });\n      }\n      const linkingUserInfo = await provider.getUserInfo({\n        idToken: token,\n        accessToken: c.body.idToken.accessToken,\n        refreshToken: c.body.idToken.refreshToken\n      });\n      if (!linkingUserInfo || !linkingUserInfo?.user) {\n        c.context.logger.error(\"Failed to get user info\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"UNAUTHORIZED\", {\n          message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.FAILED_TO_GET_USER_INFO\n        });\n      }\n      const linkingUserId = String(linkingUserInfo.user.id);\n      if (!linkingUserInfo.user.email) {\n        c.context.logger.error(\"User email not found\", {\n          provider: c.body.provider\n        });\n        throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"UNAUTHORIZED\", {\n          message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.USER_EMAIL_NOT_FOUND\n        });\n      }\n      const existingAccounts = await c.context.internalAdapter.findAccounts(\n        session.user.id\n      );\n      const hasBeenLinked = existingAccounts.find(\n        (a) => a.providerId === provider.id && a.accountId === linkingUserId\n      );\n      if (hasBeenLinked) {\n        return c.json({\n          url: \"\",\n          // this is for type inference\n          status: true,\n          redirect: false\n        });\n      }\n      const trustedProviders = c.context.options.account?.accountLinking?.trustedProviders;\n      const isTrustedProvider = trustedProviders?.includes(provider.id);\n      if (!isTrustedProvider && !linkingUserInfo.user.emailVerified || c.context.options.account?.accountLinking?.enabled === false) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"UNAUTHORIZED\", {\n          message: \"Account not linked - linking not allowed\"\n        });\n      }\n      if (linkingUserInfo.user.email !== session.user.email && c.context.options.account?.accountLinking?.allowDifferentEmails !== true) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"UNAUTHORIZED\", {\n          message: \"Account not linked - different emails not allowed\"\n        });\n      }\n      try {\n        await c.context.internalAdapter.createAccount(\n          {\n            userId: session.user.id,\n            providerId: provider.id,\n            accountId: linkingUserId,\n            accessToken: c.body.idToken.accessToken,\n            idToken: token,\n            refreshToken: c.body.idToken.refreshToken,\n            scope: c.body.idToken.scopes?.join(\",\")\n          },\n          c\n        );\n      } catch (e) {\n        throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"EXPECTATION_FAILED\", {\n          message: \"Account not linked - unable to create account\"\n        });\n      }\n      if (c.context.options.account?.accountLinking?.updateUserInfoOnLink === true) {\n        try {\n          await c.context.internalAdapter.updateUser(session.user.id, {\n            name: linkingUserInfo.user?.name,\n            image: linkingUserInfo.user?.image\n          });\n        } catch (e) {\n          console.warn(\"Could not update user - \" + e.toString());\n        }\n      }\n      return c.json({\n        url: \"\",\n        // this is for type inference\n        status: true,\n        redirect: false\n      });\n    }\n    const state = await generateState(c, {\n      userId: session.user.id,\n      email: session.user.email\n    });\n    const url = await provider.createAuthorizationURL({\n      state: state.state,\n      codeVerifier: state.codeVerifier,\n      redirectURI: `${c.context.baseURL}/callback/${provider.id}`,\n      scopes: c.body.scopes\n    });\n    return c.json({\n      url: url.toString(),\n      redirect: !c.body.disableRedirect\n    });\n  }\n);\nconst unlinkAccount = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/unlink-account\",\n  {\n    method: \"POST\",\n    body: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      providerId: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(),\n      accountId: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().optional()\n    }),\n    use: [_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.f],\n    metadata: {\n      openapi: {\n        description: \"Unlink an account\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\"\n                    }\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { providerId, accountId } = ctx.body;\n    const accounts = await ctx.context.internalAdapter.findAccounts(\n      ctx.context.session.user.id\n    );\n    if (accounts.length === 1 && !ctx.context.options.account?.accountLinking?.allowUnlinkingAll) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.FAILED_TO_UNLINK_LAST_ACCOUNT\n      });\n    }\n    const accountExist = accounts.find(\n      (account) => accountId ? account.accountId === accountId && account.providerId === providerId : account.providerId === providerId\n    );\n    if (!accountExist) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.B.ACCOUNT_NOT_FOUND\n      });\n    }\n    await ctx.context.internalAdapter.deleteAccount(accountExist.id);\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst getAccessToken = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/get-access-token\",\n  {\n    method: \"POST\",\n    body: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      providerId: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The provider ID for the OAuth provider\"\n      }),\n      accountId: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The account ID associated with the refresh token\"\n      }).optional(),\n      userId: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The user ID associated with the account\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Get a valid access token, doing a refresh if needed\",\n        responses: {\n          200: {\n            description: \"A Valid access token\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    tokenType: {\n                      type: \"string\"\n                    },\n                    idToken: {\n                      type: \"string\"\n                    },\n                    accessToken: {\n                      type: \"string\"\n                    },\n                    refreshToken: {\n                      type: \"string\"\n                    },\n                    accessTokenExpiresAt: {\n                      type: \"string\",\n                      format: \"date-time\"\n                    },\n                    refreshTokenExpiresAt: {\n                      type: \"string\",\n                      format: \"date-time\"\n                    }\n                  }\n                }\n              }\n            }\n          },\n          400: {\n            description: \"Invalid refresh token or provider configuration\"\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { providerId, accountId, userId } = ctx.body;\n    const req = ctx.request;\n    const session = await (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.g)(ctx);\n    if (req && !session) {\n      throw ctx.error(\"UNAUTHORIZED\");\n    }\n    let resolvedUserId = session?.user?.id || userId;\n    if (!resolvedUserId) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: `Either userId or session is required`\n      });\n    }\n    if (!ctx.context.socialProviders.find((p) => p.id === providerId)) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: `Provider ${providerId} is not supported.`\n      });\n    }\n    const accounts = await ctx.context.internalAdapter.findAccounts(resolvedUserId);\n    const account = accounts.find(\n      (acc) => accountId ? acc.id === accountId && acc.providerId === providerId : acc.providerId === providerId\n    );\n    if (!account) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: \"Account not found\"\n      });\n    }\n    const provider = ctx.context.socialProviders.find(\n      (p) => p.id === providerId\n    );\n    if (!provider) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: `Provider ${providerId} not found.`\n      });\n    }\n    try {\n      let newTokens = null;\n      const accessTokenExpired = account.accessTokenExpiresAt && new Date(account.accessTokenExpiresAt).getTime() - Date.now() < 5e3;\n      if (account.refreshToken && accessTokenExpired && provider.refreshAccessToken) {\n        newTokens = await provider.refreshAccessToken(\n          account.refreshToken\n        );\n        await ctx.context.internalAdapter.updateAccount(account.id, {\n          accessToken: await setTokenUtil(newTokens.accessToken, ctx.context),\n          accessTokenExpiresAt: newTokens.accessTokenExpiresAt,\n          refreshToken: await setTokenUtil(newTokens.refreshToken, ctx.context),\n          refreshTokenExpiresAt: newTokens.refreshTokenExpiresAt\n        });\n      }\n      const tokens = {\n        accessToken: await decryptOAuthToken(\n          newTokens?.accessToken ?? account.accessToken ?? \"\",\n          ctx.context\n        ),\n        accessTokenExpiresAt: newTokens?.accessTokenExpiresAt ?? account.accessTokenExpiresAt ?? void 0,\n        scopes: account.scope?.split(\",\") ?? [],\n        idToken: newTokens?.idToken ?? account.idToken ?? void 0\n      };\n      return ctx.json(tokens);\n    } catch (error) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: \"Failed to get a valid access token\",\n        cause: error\n      });\n    }\n  }\n);\nconst refreshToken = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/refresh-token\",\n  {\n    method: \"POST\",\n    body: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      providerId: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The provider ID for the OAuth provider\"\n      }),\n      accountId: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The account ID associated with the refresh token\"\n      }).optional(),\n      userId: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The user ID associated with the account\"\n      }).optional()\n    }),\n    metadata: {\n      openapi: {\n        description: \"Refresh the access token using a refresh token\",\n        responses: {\n          200: {\n            description: \"Access token refreshed successfully\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    tokenType: {\n                      type: \"string\"\n                    },\n                    idToken: {\n                      type: \"string\"\n                    },\n                    accessToken: {\n                      type: \"string\"\n                    },\n                    refreshToken: {\n                      type: \"string\"\n                    },\n                    accessTokenExpiresAt: {\n                      type: \"string\",\n                      format: \"date-time\"\n                    },\n                    refreshTokenExpiresAt: {\n                      type: \"string\",\n                      format: \"date-time\"\n                    }\n                  }\n                }\n              }\n            }\n          },\n          400: {\n            description: \"Invalid refresh token or provider configuration\"\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const { providerId, accountId, userId } = ctx.body;\n    const req = ctx.request;\n    const session = await (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.g)(ctx);\n    if (req && !session) {\n      throw ctx.error(\"UNAUTHORIZED\");\n    }\n    let resolvedUserId = session?.user?.id || userId;\n    if (!resolvedUserId) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: `Either userId or session is required`\n      });\n    }\n    const accounts = await ctx.context.internalAdapter.findAccounts(resolvedUserId);\n    const account = accounts.find(\n      (acc) => accountId ? acc.id === accountId && acc.providerId === providerId : acc.providerId === providerId\n    );\n    if (!account) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: \"Account not found\"\n      });\n    }\n    const provider = ctx.context.socialProviders.find(\n      (p) => p.id === providerId\n    );\n    if (!provider) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: `Provider ${providerId} not found.`\n      });\n    }\n    if (!provider.refreshAccessToken) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: `Provider ${providerId} does not support token refreshing.`\n      });\n    }\n    try {\n      const tokens = await provider.refreshAccessToken(\n        account.refreshToken\n      );\n      await ctx.context.internalAdapter.updateAccount(account.id, {\n        accessToken: await setTokenUtil(tokens.accessToken, ctx.context),\n        refreshToken: await setTokenUtil(tokens.refreshToken, ctx.context),\n        accessTokenExpiresAt: tokens.accessTokenExpiresAt,\n        refreshTokenExpiresAt: tokens.refreshTokenExpiresAt\n      });\n      return ctx.json(tokens);\n    } catch (error) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: \"Failed to refresh access token\",\n        cause: error\n      });\n    }\n  }\n);\nconst accountInfo = (0,_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(\n  \"/account-info\",\n  {\n    method: \"POST\",\n    use: [_better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_1__.s],\n    metadata: {\n      openapi: {\n        description: \"Get the account info provided by the provider\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    user: {\n                      type: \"object\",\n                      properties: {\n                        id: {\n                          type: \"string\"\n                        },\n                        name: {\n                          type: \"string\"\n                        },\n                        email: {\n                          type: \"string\"\n                        },\n                        image: {\n                          type: \"string\"\n                        },\n                        emailVerified: {\n                          type: \"boolean\"\n                        }\n                      },\n                      required: [\"id\", \"emailVerified\"]\n                    },\n                    data: {\n                      type: \"object\",\n                      properties: {},\n                      additionalProperties: true\n                    }\n                  },\n                  required: [\"user\", \"data\"],\n                  additionalProperties: false\n                }\n              }\n            }\n          }\n        }\n      }\n    },\n    body: zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n      accountId: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().meta({\n        description: \"The provider given account id for which to get the account info\"\n      })\n    })\n  },\n  async (ctx) => {\n    const account = await ctx.context.internalAdapter.findAccount(\n      ctx.body.accountId\n    );\n    if (!account || account.userId !== ctx.context.session.user.id) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: \"Account not found\"\n      });\n    }\n    const provider = ctx.context.socialProviders.find(\n      (p) => p.id === account.providerId\n    );\n    if (!provider) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"INTERNAL_SERVER_ERROR\", {\n        message: `Provider account provider is ${account.providerId} but it is not configured`\n      });\n    }\n    const tokens = await getAccessToken({\n      ...ctx,\n      body: {\n        accountId: account.id,\n        providerId: account.providerId\n      },\n      returnHeaders: false\n    });\n    if (!tokens.accessToken) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_2__.APIError(\"BAD_REQUEST\", {\n        message: \"Access token not found\"\n      });\n    }\n    const info = await provider.getUserInfo({\n      ...tokens,\n      accessToken: tokens.accessToken\n    });\n    return ctx.json(info);\n  }\n);\n\nconst defuReplaceArrays = (0,defu__WEBPACK_IMPORTED_MODULE_21__.createDefu)((obj, key, value) => {\n  if (Array.isArray(obj[key]) && Array.isArray(value)) {\n    obj[key] = value;\n    return true;\n  }\n});\nfunction toAuthEndpoints(endpoints, ctx) {\n  const api = {};\n  for (const [key, endpoint] of Object.entries(endpoints)) {\n    api[key] = async (context) => {\n      const authContext = await ctx;\n      let internalContext = {\n        ...context,\n        context: {\n          ...authContext,\n          returned: void 0,\n          responseHeaders: void 0,\n          session: null\n        },\n        path: endpoint.path,\n        headers: context?.headers ? new Headers(context?.headers) : void 0\n      };\n      const { beforeHooks, afterHooks } = getHooks(authContext);\n      const before = await runBeforeHooks(internalContext, beforeHooks);\n      if (\"context\" in before && before.context && typeof before.context === \"object\") {\n        const { headers, ...rest } = before.context;\n        if (headers) {\n          headers.forEach((value, key2) => {\n            internalContext.headers.set(key2, value);\n          });\n        }\n        internalContext = defuReplaceArrays(rest, internalContext);\n      } else if (before) {\n        return before;\n      }\n      internalContext.asResponse = false;\n      internalContext.returnHeaders = true;\n      const result = await endpoint(internalContext).catch((e) => {\n        if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_2__.APIError) {\n          return {\n            response: e,\n            headers: e.headers ? new Headers(e.headers) : null\n          };\n        }\n        throw e;\n      });\n      if (result && result instanceof Response) {\n        return result;\n      }\n      internalContext.context.returned = result.response;\n      internalContext.context.responseHeaders = result.headers;\n      const after = await runAfterHooks(internalContext, afterHooks);\n      if (after.response) {\n        result.response = after.response;\n      }\n      if (result.response instanceof better_call__WEBPACK_IMPORTED_MODULE_2__.APIError && (0,_better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.s)(authContext.logger.level, \"debug\")) {\n        result.response.stack = result.response.errorStack;\n      }\n      if (result.response instanceof better_call__WEBPACK_IMPORTED_MODULE_2__.APIError && !context?.asResponse) {\n        throw result.response;\n      }\n      const response = context?.asResponse ? (0,better_call__WEBPACK_IMPORTED_MODULE_2__.toResponse)(result.response, {\n        headers: result.headers\n      }) : context?.returnHeaders ? {\n        headers: result.headers,\n        response: result.response\n      } : result.response;\n      return response;\n    };\n    api[key].path = endpoint.path;\n    api[key].options = endpoint.options;\n  }\n  return api;\n}\nasync function runBeforeHooks(context, hooks) {\n  let modifiedContext = {};\n  for (const hook of hooks) {\n    if (hook.matcher(context)) {\n      const result = await hook.handler({\n        ...context,\n        returnHeaders: false\n      }).catch((e) => {\n        if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_2__.APIError && (0,_better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.s)(context.context.logger.level, \"debug\")) {\n          e.stack = e.errorStack;\n        }\n        throw e;\n      });\n      if (result && typeof result === \"object\") {\n        if (\"context\" in result && typeof result.context === \"object\") {\n          const { headers, ...rest } = result.context;\n          if (headers instanceof Headers) {\n            if (modifiedContext.headers) {\n              headers.forEach((value, key) => {\n                modifiedContext.headers?.set(key, value);\n              });\n            } else {\n              modifiedContext.headers = headers;\n            }\n          }\n          modifiedContext = defuReplaceArrays(rest, modifiedContext);\n          continue;\n        }\n        return result;\n      }\n    }\n  }\n  return { context: modifiedContext };\n}\nasync function runAfterHooks(context, hooks) {\n  for (const hook of hooks) {\n    if (hook.matcher(context)) {\n      const result = await hook.handler(context).catch((e) => {\n        if (e instanceof better_call__WEBPACK_IMPORTED_MODULE_2__.APIError) {\n          if ((0,_better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_14__.s)(context.context.logger.level, \"debug\")) {\n            e.stack = e.errorStack;\n          }\n          return {\n            response: e,\n            headers: e.headers ? new Headers(e.headers) : null\n          };\n        }\n        throw e;\n      });\n      if (result.headers) {\n        result.headers.forEach((value, key) => {\n          if (!context.context.responseHeaders) {\n            context.context.responseHeaders = new Headers({\n              [key]: value\n            });\n          } else {\n            if (key.toLowerCase() === \"set-cookie\") {\n              context.context.responseHeaders.append(key, value);\n            } else {\n              context.context.responseHeaders.set(key, value);\n            }\n          }\n        });\n      }\n      if (result.response) {\n        context.context.returned = result.response;\n      }\n    }\n  }\n  return {\n    response: context.context.returned,\n    headers: context.context.responseHeaders\n  };\n}\nfunction getHooks(authContext) {\n  const plugins = authContext.options.plugins || [];\n  const beforeHooks = [];\n  const afterHooks = [];\n  if (authContext.options.hooks?.before) {\n    beforeHooks.push({\n      matcher: () => true,\n      handler: authContext.options.hooks.before\n    });\n  }\n  if (authContext.options.hooks?.after) {\n    afterHooks.push({\n      matcher: () => true,\n      handler: authContext.options.hooks.after\n    });\n  }\n  const pluginBeforeHooks = plugins.map((plugin) => {\n    if (plugin.hooks?.before) {\n      return plugin.hooks.before;\n    }\n  }).filter((plugin) => plugin !== void 0).flat();\n  const pluginAfterHooks = plugins.map((plugin) => {\n    if (plugin.hooks?.after) {\n      return plugin.hooks.after;\n    }\n  }).filter((plugin) => plugin !== void 0).flat();\n  pluginBeforeHooks.length && beforeHooks.push(...pluginBeforeHooks);\n  pluginAfterHooks.length && afterHooks.push(...pluginAfterHooks);\n  return {\n    beforeHooks,\n    afterHooks\n  };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQ2V3amJvWVAubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQTRCO0FBQ3dLO0FBQ2pKO0FBQ087QUFDTDtBQUNTO0FBQ29CO0FBQ2hDO0FBQ2dEO0FBQ2hFO0FBQ0Q7QUFDQTtBQUNMO0FBQ0k7QUFDQTtBQUN1QztBQUNxQjtBQUNDO0FBQ3BEO0FBQ047QUFDNkM7QUFDaEI7QUFDSDtBQUNJO0FBQ0Q7QUFDL0I7QUFDRTtBQUNEO0FBQ2dDOztBQUVsRTtBQUNBLGlMQUFpTCxnQkFBZ0I7QUFDak0sZ0JBQWdCLEtBQUs7QUFDckIsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsZ0JBQWdCO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdEQUFnRCx3QkFBd0I7QUFDeEUsaUJBQWlCLHlCQUF5QjtBQUMxQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBLCtCQUErQixpQkFBaUI7QUFDaEQsd0JBQXdCLGlCQUFpQjtBQUN6QyxNQUFNO0FBQ04sc0JBQXNCLGlCQUFpQjtBQUN2QztBQUNBO0FBQ0EseUNBQXlDLGlCQUFpQjtBQUMxRCx5Q0FBeUMsaUJBQWlCO0FBQzFEO0FBQ0E7QUFDQSxrQkFBa0IscUJBQXFCO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsU0FBUyxJQUFJLGlCQUFpQjtBQUN0RDtBQUNB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QUNYO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsaURBQVE7QUFDakMsY0FBYyw0REFBZ0I7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiLFlBQVk7QUFDWjtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRTBrRCIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcZGlzdFxcc2hhcmVkXFxiZXR0ZXItYXV0aC5DZXdqYm9ZUC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgeiBmcm9tICd6b2QvdjQnO1xuaW1wb3J0IHsgYyBhcyBjcmVhdGVBdXRoTWlkZGxld2FyZSwgYSBhcyBjcmVhdGVBdXRoRW5kcG9pbnQsIGcgYXMgZ2V0U2Vzc2lvbkZyb21DdHgsIEIgYXMgQkFTRV9FUlJPUl9DT0RFUywgcyBhcyBzZXNzaW9uTWlkZGxld2FyZSwgZiBhcyBmcmVzaFNlc3Npb25NaWRkbGV3YXJlIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5EVjVFSGVZRy5tanMnO1xuaW1wb3J0IHsgQVBJRXJyb3IsIHRvUmVzcG9uc2UgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5pbXBvcnQgeyBnIGFzIGdldERhdGUgfSBmcm9tICcuL2JldHRlci1hdXRoLkNXNkQ5ZVN4Lm1qcyc7XG5pbXBvcnQgeyBjcmVhdGVIYXNoIH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2hhc2gnO1xuaW1wb3J0IHsgYmFzZTY0VXJsLCBiYXNlNjQgfSBmcm9tICdAYmV0dGVyLWF1dGgvdXRpbHMvYmFzZTY0JztcbmltcG9ydCB7IHNpZ25KV1QsIHN5bW1ldHJpY0VuY3J5cHQsIHN5bW1ldHJpY0RlY3J5cHQgfSBmcm9tICcuLi9jcnlwdG8vaW5kZXgubWpzJztcbmltcG9ydCB7IGJldHRlckZldGNoIH0gZnJvbSAnQGJldHRlci1mZXRjaC9mZXRjaCc7XG5pbXBvcnQgeyBqd3RWZXJpZnksIGRlY29kZUp3dCwgZGVjb2RlUHJvdGVjdGVkSGVhZGVyLCBpbXBvcnRKV0ssIGNyZWF0ZVJlbW90ZUpXS1NldCB9IGZyb20gJ2pvc2UnO1xuaW1wb3J0ICdAbm9ibGUvY2lwaGVycy9jaGFjaGEuanMnO1xuaW1wb3J0ICdAbm9ibGUvY2lwaGVycy91dGlscy5qcyc7XG5pbXBvcnQgJ0Bub2JsZS9oYXNoZXMvc2NyeXB0LmpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2hleCc7XG5pbXBvcnQgJ0Bub2JsZS9oYXNoZXMvdXRpbHMuanMnO1xuaW1wb3J0IHsgZyBhcyBnZW5lcmF0ZVJhbmRvbVN0cmluZyB9IGZyb20gJy4vYmV0dGVyLWF1dGguQjRRb3hkZ2MubWpzJztcbmltcG9ydCB7IGcgYXMgZ2V0T3JpZ2luLCBiIGFzIGdldEhvc3QsIGMgYXMgZ2V0UHJvdG9jb2wgfSBmcm9tICcuL2JldHRlci1hdXRoLkN1U19lRGRLLm1qcyc7XG5pbXBvcnQgeyBzIGFzIHNldFNlc3Npb25Db29raWUsIGQgYXMgZGVsZXRlU2Vzc2lvbkNvb2tpZSB9IGZyb20gJy4vYmV0dGVyLWF1dGguVWZWV0FySUIubWpzJztcbmltcG9ydCB7IEpXVEV4cGlyZWQgfSBmcm9tICdqb3NlL2Vycm9ycyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9yYW5kb20nO1xuaW1wb3J0IHsgYSBhcyBsb2dnZXIsIHMgYXMgc2hvdWxkUHVibGlzaExvZyB9IGZyb20gJy4vYmV0dGVyLWF1dGguQmpCbHlidi0ubWpzJztcbmltcG9ydCB7IHMgYXMgc2FmZUpTT05QYXJzZSB9IGZyb20gJy4vYmV0dGVyLWF1dGguQlpaS04xZzcubWpzJztcbmltcG9ydCB7IGcgYXMgZ2VuZXJhdGVJZCB9IGZyb20gJy4vYmV0dGVyLWF1dGguQlVQUFJYZksubWpzJztcbmltcG9ydCB7IGggYXMgcGFyc2VVc2VySW5wdXQgfSBmcm9tICcuL2JldHRlci1hdXRoLkRjdjhQUzdULm1qcyc7XG5pbXBvcnQgeyBiIGFzIGlzRGV2ZWxvcG1lbnQgfSBmcm9tICcuL2JldHRlci1hdXRoLkNNUTNyQS1JLm1qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9obWFjJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2JpbmFyeSc7XG5pbXBvcnQgeyBjcmVhdGVEZWZ1IH0gZnJvbSAnZGVmdSc7XG5pbXBvcnQgeyBCIGFzIEJldHRlckF1dGhFcnJvciB9IGZyb20gJy4vYmV0dGVyLWF1dGguRGR6U0pmLW4ubWpzJztcblxuZnVuY3Rpb24gZXNjYXBlUmVnRXhwQ2hhcihjaGFyKSB7XG4gIGlmIChjaGFyID09PSBcIi1cIiB8fCBjaGFyID09PSBcIl5cIiB8fCBjaGFyID09PSBcIiRcIiB8fCBjaGFyID09PSBcIitcIiB8fCBjaGFyID09PSBcIi5cIiB8fCBjaGFyID09PSBcIihcIiB8fCBjaGFyID09PSBcIilcIiB8fCBjaGFyID09PSBcInxcIiB8fCBjaGFyID09PSBcIltcIiB8fCBjaGFyID09PSBcIl1cIiB8fCBjaGFyID09PSBcIntcIiB8fCBjaGFyID09PSBcIn1cIiB8fCBjaGFyID09PSBcIipcIiB8fCBjaGFyID09PSBcIj9cIiB8fCBjaGFyID09PSBcIlxcXFxcIikge1xuICAgIHJldHVybiBgXFxcXCR7Y2hhcn1gO1xuICB9IGVsc2Uge1xuICAgIHJldHVybiBjaGFyO1xuICB9XG59XG5mdW5jdGlvbiBlc2NhcGVSZWdFeHBTdHJpbmcoc3RyKSB7XG4gIGxldCByZXN1bHQgPSBcIlwiO1xuICBmb3IgKGxldCBpID0gMDsgaSA8IHN0ci5sZW5ndGg7IGkrKykge1xuICAgIHJlc3VsdCArPSBlc2NhcGVSZWdFeHBDaGFyKHN0cltpXSk7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIHRyYW5zZm9ybShwYXR0ZXJuLCBzZXBhcmF0b3IgPSB0cnVlKSB7XG4gIGlmIChBcnJheS5pc0FycmF5KHBhdHRlcm4pKSB7XG4gICAgbGV0IHJlZ0V4cFBhdHRlcm5zID0gcGF0dGVybi5tYXAoKHApID0+IGBeJHt0cmFuc2Zvcm0ocCwgc2VwYXJhdG9yKX0kYCk7XG4gICAgcmV0dXJuIGAoPzoke3JlZ0V4cFBhdHRlcm5zLmpvaW4oXCJ8XCIpfSlgO1xuICB9XG4gIGxldCBzZXBhcmF0b3JTcGxpdHRlciA9IFwiXCI7XG4gIGxldCBzZXBhcmF0b3JNYXRjaGVyID0gXCJcIjtcbiAgbGV0IHdpbGRjYXJkID0gXCIuXCI7XG4gIGlmIChzZXBhcmF0b3IgPT09IHRydWUpIHtcbiAgICBzZXBhcmF0b3JTcGxpdHRlciA9IFwiL1wiO1xuICAgIHNlcGFyYXRvck1hdGNoZXIgPSBcIlsvXFxcXFxcXFxdXCI7XG4gICAgd2lsZGNhcmQgPSBcIlteL1xcXFxcXFxcXVwiO1xuICB9IGVsc2UgaWYgKHNlcGFyYXRvcikge1xuICAgIHNlcGFyYXRvclNwbGl0dGVyID0gc2VwYXJhdG9yO1xuICAgIHNlcGFyYXRvck1hdGNoZXIgPSBlc2NhcGVSZWdFeHBTdHJpbmcoc2VwYXJhdG9yU3BsaXR0ZXIpO1xuICAgIGlmIChzZXBhcmF0b3JNYXRjaGVyLmxlbmd0aCA+IDEpIHtcbiAgICAgIHNlcGFyYXRvck1hdGNoZXIgPSBgKD86JHtzZXBhcmF0b3JNYXRjaGVyfSlgO1xuICAgICAgd2lsZGNhcmQgPSBgKCg/ISR7c2VwYXJhdG9yTWF0Y2hlcn0pLilgO1xuICAgIH0gZWxzZSB7XG4gICAgICB3aWxkY2FyZCA9IGBbXiR7c2VwYXJhdG9yTWF0Y2hlcn1dYDtcbiAgICB9XG4gIH1cbiAgbGV0IHJlcXVpcmVkU2VwYXJhdG9yID0gc2VwYXJhdG9yID8gYCR7c2VwYXJhdG9yTWF0Y2hlcn0rP2AgOiBcIlwiO1xuICBsZXQgb3B0aW9uYWxTZXBhcmF0b3IgPSBzZXBhcmF0b3IgPyBgJHtzZXBhcmF0b3JNYXRjaGVyfSo/YCA6IFwiXCI7XG4gIGxldCBzZWdtZW50cyA9IHNlcGFyYXRvciA/IHBhdHRlcm4uc3BsaXQoc2VwYXJhdG9yU3BsaXR0ZXIpIDogW3BhdHRlcm5dO1xuICBsZXQgcmVzdWx0ID0gXCJcIjtcbiAgZm9yIChsZXQgcyA9IDA7IHMgPCBzZWdtZW50cy5sZW5ndGg7IHMrKykge1xuICAgIGxldCBzZWdtZW50ID0gc2VnbWVudHNbc107XG4gICAgbGV0IG5leHRTZWdtZW50ID0gc2VnbWVudHNbcyArIDFdO1xuICAgIGxldCBjdXJyZW50U2VwYXJhdG9yID0gXCJcIjtcbiAgICBpZiAoIXNlZ21lbnQgJiYgcyA+IDApIHtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoc2VwYXJhdG9yKSB7XG4gICAgICBpZiAocyA9PT0gc2VnbWVudHMubGVuZ3RoIC0gMSkge1xuICAgICAgICBjdXJyZW50U2VwYXJhdG9yID0gb3B0aW9uYWxTZXBhcmF0b3I7XG4gICAgICB9IGVsc2UgaWYgKG5leHRTZWdtZW50ICE9PSBcIioqXCIpIHtcbiAgICAgICAgY3VycmVudFNlcGFyYXRvciA9IHJlcXVpcmVkU2VwYXJhdG9yO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgY3VycmVudFNlcGFyYXRvciA9IFwiXCI7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChzZXBhcmF0b3IgJiYgc2VnbWVudCA9PT0gXCIqKlwiKSB7XG4gICAgICBpZiAoY3VycmVudFNlcGFyYXRvcikge1xuICAgICAgICByZXN1bHQgKz0gcyA9PT0gMCA/IFwiXCIgOiBjdXJyZW50U2VwYXJhdG9yO1xuICAgICAgICByZXN1bHQgKz0gYCg/OiR7d2lsZGNhcmR9Kj8ke2N1cnJlbnRTZXBhcmF0b3J9KSo/YDtcbiAgICAgIH1cbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBmb3IgKGxldCBjID0gMDsgYyA8IHNlZ21lbnQubGVuZ3RoOyBjKyspIHtcbiAgICAgIGxldCBjaGFyID0gc2VnbWVudFtjXTtcbiAgICAgIGlmIChjaGFyID09PSBcIlxcXFxcIikge1xuICAgICAgICBpZiAoYyA8IHNlZ21lbnQubGVuZ3RoIC0gMSkge1xuICAgICAgICAgIHJlc3VsdCArPSBlc2NhcGVSZWdFeHBDaGFyKHNlZ21lbnRbYyArIDFdKTtcbiAgICAgICAgICBjKys7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoY2hhciA9PT0gXCI/XCIpIHtcbiAgICAgICAgcmVzdWx0ICs9IHdpbGRjYXJkO1xuICAgICAgfSBlbHNlIGlmIChjaGFyID09PSBcIipcIikge1xuICAgICAgICByZXN1bHQgKz0gYCR7d2lsZGNhcmR9Kj9gO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgcmVzdWx0ICs9IGVzY2FwZVJlZ0V4cENoYXIoY2hhcik7XG4gICAgICB9XG4gICAgfVxuICAgIHJlc3VsdCArPSBjdXJyZW50U2VwYXJhdG9yO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5mdW5jdGlvbiBpc01hdGNoKHJlZ2V4cCwgc2FtcGxlKSB7XG4gIGlmICh0eXBlb2Ygc2FtcGxlICE9PSBcInN0cmluZ1wiKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgU2FtcGxlIG11c3QgYmUgYSBzdHJpbmcsIGJ1dCAke3R5cGVvZiBzYW1wbGV9IGdpdmVuYCk7XG4gIH1cbiAgcmV0dXJuIHJlZ2V4cC50ZXN0KHNhbXBsZSk7XG59XG5mdW5jdGlvbiB3aWxkY2FyZE1hdGNoKHBhdHRlcm4sIG9wdGlvbnMpIHtcbiAgaWYgKHR5cGVvZiBwYXR0ZXJuICE9PSBcInN0cmluZ1wiICYmICFBcnJheS5pc0FycmF5KHBhdHRlcm4pKSB7XG4gICAgdGhyb3cgbmV3IFR5cGVFcnJvcihcbiAgICAgIGBUaGUgZmlyc3QgYXJndW1lbnQgbXVzdCBiZSBhIHNpbmdsZSBwYXR0ZXJuIHN0cmluZyBvciBhbiBhcnJheSBvZiBwYXR0ZXJucywgYnV0ICR7dHlwZW9mIHBhdHRlcm59IGdpdmVuYFxuICAgICk7XG4gIH1cbiAgaWYgKHR5cGVvZiBvcHRpb25zID09PSBcInN0cmluZ1wiIHx8IHR5cGVvZiBvcHRpb25zID09PSBcImJvb2xlYW5cIikge1xuICAgIG9wdGlvbnMgPSB7IHNlcGFyYXRvcjogb3B0aW9ucyB9O1xuICB9XG4gIGlmIChhcmd1bWVudHMubGVuZ3RoID09PSAyICYmICEodHlwZW9mIG9wdGlvbnMgPT09IFwidW5kZWZpbmVkXCIgfHwgdHlwZW9mIG9wdGlvbnMgPT09IFwib2JqZWN0XCIgJiYgb3B0aW9ucyAhPT0gbnVsbCAmJiAhQXJyYXkuaXNBcnJheShvcHRpb25zKSkpIHtcbiAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFxuICAgICAgYFRoZSBzZWNvbmQgYXJndW1lbnQgbXVzdCBiZSBhbiBvcHRpb25zIG9iamVjdCBvciBhIHN0cmluZy9ib29sZWFuIHNlcGFyYXRvciwgYnV0ICR7dHlwZW9mIG9wdGlvbnN9IGdpdmVuYFxuICAgICk7XG4gIH1cbiAgb3B0aW9ucyA9IG9wdGlvbnMgfHwge307XG4gIGlmIChvcHRpb25zLnNlcGFyYXRvciA9PT0gXCJcXFxcXCIpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBcIlxcXFwgaXMgbm90IGEgdmFsaWQgc2VwYXJhdG9yIGJlY2F1c2UgaXQgaXMgdXNlZCBmb3IgZXNjYXBpbmcuIFRyeSBzZXR0aW5nIHRoZSBzZXBhcmF0b3IgdG8gYHRydWVgIGluc3RlYWRcIlxuICAgICk7XG4gIH1cbiAgbGV0IHJlZ2V4cFBhdHRlcm4gPSB0cmFuc2Zvcm0ocGF0dGVybiwgb3B0aW9ucy5zZXBhcmF0b3IpO1xuICBsZXQgcmVnZXhwID0gbmV3IFJlZ0V4cChgXiR7cmVnZXhwUGF0dGVybn0kYCwgb3B0aW9ucy5mbGFncyk7XG4gIGxldCBmbiA9IGlzTWF0Y2guYmluZChudWxsLCByZWdleHApO1xuICBmbi5vcHRpb25zID0gb3B0aW9ucztcbiAgZm4ucGF0dGVybiA9IHBhdHRlcm47XG4gIGZuLnJlZ2V4cCA9IHJlZ2V4cDtcbiAgcmV0dXJuIGZuO1xufVxuXG5jb25zdCBvcmlnaW5DaGVja01pZGRsZXdhcmUgPSBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gIGlmIChjdHgucmVxdWVzdD8ubWV0aG9kICE9PSBcIlBPU1RcIiB8fCAhY3R4LnJlcXVlc3QpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgY29uc3QgeyBib2R5LCBxdWVyeSwgY29udGV4dCB9ID0gY3R4O1xuICBjb25zdCBvcmlnaW5IZWFkZXIgPSBjdHguaGVhZGVycz8uZ2V0KFwib3JpZ2luXCIpIHx8IGN0eC5oZWFkZXJzPy5nZXQoXCJyZWZlcmVyXCIpIHx8IFwiXCI7XG4gIGNvbnN0IGNhbGxiYWNrVVJMID0gYm9keT8uY2FsbGJhY2tVUkwgfHwgcXVlcnk/LmNhbGxiYWNrVVJMO1xuICBjb25zdCByZWRpcmVjdFVSTCA9IGJvZHk/LnJlZGlyZWN0VG87XG4gIGNvbnN0IGVycm9yQ2FsbGJhY2tVUkwgPSBib2R5Py5lcnJvckNhbGxiYWNrVVJMO1xuICBjb25zdCBuZXdVc2VyQ2FsbGJhY2tVUkwgPSBib2R5Py5uZXdVc2VyQ2FsbGJhY2tVUkw7XG4gIGNvbnN0IHRydXN0ZWRPcmlnaW5zID0gQXJyYXkuaXNBcnJheShjb250ZXh0Lm9wdGlvbnMudHJ1c3RlZE9yaWdpbnMpID8gY29udGV4dC50cnVzdGVkT3JpZ2lucyA6IFtcbiAgICAuLi5jb250ZXh0LnRydXN0ZWRPcmlnaW5zLFxuICAgIC4uLmF3YWl0IGNvbnRleHQub3B0aW9ucy50cnVzdGVkT3JpZ2lucz8uKGN0eC5yZXF1ZXN0KSB8fCBbXVxuICBdO1xuICBjb25zdCB1c2VzQ29va2llcyA9IGN0eC5oZWFkZXJzPy5oYXMoXCJjb29raWVcIik7XG4gIGNvbnN0IG1hdGNoZXNQYXR0ZXJuID0gKHVybCwgcGF0dGVybikgPT4ge1xuICAgIGlmICh1cmwuc3RhcnRzV2l0aChcIi9cIikpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHBhdHRlcm4uaW5jbHVkZXMoXCIqXCIpKSB7XG4gICAgICBpZiAocGF0dGVybi5pbmNsdWRlcyhcIjovL1wiKSkge1xuICAgICAgICByZXR1cm4gd2lsZGNhcmRNYXRjaChwYXR0ZXJuKShnZXRPcmlnaW4odXJsKSB8fCB1cmwpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHdpbGRjYXJkTWF0Y2gocGF0dGVybikoZ2V0SG9zdCh1cmwpKTtcbiAgICB9XG4gICAgY29uc3QgcHJvdG9jb2wgPSBnZXRQcm90b2NvbCh1cmwpO1xuICAgIHJldHVybiBwcm90b2NvbCA9PT0gXCJodHRwOlwiIHx8IHByb3RvY29sID09PSBcImh0dHBzOlwiIHx8ICFwcm90b2NvbCA/IHBhdHRlcm4gPT09IGdldE9yaWdpbih1cmwpIDogdXJsLnN0YXJ0c1dpdGgocGF0dGVybik7XG4gIH07XG4gIGNvbnN0IHZhbGlkYXRlVVJMID0gKHVybCwgbGFiZWwpID0+IHtcbiAgICBpZiAoIXVybCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBpc1RydXN0ZWRPcmlnaW4gPSB0cnVzdGVkT3JpZ2lucy5zb21lKFxuICAgICAgKG9yaWdpbikgPT4gbWF0Y2hlc1BhdHRlcm4odXJsLCBvcmlnaW4pIHx8IHVybD8uc3RhcnRzV2l0aChcIi9cIikgJiYgbGFiZWwgIT09IFwib3JpZ2luXCIgJiYgL15cXC8oPyFcXC98XFxcXHwlMmZ8JTVjKVtcXHdcXC0uXFwrL0BdKig/OlxcP1tcXHdcXC0uXFwrLz0mJUBdKik/JC8udGVzdCh1cmwpXG4gICAgKTtcbiAgICBpZiAoIWlzVHJ1c3RlZE9yaWdpbikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKGBJbnZhbGlkICR7bGFiZWx9OiAke3VybH1gKTtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5pbmZvKFxuICAgICAgICBgSWYgaXQncyBhIHZhbGlkIFVSTCwgcGxlYXNlIGFkZCAke3VybH0gdG8gdHJ1c3RlZE9yaWdpbnMgaW4geW91ciBhdXRoIGNvbmZpZ1xuYCxcbiAgICAgICAgYEN1cnJlbnQgbGlzdCBvZiB0cnVzdGVkT3JpZ2luczogJHt0cnVzdGVkT3JpZ2luc31gXG4gICAgICApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHsgbWVzc2FnZTogYEludmFsaWQgJHtsYWJlbH1gIH0pO1xuICAgIH1cbiAgfTtcbiAgaWYgKHVzZXNDb29raWVzICYmICFjdHguY29udGV4dC5vcHRpb25zLmFkdmFuY2VkPy5kaXNhYmxlQ1NSRkNoZWNrKSB7XG4gICAgdmFsaWRhdGVVUkwob3JpZ2luSGVhZGVyLCBcIm9yaWdpblwiKTtcbiAgfVxuICBjYWxsYmFja1VSTCAmJiB2YWxpZGF0ZVVSTChjYWxsYmFja1VSTCwgXCJjYWxsYmFja1VSTFwiKTtcbiAgcmVkaXJlY3RVUkwgJiYgdmFsaWRhdGVVUkwocmVkaXJlY3RVUkwsIFwicmVkaXJlY3RVUkxcIik7XG4gIGVycm9yQ2FsbGJhY2tVUkwgJiYgdmFsaWRhdGVVUkwoZXJyb3JDYWxsYmFja1VSTCwgXCJlcnJvckNhbGxiYWNrVVJMXCIpO1xuICBuZXdVc2VyQ2FsbGJhY2tVUkwgJiYgdmFsaWRhdGVVUkwobmV3VXNlckNhbGxiYWNrVVJMLCBcIm5ld1VzZXJDYWxsYmFja1VSTFwiKTtcbn0pO1xuY29uc3Qgb3JpZ2luQ2hlY2sgPSAoZ2V0VmFsdWUpID0+IGNyZWF0ZUF1dGhNaWRkbGV3YXJlKGFzeW5jIChjdHgpID0+IHtcbiAgaWYgKCFjdHgucmVxdWVzdCkge1xuICAgIHJldHVybjtcbiAgfVxuICBjb25zdCB7IGNvbnRleHQgfSA9IGN0eDtcbiAgY29uc3QgY2FsbGJhY2tVUkwgPSBnZXRWYWx1ZShjdHgpO1xuICBjb25zdCB0cnVzdGVkT3JpZ2lucyA9IEFycmF5LmlzQXJyYXkoXG4gICAgY29udGV4dC5vcHRpb25zLnRydXN0ZWRPcmlnaW5zXG4gICkgPyBjb250ZXh0LnRydXN0ZWRPcmlnaW5zIDogW1xuICAgIC4uLmNvbnRleHQudHJ1c3RlZE9yaWdpbnMsXG4gICAgLi4uYXdhaXQgY29udGV4dC5vcHRpb25zLnRydXN0ZWRPcmlnaW5zPy4oY3R4LnJlcXVlc3QpIHx8IFtdXG4gIF07XG4gIGNvbnN0IG1hdGNoZXNQYXR0ZXJuID0gKHVybCwgcGF0dGVybikgPT4ge1xuICAgIGlmICh1cmwuc3RhcnRzV2l0aChcIi9cIikpIHtcbiAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKHBhdHRlcm4uaW5jbHVkZXMoXCIqXCIpKSB7XG4gICAgICBpZiAocGF0dGVybi5pbmNsdWRlcyhcIjovL1wiKSkge1xuICAgICAgICByZXR1cm4gd2lsZGNhcmRNYXRjaChwYXR0ZXJuKShnZXRPcmlnaW4odXJsKSB8fCB1cmwpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHdpbGRjYXJkTWF0Y2gocGF0dGVybikoZ2V0SG9zdCh1cmwpKTtcbiAgICB9XG4gICAgY29uc3QgcHJvdG9jb2wgPSBnZXRQcm90b2NvbCh1cmwpO1xuICAgIHJldHVybiBwcm90b2NvbCA9PT0gXCJodHRwOlwiIHx8IHByb3RvY29sID09PSBcImh0dHBzOlwiIHx8ICFwcm90b2NvbCA/IHBhdHRlcm4gPT09IGdldE9yaWdpbih1cmwpIDogdXJsLnN0YXJ0c1dpdGgocGF0dGVybik7XG4gIH07XG4gIGNvbnN0IHZhbGlkYXRlVVJMID0gKHVybCwgbGFiZWwpID0+IHtcbiAgICBpZiAoIXVybCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBpc1RydXN0ZWRPcmlnaW4gPSB0cnVzdGVkT3JpZ2lucy5zb21lKFxuICAgICAgKG9yaWdpbikgPT4gbWF0Y2hlc1BhdHRlcm4odXJsLCBvcmlnaW4pIHx8IHVybD8uc3RhcnRzV2l0aChcIi9cIikgJiYgbGFiZWwgIT09IFwib3JpZ2luXCIgJiYgL15cXC8oPyFcXC98XFxcXHwlMmZ8JTVjKVtcXHdcXC0uXFwrL0BdKig/OlxcP1tcXHdcXC0uXFwrLz0mJUBdKik/JC8udGVzdChcbiAgICAgICAgdXJsXG4gICAgICApXG4gICAgKTtcbiAgICBpZiAoIWlzVHJ1c3RlZE9yaWdpbikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKGBJbnZhbGlkICR7bGFiZWx9OiAke3VybH1gKTtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5pbmZvKFxuICAgICAgICBgSWYgaXQncyBhIHZhbGlkIFVSTCwgcGxlYXNlIGFkZCAke3VybH0gdG8gdHJ1c3RlZE9yaWdpbnMgaW4geW91ciBhdXRoIGNvbmZpZ1xuYCxcbiAgICAgICAgYEN1cnJlbnQgbGlzdCBvZiB0cnVzdGVkT3JpZ2luczogJHt0cnVzdGVkT3JpZ2luc31gXG4gICAgICApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHsgbWVzc2FnZTogYEludmFsaWQgJHtsYWJlbH1gIH0pO1xuICAgIH1cbiAgfTtcbiAgY29uc3QgY2FsbGJhY2tzID0gQXJyYXkuaXNBcnJheShjYWxsYmFja1VSTCkgPyBjYWxsYmFja1VSTCA6IFtjYWxsYmFja1VSTF07XG4gIGZvciAoY29uc3QgdXJsIG9mIGNhbGxiYWNrcykge1xuICAgIHZhbGlkYXRlVVJMKHVybCwgXCJjYWxsYmFja1VSTFwiKTtcbiAgfVxufSk7XG5cbmFzeW5jIGZ1bmN0aW9uIGNyZWF0ZUVtYWlsVmVyaWZpY2F0aW9uVG9rZW4oc2VjcmV0LCBlbWFpbCwgdXBkYXRlVG8sIGV4cGlyZXNJbiA9IDM2MDApIHtcbiAgY29uc3QgdG9rZW4gPSBhd2FpdCBzaWduSldUKFxuICAgIHtcbiAgICAgIGVtYWlsOiBlbWFpbC50b0xvd2VyQ2FzZSgpLFxuICAgICAgdXBkYXRlVG9cbiAgICB9LFxuICAgIHNlY3JldCxcbiAgICBleHBpcmVzSW5cbiAgKTtcbiAgcmV0dXJuIHRva2VuO1xufVxuYXN5bmMgZnVuY3Rpb24gc2VuZFZlcmlmaWNhdGlvbkVtYWlsRm4oY3R4LCB1c2VyKSB7XG4gIGlmICghY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uc2VuZFZlcmlmaWNhdGlvbkVtYWlsKSB7XG4gICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiVmVyaWZpY2F0aW9uIGVtYWlsIGlzbid0IGVuYWJsZWQuXCIpO1xuICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgIG1lc3NhZ2U6IFwiVmVyaWZpY2F0aW9uIGVtYWlsIGlzbid0IGVuYWJsZWRcIlxuICAgIH0pO1xuICB9XG4gIGNvbnN0IHRva2VuID0gYXdhaXQgY3JlYXRlRW1haWxWZXJpZmljYXRpb25Ub2tlbihcbiAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgdXNlci5lbWFpbCxcbiAgICB2b2lkIDAsXG4gICAgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uZXhwaXJlc0luXG4gICk7XG4gIGNvbnN0IHVybCA9IGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L3ZlcmlmeS1lbWFpbD90b2tlbj0ke3Rva2VufSZjYWxsYmFja1VSTD0ke2N0eC5ib2R5LmNhbGxiYWNrVVJMIHx8IFwiL1wifWA7XG4gIGF3YWl0IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24uc2VuZFZlcmlmaWNhdGlvbkVtYWlsKFxuICAgIHtcbiAgICAgIHVzZXIsXG4gICAgICB1cmwsXG4gICAgICB0b2tlblxuICAgIH0sXG4gICAgY3R4LnJlcXVlc3RcbiAgKTtcbn1cbmNvbnN0IHNlbmRWZXJpZmljYXRpb25FbWFpbCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvc2VuZC12ZXJpZmljYXRpb24tZW1haWxcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgZW1haWw6IHouZW1haWwoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGVtYWlsIHRvIHNlbmQgdGhlIHZlcmlmaWNhdGlvbiBlbWFpbCB0b1wiXG4gICAgICB9KSxcbiAgICAgIGNhbGxiYWNrVVJMOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHVzZSBmb3IgZW1haWwgdmVyaWZpY2F0aW9uIGNhbGxiYWNrXCJcbiAgICAgIH0pLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJTZW5kIGEgdmVyaWZpY2F0aW9uIGVtYWlsIHRvIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlcXVlc3RCb2R5OiB7XG4gICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICBlbWFpbDoge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgZW1haWwgdG8gc2VuZCB0aGUgdmVyaWZpY2F0aW9uIGVtYWlsIHRvXCIsXG4gICAgICAgICAgICAgICAgICAgIGV4YW1wbGU6IFwidXNlckBleGFtcGxlLmNvbVwiXG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgY2FsbGJhY2tVUkw6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byB1c2UgZm9yIGVtYWlsIHZlcmlmaWNhdGlvbiBjYWxsYmFja1wiLFxuICAgICAgICAgICAgICAgICAgICBleGFtcGxlOiBcImh0dHBzOi8vZXhhbXBsZS5jb20vY2FsbGJhY2tcIixcbiAgICAgICAgICAgICAgICAgICAgbnVsbGFibGU6IHRydWVcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJlbWFpbFwiXVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbmRpY2F0ZXMgaWYgdGhlIGVtYWlsIHdhcyBzZW50IHN1Y2Nlc3NmdWxseVwiLFxuICAgICAgICAgICAgICAgICAgICAgIGV4YW1wbGU6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgXCI0MDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiQmFkIFJlcXVlc3RcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkVycm9yIG1lc3NhZ2VcIixcbiAgICAgICAgICAgICAgICAgICAgICBleGFtcGxlOiBcIlZlcmlmaWNhdGlvbiBlbWFpbCBpc24ndCBlbmFibGVkXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGlmICghY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uc2VuZFZlcmlmaWNhdGlvbkVtYWlsKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJWZXJpZmljYXRpb24gZW1haWwgaXNuJ3QgZW5hYmxlZC5cIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiVmVyaWZpY2F0aW9uIGVtYWlsIGlzbid0IGVuYWJsZWRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHsgZW1haWwgfSA9IGN0eC5ib2R5O1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwoZW1haWwpO1xuICAgICAgaWYgKCF1c2VyKSB7XG4gICAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgICAgc3RhdHVzOiB0cnVlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgYXdhaXQgc2VuZFZlcmlmaWNhdGlvbkVtYWlsRm4oY3R4LCB1c2VyLnVzZXIpO1xuICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgc3RhdHVzOiB0cnVlXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKHNlc3Npb24/LnVzZXIuZW1haWxWZXJpZmllZCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIllvdSBjYW4gb25seSBzZW5kIGEgdmVyaWZpY2F0aW9uIGVtYWlsIHRvIGFuIHVudmVyaWZpZWQgZW1haWxcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChzZXNzaW9uPy51c2VyLmVtYWlsICE9PSBlbWFpbCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIllvdSBjYW4gb25seSBzZW5kIGEgdmVyaWZpY2F0aW9uIGVtYWlsIHRvIHlvdXIgb3duIGVtYWlsXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBzZW5kVmVyaWZpY2F0aW9uRW1haWxGbihjdHgsIHNlc3Npb24udXNlcik7XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN0YXR1czogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xuY29uc3QgdmVyaWZ5RW1haWwgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3ZlcmlmeS1lbWFpbFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIHF1ZXJ5OiB6Lm9iamVjdCh7XG4gICAgICB0b2tlbjogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHRva2VuIHRvIHZlcmlmeSB0aGUgZW1haWxcIlxuICAgICAgfSksXG4gICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byByZWRpcmVjdCB0byBhZnRlciBlbWFpbCB2ZXJpZmljYXRpb25cIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIHVzZTogW29yaWdpbkNoZWNrKChjdHgpID0+IGN0eC5xdWVyeS5jYWxsYmFja1VSTCldLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlZlcmlmeSB0aGUgZW1haWwgb2YgdGhlIHVzZXJcIixcbiAgICAgICAgcGFyYW1ldGVyczogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIG5hbWU6IFwidG9rZW5cIixcbiAgICAgICAgICAgIGluOiBcInF1ZXJ5XCIsXG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdG9rZW4gdG8gdmVyaWZ5IHRoZSBlbWFpbFwiLFxuICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAge1xuICAgICAgICAgICAgbmFtZTogXCJjYWxsYmFja1VSTFwiLFxuICAgICAgICAgICAgaW46IFwicXVlcnlcIixcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gcmVkaXJlY3QgdG8gYWZ0ZXIgZW1haWwgdmVyaWZpY2F0aW9uXCIsXG4gICAgICAgICAgICByZXF1aXJlZDogZmFsc2UsXG4gICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlciBJRFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW1haWw6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlciBlbWFpbFwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2VyIG5hbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGltYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZXIgaW1hZ2UgVVJMXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbmRpY2F0ZXMgaWYgdGhlIHVzZXIgZW1haWwgaXMgdmVyaWZpZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2VyIGNyZWF0aW9uIGRhdGVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVc2VyIHVwZGF0ZSBkYXRlXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXG4gICAgICAgICAgICAgICAgICAgICAgICBcImlkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImVtYWlsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcIm5hbWVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaW1hZ2VcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW1haWxWZXJpZmllZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVkQXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidXBkYXRlZEF0XCJcbiAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluZGljYXRlcyBpZiB0aGUgZW1haWwgd2FzIHZlcmlmaWVkIHN1Y2Nlc3NmdWxseVwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1widXNlclwiLCBcInN0YXR1c1wiXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGZ1bmN0aW9uIHJlZGlyZWN0T25FcnJvcihlcnJvcikge1xuICAgICAgaWYgKGN0eC5xdWVyeS5jYWxsYmFja1VSTCkge1xuICAgICAgICBpZiAoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMLmluY2x1ZGVzKFwiP1wiKSkge1xuICAgICAgICAgIHRocm93IGN0eC5yZWRpcmVjdChgJHtjdHgucXVlcnkuY2FsbGJhY2tVUkx9JmVycm9yPSR7ZXJyb3J9YCk7XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KGAke2N0eC5xdWVyeS5jYWxsYmFja1VSTH0/ZXJyb3I9JHtlcnJvcn1gKTtcbiAgICAgIH1cbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IGVycm9yXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgeyB0b2tlbiB9ID0gY3R4LnF1ZXJ5O1xuICAgIGxldCBqd3Q7XG4gICAgdHJ5IHtcbiAgICAgIGp3dCA9IGF3YWl0IGp3dFZlcmlmeShcbiAgICAgICAgdG9rZW4sXG4gICAgICAgIG5ldyBUZXh0RW5jb2RlcigpLmVuY29kZShjdHguY29udGV4dC5zZWNyZXQpLFxuICAgICAgICB7XG4gICAgICAgICAgYWxnb3JpdGhtczogW1wiSFMyNTZcIl1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBpZiAoZSBpbnN0YW5jZW9mIEpXVEV4cGlyZWQpIHtcbiAgICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcInRva2VuX2V4cGlyZWRcIik7XG4gICAgICB9XG4gICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKFwiaW52YWxpZF90b2tlblwiKTtcbiAgICB9XG4gICAgY29uc3Qgc2NoZW1hID0gei5vYmplY3Qoe1xuICAgICAgZW1haWw6IHouc3RyaW5nKCkuZW1haWwoKSxcbiAgICAgIHVwZGF0ZVRvOiB6LnN0cmluZygpLm9wdGlvbmFsKClcbiAgICB9KTtcbiAgICBjb25zdCBwYXJzZWQgPSBzY2hlbWEucGFyc2Uoand0LnBheWxvYWQpO1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUVtYWlsKFxuICAgICAgcGFyc2VkLmVtYWlsXG4gICAgKTtcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJ1c2VyX25vdF9mb3VuZFwiKTtcbiAgICB9XG4gICAgaWYgKHBhcnNlZC51cGRhdGVUbykge1xuICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb25Gcm9tQ3R4KGN0eCk7XG4gICAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgICAgaWYgKGN0eC5xdWVyeS5jYWxsYmFja1VSTCkge1xuICAgICAgICAgIHRocm93IGN0eC5yZWRpcmVjdChgJHtjdHgucXVlcnkuY2FsbGJhY2tVUkx9P2Vycm9yPXVuYXV0aG9yaXplZGApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJ1bmF1dGhvcml6ZWRcIik7XG4gICAgICB9XG4gICAgICBpZiAoc2Vzc2lvbi51c2VyLmVtYWlsICE9PSBwYXJzZWQuZW1haWwpIHtcbiAgICAgICAgaWYgKGN0eC5xdWVyeS5jYWxsYmFja1VSTCkge1xuICAgICAgICAgIHRocm93IGN0eC5yZWRpcmVjdChgJHtjdHgucXVlcnkuY2FsbGJhY2tVUkx9P2Vycm9yPXVuYXV0aG9yaXplZGApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJ1bmF1dGhvcml6ZWRcIik7XG4gICAgICB9XG4gICAgICBjb25zdCB1cGRhdGVkVXNlcjIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlVXNlckJ5RW1haWwoXG4gICAgICAgIHBhcnNlZC5lbWFpbCxcbiAgICAgICAge1xuICAgICAgICAgIGVtYWlsOiBwYXJzZWQudXBkYXRlVG8sXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogZmFsc2VcbiAgICAgICAgfSxcbiAgICAgICAgY3R4XG4gICAgICApO1xuICAgICAgY29uc3QgbmV3VG9rZW4gPSBhd2FpdCBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuKFxuICAgICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICAgIHBhcnNlZC51cGRhdGVUb1xuICAgICAgKTtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LnNlbmRWZXJpZmljYXRpb25FbWFpbD8uKFxuICAgICAgICB7XG4gICAgICAgICAgdXNlcjogdXBkYXRlZFVzZXIyLFxuICAgICAgICAgIHVybDogYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vdmVyaWZ5LWVtYWlsP3Rva2VuPSR7bmV3VG9rZW59JmNhbGxiYWNrVVJMPSR7Y3R4LnF1ZXJ5LmNhbGxiYWNrVVJMIHx8IFwiL1wifWAsXG4gICAgICAgICAgdG9rZW46IG5ld1Rva2VuXG4gICAgICAgIH0sXG4gICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICApO1xuICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgICAgc2Vzc2lvbjogc2Vzc2lvbi5zZXNzaW9uLFxuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgLi4uc2Vzc2lvbi51c2VyLFxuICAgICAgICAgIGVtYWlsOiBwYXJzZWQudXBkYXRlVG8sXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogZmFsc2VcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKSB7XG4gICAgICAgIHRocm93IGN0eC5yZWRpcmVjdChjdHgucXVlcnkuY2FsbGJhY2tVUkwpO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgc3RhdHVzOiB0cnVlLFxuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHVwZGF0ZWRVc2VyMi5pZCxcbiAgICAgICAgICBlbWFpbDogdXBkYXRlZFVzZXIyLmVtYWlsLFxuICAgICAgICAgIG5hbWU6IHVwZGF0ZWRVc2VyMi5uYW1lLFxuICAgICAgICAgIGltYWdlOiB1cGRhdGVkVXNlcjIuaW1hZ2UsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogdXBkYXRlZFVzZXIyLmVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgY3JlYXRlZEF0OiB1cGRhdGVkVXNlcjIuY3JlYXRlZEF0LFxuICAgICAgICAgIHVwZGF0ZWRBdDogdXBkYXRlZFVzZXIyLnVwZGF0ZWRBdFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/Lm9uRW1haWxWZXJpZmljYXRpb24pIHtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24ub25FbWFpbFZlcmlmaWNhdGlvbihcbiAgICAgICAgdXNlci51c2VyLFxuICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgKTtcbiAgICB9XG4gICAgY29uc3QgdXBkYXRlZFVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlVXNlckJ5RW1haWwoXG4gICAgICBwYXJzZWQuZW1haWwsXG4gICAgICB7XG4gICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWVcbiAgICAgIH0sXG4gICAgICBjdHhcbiAgICApO1xuICAgIGlmIChjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5hZnRlckVtYWlsVmVyaWZpY2F0aW9uKSB7XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uLmFmdGVyRW1haWxWZXJpZmljYXRpb24oXG4gICAgICAgIHVwZGF0ZWRVc2VyLFxuICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LmF1dG9TaWduSW5BZnRlclZlcmlmaWNhdGlvbikge1xuICAgICAgY29uc3QgY3VycmVudFNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICAgICAgaWYgKCFjdXJyZW50U2Vzc2lvbiB8fCBjdXJyZW50U2Vzc2lvbi51c2VyLmVtYWlsICE9PSBwYXJzZWQuZW1haWwpIHtcbiAgICAgICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVTZXNzaW9uKFxuICAgICAgICAgIHVzZXIudXNlci5pZCxcbiAgICAgICAgICBjdHhcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsIHtcbiAgICAgICAgICAgIG1lc3NhZ2U6IFwiRmFpbGVkIHRvIGNyZWF0ZSBzZXNzaW9uXCJcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICAgIHNlc3Npb24sXG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgLi4udXNlci51c2VyLFxuICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICAgIHNlc3Npb246IGN1cnJlbnRTZXNzaW9uLnNlc3Npb24sXG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgLi4uY3VycmVudFNlc3Npb24udXNlcixcbiAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWVcbiAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKSB7XG4gICAgICB0aHJvdyBjdHgucmVkaXJlY3QoY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN0YXR1czogdHJ1ZSxcbiAgICAgIHVzZXI6IG51bGxcbiAgICB9KTtcbiAgfVxuKTtcblxuY29uc3QgSElERV9NRVRBREFUQSA9IHtcbiAgaXNBY3Rpb246IGZhbHNlXG59O1xuXG5hc3luYyBmdW5jdGlvbiBnZW5lcmF0ZVN0YXRlKGMsIGxpbmspIHtcbiAgY29uc3QgY2FsbGJhY2tVUkwgPSBjLmJvZHk/LmNhbGxiYWNrVVJMIHx8IGMuY29udGV4dC5vcHRpb25zLmJhc2VVUkw7XG4gIGlmICghY2FsbGJhY2tVUkwpIHtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICBtZXNzYWdlOiBcImNhbGxiYWNrVVJMIGlzIHJlcXVpcmVkXCJcbiAgICB9KTtcbiAgfVxuICBjb25zdCBjb2RlVmVyaWZpZXIgPSBnZW5lcmF0ZVJhbmRvbVN0cmluZygxMjgpO1xuICBjb25zdCBzdGF0ZSA9IGdlbmVyYXRlUmFuZG9tU3RyaW5nKDMyKTtcbiAgY29uc3QgZGF0YSA9IEpTT04uc3RyaW5naWZ5KHtcbiAgICBjYWxsYmFja1VSTCxcbiAgICBjb2RlVmVyaWZpZXIsXG4gICAgZXJyb3JVUkw6IGMuYm9keT8uZXJyb3JDYWxsYmFja1VSTCxcbiAgICBuZXdVc2VyVVJMOiBjLmJvZHk/Lm5ld1VzZXJDYWxsYmFja1VSTCxcbiAgICBsaW5rLFxuICAgIC8qKlxuICAgICAqIFRoaXMgaXMgdGhlIGFjdHVhbCBleHBpcnkgdGltZSBvZiB0aGUgc3RhdGVcbiAgICAgKi9cbiAgICBleHBpcmVzQXQ6IERhdGUubm93KCkgKyAxMCAqIDYwICogMWUzLFxuICAgIHJlcXVlc3RTaWduVXA6IGMuYm9keT8ucmVxdWVzdFNpZ25VcFxuICB9KTtcbiAgY29uc3QgZXhwaXJlc0F0ID0gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCk7XG4gIGV4cGlyZXNBdC5zZXRNaW51dGVzKGV4cGlyZXNBdC5nZXRNaW51dGVzKCkgKyAxMCk7XG4gIGNvbnN0IHZlcmlmaWNhdGlvbiA9IGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAge1xuICAgICAgdmFsdWU6IGRhdGEsXG4gICAgICBpZGVudGlmaWVyOiBzdGF0ZSxcbiAgICAgIGV4cGlyZXNBdFxuICAgIH0sXG4gICAgY1xuICApO1xuICBpZiAoIXZlcmlmaWNhdGlvbikge1xuICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICBcIlVuYWJsZSB0byBjcmVhdGUgdmVyaWZpY2F0aW9uLiBNYWtlIHN1cmUgdGhlIGRhdGFiYXNlIGFkYXB0ZXIgaXMgcHJvcGVybHkgd29ya2luZyBhbmQgdGhlcmUgaXMgYSB2ZXJpZmljYXRpb24gdGFibGUgaW4gdGhlIGRhdGFiYXNlXCJcbiAgICApO1xuICAgIHRocm93IG5ldyBBUElFcnJvcihcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiLCB7XG4gICAgICBtZXNzYWdlOiBcIlVuYWJsZSB0byBjcmVhdGUgdmVyaWZpY2F0aW9uXCJcbiAgICB9KTtcbiAgfVxuICByZXR1cm4ge1xuICAgIHN0YXRlOiB2ZXJpZmljYXRpb24uaWRlbnRpZmllcixcbiAgICBjb2RlVmVyaWZpZXJcbiAgfTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHBhcnNlU3RhdGUoYykge1xuICBjb25zdCBzdGF0ZSA9IGMucXVlcnkuc3RhdGUgfHwgYy5ib2R5LnN0YXRlO1xuICBjb25zdCBkYXRhID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVmVyaWZpY2F0aW9uVmFsdWUoc3RhdGUpO1xuICBpZiAoIWRhdGEpIHtcbiAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiU3RhdGUgTWlzbWF0Y2guIFZlcmlmaWNhdGlvbiBub3QgZm91bmRcIiwge1xuICAgICAgc3RhdGVcbiAgICB9KTtcbiAgICBjb25zdCBlcnJvclVSTCA9IGMuY29udGV4dC5vcHRpb25zLm9uQVBJRXJyb3I/LmVycm9yVVJMIHx8IGAke2MuY29udGV4dC5iYXNlVVJMfS9lcnJvcmA7XG4gICAgdGhyb3cgYy5yZWRpcmVjdChgJHtlcnJvclVSTH0/ZXJyb3I9cGxlYXNlX3Jlc3RhcnRfdGhlX3Byb2Nlc3NgKTtcbiAgfVxuICBjb25zdCBwYXJzZWREYXRhID0gei5vYmplY3Qoe1xuICAgIGNhbGxiYWNrVVJMOiB6LnN0cmluZygpLFxuICAgIGNvZGVWZXJpZmllcjogei5zdHJpbmcoKSxcbiAgICBlcnJvclVSTDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgIG5ld1VzZXJVUkw6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICBleHBpcmVzQXQ6IHoubnVtYmVyKCksXG4gICAgbGluazogei5vYmplY3Qoe1xuICAgICAgZW1haWw6IHouc3RyaW5nKCksXG4gICAgICB1c2VySWQ6IHouY29lcmNlLnN0cmluZygpXG4gICAgfSkub3B0aW9uYWwoKSxcbiAgICByZXF1ZXN0U2lnblVwOiB6LmJvb2xlYW4oKS5vcHRpb25hbCgpXG4gIH0pLnBhcnNlKEpTT04ucGFyc2UoZGF0YS52YWx1ZSkpO1xuICBpZiAoIXBhcnNlZERhdGEuZXJyb3JVUkwpIHtcbiAgICBwYXJzZWREYXRhLmVycm9yVVJMID0gYCR7Yy5jb250ZXh0LmJhc2VVUkx9L2Vycm9yYDtcbiAgfVxuICBpZiAocGFyc2VkRGF0YS5leHBpcmVzQXQgPCBEYXRlLm5vdygpKSB7XG4gICAgYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVWZXJpZmljYXRpb25WYWx1ZShkYXRhLmlkKTtcbiAgICBjb25zdCBlcnJvclVSTCA9IGMuY29udGV4dC5vcHRpb25zLm9uQVBJRXJyb3I/LmVycm9yVVJMIHx8IGAke2MuY29udGV4dC5iYXNlVVJMfS9lcnJvcmA7XG4gICAgdGhyb3cgYy5yZWRpcmVjdChgJHtlcnJvclVSTH0/ZXJyb3I9cGxlYXNlX3Jlc3RhcnRfdGhlX3Byb2Nlc3NgKTtcbiAgfVxuICBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVZlcmlmaWNhdGlvblZhbHVlKGRhdGEuaWQpO1xuICByZXR1cm4gcGFyc2VkRGF0YTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gZ2VuZXJhdGVDb2RlQ2hhbGxlbmdlKGNvZGVWZXJpZmllcikge1xuICBjb25zdCBjb2RlQ2hhbGxlbmdlQnl0ZXMgPSBhd2FpdCBjcmVhdGVIYXNoKFwiU0hBLTI1NlwiKS5kaWdlc3QoY29kZVZlcmlmaWVyKTtcbiAgcmV0dXJuIGJhc2U2NFVybC5lbmNvZGUobmV3IFVpbnQ4QXJyYXkoY29kZUNoYWxsZW5nZUJ5dGVzKSwge1xuICAgIHBhZGRpbmc6IGZhbHNlXG4gIH0pO1xufVxuZnVuY3Rpb24gZ2V0T0F1dGgyVG9rZW5zKGRhdGEpIHtcbiAgcmV0dXJuIHtcbiAgICB0b2tlblR5cGU6IGRhdGEudG9rZW5fdHlwZSxcbiAgICBhY2Nlc3NUb2tlbjogZGF0YS5hY2Nlc3NfdG9rZW4sXG4gICAgcmVmcmVzaFRva2VuOiBkYXRhLnJlZnJlc2hfdG9rZW4sXG4gICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IGRhdGEuZXhwaXJlc19pbiA/IGdldERhdGUoZGF0YS5leHBpcmVzX2luLCBcInNlY1wiKSA6IHZvaWQgMCxcbiAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IGRhdGEucmVmcmVzaF90b2tlbl9leHBpcmVzX2luID8gZ2V0RGF0ZShkYXRhLnJlZnJlc2hfdG9rZW5fZXhwaXJlc19pbiwgXCJzZWNcIikgOiB2b2lkIDAsXG4gICAgc2NvcGVzOiBkYXRhPy5zY29wZSA/IHR5cGVvZiBkYXRhLnNjb3BlID09PSBcInN0cmluZ1wiID8gZGF0YS5zY29wZS5zcGxpdChcIiBcIikgOiBkYXRhLnNjb3BlIDogW10sXG4gICAgaWRUb2tlbjogZGF0YS5pZF90b2tlblxuICB9O1xufVxuY29uc3QgZW5jb2RlT0F1dGhQYXJhbWV0ZXIgPSAodmFsdWUpID0+IGVuY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkucmVwbGFjZSgvJTIwL2csIFwiK1wiKTtcbmZ1bmN0aW9uIGRlY3J5cHRPQXV0aFRva2VuKHRva2VuLCBjdHgpIHtcbiAgaWYgKCF0b2tlbikgcmV0dXJuIHRva2VuO1xuICBpZiAoY3R4Lm9wdGlvbnMuYWNjb3VudD8uZW5jcnlwdE9BdXRoVG9rZW5zKSB7XG4gICAgcmV0dXJuIHN5bW1ldHJpY0RlY3J5cHQoe1xuICAgICAga2V5OiBjdHguc2VjcmV0LFxuICAgICAgZGF0YTogdG9rZW5cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gdG9rZW47XG59XG5mdW5jdGlvbiBzZXRUb2tlblV0aWwodG9rZW4sIGN0eCkge1xuICBpZiAoY3R4Lm9wdGlvbnMuYWNjb3VudD8uZW5jcnlwdE9BdXRoVG9rZW5zICYmIHRva2VuKSB7XG4gICAgcmV0dXJuIHN5bW1ldHJpY0VuY3J5cHQoe1xuICAgICAga2V5OiBjdHguc2VjcmV0LFxuICAgICAgZGF0YTogdG9rZW5cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gdG9rZW47XG59XG5cbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZU9BdXRoVXNlckluZm8oYywge1xuICB1c2VySW5mbyxcbiAgYWNjb3VudCxcbiAgY2FsbGJhY2tVUkwsXG4gIGRpc2FibGVTaWduVXAsXG4gIG92ZXJyaWRlVXNlckluZm9cbn0pIHtcbiAgY29uc3QgZGJVc2VyID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kT0F1dGhVc2VyKFxuICAgIHVzZXJJbmZvLmVtYWlsLnRvTG93ZXJDYXNlKCksXG4gICAgYWNjb3VudC5hY2NvdW50SWQsXG4gICAgYWNjb3VudC5wcm92aWRlcklkXG4gICkuY2F0Y2goKGUpID0+IHtcbiAgICBsb2dnZXIuZXJyb3IoXG4gICAgICBcIkJldHRlciBhdXRoIHdhcyB1bmFibGUgdG8gcXVlcnkgeW91ciBkYXRhYmFzZS5cXG5FcnJvcjogXCIsXG4gICAgICBlXG4gICAgKTtcbiAgICBjb25zdCBlcnJvclVSTCA9IGMuY29udGV4dC5vcHRpb25zLm9uQVBJRXJyb3I/LmVycm9yVVJMIHx8IGAke2MuY29udGV4dC5iYXNlVVJMfS9lcnJvcmA7XG4gICAgdGhyb3cgYy5yZWRpcmVjdChgJHtlcnJvclVSTH0/ZXJyb3I9aW50ZXJuYWxfc2VydmVyX2Vycm9yYCk7XG4gIH0pO1xuICBsZXQgdXNlciA9IGRiVXNlcj8udXNlcjtcbiAgbGV0IGlzUmVnaXN0ZXIgPSAhdXNlcjtcbiAgaWYgKGRiVXNlcikge1xuICAgIGNvbnN0IGhhc0JlZW5MaW5rZWQgPSBkYlVzZXIuYWNjb3VudHMuZmluZChcbiAgICAgIChhKSA9PiBhLnByb3ZpZGVySWQgPT09IGFjY291bnQucHJvdmlkZXJJZCAmJiBhLmFjY291bnRJZCA9PT0gYWNjb3VudC5hY2NvdW50SWRcbiAgICApO1xuICAgIGlmICghaGFzQmVlbkxpbmtlZCkge1xuICAgICAgY29uc3QgdHJ1c3RlZFByb3ZpZGVycyA9IGMuY29udGV4dC5vcHRpb25zLmFjY291bnQ/LmFjY291bnRMaW5raW5nPy50cnVzdGVkUHJvdmlkZXJzO1xuICAgICAgY29uc3QgaXNUcnVzdGVkUHJvdmlkZXIgPSB0cnVzdGVkUHJvdmlkZXJzPy5pbmNsdWRlcyhcbiAgICAgICAgYWNjb3VudC5wcm92aWRlcklkXG4gICAgICApO1xuICAgICAgaWYgKCFpc1RydXN0ZWRQcm92aWRlciAmJiAhdXNlckluZm8uZW1haWxWZXJpZmllZCB8fCBjLmNvbnRleHQub3B0aW9ucy5hY2NvdW50Py5hY2NvdW50TGlua2luZz8uZW5hYmxlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgaWYgKGlzRGV2ZWxvcG1lbnQpIHtcbiAgICAgICAgICBsb2dnZXIud2FybihcbiAgICAgICAgICAgIGBVc2VyIGFscmVhZHkgZXhpc3QgYnV0IGFjY291bnQgaXNuJ3QgbGlua2VkIHRvICR7YWNjb3VudC5wcm92aWRlcklkfS4gVG8gcmVhZCBtb3JlIGFib3V0IGhvdyBhY2NvdW50IGxpbmtpbmcgd29ya3MgaW4gQmV0dGVyIEF1dGggc2VlIGh0dHBzOi8vd3d3LmJldHRlci1hdXRoLmNvbS9kb2NzL2NvbmNlcHRzL3VzZXJzLWFjY291bnRzI2FjY291bnQtbGlua2luZy5gXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIGVycm9yOiBcImFjY291bnQgbm90IGxpbmtlZFwiLFxuICAgICAgICAgIGRhdGE6IG51bGxcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHRyeSB7XG4gICAgICAgIGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIubGlua0FjY291bnQoXG4gICAgICAgICAge1xuICAgICAgICAgICAgcHJvdmlkZXJJZDogYWNjb3VudC5wcm92aWRlcklkLFxuICAgICAgICAgICAgYWNjb3VudElkOiB1c2VySW5mby5pZC50b1N0cmluZygpLFxuICAgICAgICAgICAgdXNlcklkOiBkYlVzZXIudXNlci5pZCxcbiAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBhd2FpdCBzZXRUb2tlblV0aWwoYWNjb3VudC5hY2Nlc3NUb2tlbiwgYy5jb250ZXh0KSxcbiAgICAgICAgICAgIHJlZnJlc2hUb2tlbjogYXdhaXQgc2V0VG9rZW5VdGlsKGFjY291bnQucmVmcmVzaFRva2VuLCBjLmNvbnRleHQpLFxuICAgICAgICAgICAgaWRUb2tlbjogYWNjb3VudC5pZFRva2VuLFxuICAgICAgICAgICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IGFjY291bnQuYWNjZXNzVG9rZW5FeHBpcmVzQXQsXG4gICAgICAgICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IGFjY291bnQucmVmcmVzaFRva2VuRXhwaXJlc0F0LFxuICAgICAgICAgICAgc2NvcGU6IGFjY291bnQuc2NvcGVcbiAgICAgICAgICB9LFxuICAgICAgICAgIGNcbiAgICAgICAgKTtcbiAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFwiVW5hYmxlIHRvIGxpbmsgYWNjb3VudFwiLCBlKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBlcnJvcjogXCJ1bmFibGUgdG8gbGluayBhY2NvdW50XCIsXG4gICAgICAgICAgZGF0YTogbnVsbFxuICAgICAgICB9O1xuICAgICAgfVxuICAgIH0gZWxzZSB7XG4gICAgICBpZiAoYy5jb250ZXh0Lm9wdGlvbnMuYWNjb3VudD8udXBkYXRlQWNjb3VudE9uU2lnbkluICE9PSBmYWxzZSkge1xuICAgICAgICBjb25zdCB1cGRhdGVEYXRhID0gT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgICAgICAgIE9iamVjdC5lbnRyaWVzKHtcbiAgICAgICAgICAgIGlkVG9rZW46IGFjY291bnQuaWRUb2tlbixcbiAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBhd2FpdCBzZXRUb2tlblV0aWwoYWNjb3VudC5hY2Nlc3NUb2tlbiwgYy5jb250ZXh0KSxcbiAgICAgICAgICAgIHJlZnJlc2hUb2tlbjogYXdhaXQgc2V0VG9rZW5VdGlsKGFjY291bnQucmVmcmVzaFRva2VuLCBjLmNvbnRleHQpLFxuICAgICAgICAgICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IGFjY291bnQuYWNjZXNzVG9rZW5FeHBpcmVzQXQsXG4gICAgICAgICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IGFjY291bnQucmVmcmVzaFRva2VuRXhwaXJlc0F0LFxuICAgICAgICAgICAgc2NvcGU6IGFjY291bnQuc2NvcGVcbiAgICAgICAgICB9KS5maWx0ZXIoKFtfLCB2YWx1ZV0pID0+IHZhbHVlICE9PSB2b2lkIDApXG4gICAgICAgICk7XG4gICAgICAgIGlmIChPYmplY3Qua2V5cyh1cGRhdGVEYXRhKS5sZW5ndGggPiAwKSB7XG4gICAgICAgICAgYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVBY2NvdW50KFxuICAgICAgICAgICAgaGFzQmVlbkxpbmtlZC5pZCxcbiAgICAgICAgICAgIHVwZGF0ZURhdGEsXG4gICAgICAgICAgICBjXG4gICAgICAgICAgKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgICBpZiAob3ZlcnJpZGVVc2VySW5mbykge1xuICAgICAgY29uc3QgeyBpZDogXywgLi4ucmVzdFVzZXJJbmZvIH0gPSB1c2VySW5mbztcbiAgICAgIGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlVXNlcihkYlVzZXIudXNlci5pZCwge1xuICAgICAgICAuLi5yZXN0VXNlckluZm8sXG4gICAgICAgIGVtYWlsOiB1c2VySW5mby5lbWFpbC50b0xvd2VyQ2FzZSgpLFxuICAgICAgICBlbWFpbFZlcmlmaWVkOiB1c2VySW5mby5lbWFpbC50b0xvd2VyQ2FzZSgpID09PSBkYlVzZXIudXNlci5lbWFpbCA/IGRiVXNlci51c2VyLmVtYWlsVmVyaWZpZWQgfHwgdXNlckluZm8uZW1haWxWZXJpZmllZCA6IHVzZXJJbmZvLmVtYWlsVmVyaWZpZWRcbiAgICAgIH0pO1xuICAgIH1cbiAgfSBlbHNlIHtcbiAgICBpZiAoZGlzYWJsZVNpZ25VcCkge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgZXJyb3I6IFwic2lnbnVwIGRpc2FibGVkXCIsXG4gICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIGlzUmVnaXN0ZXI6IGZhbHNlXG4gICAgICB9O1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgY29uc3QgeyBpZDogXywgLi4ucmVzdFVzZXJJbmZvIH0gPSB1c2VySW5mbztcbiAgICAgIHVzZXIgPSBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZU9BdXRoVXNlcihcbiAgICAgICAge1xuICAgICAgICAgIC4uLnJlc3RVc2VySW5mbyxcbiAgICAgICAgICBlbWFpbDogdXNlckluZm8uZW1haWwudG9Mb3dlckNhc2UoKVxuICAgICAgICB9LFxuICAgICAgICB7XG4gICAgICAgICAgYWNjZXNzVG9rZW46IGF3YWl0IHNldFRva2VuVXRpbChhY2NvdW50LmFjY2Vzc1Rva2VuLCBjLmNvbnRleHQpLFxuICAgICAgICAgIHJlZnJlc2hUb2tlbjogYXdhaXQgc2V0VG9rZW5VdGlsKGFjY291bnQucmVmcmVzaFRva2VuLCBjLmNvbnRleHQpLFxuICAgICAgICAgIGlkVG9rZW46IGFjY291bnQuaWRUb2tlbixcbiAgICAgICAgICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDogYWNjb3VudC5hY2Nlc3NUb2tlbkV4cGlyZXNBdCxcbiAgICAgICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IGFjY291bnQucmVmcmVzaFRva2VuRXhwaXJlc0F0LFxuICAgICAgICAgIHNjb3BlOiBhY2NvdW50LnNjb3BlLFxuICAgICAgICAgIHByb3ZpZGVySWQ6IGFjY291bnQucHJvdmlkZXJJZCxcbiAgICAgICAgICBhY2NvdW50SWQ6IHVzZXJJbmZvLmlkLnRvU3RyaW5nKClcbiAgICAgICAgfSxcbiAgICAgICAgY1xuICAgICAgKS50aGVuKChyZXMpID0+IHJlcz8udXNlcik7XG4gICAgICBpZiAoIXVzZXJJbmZvLmVtYWlsVmVyaWZpZWQgJiYgdXNlciAmJiBjLmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uc2VuZE9uU2lnblVwKSB7XG4gICAgICAgIGNvbnN0IHRva2VuID0gYXdhaXQgY3JlYXRlRW1haWxWZXJpZmljYXRpb25Ub2tlbihcbiAgICAgICAgICBjLmNvbnRleHQuc2VjcmV0LFxuICAgICAgICAgIHVzZXIuZW1haWwsXG4gICAgICAgICAgdm9pZCAwLFxuICAgICAgICAgIGMuY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5leHBpcmVzSW5cbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgdXJsID0gYCR7Yy5jb250ZXh0LmJhc2VVUkx9L3ZlcmlmeS1lbWFpbD90b2tlbj0ke3Rva2VufSZjYWxsYmFja1VSTD0ke2NhbGxiYWNrVVJMfWA7XG4gICAgICAgIGF3YWl0IGMuY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5zZW5kVmVyaWZpY2F0aW9uRW1haWw/LihcbiAgICAgICAgICB7XG4gICAgICAgICAgICB1c2VyLFxuICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgdG9rZW5cbiAgICAgICAgICB9LFxuICAgICAgICAgIGMucmVxdWVzdFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgIGxvZ2dlci5lcnJvcihlKTtcbiAgICAgIGlmIChlIGluc3RhbmNlb2YgQVBJRXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBlcnJvcjogZS5tZXNzYWdlLFxuICAgICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgICAgaXNSZWdpc3RlcjogZmFsc2VcbiAgICAgICAgfTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIGVycm9yOiBcInVuYWJsZSB0byBjcmVhdGUgdXNlclwiLFxuICAgICAgICBkYXRhOiBudWxsLFxuICAgICAgICBpc1JlZ2lzdGVyOiBmYWxzZVxuICAgICAgfTtcbiAgICB9XG4gIH1cbiAgaWYgKCF1c2VyKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIGVycm9yOiBcInVuYWJsZSB0byBjcmVhdGUgdXNlclwiLFxuICAgICAgZGF0YTogbnVsbCxcbiAgICAgIGlzUmVnaXN0ZXI6IGZhbHNlXG4gICAgfTtcbiAgfVxuICBjb25zdCBzZXNzaW9uID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVTZXNzaW9uKHVzZXIuaWQsIGMpO1xuICBpZiAoIXNlc3Npb24pIHtcbiAgICByZXR1cm4ge1xuICAgICAgZXJyb3I6IFwidW5hYmxlIHRvIGNyZWF0ZSBzZXNzaW9uXCIsXG4gICAgICBkYXRhOiBudWxsLFxuICAgICAgaXNSZWdpc3RlcjogZmFsc2VcbiAgICB9O1xuICB9XG4gIHJldHVybiB7XG4gICAgZGF0YToge1xuICAgICAgc2Vzc2lvbixcbiAgICAgIHVzZXJcbiAgICB9LFxuICAgIGVycm9yOiBudWxsLFxuICAgIGlzUmVnaXN0ZXJcbiAgfTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gIGlkLFxuICBvcHRpb25zLFxuICBhdXRob3JpemF0aW9uRW5kcG9pbnQsXG4gIHN0YXRlLFxuICBjb2RlVmVyaWZpZXIsXG4gIHNjb3BlcyxcbiAgY2xhaW1zLFxuICByZWRpcmVjdFVSSSxcbiAgZHVyYXRpb24sXG4gIHByb21wdCxcbiAgYWNjZXNzVHlwZSxcbiAgcmVzcG9uc2VUeXBlLFxuICBkaXNwbGF5LFxuICBsb2dpbkhpbnQsXG4gIGhkLFxuICByZXNwb25zZU1vZGUsXG4gIGFkZGl0aW9uYWxQYXJhbXMsXG4gIHNjb3BlSm9pbmVyXG59KSB7XG4gIGNvbnN0IHVybCA9IG5ldyBVUkwoYXV0aG9yaXphdGlvbkVuZHBvaW50KTtcbiAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJyZXNwb25zZV90eXBlXCIsIHJlc3BvbnNlVHlwZSB8fCBcImNvZGVcIik7XG4gIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwiY2xpZW50X2lkXCIsIG9wdGlvbnMuY2xpZW50SWQpO1xuICB1cmwuc2VhcmNoUGFyYW1zLnNldChcInN0YXRlXCIsIHN0YXRlKTtcbiAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJzY29wZVwiLCBzY29wZXMuam9pbihzY29wZUpvaW5lciB8fCBcIiBcIikpO1xuICB1cmwuc2VhcmNoUGFyYW1zLnNldChcInJlZGlyZWN0X3VyaVwiLCBvcHRpb25zLnJlZGlyZWN0VVJJIHx8IHJlZGlyZWN0VVJJKTtcbiAgZHVyYXRpb24gJiYgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJkdXJhdGlvblwiLCBkdXJhdGlvbik7XG4gIGRpc3BsYXkgJiYgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJkaXNwbGF5XCIsIGRpc3BsYXkpO1xuICBsb2dpbkhpbnQgJiYgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJsb2dpbl9oaW50XCIsIGxvZ2luSGludCk7XG4gIHByb21wdCAmJiB1cmwuc2VhcmNoUGFyYW1zLnNldChcInByb21wdFwiLCBwcm9tcHQpO1xuICBoZCAmJiB1cmwuc2VhcmNoUGFyYW1zLnNldChcImhkXCIsIGhkKTtcbiAgYWNjZXNzVHlwZSAmJiB1cmwuc2VhcmNoUGFyYW1zLnNldChcImFjY2Vzc190eXBlXCIsIGFjY2Vzc1R5cGUpO1xuICByZXNwb25zZU1vZGUgJiYgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJyZXNwb25zZV9tb2RlXCIsIHJlc3BvbnNlTW9kZSk7XG4gIGlmIChjb2RlVmVyaWZpZXIpIHtcbiAgICBjb25zdCBjb2RlQ2hhbGxlbmdlID0gYXdhaXQgZ2VuZXJhdGVDb2RlQ2hhbGxlbmdlKGNvZGVWZXJpZmllcik7XG4gICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJjb2RlX2NoYWxsZW5nZV9tZXRob2RcIiwgXCJTMjU2XCIpO1xuICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwiY29kZV9jaGFsbGVuZ2VcIiwgY29kZUNoYWxsZW5nZSk7XG4gIH1cbiAgaWYgKGNsYWltcykge1xuICAgIGNvbnN0IGNsYWltc09iaiA9IGNsYWltcy5yZWR1Y2UoXG4gICAgICAoYWNjLCBjbGFpbSkgPT4ge1xuICAgICAgICBhY2NbY2xhaW1dID0gbnVsbDtcbiAgICAgICAgcmV0dXJuIGFjYztcbiAgICAgIH0sXG4gICAgICB7fVxuICAgICk7XG4gICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXG4gICAgICBcImNsYWltc1wiLFxuICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBpZF90b2tlbjogeyBlbWFpbDogbnVsbCwgZW1haWxfdmVyaWZpZWQ6IG51bGwsIC4uLmNsYWltc09iaiB9XG4gICAgICB9KVxuICAgICk7XG4gIH1cbiAgaWYgKGFkZGl0aW9uYWxQYXJhbXMpIHtcbiAgICBPYmplY3QuZW50cmllcyhhZGRpdGlvbmFsUGFyYW1zKS5mb3JFYWNoKChba2V5LCB2YWx1ZV0pID0+IHtcbiAgICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KGtleSwgdmFsdWUpO1xuICAgIH0pO1xuICB9XG4gIHJldHVybiB1cmw7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUF1dGhvcml6YXRpb25Db2RlUmVxdWVzdCh7XG4gIGNvZGUsXG4gIGNvZGVWZXJpZmllcixcbiAgcmVkaXJlY3RVUkksXG4gIG9wdGlvbnMsXG4gIGF1dGhlbnRpY2F0aW9uLFxuICBkZXZpY2VJZCxcbiAgaGVhZGVycyxcbiAgYWRkaXRpb25hbFBhcmFtcyA9IHt9LFxuICByZXNvdXJjZVxufSkge1xuICBjb25zdCBib2R5ID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICBjb25zdCByZXF1ZXN0SGVhZGVycyA9IHtcbiAgICBcImNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiLFxuICAgIGFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgXCJ1c2VyLWFnZW50XCI6IFwiYmV0dGVyLWF1dGhcIixcbiAgICAuLi5oZWFkZXJzXG4gIH07XG4gIGJvZHkuc2V0KFwiZ3JhbnRfdHlwZVwiLCBcImF1dGhvcml6YXRpb25fY29kZVwiKTtcbiAgYm9keS5zZXQoXCJjb2RlXCIsIGNvZGUpO1xuICBjb2RlVmVyaWZpZXIgJiYgYm9keS5zZXQoXCJjb2RlX3ZlcmlmaWVyXCIsIGNvZGVWZXJpZmllcik7XG4gIG9wdGlvbnMuY2xpZW50S2V5ICYmIGJvZHkuc2V0KFwiY2xpZW50X2tleVwiLCBvcHRpb25zLmNsaWVudEtleSk7XG4gIGRldmljZUlkICYmIGJvZHkuc2V0KFwiZGV2aWNlX2lkXCIsIGRldmljZUlkKTtcbiAgYm9keS5zZXQoXCJyZWRpcmVjdF91cmlcIiwgb3B0aW9ucy5yZWRpcmVjdFVSSSB8fCByZWRpcmVjdFVSSSk7XG4gIGlmIChyZXNvdXJjZSkge1xuICAgIGlmICh0eXBlb2YgcmVzb3VyY2UgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgIGJvZHkuYXBwZW5kKFwicmVzb3VyY2VcIiwgcmVzb3VyY2UpO1xuICAgIH0gZWxzZSB7XG4gICAgICBmb3IgKGNvbnN0IF9yZXNvdXJjZSBvZiByZXNvdXJjZSkge1xuICAgICAgICBib2R5LmFwcGVuZChcInJlc291cmNlXCIsIF9yZXNvdXJjZSk7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIGlmIChhdXRoZW50aWNhdGlvbiA9PT0gXCJiYXNpY1wiKSB7XG4gICAgY29uc3QgZW5jb2RlZENyZWRlbnRpYWxzID0gYmFzZTY0LmVuY29kZShcbiAgICAgIGAke29wdGlvbnMuY2xpZW50SWR9OiR7b3B0aW9ucy5jbGllbnRTZWNyZXQgPz8gXCJcIn1gXG4gICAgKTtcbiAgICByZXF1ZXN0SGVhZGVyc1tcImF1dGhvcml6YXRpb25cIl0gPSBgQmFzaWMgJHtlbmNvZGVkQ3JlZGVudGlhbHN9YDtcbiAgfSBlbHNlIHtcbiAgICBvcHRpb25zLmNsaWVudElkICYmIGJvZHkuc2V0KFwiY2xpZW50X2lkXCIsIG9wdGlvbnMuY2xpZW50SWQpO1xuICAgIGlmIChvcHRpb25zLmNsaWVudFNlY3JldCkge1xuICAgICAgYm9keS5zZXQoXCJjbGllbnRfc2VjcmV0XCIsIG9wdGlvbnMuY2xpZW50U2VjcmV0KTtcbiAgICB9XG4gIH1cbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoYWRkaXRpb25hbFBhcmFtcykpIHtcbiAgICBpZiAoIWJvZHkuaGFzKGtleSkpIGJvZHkuYXBwZW5kKGtleSwgdmFsdWUpO1xuICB9XG4gIHJldHVybiB7XG4gICAgYm9keSxcbiAgICBoZWFkZXJzOiByZXF1ZXN0SGVhZGVyc1xuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gIGNvZGUsXG4gIGNvZGVWZXJpZmllcixcbiAgcmVkaXJlY3RVUkksXG4gIG9wdGlvbnMsXG4gIHRva2VuRW5kcG9pbnQsXG4gIGF1dGhlbnRpY2F0aW9uLFxuICBkZXZpY2VJZCxcbiAgaGVhZGVycyxcbiAgYWRkaXRpb25hbFBhcmFtcyA9IHt9LFxuICByZXNvdXJjZVxufSkge1xuICBjb25zdCB7IGJvZHksIGhlYWRlcnM6IHJlcXVlc3RIZWFkZXJzIH0gPSBjcmVhdGVBdXRob3JpemF0aW9uQ29kZVJlcXVlc3Qoe1xuICAgIGNvZGUsXG4gICAgY29kZVZlcmlmaWVyLFxuICAgIHJlZGlyZWN0VVJJLFxuICAgIG9wdGlvbnMsXG4gICAgYXV0aGVudGljYXRpb24sXG4gICAgZGV2aWNlSWQsXG4gICAgaGVhZGVycyxcbiAgICBhZGRpdGlvbmFsUGFyYW1zLFxuICAgIHJlc291cmNlXG4gIH0pO1xuICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaCh0b2tlbkVuZHBvaW50LCB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5LFxuICAgIGhlYWRlcnM6IHJlcXVlc3RIZWFkZXJzXG4gIH0pO1xuICBpZiAoZXJyb3IpIHtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxuICBjb25zdCB0b2tlbnMgPSBnZXRPQXV0aDJUb2tlbnMoZGF0YSk7XG4gIHJldHVybiB0b2tlbnM7XG59XG5hc3luYyBmdW5jdGlvbiB2YWxpZGF0ZVRva2VuKHRva2VuLCBqd2tzRW5kcG9pbnQpIHtcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goandrc0VuZHBvaW50LCB7XG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIGhlYWRlcnM6IHtcbiAgICAgIGFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICBcInVzZXItYWdlbnRcIjogXCJiZXR0ZXItYXV0aFwiXG4gICAgfVxuICB9KTtcbiAgaWYgKGVycm9yKSB7XG4gICAgdGhyb3cgZXJyb3I7XG4gIH1cbiAgY29uc3Qga2V5cyA9IGRhdGFbXCJrZXlzXCJdO1xuICBjb25zdCBoZWFkZXIgPSBKU09OLnBhcnNlKGF0b2IodG9rZW4uc3BsaXQoXCIuXCIpWzBdKSk7XG4gIGNvbnN0IGtleSA9IGtleXMuZmluZCgoa2V5MikgPT4ga2V5Mi5raWQgPT09IGhlYWRlci5raWQpO1xuICBpZiAoIWtleSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIktleSBub3QgZm91bmRcIik7XG4gIH1cbiAgY29uc3QgdmVyaWZpZWQgPSBhd2FpdCBqd3RWZXJpZnkodG9rZW4sIGtleSk7XG4gIHJldHVybiB2ZXJpZmllZDtcbn1cblxuZnVuY3Rpb24gY3JlYXRlUmVmcmVzaEFjY2Vzc1Rva2VuUmVxdWVzdCh7XG4gIHJlZnJlc2hUb2tlbixcbiAgb3B0aW9ucyxcbiAgYXV0aGVudGljYXRpb24sXG4gIGV4dHJhUGFyYW1zLFxuICByZXNvdXJjZVxufSkge1xuICBjb25zdCBib2R5ID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICBjb25zdCBoZWFkZXJzID0ge1xuICAgIFwiY29udGVudC10eXBlXCI6IFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCIsXG4gICAgYWNjZXB0OiBcImFwcGxpY2F0aW9uL2pzb25cIlxuICB9O1xuICBib2R5LnNldChcImdyYW50X3R5cGVcIiwgXCJyZWZyZXNoX3Rva2VuXCIpO1xuICBib2R5LnNldChcInJlZnJlc2hfdG9rZW5cIiwgcmVmcmVzaFRva2VuKTtcbiAgaWYgKGF1dGhlbnRpY2F0aW9uID09PSBcImJhc2ljXCIpIHtcbiAgICBpZiAob3B0aW9ucy5jbGllbnRJZCkge1xuICAgICAgaGVhZGVyc1tcImF1dGhvcml6YXRpb25cIl0gPSBcIkJhc2ljIFwiICsgYmFzZTY0LmVuY29kZShgJHtvcHRpb25zLmNsaWVudElkfToke29wdGlvbnMuY2xpZW50U2VjcmV0ID8/IFwiXCJ9YCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIGhlYWRlcnNbXCJhdXRob3JpemF0aW9uXCJdID0gXCJCYXNpYyBcIiArIGJhc2U2NC5lbmNvZGUoYDoke29wdGlvbnMuY2xpZW50U2VjcmV0ID8/IFwiXCJ9YCk7XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIG9wdGlvbnMuY2xpZW50SWQgJiYgYm9keS5zZXQoXCJjbGllbnRfaWRcIiwgb3B0aW9ucy5jbGllbnRJZCk7XG4gICAgaWYgKG9wdGlvbnMuY2xpZW50U2VjcmV0KSB7XG4gICAgICBib2R5LnNldChcImNsaWVudF9zZWNyZXRcIiwgb3B0aW9ucy5jbGllbnRTZWNyZXQpO1xuICAgIH1cbiAgfVxuICBpZiAocmVzb3VyY2UpIHtcbiAgICBpZiAodHlwZW9mIHJlc291cmNlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICBib2R5LmFwcGVuZChcInJlc291cmNlXCIsIHJlc291cmNlKTtcbiAgICB9IGVsc2Uge1xuICAgICAgZm9yIChjb25zdCBfcmVzb3VyY2Ugb2YgcmVzb3VyY2UpIHtcbiAgICAgICAgYm9keS5hcHBlbmQoXCJyZXNvdXJjZVwiLCBfcmVzb3VyY2UpO1xuICAgICAgfVxuICAgIH1cbiAgfVxuICBpZiAoZXh0cmFQYXJhbXMpIHtcbiAgICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhleHRyYVBhcmFtcykpIHtcbiAgICAgIGJvZHkuc2V0KGtleSwgdmFsdWUpO1xuICAgIH1cbiAgfVxuICByZXR1cm4ge1xuICAgIGJvZHksXG4gICAgaGVhZGVyc1xuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgcmVmcmVzaFRva2VuLFxuICBvcHRpb25zLFxuICB0b2tlbkVuZHBvaW50LFxuICBhdXRoZW50aWNhdGlvbixcbiAgZXh0cmFQYXJhbXNcbn0pIHtcbiAgY29uc3QgeyBib2R5LCBoZWFkZXJzIH0gPSBjcmVhdGVSZWZyZXNoQWNjZXNzVG9rZW5SZXF1ZXN0KHtcbiAgICByZWZyZXNoVG9rZW4sXG4gICAgb3B0aW9ucyxcbiAgICBhdXRoZW50aWNhdGlvbixcbiAgICBleHRyYVBhcmFtc1xuICB9KTtcbiAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2godG9rZW5FbmRwb2ludCwge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keSxcbiAgICBoZWFkZXJzXG4gIH0pO1xuICBpZiAoZXJyb3IpIHtcbiAgICB0aHJvdyBlcnJvcjtcbiAgfVxuICBjb25zdCB0b2tlbnMgPSB7XG4gICAgYWNjZXNzVG9rZW46IGRhdGEuYWNjZXNzX3Rva2VuLFxuICAgIHJlZnJlc2hUb2tlbjogZGF0YS5yZWZyZXNoX3Rva2VuLFxuICAgIHRva2VuVHlwZTogZGF0YS50b2tlbl90eXBlLFxuICAgIHNjb3BlczogZGF0YS5zY29wZT8uc3BsaXQoXCIgXCIpLFxuICAgIGlkVG9rZW46IGRhdGEuaWRfdG9rZW5cbiAgfTtcbiAgaWYgKGRhdGEuZXhwaXJlc19pbikge1xuICAgIGNvbnN0IG5vdyA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpO1xuICAgIHRva2Vucy5hY2Nlc3NUb2tlbkV4cGlyZXNBdCA9IG5ldyBEYXRlKFxuICAgICAgbm93LmdldFRpbWUoKSArIGRhdGEuZXhwaXJlc19pbiAqIDFlM1xuICAgICk7XG4gIH1cbiAgcmV0dXJuIHRva2Vucztcbn1cblxuY29uc3QgYXBwbGUgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gXCJodHRwczovL2FwcGxlaWQuYXBwbGUuY29tL2F1dGgvdG9rZW5cIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJhcHBsZVwiLFxuICAgIG5hbWU6IFwiQXBwbGVcIixcbiAgICBhc3luYyBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgY29uc3QgX3Njb3BlID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJlbWFpbFwiLCBcIm5hbWVcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZS5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZS5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICBjb25zdCB1cmwgPSBhd2FpdCBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwiYXBwbGVcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vYXBwbGVpZC5hcHBsZS5jb20vYXV0aC9hdXRob3JpemVcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGUsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgcmVzcG9uc2VNb2RlOiBcImZvcm1fcG9zdFwiLFxuICAgICAgICByZXNwb25zZVR5cGU6IFwiY29kZSBpZF90b2tlblwiXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB1cmw7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyB2ZXJpZnlJZFRva2VuKHRva2VuLCBub25jZSkge1xuICAgICAgaWYgKG9wdGlvbnMuZGlzYWJsZUlkVG9rZW5TaWduSW4pIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMudmVyaWZ5SWRUb2tlbikge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy52ZXJpZnlJZFRva2VuKHRva2VuLCBub25jZSk7XG4gICAgICB9XG4gICAgICBjb25zdCBkZWNvZGVkSGVhZGVyID0gZGVjb2RlUHJvdGVjdGVkSGVhZGVyKHRva2VuKTtcbiAgICAgIGNvbnN0IHsga2lkLCBhbGc6IGp3dEFsZyB9ID0gZGVjb2RlZEhlYWRlcjtcbiAgICAgIGlmICgha2lkIHx8ICFqd3RBbGcpIHJldHVybiBmYWxzZTtcbiAgICAgIGNvbnN0IHB1YmxpY0tleSA9IGF3YWl0IGdldEFwcGxlUHVibGljS2V5KGtpZCk7XG4gICAgICBjb25zdCB7IHBheWxvYWQ6IGp3dENsYWltcyB9ID0gYXdhaXQgand0VmVyaWZ5KHRva2VuLCBwdWJsaWNLZXksIHtcbiAgICAgICAgYWxnb3JpdGhtczogW2p3dEFsZ10sXG4gICAgICAgIGlzc3VlcjogXCJodHRwczovL2FwcGxlaWQuYXBwbGUuY29tXCIsXG4gICAgICAgIGF1ZGllbmNlOiBvcHRpb25zLmF1ZGllbmNlICYmIG9wdGlvbnMuYXVkaWVuY2UubGVuZ3RoID8gb3B0aW9ucy5hdWRpZW5jZSA6IG9wdGlvbnMuYXBwQnVuZGxlSWRlbnRpZmllciA/IG9wdGlvbnMuYXBwQnVuZGxlSWRlbnRpZmllciA6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgIG1heFRva2VuQWdlOiBcIjFoXCJcbiAgICAgIH0pO1xuICAgICAgW1wiZW1haWxfdmVyaWZpZWRcIiwgXCJpc19wcml2YXRlX2VtYWlsXCJdLmZvckVhY2goKGZpZWxkKSA9PiB7XG4gICAgICAgIGlmIChqd3RDbGFpbXNbZmllbGRdICE9PSB2b2lkIDApIHtcbiAgICAgICAgICBqd3RDbGFpbXNbZmllbGRdID0gQm9vbGVhbihqd3RDbGFpbXNbZmllbGRdKTtcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAobm9uY2UgJiYgand0Q2xhaW1zLm5vbmNlICE9PSBub25jZSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICByZXR1cm4gISFqd3RDbGFpbXM7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hcHBsZWlkLmFwcGxlLmNvbS9hdXRoL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGlmICghdG9rZW4uaWRUb2tlbikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHByb2ZpbGUgPSBkZWNvZGVKd3QodG9rZW4uaWRUb2tlbik7XG4gICAgICBpZiAoIXByb2ZpbGUpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCBuYW1lID0gdG9rZW4udXNlciA/IGAke3Rva2VuLnVzZXIubmFtZT8uZmlyc3ROYW1lfSAke3Rva2VuLnVzZXIubmFtZT8ubGFzdE5hbWV9YCA6IHByb2ZpbGUubmFtZSB8fCBwcm9maWxlLmVtYWlsO1xuICAgICAgY29uc3QgZW1haWxWZXJpZmllZCA9IHR5cGVvZiBwcm9maWxlLmVtYWlsX3ZlcmlmaWVkID09PSBcImJvb2xlYW5cIiA/IHByb2ZpbGUuZW1haWxfdmVyaWZpZWQgOiBwcm9maWxlLmVtYWlsX3ZlcmlmaWVkID09PSBcInRydWVcIjtcbiAgICAgIGNvbnN0IGVucmljaGVkUHJvZmlsZSA9IHtcbiAgICAgICAgLi4ucHJvZmlsZSxcbiAgICAgICAgbmFtZVxuICAgICAgfTtcbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/LihlbnJpY2hlZFByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLnN1YixcbiAgICAgICAgICBuYW1lOiBlbnJpY2hlZFByb2ZpbGUubmFtZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogZW5yaWNoZWRQcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcbmNvbnN0IGdldEFwcGxlUHVibGljS2V5ID0gYXN5bmMgKGtpZCkgPT4ge1xuICBjb25zdCBBUFBMRV9CQVNFX1VSTCA9IFwiaHR0cHM6Ly9hcHBsZWlkLmFwcGxlLmNvbVwiO1xuICBjb25zdCBKV0tTX0FQUExFX1VSSSA9IFwiL2F1dGgva2V5c1wiO1xuICBjb25zdCB7IGRhdGEgfSA9IGF3YWl0IGJldHRlckZldGNoKGAke0FQUExFX0JBU0VfVVJMfSR7SldLU19BUFBMRV9VUkl9YCk7XG4gIGlmICghZGF0YT8ua2V5cykge1xuICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgIG1lc3NhZ2U6IFwiS2V5cyBub3QgZm91bmRcIlxuICAgIH0pO1xuICB9XG4gIGNvbnN0IGp3ayA9IGRhdGEua2V5cy5maW5kKChrZXkpID0+IGtleS5raWQgPT09IGtpZCk7XG4gIGlmICghandrKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBKV0sgd2l0aCBraWQgJHtraWR9IG5vdCBmb3VuZGApO1xuICB9XG4gIHJldHVybiBhd2FpdCBpbXBvcnRKV0soandrLCBqd2suYWxnKTtcbn07XG5cbmNvbnN0IGF0bGFzc2lhbiA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiYXRsYXNzaWFuXCIsXG4gICAgbmFtZTogXCJBdGxhc3NpYW5cIixcbiAgICBhc3luYyBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBpZiAoIW9wdGlvbnMuY2xpZW50SWQgfHwgIW9wdGlvbnMuY2xpZW50U2VjcmV0KSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcIkNsaWVudCBJZCBhbmQgU2VjcmV0IGFyZSByZXF1aXJlZCBmb3IgQXRsYXNzaWFuXCIpO1xuICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiQ0xJRU5UX0lEX0FORF9TRUNSRVRfUkVRVUlSRURcIik7XG4gICAgICB9XG4gICAgICBpZiAoIWNvZGVWZXJpZmllcikge1xuICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiY29kZVZlcmlmaWVyIGlzIHJlcXVpcmVkIGZvciBBdGxhc3NpYW5cIik7XG4gICAgICB9XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJyZWFkOmppcmEtdXNlclwiLCBcIm9mZmxpbmVfYWNjZXNzXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcImF0bGFzc2lhblwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hdXRoLmF0bGFzc2lhbi5jb20vYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIGFkZGl0aW9uYWxQYXJhbXM6IHtcbiAgICAgICAgICBhdWRpZW5jZTogXCJhcGkuYXRsYXNzaWFuLmNvbVwiXG4gICAgICAgIH0sXG4gICAgICAgIHByb21wdDogb3B0aW9ucy5wcm9tcHRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hdXRoLmF0bGFzc2lhbi5jb20vb2F1dGgvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vYXV0aC5hdGxhc3NpYW4uY29tL29hdXRoL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGlmICghdG9rZW4uYWNjZXNzVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUgfSA9IGF3YWl0IGJldHRlckZldGNoKFwiaHR0cHM6Ly9hcGkuYXRsYXNzaWFuLmNvbS9tZVwiLCB7XG4gICAgICAgICAgaGVhZGVyczogeyBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YCB9XG4gICAgICAgIH0pO1xuICAgICAgICBpZiAoIXByb2ZpbGUpIHJldHVybiBudWxsO1xuICAgICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgaWQ6IHByb2ZpbGUuYWNjb3VudF9pZCxcbiAgICAgICAgICAgIG5hbWU6IHByb2ZpbGUubmFtZSxcbiAgICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgICAgaW1hZ2U6IHByb2ZpbGUucGljdHVyZSxcbiAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IGZhbHNlLFxuICAgICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICAgIH0sXG4gICAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgICB9O1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGZldGNoIHVzZXIgaW5mbyBmcm9tIEZpZ21hOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgY29nbml0byA9IChvcHRpb25zKSA9PiB7XG4gIGlmICghb3B0aW9ucy5kb21haW4gfHwgIW9wdGlvbnMucmVnaW9uIHx8ICFvcHRpb25zLnVzZXJQb29sSWQpIHtcbiAgICBsb2dnZXIuZXJyb3IoXG4gICAgICBcIkRvbWFpbiwgcmVnaW9uIGFuZCB1c2VyUG9vbElkIGFyZSByZXF1aXJlZCBmb3IgQW1hem9uIENvZ25pdG8uIE1ha2Ugc3VyZSB0byBwcm92aWRlIHRoZW0gaW4gdGhlIG9wdGlvbnMuXCJcbiAgICApO1xuICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJET01BSU5fQU5EX1JFR0lPTl9SRVFVSVJFRFwiKTtcbiAgfVxuICBjb25zdCBjbGVhbkRvbWFpbiA9IG9wdGlvbnMuZG9tYWluLnJlcGxhY2UoL15odHRwcz86XFwvXFwvLywgXCJcIik7XG4gIGNvbnN0IGF1dGhvcml6YXRpb25FbmRwb2ludCA9IGBodHRwczovLyR7Y2xlYW5Eb21haW59L29hdXRoMi9hdXRob3JpemVgO1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gYGh0dHBzOi8vJHtjbGVhbkRvbWFpbn0vb2F1dGgyL3Rva2VuYDtcbiAgY29uc3QgdXNlckluZm9FbmRwb2ludCA9IGBodHRwczovLyR7Y2xlYW5Eb21haW59L29hdXRoMi91c2VyaW5mb2A7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiY29nbml0b1wiLFxuICAgIG5hbWU6IFwiQ29nbml0b1wiLFxuICAgIGFzeW5jIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGlmICghb3B0aW9ucy5jbGllbnRJZCkge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXG4gICAgICAgICAgXCJDbGllbnRJZCBpcyByZXF1aXJlZCBmb3IgQW1hem9uIENvZ25pdG8uIE1ha2Ugc3VyZSB0byBwcm92aWRlIHRoZW0gaW4gdGhlIG9wdGlvbnMuXCJcbiAgICAgICAgKTtcbiAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcIkNMSUVOVF9JRF9BTkRfU0VDUkVUX1JFUVVJUkVEXCIpO1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMucmVxdWlyZUNsaWVudFNlY3JldCAmJiAhb3B0aW9ucy5jbGllbnRTZWNyZXQpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFxuICAgICAgICAgIFwiQ2xpZW50IFNlY3JldCBpcyByZXF1aXJlZCB3aGVuIHJlcXVpcmVDbGllbnRTZWNyZXQgaXMgdHJ1ZS4gTWFrZSBzdXJlIHRvIHByb3ZpZGUgaXQgaW4gdGhlIG9wdGlvbnMuXCJcbiAgICAgICAgKTtcbiAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcIkNMSUVOVF9TRUNSRVRfUkVRVUlSRURcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJvcGVuaWRcIiwgXCJwcm9maWxlXCIsIFwiZW1haWxcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIGNvbnN0IHVybCA9IGF3YWl0IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJjb2duaXRvXCIsXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICAuLi5vcHRpb25zXG4gICAgICAgIH0sXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludCxcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgcHJvbXB0OiBvcHRpb25zLnByb21wdFxuICAgICAgfSk7XG4gICAgICByZXR1cm4gdXJsO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIHZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKSB7XG4gICAgICBpZiAob3B0aW9ucy5kaXNhYmxlSWRUb2tlblNpZ25Jbikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy52ZXJpZnlJZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLnZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKTtcbiAgICAgIH1cbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IGRlY29kZWRIZWFkZXIgPSBkZWNvZGVQcm90ZWN0ZWRIZWFkZXIodG9rZW4pO1xuICAgICAgICBjb25zdCB7IGtpZCwgYWxnOiBqd3RBbGcgfSA9IGRlY29kZWRIZWFkZXI7XG4gICAgICAgIGlmICgha2lkIHx8ICFqd3RBbGcpIHJldHVybiBmYWxzZTtcbiAgICAgICAgY29uc3QgcHVibGljS2V5ID0gYXdhaXQgZ2V0Q29nbml0b1B1YmxpY0tleShcbiAgICAgICAgICBraWQsXG4gICAgICAgICAgb3B0aW9ucy5yZWdpb24sXG4gICAgICAgICAgb3B0aW9ucy51c2VyUG9vbElkXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IGV4cGVjdGVkSXNzdWVyID0gYGh0dHBzOi8vY29nbml0by1pZHAuJHtvcHRpb25zLnJlZ2lvbn0uYW1hem9uYXdzLmNvbS8ke29wdGlvbnMudXNlclBvb2xJZH1gO1xuICAgICAgICBjb25zdCB7IHBheWxvYWQ6IGp3dENsYWltcyB9ID0gYXdhaXQgand0VmVyaWZ5KHRva2VuLCBwdWJsaWNLZXksIHtcbiAgICAgICAgICBhbGdvcml0aG1zOiBband0QWxnXSxcbiAgICAgICAgICBpc3N1ZXI6IGV4cGVjdGVkSXNzdWVyLFxuICAgICAgICAgIGF1ZGllbmNlOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIG1heFRva2VuQWdlOiBcIjFoXCJcbiAgICAgICAgfSk7XG4gICAgICAgIGlmIChub25jZSAmJiBqd3RDbGFpbXMubm9uY2UgIT09IG5vbmNlKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIHZlcmlmeSBJRCB0b2tlbjpcIiwgZXJyb3IpO1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgaWYgKHRva2VuLmlkVG9rZW4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBwcm9maWxlID0gZGVjb2RlSnd0KHRva2VuLmlkVG9rZW4pO1xuICAgICAgICAgIGlmICghcHJvZmlsZSkge1xuICAgICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IG5hbWUgPSBwcm9maWxlLm5hbWUgfHwgcHJvZmlsZS5naXZlbl9uYW1lIHx8IHByb2ZpbGUudXNlcm5hbWUgfHwgcHJvZmlsZS5lbWFpbDtcbiAgICAgICAgICBjb25zdCBlbnJpY2hlZFByb2ZpbGUgPSB7XG4gICAgICAgICAgICAuLi5wcm9maWxlLFxuICAgICAgICAgICAgbmFtZVxuICAgICAgICAgIH07XG4gICAgICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKGVucmljaGVkUHJvZmlsZSk7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgaWQ6IHByb2ZpbGUuc3ViLFxuICAgICAgICAgICAgICBuYW1lOiBlbnJpY2hlZFByb2ZpbGUubmFtZSxcbiAgICAgICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgICAgIGltYWdlOiBwcm9maWxlLnBpY3R1cmUsXG4gICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHByb2ZpbGUuZW1haWxfdmVyaWZpZWQsXG4gICAgICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBkYXRhOiBlbnJpY2hlZFByb2ZpbGVcbiAgICAgICAgICB9O1xuICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBkZWNvZGUgSUQgdG9rZW46XCIsIGVycm9yKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKHRva2VuLmFjY2Vzc1Rva2VuKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgY29uc3QgeyBkYXRhOiB1c2VySW5mbyB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgICAgICB1c2VySW5mb0VuZHBvaW50LFxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgICk7XG4gICAgICAgICAgaWYgKHVzZXJJbmZvKSB7XG4gICAgICAgICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4odXNlckluZm8pO1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgIGlkOiB1c2VySW5mby5zdWIsXG4gICAgICAgICAgICAgICAgbmFtZTogdXNlckluZm8ubmFtZSB8fCB1c2VySW5mby5naXZlbl9uYW1lIHx8IHVzZXJJbmZvLnVzZXJuYW1lLFxuICAgICAgICAgICAgICAgIGVtYWlsOiB1c2VySW5mby5lbWFpbCxcbiAgICAgICAgICAgICAgICBpbWFnZTogdXNlckluZm8ucGljdHVyZSxcbiAgICAgICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB1c2VySW5mby5lbWFpbF92ZXJpZmllZCxcbiAgICAgICAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgIGRhdGE6IHVzZXJJbmZvXG4gICAgICAgICAgICB9O1xuICAgICAgICAgIH1cbiAgICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gZmV0Y2ggdXNlciBpbmZvIGZyb20gQ29nbml0bzpcIiwgZXJyb3IpO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5jb25zdCBnZXRDb2duaXRvUHVibGljS2V5ID0gYXN5bmMgKGtpZCwgcmVnaW9uLCB1c2VyUG9vbElkKSA9PiB7XG4gIGNvbnN0IENPR05JVE9fSldLU19VUkkgPSBgaHR0cHM6Ly9jb2duaXRvLWlkcC4ke3JlZ2lvbn0uYW1hem9uYXdzLmNvbS8ke3VzZXJQb29sSWR9Ly53ZWxsLWtub3duL2p3a3MuanNvbmA7XG4gIHRyeSB7XG4gICAgY29uc3QgeyBkYXRhIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChDT0dOSVRPX0pXS1NfVVJJKTtcbiAgICBpZiAoIWRhdGE/LmtleXMpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJLZXlzIG5vdCBmb3VuZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgandrID0gZGF0YS5rZXlzLmZpbmQoKGtleSkgPT4ga2V5LmtpZCA9PT0ga2lkKTtcbiAgICBpZiAoIWp3aykge1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBKV0sgd2l0aCBraWQgJHtraWR9IG5vdCBmb3VuZGApO1xuICAgIH1cbiAgICByZXR1cm4gYXdhaXQgaW1wb3J0SldLKGp3aywgandrLmFsZyk7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGZldGNoIENvZ25pdG8gcHVibGljIGtleTpcIiwgZXJyb3IpO1xuICAgIHRocm93IGVycm9yO1xuICB9XG59O1xuXG5jb25zdCBkaXNjb3JkID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJkaXNjb3JkXCIsXG4gICAgbmFtZTogXCJEaXNjb3JkXCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcImlkZW50aWZ5XCIsIFwiZW1haWxcIl07XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHJldHVybiBuZXcgVVJMKFxuICAgICAgICBgaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvb2F1dGgyL2F1dGhvcml6ZT9zY29wZT0ke19zY29wZXMuam9pbihcbiAgICAgICAgICBcIitcIlxuICAgICAgICApfSZyZXNwb25zZV90eXBlPWNvZGUmY2xpZW50X2lkPSR7b3B0aW9ucy5jbGllbnRJZH0mcmVkaXJlY3RfdXJpPSR7ZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgICAgICAgIG9wdGlvbnMucmVkaXJlY3RVUkkgfHwgcmVkaXJlY3RVUklcbiAgICAgICAgKX0mc3RhdGU9JHtzdGF0ZX0mcHJvbXB0PSR7b3B0aW9ucy5wcm9tcHQgfHwgXCJub25lXCJ9YFxuICAgICAgKTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9kaXNjb3JkLmNvbS9hcGkvb2F1dGgyL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vZGlzY29yZC5jb20vYXBpL29hdXRoMi90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2Rpc2NvcmQuY29tL2FwaS91c2Vycy9AbWVcIixcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIGF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgaWYgKHByb2ZpbGUuYXZhdGFyID09PSBudWxsKSB7XG4gICAgICAgIGNvbnN0IGRlZmF1bHRBdmF0YXJOdW1iZXIgPSBwcm9maWxlLmRpc2NyaW1pbmF0b3IgPT09IFwiMFwiID8gTnVtYmVyKEJpZ0ludChwcm9maWxlLmlkKSA+PiBCaWdJbnQoMjIpKSAlIDYgOiBwYXJzZUludChwcm9maWxlLmRpc2NyaW1pbmF0b3IpICUgNTtcbiAgICAgICAgcHJvZmlsZS5pbWFnZV91cmwgPSBgaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vZW1iZWQvYXZhdGFycy8ke2RlZmF1bHRBdmF0YXJOdW1iZXJ9LnBuZ2A7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBmb3JtYXQgPSBwcm9maWxlLmF2YXRhci5zdGFydHNXaXRoKFwiYV9cIikgPyBcImdpZlwiIDogXCJwbmdcIjtcbiAgICAgICAgcHJvZmlsZS5pbWFnZV91cmwgPSBgaHR0cHM6Ly9jZG4uZGlzY29yZGFwcC5jb20vYXZhdGFycy8ke3Byb2ZpbGUuaWR9LyR7cHJvZmlsZS5hdmF0YXJ9LiR7Zm9ybWF0fWA7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuaWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5nbG9iYWxfbmFtZSB8fCBwcm9maWxlLnVzZXJuYW1lIHx8IFwiXCIsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogcHJvZmlsZS52ZXJpZmllZCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5pbWFnZV91cmwsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgZmFjZWJvb2sgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcImZhY2Vib29rXCIsXG4gICAgbmFtZTogXCJGYWNlYm9va1wiLFxuICAgIGFzeW5jIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCByZWRpcmVjdFVSSSwgbG9naW5IaW50IH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcImVtYWlsXCIsIFwicHVibGljX3Byb2ZpbGVcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBhd2FpdCBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwiZmFjZWJvb2tcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vd3d3LmZhY2Vib29rLmNvbS92MjEuMC9kaWFsb2cvb2F1dGhcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIGxvZ2luSGludCxcbiAgICAgICAgYWRkaXRpb25hbFBhcmFtczogb3B0aW9ucy5jb25maWdJZCA/IHtcbiAgICAgICAgICBjb25maWdfaWQ6IG9wdGlvbnMuY29uZmlnSWRcbiAgICAgICAgfSA6IHt9XG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vb2F1dGgvYWNjZXNzX3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgdmVyaWZ5SWRUb2tlbih0b2tlbiwgbm9uY2UpIHtcbiAgICAgIGlmIChvcHRpb25zLmRpc2FibGVJZFRva2VuU2lnbkluKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICAgIGlmIChvcHRpb25zLnZlcmlmeUlkVG9rZW4pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMudmVyaWZ5SWRUb2tlbih0b2tlbiwgbm9uY2UpO1xuICAgICAgfVxuICAgICAgaWYgKHRva2VuLnNwbGl0KFwiLlwiKS5sZW5ndGggPT09IDMpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCB7IHBheWxvYWQ6IGp3dENsYWltcyB9ID0gYXdhaXQgand0VmVyaWZ5KFxuICAgICAgICAgICAgdG9rZW4sXG4gICAgICAgICAgICBjcmVhdGVSZW1vdGVKV0tTZXQoXG4gICAgICAgICAgICAgIC8vIGh0dHBzOi8vZGV2ZWxvcGVycy5mYWNlYm9vay5jb20vZG9jcy9mYWNlYm9vay1sb2dpbi9saW1pdGVkLWxvZ2luL3Rva2VuLyNqd2tzXG4gICAgICAgICAgICAgIG5ldyBVUkwoXG4gICAgICAgICAgICAgICAgXCJodHRwczovL2xpbWl0ZWQuZmFjZWJvb2suY29tLy53ZWxsLWtub3duL29hdXRoL29wZW5pZC9qd2tzL1wiXG4gICAgICAgICAgICAgIClcbiAgICAgICAgICAgICksXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGFsZ29yaXRobXM6IFtcIlJTMjU2XCJdLFxuICAgICAgICAgICAgICBhdWRpZW5jZTogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICAgICAgaXNzdWVyOiBcImh0dHBzOi8vd3d3LmZhY2Vib29rLmNvbVwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgKTtcbiAgICAgICAgICBpZiAobm9uY2UgJiYgand0Q2xhaW1zLm5vbmNlICE9PSBub25jZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gISFqd3RDbGFpbXM7XG4gICAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS92MTguMC9vYXV0aC9hY2Nlc3NfdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgaWYgKHRva2VuLmlkVG9rZW4gJiYgdG9rZW4uaWRUb2tlbi5zcGxpdChcIi5cIikubGVuZ3RoID09PSAzKSB7XG4gICAgICAgIGNvbnN0IHByb2ZpbGUyID0gZGVjb2RlSnd0KHRva2VuLmlkVG9rZW4pO1xuICAgICAgICBjb25zdCB1c2VyID0ge1xuICAgICAgICAgIGlkOiBwcm9maWxlMi5zdWIsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZTIubmFtZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZTIuZW1haWwsXG4gICAgICAgICAgcGljdHVyZToge1xuICAgICAgICAgICAgZGF0YToge1xuICAgICAgICAgICAgICB1cmw6IHByb2ZpbGUyLnBpY3R1cmUsXG4gICAgICAgICAgICAgIGhlaWdodDogMTAwLFxuICAgICAgICAgICAgICB3aWR0aDogMTAwLFxuICAgICAgICAgICAgICBpc19zaWxob3VldHRlOiBmYWxzZVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgY29uc3QgdXNlck1hcDIgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lih7XG4gICAgICAgICAgLi4udXNlcixcbiAgICAgICAgICBlbWFpbF92ZXJpZmllZDogdHJ1ZVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAuLi51c2VyLFxuICAgICAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZSxcbiAgICAgICAgICAgIC4uLnVzZXJNYXAyXG4gICAgICAgICAgfSxcbiAgICAgICAgICBkYXRhOiBwcm9maWxlMlxuICAgICAgICB9O1xuICAgICAgfVxuICAgICAgY29uc3QgZmllbGRzID0gW1xuICAgICAgICBcImlkXCIsXG4gICAgICAgIFwibmFtZVwiLFxuICAgICAgICBcImVtYWlsXCIsXG4gICAgICAgIFwicGljdHVyZVwiLFxuICAgICAgICAuLi5vcHRpb25zPy5maWVsZHMgfHwgW11cbiAgICAgIF07XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9tZT9maWVsZHM9XCIgKyBmaWVsZHMuam9pbihcIixcIiksXG4gICAgICAgIHtcbiAgICAgICAgICBhdXRoOiB7XG4gICAgICAgICAgICB0eXBlOiBcIkJlYXJlclwiLFxuICAgICAgICAgICAgdG9rZW46IHRva2VuLmFjY2Vzc1Rva2VuXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLmlkLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUubmFtZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5waWN0dXJlLmRhdGEudXJsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHByb2ZpbGUuZW1haWxfdmVyaWZpZWQsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgZmlnbWEgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcImZpZ21hXCIsXG4gICAgbmFtZTogXCJGaWdtYVwiLFxuICAgIGFzeW5jIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGlmICghb3B0aW9ucy5jbGllbnRJZCB8fCAhb3B0aW9ucy5jbGllbnRTZWNyZXQpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFxuICAgICAgICAgIFwiQ2xpZW50IElkIGFuZCBDbGllbnQgU2VjcmV0IGFyZSByZXF1aXJlZCBmb3IgRmlnbWEuIE1ha2Ugc3VyZSB0byBwcm92aWRlIHRoZW0gaW4gdGhlIG9wdGlvbnMuXCJcbiAgICAgICAgKTtcbiAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcIkNMSUVOVF9JRF9BTkRfU0VDUkVUX1JFUVVJUkVEXCIpO1xuICAgICAgfVxuICAgICAgaWYgKCFjb2RlVmVyaWZpZXIpIHtcbiAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcImNvZGVWZXJpZmllciBpcyByZXF1aXJlZCBmb3IgRmlnbWFcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJmaWxlX3JlYWRcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIGNvbnN0IHVybCA9IGF3YWl0IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJmaWdtYVwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly93d3cuZmlnbWEuY29tL29hdXRoXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUklcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHVybDtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vd3d3LmZpZ21hLmNvbS9hcGkvb2F1dGgvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly93d3cuZmlnbWEuY29tL2FwaS9vYXV0aC90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICAgIFwiaHR0cHM6Ly9hcGkuZmlnbWEuY29tL3YxL21lXCIsXG4gICAgICAgICAge1xuICAgICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgaWYgKCFwcm9maWxlKSB7XG4gICAgICAgICAgbG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGZldGNoIHVzZXIgZnJvbSBGaWdtYVwiKTtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICAgIHJldHVybiB7XG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgaWQ6IHByb2ZpbGUuaWQsXG4gICAgICAgICAgICBuYW1lOiBwcm9maWxlLmhhbmRsZSxcbiAgICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgICAgaW1hZ2U6IHByb2ZpbGUuaW1nX3VybCxcbiAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6ICEhcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgICB9LFxuICAgICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgICAgfTtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBmZXRjaCB1c2VyIGluZm8gZnJvbSBGaWdtYTpcIiwgZXJyb3IpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IGdpdGh1YiA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHRva2VuRW5kcG9pbnQgPSBcImh0dHBzOi8vZ2l0aHViLmNvbS9sb2dpbi9vYXV0aC9hY2Nlc3NfdG9rZW5cIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJnaXRodWJcIixcbiAgICBuYW1lOiBcIkdpdEh1YlwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCBsb2dpbkhpbnQsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcInJlYWQ6dXNlclwiLCBcInVzZXI6ZW1haWxcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwiZ2l0aHViXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL2dpdGh1Yi5jb20vbG9naW4vb2F1dGgvYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBsb2dpbkhpbnQsXG4gICAgICAgIHByb21wdDogb3B0aW9ucy5wcm9tcHRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9naXRodWIuY29tL2xvZ2luL29hdXRoL2FjY2Vzc190b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2FwaS5naXRodWIuY29tL3VzZXJcIixcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIFwiVXNlci1BZ2VudFwiOiBcImJldHRlci1hdXRoXCIsXG4gICAgICAgICAgICBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogZW1haWxzIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcImh0dHBzOi8vYXBpLmdpdGh1Yi5jb20vdXNlci9lbWFpbHNcIiwge1xuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWAsXG4gICAgICAgICAgXCJVc2VyLUFnZW50XCI6IFwiYmV0dGVyLWF1dGhcIlxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmICghcHJvZmlsZS5lbWFpbCAmJiBlbWFpbHMpIHtcbiAgICAgICAgcHJvZmlsZS5lbWFpbCA9IChlbWFpbHMuZmluZCgoZSkgPT4gZS5wcmltYXJ5KSA/PyBlbWFpbHNbMF0pPy5lbWFpbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGVtYWlsVmVyaWZpZWQgPSBlbWFpbHM/LmZpbmQoKGUpID0+IGUuZW1haWwgPT09IHByb2ZpbGUuZW1haWwpPy52ZXJpZmllZCA/PyBmYWxzZTtcbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLm5hbWUgfHwgcHJvZmlsZS5sb2dpbixcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5hdmF0YXJfdXJsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgZ29vZ2xlID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJnb29nbGVcIixcbiAgICBuYW1lOiBcIkdvb2dsZVwiLFxuICAgIGFzeW5jIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgc3RhdGUsXG4gICAgICBzY29wZXMsXG4gICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICByZWRpcmVjdFVSSSxcbiAgICAgIGxvZ2luSGludCxcbiAgICAgIGRpc3BsYXlcbiAgICB9KSB7XG4gICAgICBpZiAoIW9wdGlvbnMuY2xpZW50SWQgfHwgIW9wdGlvbnMuY2xpZW50U2VjcmV0KSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcbiAgICAgICAgICBcIkNsaWVudCBJZCBhbmQgQ2xpZW50IFNlY3JldCBpcyByZXF1aXJlZCBmb3IgR29vZ2xlLiBNYWtlIHN1cmUgdG8gcHJvdmlkZSB0aGVtIGluIHRoZSBvcHRpb25zLlwiXG4gICAgICAgICk7XG4gICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJDTElFTlRfSURfQU5EX1NFQ1JFVF9SRVFVSVJFRFwiKTtcbiAgICAgIH1cbiAgICAgIGlmICghY29kZVZlcmlmaWVyKSB7XG4gICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJjb2RlVmVyaWZpZXIgaXMgcmVxdWlyZWQgZm9yIEdvb2dsZVwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcImVtYWlsXCIsIFwicHJvZmlsZVwiLCBcIm9wZW5pZFwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgY29uc3QgdXJsID0gYXdhaXQgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcImdvb2dsZVwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tL28vb2F1dGgyL2F1dGhcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgcHJvbXB0OiBvcHRpb25zLnByb21wdCxcbiAgICAgICAgYWNjZXNzVHlwZTogb3B0aW9ucy5hY2Nlc3NUeXBlLFxuICAgICAgICBkaXNwbGF5OiBkaXNwbGF5IHx8IG9wdGlvbnMuZGlzcGxheSxcbiAgICAgICAgbG9naW5IaW50LFxuICAgICAgICBoZDogb3B0aW9ucy5oZCxcbiAgICAgICAgYWRkaXRpb25hbFBhcmFtczoge1xuICAgICAgICAgIGluY2x1ZGVfZ3JhbnRlZF9zY29wZXM6IFwidHJ1ZVwiXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHVybDtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vb2F1dGgyLmdvb2dsZWFwaXMuY29tL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vd3d3Lmdvb2dsZWFwaXMuY29tL29hdXRoMi92NC90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIHZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKSB7XG4gICAgICBpZiAob3B0aW9ucy5kaXNhYmxlSWRUb2tlblNpZ25Jbikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy52ZXJpZnlJZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLnZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGdvb2dsZVB1YmxpY0tleVVybCA9IGBodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9vYXV0aDIvdjMvdG9rZW5pbmZvP2lkX3Rva2VuPSR7dG9rZW59YDtcbiAgICAgIGNvbnN0IHsgZGF0YTogdG9rZW5JbmZvIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChnb29nbGVQdWJsaWNLZXlVcmwpO1xuICAgICAgaWYgKCF0b2tlbkluZm8pIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgY29uc3QgaXNWYWxpZCA9IHRva2VuSW5mby5hdWQgPT09IG9wdGlvbnMuY2xpZW50SWQgJiYgKHRva2VuSW5mby5pc3MgPT09IFwiaHR0cHM6Ly9hY2NvdW50cy5nb29nbGUuY29tXCIgfHwgdG9rZW5JbmZvLmlzcyA9PT0gXCJhY2NvdW50cy5nb29nbGUuY29tXCIpO1xuICAgICAgcmV0dXJuIGlzVmFsaWQ7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgaWYgKCF0b2tlbi5pZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlciA9IGRlY29kZUp3dCh0b2tlbi5pZFRva2VuKTtcbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lih1c2VyKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogdXNlci5zdWIsXG4gICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiB1c2VyLnBpY3R1cmUsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogdXNlci5lbWFpbF92ZXJpZmllZCxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHVzZXJcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCBraWNrID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJraWNrXCIsXG4gICAgbmFtZTogXCJLaWNrXCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIHJlZGlyZWN0VVJJLCBjb2RlVmVyaWZpZXIgfSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1widXNlcjpyZWFkXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcImtpY2tcIixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL2lkLmtpY2suY29tL29hdXRoL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgc3RhdGVcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7IGNvZGUsIHJlZGlyZWN0VVJJLCBjb2RlVmVyaWZpZXIgfSkge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2lkLmtpY2suY29tL29hdXRoL3Rva2VuXCIsXG4gICAgICAgIGNvZGVWZXJpZmllclxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXCJodHRwczovL2FwaS5raWNrLmNvbS9wdWJsaWMvdjEvdXNlcnNcIiwge1xuICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHByb2ZpbGUgPSBkYXRhLmRhdGFbMF07XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUudXNlcl9pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLm5hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUucHJvZmlsZV9waWN0dXJlLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgaHVnZ2luZ2ZhY2UgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcImh1Z2dpbmdmYWNlXCIsXG4gICAgbmFtZTogXCJIdWdnaW5nIEZhY2VcIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJvcGVuaWRcIiwgXCJwcm9maWxlXCIsIFwiZW1haWxcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwiaHVnZ2luZ2ZhY2VcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vaHVnZ2luZ2ZhY2UuY28vb2F1dGgvYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUklcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9odWdnaW5nZmFjZS5jby9vYXV0aC90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2h1Z2dpbmdmYWNlLmNvL29hdXRoL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vaHVnZ2luZ2ZhY2UuY28vb2F1dGgvdXNlcmluZm9cIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5zdWIsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5uYW1lIHx8IHByb2ZpbGUucHJlZmVycmVkX3VzZXJuYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLnBpY3R1cmUsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogcHJvZmlsZS5lbWFpbF92ZXJpZmllZCA/PyBmYWxzZSxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCBtaWNyb3NvZnQgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB0ZW5hbnQgPSBvcHRpb25zLnRlbmFudElkIHx8IFwiY29tbW9uXCI7XG4gIGNvbnN0IGF1dGhvcml0eSA9IG9wdGlvbnMuYXV0aG9yaXR5IHx8IFwiaHR0cHM6Ly9sb2dpbi5taWNyb3NvZnRvbmxpbmUuY29tXCI7XG4gIGNvbnN0IGF1dGhvcml6YXRpb25FbmRwb2ludCA9IGAke2F1dGhvcml0eX0vJHt0ZW5hbnR9L29hdXRoMi92Mi4wL2F1dGhvcml6ZWA7XG4gIGNvbnN0IHRva2VuRW5kcG9pbnQgPSBgJHthdXRob3JpdHl9LyR7dGVuYW50fS9vYXV0aDIvdjIuMC90b2tlbmA7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwibWljcm9zb2Z0XCIsXG4gICAgbmFtZTogXCJNaWNyb3NvZnQgRW50cmFJRFwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoZGF0YSkge1xuICAgICAgY29uc3Qgc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJvcGVuaWRcIiwgXCJwcm9maWxlXCIsIFwiZW1haWxcIiwgXCJVc2VyLlJlYWRcIiwgXCJvZmZsaW5lX2FjY2Vzc1wiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBkYXRhLnNjb3BlcyAmJiBzY29wZXMucHVzaCguLi5kYXRhLnNjb3Blcyk7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcIm1pY3Jvc29mdFwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQsXG4gICAgICAgIHN0YXRlOiBkYXRhLnN0YXRlLFxuICAgICAgICBjb2RlVmVyaWZpZXI6IGRhdGEuY29kZVZlcmlmaWVyLFxuICAgICAgICBzY29wZXMsXG4gICAgICAgIHJlZGlyZWN0VVJJOiBkYXRhLnJlZGlyZWN0VVJJLFxuICAgICAgICBwcm9tcHQ6IG9wdGlvbnMucHJvbXB0LFxuICAgICAgICBsb2dpbkhpbnQ6IGRhdGEubG9naW5IaW50XG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoeyBjb2RlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgaWYgKCF0b2tlbi5pZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlciA9IGRlY29kZUp3dCh0b2tlbi5pZFRva2VuKTtcbiAgICAgIGNvbnN0IHByb2ZpbGVQaG90b1NpemUgPSBvcHRpb25zLnByb2ZpbGVQaG90b1NpemUgfHwgNDg7XG4gICAgICBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgYGh0dHBzOi8vZ3JhcGgubWljcm9zb2Z0LmNvbS92MS4wL21lL3Bob3Rvcy8ke3Byb2ZpbGVQaG90b1NpemV9eCR7cHJvZmlsZVBob3RvU2l6ZX0vJHZhbHVlYCxcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfSxcbiAgICAgICAgICBhc3luYyBvblJlc3BvbnNlKGNvbnRleHQpIHtcbiAgICAgICAgICAgIGlmIChvcHRpb25zLmRpc2FibGVQcm9maWxlUGhvdG8gfHwgIWNvbnRleHQucmVzcG9uc2Uub2spIHtcbiAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBjb250ZXh0LnJlc3BvbnNlLmNsb25lKCk7XG4gICAgICAgICAgICAgIGNvbnN0IHBpY3R1cmVCdWZmZXIgPSBhd2FpdCByZXNwb25zZS5hcnJheUJ1ZmZlcigpO1xuICAgICAgICAgICAgICBjb25zdCBwaWN0dXJlQmFzZTY0ID0gYmFzZTY0LmVuY29kZShwaWN0dXJlQnVmZmVyKTtcbiAgICAgICAgICAgICAgdXNlci5waWN0dXJlID0gYGRhdGE6aW1hZ2UvanBlZztiYXNlNjQsICR7cGljdHVyZUJhc2U2NH1gO1xuICAgICAgICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICAgICAgICBsb2dnZXIuZXJyb3IoXG4gICAgICAgICAgICAgICAgZSAmJiB0eXBlb2YgZSA9PT0gXCJvYmplY3RcIiAmJiBcIm5hbWVcIiBpbiBlID8gZS5uYW1lIDogXCJcIixcbiAgICAgICAgICAgICAgICBlXG4gICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHVzZXIpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiB1c2VyLnN1YixcbiAgICAgICAgICBuYW1lOiB1c2VyLm5hbWUsXG4gICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgaW1hZ2U6IHVzZXIucGljdHVyZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB0cnVlLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogdXNlclxuICAgICAgfTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIGNvbnN0IHNjb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1wib3BlbmlkXCIsIFwicHJvZmlsZVwiLCBcImVtYWlsXCIsIFwiVXNlci5SZWFkXCIsIFwib2ZmbGluZV9hY2Nlc3NcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIHNjb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgZXh0cmFQYXJhbXM6IHtcbiAgICAgICAgICBzY29wZTogc2NvcGVzLmpvaW4oXCIgXCIpXG4gICAgICAgICAgLy8gSW5jbHVkZSB0aGUgc2NvcGVzIGluIHJlcXVlc3QgdG8gbWljcm9zb2Z0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3Qgc2xhY2sgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcInNsYWNrXCIsXG4gICAgbmFtZTogXCJTbGFja1wiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJvcGVuaWRcIiwgXCJwcm9maWxlXCIsIFwiZW1haWxcIl07XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIGNvbnN0IHVybCA9IG5ldyBVUkwoXCJodHRwczovL3NsYWNrLmNvbS9vcGVuaWQvY29ubmVjdC9hdXRob3JpemVcIik7XG4gICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldChcInNjb3BlXCIsIF9zY29wZXMuam9pbihcIiBcIikpO1xuICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJyZXNwb25zZV90eXBlXCIsIFwiY29kZVwiKTtcbiAgICAgIHVybC5zZWFyY2hQYXJhbXMuc2V0KFwiY2xpZW50X2lkXCIsIG9wdGlvbnMuY2xpZW50SWQpO1xuICAgICAgdXJsLnNlYXJjaFBhcmFtcy5zZXQoXCJyZWRpcmVjdF91cmlcIiwgb3B0aW9ucy5yZWRpcmVjdFVSSSB8fCByZWRpcmVjdFVSSSk7XG4gICAgICB1cmwuc2VhcmNoUGFyYW1zLnNldChcInN0YXRlXCIsIHN0YXRlKTtcbiAgICAgIHJldHVybiB1cmw7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vc2xhY2suY29tL2FwaS9vcGVuaWQuY29ubmVjdC50b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL3NsYWNrLmNvbS9hcGkvb3BlbmlkLmNvbm5lY3QudG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9zbGFjay5jb20vYXBpL29wZW5pZC5jb25uZWN0LnVzZXJJbmZvXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZVtcImh0dHBzOi8vc2xhY2suY29tL3VzZXJfaWRcIl0sXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5uYW1lIHx8IFwiXCIsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogcHJvZmlsZS5lbWFpbF92ZXJpZmllZCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5waWN0dXJlIHx8IHByb2ZpbGVbXCJodHRwczovL3NsYWNrLmNvbS91c2VyX2ltYWdlXzUxMlwiXSxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCBub3Rpb24gPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gXCJodHRwczovL2FwaS5ub3Rpb24uY29tL3YxL29hdXRoL3Rva2VuXCI7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwibm90aW9uXCIsXG4gICAgbmFtZTogXCJOb3Rpb25cIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgbG9naW5IaW50LCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgcmV0dXJuIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJub3Rpb25cIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vYXBpLm5vdGlvbi5jb20vdjEvb2F1dGgvYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBsb2dpbkhpbnQsXG4gICAgICAgIGFkZGl0aW9uYWxQYXJhbXM6IHtcbiAgICAgICAgICBvd25lcjogXCJ1c2VyXCJcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50LFxuICAgICAgICBhdXRoZW50aWNhdGlvbjogXCJiYXNpY1wiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXCJodHRwczovL2FwaS5ub3Rpb24uY29tL3YxL3VzZXJzL21lXCIsIHtcbiAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gLFxuICAgICAgICAgIFwiTm90aW9uLVZlcnNpb25cIjogXCIyMDIyLTA2LTI4XCJcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgICBpZiAoZXJyb3IgfHwgIXByb2ZpbGUpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyUHJvZmlsZSA9IHByb2ZpbGUuYm90Py5vd25lcj8udXNlcjtcbiAgICAgIGlmICghdXNlclByb2ZpbGUpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4odXNlclByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiB1c2VyUHJvZmlsZS5pZCxcbiAgICAgICAgICBuYW1lOiB1c2VyUHJvZmlsZS5uYW1lIHx8IFwiTm90aW9uIFVzZXJcIixcbiAgICAgICAgICBlbWFpbDogdXNlclByb2ZpbGUucGVyc29uPy5lbWFpbCB8fCBudWxsLFxuICAgICAgICAgIGltYWdlOiB1c2VyUHJvZmlsZS5hdmF0YXJfdXJsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6ICEhdXNlclByb2ZpbGUucGVyc29uPy5lbWFpbCxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHVzZXJQcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3Qgc3BvdGlmeSA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwic3BvdGlmeVwiLFxuICAgIG5hbWU6IFwiU3BvdGlmeVwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcInVzZXItcmVhZC1lbWFpbFwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgcmV0dXJuIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJzcG90aWZ5XCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL2FjY291bnRzLnNwb3RpZnkuY29tL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vYWNjb3VudHMuc3BvdGlmeS5jb20vYXBpL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vYWNjb3VudHMuc3BvdGlmeS5jb20vYXBpL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vYXBpLnNwb3RpZnkuY29tL3YxL21lXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuaWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5kaXNwbGF5X25hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUuaW1hZ2VzWzBdPy51cmwsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogZmFsc2UsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgdHdpdGNoID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJ0d2l0Y2hcIixcbiAgICBuYW1lOiBcIlR3aXRjaFwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJ1c2VyOnJlYWQ6ZW1haWxcIiwgXCJvcGVuaWRcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwidHdpdGNoXCIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly9pZC50d2l0Y2gudHYvb2F1dGgyL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICBjbGFpbXM6IG9wdGlvbnMuY2xhaW1zIHx8IFtcbiAgICAgICAgICBcImVtYWlsXCIsXG4gICAgICAgICAgXCJlbWFpbF92ZXJpZmllZFwiLFxuICAgICAgICAgIFwicHJlZmVycmVkX3VzZXJuYW1lXCIsXG4gICAgICAgICAgXCJwaWN0dXJlXCJcbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vaWQudHdpdGNoLnR2L29hdXRoMi90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2lkLnR3aXRjaC50di9vYXV0aDIvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgaWRUb2tlbiA9IHRva2VuLmlkVG9rZW47XG4gICAgICBpZiAoIWlkVG9rZW4pIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFwiTm8gaWRUb2tlbiBmb3VuZCBpbiB0b2tlblwiKTtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCBwcm9maWxlID0gZGVjb2RlSnd0KGlkVG9rZW4pO1xuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLnN1YixcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLnByZWZlcnJlZF91c2VybmFtZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5waWN0dXJlLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHByb2ZpbGUuZW1haWxfdmVyaWZpZWQsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgdHdpdHRlciA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwidHdpdHRlclwiLFxuICAgIG5hbWU6IFwiVHdpdHRlclwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoZGF0YSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1widXNlcnMucmVhZFwiLCBcInR3ZWV0LnJlYWRcIiwgXCJvZmZsaW5lLmFjY2Vzc1wiLCBcInVzZXJzLmVtYWlsXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBkYXRhLnNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uZGF0YS5zY29wZXMpO1xuICAgICAgcmV0dXJuIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJ0d2l0dGVyXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL3guY29tL2kvb2F1dGgyL2F1dGhvcml6ZVwiLFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlOiBkYXRhLnN0YXRlLFxuICAgICAgICBjb2RlVmVyaWZpZXI6IGRhdGEuY29kZVZlcmlmaWVyLFxuICAgICAgICByZWRpcmVjdFVSSTogZGF0YS5yZWRpcmVjdFVSSVxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCBjb2RlVmVyaWZpZXIsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICBhdXRoZW50aWNhdGlvbjogXCJiYXNpY1wiLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2FwaS54LmNvbS8yL29hdXRoMi90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgYXV0aGVudGljYXRpb246IFwiYmFzaWNcIixcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2FwaS54LmNvbS8yL29hdXRoMi90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yOiBwcm9maWxlRXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vYXBpLnguY29tLzIvdXNlcnMvbWU/dXNlci5maWVsZHM9cHJvZmlsZV9pbWFnZV91cmxcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChwcm9maWxlRXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IGVtYWlsRGF0YSwgZXJyb3I6IGVtYWlsRXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFwiaHR0cHM6Ly9hcGkueC5jb20vMi91c2Vycy9tZT91c2VyLmZpZWxkcz1jb25maXJtZWRfZW1haWxcIiwge1xuICAgICAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGxldCBlbWFpbFZlcmlmaWVkID0gZmFsc2U7XG4gICAgICBpZiAoIWVtYWlsRXJyb3IgJiYgZW1haWxEYXRhPy5kYXRhPy5jb25maXJtZWRfZW1haWwpIHtcbiAgICAgICAgcHJvZmlsZS5kYXRhLmVtYWlsID0gZW1haWxEYXRhLmRhdGEuY29uZmlybWVkX2VtYWlsO1xuICAgICAgICBlbWFpbFZlcmlmaWVkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5kYXRhLmlkLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUuZGF0YS5uYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmRhdGEuZW1haWwgfHwgcHJvZmlsZS5kYXRhLnVzZXJuYW1lIHx8IG51bGwsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUuZGF0YS5wcm9maWxlX2ltYWdlX3VybCxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IGRyb3Bib3ggPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gXCJodHRwczovL2FwaS5kcm9wYm94YXBpLmNvbS9vYXV0aDIvdG9rZW5cIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJkcm9wYm94XCIsXG4gICAgbmFtZTogXCJEcm9wYm94XCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTDogYXN5bmMgKHtcbiAgICAgIHN0YXRlLFxuICAgICAgc2NvcGVzLFxuICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgcmVkaXJlY3RVUklcbiAgICB9KSA9PiB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJhY2NvdW50X2luZm8ucmVhZFwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgY29uc3QgYWRkaXRpb25hbFBhcmFtcyA9IHt9O1xuICAgICAgaWYgKG9wdGlvbnMuYWNjZXNzVHlwZSkge1xuICAgICAgICBhZGRpdGlvbmFsUGFyYW1zLnRva2VuX2FjY2Vzc190eXBlID0gb3B0aW9ucy5hY2Nlc3NUeXBlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIGF3YWl0IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJkcm9wYm94XCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL3d3dy5kcm9wYm94LmNvbS9vYXV0aDIvYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIGFkZGl0aW9uYWxQYXJhbXNcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gYXdhaXQgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vYXBpLmRyb3Bib3guY29tL29hdXRoMi90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2FwaS5kcm9wYm94YXBpLmNvbS8yL3VzZXJzL2dldF9jdXJyZW50X2FjY291bnRcIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuYWNjb3VudF9pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLm5hbWU/LmRpc3BsYXlfbmFtZSxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBwcm9maWxlLmVtYWlsX3ZlcmlmaWVkIHx8IGZhbHNlLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLnByb2ZpbGVfcGhvdG9fdXJsLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IGxpbmVhciA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IHRva2VuRW5kcG9pbnQgPSBcImh0dHBzOi8vYXBpLmxpbmVhci5hcHAvb2F1dGgvdG9rZW5cIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJsaW5lYXJcIixcbiAgICBuYW1lOiBcIkxpbmVhclwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCBsb2dpbkhpbnQsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcInJlYWRcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwibGluZWFyXCIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIGF1dGhvcml6YXRpb25FbmRwb2ludDogXCJodHRwczovL2xpbmVhci5hcHAvb2F1dGgvYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBsb2dpbkhpbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vYXBpLmxpbmVhci5hcHAvZ3JhcGhxbFwiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfSxcbiAgICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgICBxdWVyeTogYFxuXHRcdFx0XHRcdFx0XHRxdWVyeSB7XG5cdFx0XHRcdFx0XHRcdFx0dmlld2VyIHtcblx0XHRcdFx0XHRcdFx0XHRcdGlkXG5cdFx0XHRcdFx0XHRcdFx0XHRuYW1lXG5cdFx0XHRcdFx0XHRcdFx0XHRlbWFpbFxuXHRcdFx0XHRcdFx0XHRcdFx0YXZhdGFyVXJsXG5cdFx0XHRcdFx0XHRcdFx0XHRhY3RpdmVcblx0XHRcdFx0XHRcdFx0XHRcdGNyZWF0ZWRBdFxuXHRcdFx0XHRcdFx0XHRcdFx0dXBkYXRlZEF0XG5cdFx0XHRcdFx0XHRcdFx0fVxuXHRcdFx0XHRcdFx0XHR9XG5cdFx0XHRcdFx0XHRgXG4gICAgICAgICAgfSlcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvciB8fCAhcHJvZmlsZT8uZGF0YT8udmlld2VyKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlckRhdGEgPSBwcm9maWxlLmRhdGEudmlld2VyO1xuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHVzZXJEYXRhKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5kYXRhLnZpZXdlci5pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLmRhdGEudmlld2VyLm5hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZGF0YS52aWV3ZXIuZW1haWwsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUuZGF0YS52aWV3ZXIuYXZhdGFyVXJsLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHRydWUsXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiB1c2VyRGF0YVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IGxpbmtlZGluID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgYXV0aG9yaXphdGlvbkVuZHBvaW50ID0gXCJodHRwczovL3d3dy5saW5rZWRpbi5jb20vb2F1dGgvdjIvYXV0aG9yaXphdGlvblwiO1xuICBjb25zdCB0b2tlbkVuZHBvaW50ID0gXCJodHRwczovL3d3dy5saW5rZWRpbi5jb20vb2F1dGgvdjIvYWNjZXNzVG9rZW5cIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJsaW5rZWRpblwiLFxuICAgIG5hbWU6IFwiTGlua2VkaW5cIixcbiAgICBjcmVhdGVBdXRob3JpemF0aW9uVVJMOiBhc3luYyAoe1xuICAgICAgc3RhdGUsXG4gICAgICBzY29wZXMsXG4gICAgICByZWRpcmVjdFVSSSxcbiAgICAgIGxvZ2luSGludFxuICAgIH0pID0+IHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcInByb2ZpbGVcIiwgXCJlbWFpbFwiLCBcIm9wZW5pZFwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgcmV0dXJuIGF3YWl0IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJsaW5rZWRpblwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIGxvZ2luSGludCxcbiAgICAgICAgcmVkaXJlY3RVUklcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIGF3YWl0IHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vYXBpLmxpbmtlZGluLmNvbS92Mi91c2VyaW5mb1wiLFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgaWYgKGVycm9yKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLnN1YixcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLm5hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUuZW1haWwsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogcHJvZmlsZS5lbWFpbF92ZXJpZmllZCB8fCBmYWxzZSxcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5waWN0dXJlLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IGNsZWFuRG91YmxlU2xhc2hlcyA9IChpbnB1dCA9IFwiXCIpID0+IHtcbiAgcmV0dXJuIGlucHV0LnNwbGl0KFwiOi8vXCIpLm1hcCgoc3RyKSA9PiBzdHIucmVwbGFjZSgvXFwvezIsfS9nLCBcIi9cIikpLmpvaW4oXCI6Ly9cIik7XG59O1xuY29uc3QgaXNzdWVyVG9FbmRwb2ludHMgPSAoaXNzdWVyKSA9PiB7XG4gIGxldCBiYXNlVXJsID0gaXNzdWVyIHx8IFwiaHR0cHM6Ly9naXRsYWIuY29tXCI7XG4gIHJldHVybiB7XG4gICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBjbGVhbkRvdWJsZVNsYXNoZXMoYCR7YmFzZVVybH0vb2F1dGgvYXV0aG9yaXplYCksXG4gICAgdG9rZW5FbmRwb2ludDogY2xlYW5Eb3VibGVTbGFzaGVzKGAke2Jhc2VVcmx9L29hdXRoL3Rva2VuYCksXG4gICAgdXNlcmluZm9FbmRwb2ludDogY2xlYW5Eb3VibGVTbGFzaGVzKGAke2Jhc2VVcmx9L2FwaS92NC91c2VyYClcbiAgfTtcbn07XG5jb25zdCBnaXRsYWIgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCB7IGF1dGhvcml6YXRpb25FbmRwb2ludCwgdG9rZW5FbmRwb2ludCwgdXNlcmluZm9FbmRwb2ludCB9ID0gaXNzdWVyVG9FbmRwb2ludHMob3B0aW9ucy5pc3N1ZXIpO1xuICBjb25zdCBpc3N1ZXJJZCA9IFwiZ2l0bGFiXCI7XG4gIGNvbnN0IGlzc3Vlck5hbWUgPSBcIkdpdGxhYlwiO1xuICByZXR1cm4ge1xuICAgIGlkOiBpc3N1ZXJJZCxcbiAgICBuYW1lOiBpc3N1ZXJOYW1lLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkw6IGFzeW5jICh7XG4gICAgICBzdGF0ZSxcbiAgICAgIHNjb3BlcyxcbiAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgIGxvZ2luSGludCxcbiAgICAgIHJlZGlyZWN0VVJJXG4gICAgfSkgPT4ge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1wicmVhZF91c2VyXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gYXdhaXQgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBpc3N1ZXJJZCxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50LFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgY29kZVZlcmlmaWVyLFxuICAgICAgICBsb2dpbkhpbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkksIGNvZGVWZXJpZmllciB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudEtleTogb3B0aW9ucy5jbGllbnRLZXksXG4gICAgICAgICAgY2xpZW50U2VjcmV0OiBvcHRpb25zLmNsaWVudFNlY3JldFxuICAgICAgICB9LFxuICAgICAgICB0b2tlbkVuZHBvaW50OiBcImh0dHBzOi8vZ2l0bGFiLmNvbS9vYXV0aC90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgdXNlcmluZm9FbmRwb2ludCxcbiAgICAgICAgeyBoZWFkZXJzOiB7IGF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gIH0gfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvciB8fCBwcm9maWxlLnN0YXRlICE9PSBcImFjdGl2ZVwiIHx8IHByb2ZpbGUubG9ja2VkKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlck1hcCA9IGF3YWl0IG9wdGlvbnMubWFwUHJvZmlsZVRvVXNlcj8uKHByb2ZpbGUpO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjoge1xuICAgICAgICAgIGlkOiBwcm9maWxlLmlkLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUubmFtZSA/PyBwcm9maWxlLnVzZXJuYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLmVtYWlsLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLmF2YXRhcl91cmwsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZSxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCB0aWt0b2sgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcInRpa3Rva1wiLFxuICAgIG5hbWU6IFwiVGlrVG9rXCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcInVzZXIuaW5mby5wcm9maWxlXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gbmV3IFVSTChcbiAgICAgICAgYGh0dHBzOi8vd3d3LnRpa3Rvay5jb20vdjIvYXV0aC9hdXRob3JpemU/c2NvcGU9JHtfc2NvcGVzLmpvaW4oXG4gICAgICAgICAgXCIsXCJcbiAgICAgICAgKX0mcmVzcG9uc2VfdHlwZT1jb2RlJmNsaWVudF9rZXk9JHtvcHRpb25zLmNsaWVudEtleX0mY2xpZW50X3NlY3JldD0ke29wdGlvbnMuY2xpZW50U2VjcmV0fSZyZWRpcmVjdF91cmk9JHtlbmNvZGVVUklDb21wb25lbnQoXG4gICAgICAgICAgb3B0aW9ucy5yZWRpcmVjdFVSSSB8fCByZWRpcmVjdFVSSVxuICAgICAgICApfSZzdGF0ZT0ke3N0YXRlfWBcbiAgICAgICk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJOiBvcHRpb25zLnJlZGlyZWN0VVJJIHx8IHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9vcGVuLnRpa3Rva2FwaXMuY29tL3YyL29hdXRoL3Rva2VuL1wiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9vcGVuLnRpa3Rva2FwaXMuY29tL3YyL29hdXRoL3Rva2VuL1wiLFxuICAgICAgICBhdXRoZW50aWNhdGlvbjogXCJwb3N0XCIsXG4gICAgICAgIGV4dHJhUGFyYW1zOiB7XG4gICAgICAgICAgY2xpZW50X2tleTogb3B0aW9ucy5jbGllbnRLZXlcbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgZmllbGRzID0gW1xuICAgICAgICBcIm9wZW5faWRcIixcbiAgICAgICAgXCJhdmF0YXJfbGFyZ2VfdXJsXCIsXG4gICAgICAgIFwiZGlzcGxheV9uYW1lXCIsXG4gICAgICAgIFwidXNlcm5hbWVcIlxuICAgICAgXTtcbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBgaHR0cHM6Ly9vcGVuLnRpa3Rva2FwaXMuY29tL3YyL3VzZXIvaW5mby8/ZmllbGRzPSR7ZmllbGRzLmpvaW4oXCIsXCIpfWAsXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBhdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5kYXRhLnVzZXIuZW1haWwgfHwgcHJvZmlsZS5kYXRhLnVzZXIudXNlcm5hbWUsXG4gICAgICAgICAgaWQ6IHByb2ZpbGUuZGF0YS51c2VyLm9wZW5faWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5kYXRhLnVzZXIuZGlzcGxheV9uYW1lIHx8IHByb2ZpbGUuZGF0YS51c2VyLnVzZXJuYW1lLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLmRhdGEudXNlci5hdmF0YXJfbGFyZ2VfdXJsLFxuICAgICAgICAgIC8qKiBAbm90ZSBUaWt0b2sgZG9lcyBub3QgcHJvdmlkZSBlbWFpbFZlcmlmaWVkIG9yIGV2ZW4gZW1haWwqL1xuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHByb2ZpbGUuZGF0YS51c2VyLmVtYWlsID8gdHJ1ZSA6IGZhbHNlXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCByZWRkaXQgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcInJlZGRpdFwiLFxuICAgIG5hbWU6IFwiUmVkZGl0XCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcImlkZW50aXR5XCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcInJlZGRpdFwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly93d3cucmVkZGl0LmNvbS9hcGkvdjEvYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBkdXJhdGlvbjogb3B0aW9ucy5kdXJhdGlvblxuICAgICAgfSk7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICBjb25zdCBib2R5ID0gbmV3IFVSTFNlYXJjaFBhcmFtcyh7XG4gICAgICAgIGdyYW50X3R5cGU6IFwiYXV0aG9yaXphdGlvbl9jb2RlXCIsXG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0X3VyaTogb3B0aW9ucy5yZWRpcmVjdFVSSSB8fCByZWRpcmVjdFVSSVxuICAgICAgfSk7XG4gICAgICBjb25zdCBoZWFkZXJzID0ge1xuICAgICAgICBcImNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiLFxuICAgICAgICBhY2NlcHQ6IFwidGV4dC9wbGFpblwiLFxuICAgICAgICBcInVzZXItYWdlbnRcIjogXCJiZXR0ZXItYXV0aFwiLFxuICAgICAgICBBdXRob3JpemF0aW9uOiBgQmFzaWMgJHtiYXNlNjQuZW5jb2RlKFxuICAgICAgICAgIGAke29wdGlvbnMuY2xpZW50SWR9OiR7b3B0aW9ucy5jbGllbnRTZWNyZXR9YFxuICAgICAgICApfWBcbiAgICAgIH07XG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL3d3dy5yZWRkaXQuY29tL2FwaS92MS9hY2Nlc3NfdG9rZW5cIixcbiAgICAgICAge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgaGVhZGVycyxcbiAgICAgICAgICBib2R5OiBib2R5LnRvU3RyaW5nKClcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICB0aHJvdyBlcnJvcjtcbiAgICAgIH1cbiAgICAgIHJldHVybiBnZXRPQXV0aDJUb2tlbnMoZGF0YSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIGF1dGhlbnRpY2F0aW9uOiBcImJhc2ljXCIsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly93d3cucmVkZGl0LmNvbS9hcGkvdjEvYWNjZXNzX3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vb2F1dGgucmVkZGl0LmNvbS9hcGkvdjEvbWVcIixcbiAgICAgICAge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIEF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gLFxuICAgICAgICAgICAgXCJVc2VyLUFnZW50XCI6IFwiYmV0dGVyLWF1dGhcIlxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS5pZCxcbiAgICAgICAgICBuYW1lOiBwcm9maWxlLm5hbWUsXG4gICAgICAgICAgZW1haWw6IHByb2ZpbGUub2F1dGhfY2xpZW50X2lkLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHByb2ZpbGUuaGFzX3ZlcmlmaWVkX2VtYWlsLFxuICAgICAgICAgIGltYWdlOiBwcm9maWxlLmljb25faW1nPy5zcGxpdChcIj9cIilbMF0sXG4gICAgICAgICAgLi4udXNlck1hcFxuICAgICAgICB9LFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3Qgcm9ibG94ID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJyb2Jsb3hcIixcbiAgICBuYW1lOiBcIlJvYmxveFwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJvcGVuaWRcIiwgXCJwcm9maWxlXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gbmV3IFVSTChcbiAgICAgICAgYGh0dHBzOi8vYXBpcy5yb2Jsb3guY29tL29hdXRoL3YxL2F1dGhvcml6ZT9zY29wZT0ke19zY29wZXMuam9pbihcbiAgICAgICAgICBcIitcIlxuICAgICAgICApfSZyZXNwb25zZV90eXBlPWNvZGUmY2xpZW50X2lkPSR7b3B0aW9ucy5jbGllbnRJZH0mcmVkaXJlY3RfdXJpPSR7ZW5jb2RlVVJJQ29tcG9uZW50KFxuICAgICAgICAgIG9wdGlvbnMucmVkaXJlY3RVUkkgfHwgcmVkaXJlY3RVUklcbiAgICAgICAgKX0mc3RhdGU9JHtzdGF0ZX0mcHJvbXB0PSR7b3B0aW9ucy5wcm9tcHQgfHwgXCJzZWxlY3RfYWNjb3VudCBjb25zZW50XCJ9YFxuICAgICAgKTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgcmVkaXJlY3RVUkk6IG9wdGlvbnMucmVkaXJlY3RVUkkgfHwgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9hcGlzLnJvYmxveC5jb20vb2F1dGgvdjEvdG9rZW5cIixcbiAgICAgICAgYXV0aGVudGljYXRpb246IFwicG9zdFwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2FwaXMucm9ibG94LmNvbS9vYXV0aC92MS90b2tlblwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2FwaXMucm9ibG94LmNvbS9vYXV0aC92MS91c2VyaW5mb1wiLFxuICAgICAgICB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuc3ViLFxuICAgICAgICAgIG5hbWU6IHByb2ZpbGUubmlja25hbWUgfHwgcHJvZmlsZS5wcmVmZXJyZWRfdXNlcm5hbWUgfHwgXCJcIixcbiAgICAgICAgICBpbWFnZTogcHJvZmlsZS5waWN0dXJlLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLnByZWZlcnJlZF91c2VybmFtZSB8fCBudWxsLFxuICAgICAgICAgIC8vIFJvYmxveCBkb2VzIG5vdCBwcm92aWRlIGVtYWlsXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogdHJ1ZSxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHtcbiAgICAgICAgICAuLi5wcm9maWxlXG4gICAgICAgIH1cbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCBzYWxlc2ZvcmNlID0gKG9wdGlvbnMpID0+IHtcbiAgY29uc3QgZW52aXJvbm1lbnQgPSBvcHRpb25zLmVudmlyb25tZW50ID8/IFwicHJvZHVjdGlvblwiO1xuICBjb25zdCBpc1NhbmRib3ggPSBlbnZpcm9ubWVudCA9PT0gXCJzYW5kYm94XCI7XG4gIGNvbnN0IGF1dGhvcml6YXRpb25FbmRwb2ludCA9IG9wdGlvbnMubG9naW5VcmwgPyBgaHR0cHM6Ly8ke29wdGlvbnMubG9naW5Vcmx9L3NlcnZpY2VzL29hdXRoMi9hdXRob3JpemVgIDogaXNTYW5kYm94ID8gXCJodHRwczovL3Rlc3Quc2FsZXNmb3JjZS5jb20vc2VydmljZXMvb2F1dGgyL2F1dGhvcml6ZVwiIDogXCJodHRwczovL2xvZ2luLnNhbGVzZm9yY2UuY29tL3NlcnZpY2VzL29hdXRoMi9hdXRob3JpemVcIjtcbiAgY29uc3QgdG9rZW5FbmRwb2ludCA9IG9wdGlvbnMubG9naW5VcmwgPyBgaHR0cHM6Ly8ke29wdGlvbnMubG9naW5Vcmx9L3NlcnZpY2VzL29hdXRoMi90b2tlbmAgOiBpc1NhbmRib3ggPyBcImh0dHBzOi8vdGVzdC5zYWxlc2ZvcmNlLmNvbS9zZXJ2aWNlcy9vYXV0aDIvdG9rZW5cIiA6IFwiaHR0cHM6Ly9sb2dpbi5zYWxlc2ZvcmNlLmNvbS9zZXJ2aWNlcy9vYXV0aDIvdG9rZW5cIjtcbiAgY29uc3QgdXNlckluZm9FbmRwb2ludCA9IG9wdGlvbnMubG9naW5VcmwgPyBgaHR0cHM6Ly8ke29wdGlvbnMubG9naW5Vcmx9L3NlcnZpY2VzL29hdXRoMi91c2VyaW5mb2AgOiBpc1NhbmRib3ggPyBcImh0dHBzOi8vdGVzdC5zYWxlc2ZvcmNlLmNvbS9zZXJ2aWNlcy9vYXV0aDIvdXNlcmluZm9cIiA6IFwiaHR0cHM6Ly9sb2dpbi5zYWxlc2ZvcmNlLmNvbS9zZXJ2aWNlcy9vYXV0aDIvdXNlcmluZm9cIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJzYWxlc2ZvcmNlXCIsXG4gICAgbmFtZTogXCJTYWxlc2ZvcmNlXCIsXG4gICAgYXN5bmMgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIGNvZGVWZXJpZmllciwgcmVkaXJlY3RVUkkgfSkge1xuICAgICAgaWYgKCFvcHRpb25zLmNsaWVudElkIHx8ICFvcHRpb25zLmNsaWVudFNlY3JldCkge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXG4gICAgICAgICAgXCJDbGllbnQgSWQgYW5kIENsaWVudCBTZWNyZXQgYXJlIHJlcXVpcmVkIGZvciBTYWxlc2ZvcmNlLiBNYWtlIHN1cmUgdG8gcHJvdmlkZSB0aGVtIGluIHRoZSBvcHRpb25zLlwiXG4gICAgICAgICk7XG4gICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJDTElFTlRfSURfQU5EX1NFQ1JFVF9SRVFVSVJFRFwiKTtcbiAgICAgIH1cbiAgICAgIGlmICghY29kZVZlcmlmaWVyKSB7XG4gICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJjb2RlVmVyaWZpZXIgaXMgcmVxdWlyZWQgZm9yIFNhbGVzZm9yY2VcIik7XG4gICAgICB9XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJvcGVuaWRcIiwgXCJlbWFpbFwiLCBcInByb2ZpbGVcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwic2FsZXNmb3JjZVwiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkk6IG9wdGlvbnMucmVkaXJlY3RVUkkgfHwgcmVkaXJlY3RVUklcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkk6IG9wdGlvbnMucmVkaXJlY3RVUkkgfHwgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgdHJ5IHtcbiAgICAgICAgY29uc3QgeyBkYXRhOiB1c2VyIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgICB1c2VySW5mb0VuZHBvaW50LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIGlmICghdXNlcikge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBmZXRjaCB1c2VyIGluZm8gZnJvbSBTYWxlc2ZvcmNlXCIpO1xuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lih1c2VyKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICBpZDogdXNlci51c2VyX2lkLFxuICAgICAgICAgICAgbmFtZTogdXNlci5uYW1lLFxuICAgICAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsXG4gICAgICAgICAgICBpbWFnZTogdXNlci5waG90b3M/LnBpY3R1cmUgfHwgdXNlci5waG90b3M/LnRodW1ibmFpbCxcbiAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVzZXIuZW1haWxfdmVyaWZpZWQgPz8gZmFsc2UsXG4gICAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgICAgfSxcbiAgICAgICAgICBkYXRhOiB1c2VyXG4gICAgICAgIH07XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gZmV0Y2ggdXNlciBpbmZvIGZyb20gU2FsZXNmb3JjZTpcIiwgZXJyb3IpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IHZrID0gKG9wdGlvbnMpID0+IHtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJ2a1wiLFxuICAgIG5hbWU6IFwiVktcIixcbiAgICBhc3luYyBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHsgc3RhdGUsIHNjb3BlcywgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJlbWFpbFwiLCBcInBob25lXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICBjb25zdCBhdXRob3JpemF0aW9uRW5kcG9pbnQgPSBcImh0dHBzOi8vaWQudmsuY29tL2F1dGhvcml6ZVwiO1xuICAgICAgcmV0dXJuIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJ2a1wiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBjb2RlVmVyaWZpZXJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHtcbiAgICAgIGNvZGUsXG4gICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICByZWRpcmVjdFVSSSxcbiAgICAgIGRldmljZUlkXG4gICAgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJOiBvcHRpb25zLnJlZGlyZWN0VVJJIHx8IHJlZGlyZWN0VVJJLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBkZXZpY2VJZCxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2lkLnZrLmNvbS9vYXV0aDIvYXV0aFwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gPyBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA6IGFzeW5jIChyZWZyZXNoVG9rZW4pID0+IHtcbiAgICAgIHJldHVybiByZWZyZXNoQWNjZXNzVG9rZW4oe1xuICAgICAgICByZWZyZXNoVG9rZW4sXG4gICAgICAgIG9wdGlvbnM6IHtcbiAgICAgICAgICBjbGllbnRJZDogb3B0aW9ucy5jbGllbnRJZCxcbiAgICAgICAgICBjbGllbnRLZXk6IG9wdGlvbnMuY2xpZW50S2V5LFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL2lkLnZrLmNvbS9vYXV0aDIvYXV0aFwiXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKGRhdGEpIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKGRhdGEpO1xuICAgICAgfVxuICAgICAgaWYgKCFkYXRhLmFjY2Vzc1Rva2VuKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgZm9ybUJvZHkgPSBuZXcgVVJMU2VhcmNoUGFyYW1zKHtcbiAgICAgICAgYWNjZXNzX3Rva2VuOiBkYXRhLmFjY2Vzc1Rva2VuLFxuICAgICAgICBjbGllbnRfaWQ6IG9wdGlvbnMuY2xpZW50SWRcbiAgICAgIH0pLnRvU3RyaW5nKCk7XG4gICAgICBjb25zdCB7IGRhdGE6IHByb2ZpbGUsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgXCJodHRwczovL2lkLnZrLmNvbS9vYXV0aDIvdXNlcl9pbmZvXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkXCJcbiAgICAgICAgICB9LFxuICAgICAgICAgIGJvZHk6IGZvcm1Cb2R5XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBpZiAoIXByb2ZpbGUudXNlci5lbWFpbCkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZDogcHJvZmlsZS51c2VyLnVzZXJfaWQsXG4gICAgICAgICAgZmlyc3RfbmFtZTogcHJvZmlsZS51c2VyLmZpcnN0X25hbWUsXG4gICAgICAgICAgbGFzdF9uYW1lOiBwcm9maWxlLnVzZXIubGFzdF9uYW1lLFxuICAgICAgICAgIGVtYWlsOiBwcm9maWxlLnVzZXIuZW1haWwsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUudXNlci5hdmF0YXIsXG4gICAgICAgICAgLyoqIEBub3RlIFZLIGRvZXMgbm90IHByb3ZpZGUgZW1haWxWZXJpZmllZCovXG4gICAgICAgICAgZW1haWxWZXJpZmllZDogISFwcm9maWxlLnVzZXIuZW1haWwsXG4gICAgICAgICAgYmlydGhkYXk6IHByb2ZpbGUudXNlci5iaXJ0aGRheSxcbiAgICAgICAgICBzZXg6IHByb2ZpbGUudXNlci5zZXgsXG4gICAgICAgICAgbmFtZTogYCR7cHJvZmlsZS51c2VyLmZpcnN0X25hbWV9ICR7cHJvZmlsZS51c2VyLmxhc3RfbmFtZX1gLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YTogcHJvZmlsZVxuICAgICAgfTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn07XG5cbmNvbnN0IHpvb20gPSAodXNlck9wdGlvbnMpID0+IHtcbiAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICBwa2NlOiB0cnVlLFxuICAgIC4uLnVzZXJPcHRpb25zXG4gIH07XG4gIHJldHVybiB7XG4gICAgaWQ6IFwiem9vbVwiLFxuICAgIG5hbWU6IFwiWm9vbVwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkw6IGFzeW5jICh7IHN0YXRlLCByZWRpcmVjdFVSSSwgY29kZVZlcmlmaWVyIH0pID0+IHtcbiAgICAgIGNvbnN0IHBhcmFtcyA9IG5ldyBVUkxTZWFyY2hQYXJhbXMoe1xuICAgICAgICByZXNwb25zZV90eXBlOiBcImNvZGVcIixcbiAgICAgICAgcmVkaXJlY3RfdXJpOiBvcHRpb25zLnJlZGlyZWN0VVJJID8gb3B0aW9ucy5yZWRpcmVjdFVSSSA6IHJlZGlyZWN0VVJJLFxuICAgICAgICBjbGllbnRfaWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgIHN0YXRlXG4gICAgICB9KTtcbiAgICAgIGlmIChvcHRpb25zLnBrY2UpIHtcbiAgICAgICAgY29uc3QgY29kZUNoYWxsZW5nZSA9IGF3YWl0IGdlbmVyYXRlQ29kZUNoYWxsZW5nZShjb2RlVmVyaWZpZXIpO1xuICAgICAgICBwYXJhbXMuc2V0KFwiY29kZV9jaGFsbGVuZ2VfbWV0aG9kXCIsIFwiUzI1NlwiKTtcbiAgICAgICAgcGFyYW1zLnNldChcImNvZGVfY2hhbGxlbmdlXCIsIGNvZGVDaGFsbGVuZ2UpO1xuICAgICAgfVxuICAgICAgY29uc3QgdXJsID0gbmV3IFVSTChcImh0dHBzOi8vem9vbS51cy9vYXV0aC9hdXRob3JpemVcIik7XG4gICAgICB1cmwuc2VhcmNoID0gcGFyYW1zLnRvU3RyaW5nKCk7XG4gICAgICByZXR1cm4gdXJsO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkksIGNvZGVWZXJpZmllciB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIHJlZGlyZWN0VVJJOiBvcHRpb25zLnJlZGlyZWN0VVJJIHx8IHJlZGlyZWN0VVJJLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly96b29tLnVzL29hdXRoL3Rva2VuXCIsXG4gICAgICAgIGF1dGhlbnRpY2F0aW9uOiBcInBvc3RcIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9hcGkuem9vbS51cy92Mi91c2Vycy9tZVwiLFxuICAgICAgICB7XG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgYXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWBcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IpIHtcbiAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IHByb2ZpbGUuaWQsXG4gICAgICAgICAgbmFtZTogcHJvZmlsZS5kaXNwbGF5X25hbWUsXG4gICAgICAgICAgaW1hZ2U6IHByb2ZpbGUucGljX3VybCxcbiAgICAgICAgICBlbWFpbDogcHJvZmlsZS5lbWFpbCxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBCb29sZWFuKHByb2ZpbGUudmVyaWZpZWQpLFxuICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgfSxcbiAgICAgICAgZGF0YToge1xuICAgICAgICAgIC4uLnByb2ZpbGVcbiAgICAgICAgfVxuICAgICAgfTtcbiAgICB9XG4gIH07XG59O1xuXG5jb25zdCBrYWthbyA9IChvcHRpb25zKSA9PiB7XG4gIHJldHVybiB7XG4gICAgaWQ6IFwia2FrYW9cIixcbiAgICBuYW1lOiBcIktha2FvXCIsXG4gICAgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7IHN0YXRlLCBzY29wZXMsIHJlZGlyZWN0VVJJIH0pIHtcbiAgICAgIGNvbnN0IF9zY29wZXMgPSBvcHRpb25zLmRpc2FibGVEZWZhdWx0U2NvcGUgPyBbXSA6IFtcImFjY291bnRfZW1haWxcIiwgXCJwcm9maWxlX2ltYWdlXCIsIFwicHJvZmlsZV9uaWNrbmFtZVwiXTtcbiAgICAgIG9wdGlvbnMuc2NvcGUgJiYgX3Njb3Blcy5wdXNoKC4uLm9wdGlvbnMuc2NvcGUpO1xuICAgICAgc2NvcGVzICYmIF9zY29wZXMucHVzaCguLi5zY29wZXMpO1xuICAgICAgcmV0dXJuIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJrYWthb1wiLFxuICAgICAgICBvcHRpb25zLFxuICAgICAgICBhdXRob3JpemF0aW9uRW5kcG9pbnQ6IFwiaHR0cHM6Ly9rYXV0aC5rYWthby5jb20vb2F1dGgvYXV0aG9yaXplXCIsXG4gICAgICAgIHNjb3BlczogX3Njb3BlcyxcbiAgICAgICAgc3RhdGUsXG4gICAgICAgIHJlZGlyZWN0VVJJXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGU6IGFzeW5jICh7IGNvZGUsIHJlZGlyZWN0VVJJIH0pID0+IHtcbiAgICAgIHJldHVybiB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlKHtcbiAgICAgICAgY29kZSxcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9rYXV0aC5rYWthby5jb20vb2F1dGgvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9rYXV0aC5rYWthby5jb20vb2F1dGgvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyBkYXRhOiBwcm9maWxlLCBlcnJvciB9ID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgIFwiaHR0cHM6Ly9rYXBpLmtha2FvLmNvbS92Mi91c2VyL21lXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvciB8fCAhcHJvZmlsZSkge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIGNvbnN0IGFjY291bnQgPSBwcm9maWxlLmtha2FvX2FjY291bnQgfHwge307XG4gICAgICBjb25zdCBrYWthb1Byb2ZpbGUgPSBhY2NvdW50LnByb2ZpbGUgfHwge307XG4gICAgICBjb25zdCB1c2VyID0ge1xuICAgICAgICBpZDogU3RyaW5nKHByb2ZpbGUuaWQpLFxuICAgICAgICBuYW1lOiBrYWthb1Byb2ZpbGUubmlja25hbWUgfHwgYWNjb3VudC5uYW1lIHx8IHZvaWQgMCxcbiAgICAgICAgZW1haWw6IGFjY291bnQuZW1haWwsXG4gICAgICAgIGltYWdlOiBrYWthb1Byb2ZpbGUucHJvZmlsZV9pbWFnZV91cmwgfHwga2FrYW9Qcm9maWxlLnRodW1ibmFpbF9pbWFnZV91cmwsXG4gICAgICAgIGVtYWlsVmVyaWZpZWQ6ICEhYWNjb3VudC5pc19lbWFpbF92YWxpZCAmJiAhIWFjY291bnQuaXNfZW1haWxfdmVyaWZpZWQsXG4gICAgICAgIC4uLnVzZXJNYXBcbiAgICAgIH07XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyLFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgbmF2ZXIgPSAob3B0aW9ucykgPT4ge1xuICByZXR1cm4ge1xuICAgIGlkOiBcIm5hdmVyXCIsXG4gICAgbmFtZTogXCJOYXZlclwiLFxuICAgIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgc2NvcGVzLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBjb25zdCBfc2NvcGVzID0gb3B0aW9ucy5kaXNhYmxlRGVmYXVsdFNjb3BlID8gW10gOiBbXCJwcm9maWxlXCIsIFwiZW1haWxcIl07XG4gICAgICBvcHRpb25zLnNjb3BlICYmIF9zY29wZXMucHVzaCguLi5vcHRpb25zLnNjb3BlKTtcbiAgICAgIHNjb3BlcyAmJiBfc2NvcGVzLnB1c2goLi4uc2NvcGVzKTtcbiAgICAgIHJldHVybiBjcmVhdGVBdXRob3JpemF0aW9uVVJMKHtcbiAgICAgICAgaWQ6IFwibmF2ZXJcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50OiBcImh0dHBzOi8vbmlkLm5hdmVyLmNvbS9vYXV0aDIuMC9hdXRob3JpemVcIixcbiAgICAgICAgc2NvcGVzOiBfc2NvcGVzLFxuICAgICAgICBzdGF0ZSxcbiAgICAgICAgcmVkaXJlY3RVUklcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgcmVkaXJlY3RVUkkgfSkgPT4ge1xuICAgICAgcmV0dXJuIHZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICByZWRpcmVjdFVSSSxcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgdG9rZW5FbmRwb2ludDogXCJodHRwczovL25pZC5uYXZlci5jb20vb2F1dGgyLjAvdG9rZW5cIlxuICAgICAgfSk7XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICByZXR1cm4gcmVmcmVzaEFjY2Vzc1Rva2VuKHtcbiAgICAgICAgcmVmcmVzaFRva2VuLFxuICAgICAgICBvcHRpb25zOiB7XG4gICAgICAgICAgY2xpZW50SWQ6IG9wdGlvbnMuY2xpZW50SWQsXG4gICAgICAgICAgY2xpZW50S2V5OiBvcHRpb25zLmNsaWVudEtleSxcbiAgICAgICAgICBjbGllbnRTZWNyZXQ6IG9wdGlvbnMuY2xpZW50U2VjcmV0XG4gICAgICAgIH0sXG4gICAgICAgIHRva2VuRW5kcG9pbnQ6IFwiaHR0cHM6Ly9uaWQubmF2ZXIuY29tL29hdXRoMi4wL3Rva2VuXCJcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgYXN5bmMgZ2V0VXNlckluZm8odG9rZW4pIHtcbiAgICAgIGlmIChvcHRpb25zLmdldFVzZXJJbmZvKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLmdldFVzZXJJbmZvKHRva2VuKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgZGF0YTogcHJvZmlsZSwgZXJyb3IgfSA9IGF3YWl0IGJldHRlckZldGNoKFxuICAgICAgICBcImh0dHBzOi8vb3BlbmFwaS5uYXZlci5jb20vdjEvbmlkL21lXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBBdXRob3JpemF0aW9uOiBgQmVhcmVyICR7dG9rZW4uYWNjZXNzVG9rZW59YFxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGlmIChlcnJvciB8fCAhcHJvZmlsZSB8fCBwcm9maWxlLnJlc3VsdGNvZGUgIT09IFwiMDBcIikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHVzZXJNYXAgPSBhd2FpdCBvcHRpb25zLm1hcFByb2ZpbGVUb1VzZXI/Lihwcm9maWxlKTtcbiAgICAgIGNvbnN0IHJlcyA9IHByb2ZpbGUucmVzcG9uc2UgfHwge307XG4gICAgICBjb25zdCB1c2VyID0ge1xuICAgICAgICBpZDogcmVzLmlkLFxuICAgICAgICBuYW1lOiByZXMubmFtZSB8fCByZXMubmlja25hbWUsXG4gICAgICAgIGVtYWlsOiByZXMuZW1haWwsXG4gICAgICAgIGltYWdlOiByZXMucHJvZmlsZV9pbWFnZSxcbiAgICAgICAgZW1haWxWZXJpZmllZDogZmFsc2UsXG4gICAgICAgIC4uLnVzZXJNYXBcbiAgICAgIH07XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyLFxuICAgICAgICBkYXRhOiBwcm9maWxlXG4gICAgICB9O1xuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3QgbGluZSA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IGF1dGhvcml6YXRpb25FbmRwb2ludCA9IFwiaHR0cHM6Ly9hY2Nlc3MubGluZS5tZS9vYXV0aDIvdjIuMS9hdXRob3JpemVcIjtcbiAgY29uc3QgdG9rZW5FbmRwb2ludCA9IFwiaHR0cHM6Ly9hcGkubGluZS5tZS9vYXV0aDIvdjIuMS90b2tlblwiO1xuICBjb25zdCB1c2VySW5mb0VuZHBvaW50ID0gXCJodHRwczovL2FwaS5saW5lLm1lL29hdXRoMi92Mi4xL3VzZXJpbmZvXCI7XG4gIGNvbnN0IHZlcmlmeUlkVG9rZW5FbmRwb2ludCA9IFwiaHR0cHM6Ly9hcGkubGluZS5tZS9vYXV0aDIvdjIuMS92ZXJpZnlcIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJsaW5lXCIsXG4gICAgbmFtZTogXCJMSU5FXCIsXG4gICAgYXN5bmMgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICBzdGF0ZSxcbiAgICAgIHNjb3BlcyxcbiAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgbG9naW5IaW50XG4gICAgfSkge1xuICAgICAgY29uc3QgX3Njb3BlcyA9IG9wdGlvbnMuZGlzYWJsZURlZmF1bHRTY29wZSA/IFtdIDogW1wib3BlbmlkXCIsIFwicHJvZmlsZVwiLCBcImVtYWlsXCJdO1xuICAgICAgb3B0aW9ucy5zY29wZSAmJiBfc2NvcGVzLnB1c2goLi4ub3B0aW9ucy5zY29wZSk7XG4gICAgICBzY29wZXMgJiYgX3Njb3Blcy5wdXNoKC4uLnNjb3Blcyk7XG4gICAgICByZXR1cm4gYXdhaXQgY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICAgIGlkOiBcImxpbmVcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50LFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBsb2dpbkhpbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZTogYXN5bmMgKHsgY29kZSwgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICByZXR1cm4gdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSh7XG4gICAgICAgIGNvZGUsXG4gICAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgICAgcmVkaXJlY3RVUkksXG4gICAgICAgIG9wdGlvbnMsXG4gICAgICAgIHRva2VuRW5kcG9pbnRcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgcmVmcmVzaEFjY2Vzc1Rva2VuOiBvcHRpb25zLnJlZnJlc2hBY2Nlc3NUb2tlbiA/IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuIDogYXN5bmMgKHJlZnJlc2hUb2tlbikgPT4ge1xuICAgICAgcmV0dXJuIHJlZnJlc2hBY2Nlc3NUb2tlbih7XG4gICAgICAgIHJlZnJlc2hUb2tlbixcbiAgICAgICAgb3B0aW9uczoge1xuICAgICAgICAgIGNsaWVudElkOiBvcHRpb25zLmNsaWVudElkLFxuICAgICAgICAgIGNsaWVudFNlY3JldDogb3B0aW9ucy5jbGllbnRTZWNyZXRcbiAgICAgICAgfSxcbiAgICAgICAgdG9rZW5FbmRwb2ludFxuICAgICAgfSk7XG4gICAgfSxcbiAgICBhc3luYyB2ZXJpZnlJZFRva2VuKHRva2VuLCBub25jZSkge1xuICAgICAgaWYgKG9wdGlvbnMuZGlzYWJsZUlkVG9rZW5TaWduSW4pIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKG9wdGlvbnMudmVyaWZ5SWRUb2tlbikge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy52ZXJpZnlJZFRva2VuKHRva2VuLCBub25jZSk7XG4gICAgICB9XG4gICAgICBjb25zdCBib2R5ID0gbmV3IFVSTFNlYXJjaFBhcmFtcygpO1xuICAgICAgYm9keS5zZXQoXCJpZF90b2tlblwiLCB0b2tlbik7XG4gICAgICBib2R5LnNldChcImNsaWVudF9pZFwiLCBvcHRpb25zLmNsaWVudElkKTtcbiAgICAgIGlmIChub25jZSkgYm9keS5zZXQoXCJub25jZVwiLCBub25jZSk7XG4gICAgICBjb25zdCB7IGRhdGEsIGVycm9yIH0gPSBhd2FpdCBiZXR0ZXJGZXRjaChcbiAgICAgICAgdmVyaWZ5SWRUb2tlbkVuZHBvaW50LFxuICAgICAgICB7XG4gICAgICAgICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgICBcImNvbnRlbnQtdHlwZVwiOiBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiXG4gICAgICAgICAgfSxcbiAgICAgICAgICBib2R5XG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICBpZiAoZXJyb3IgfHwgIWRhdGEpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgaWYgKGRhdGEuYXVkICE9PSBvcHRpb25zLmNsaWVudElkKSByZXR1cm4gZmFsc2U7XG4gICAgICBpZiAobm9uY2UgJiYgZGF0YS5ub25jZSAmJiBkYXRhLm5vbmNlICE9PSBub25jZSkgcmV0dXJuIGZhbHNlO1xuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfSxcbiAgICBhc3luYyBnZXRVc2VySW5mbyh0b2tlbikge1xuICAgICAgaWYgKG9wdGlvbnMuZ2V0VXNlckluZm8pIHtcbiAgICAgICAgcmV0dXJuIG9wdGlvbnMuZ2V0VXNlckluZm8odG9rZW4pO1xuICAgICAgfVxuICAgICAgbGV0IHByb2ZpbGUgPSBudWxsO1xuICAgICAgaWYgKHRva2VuLmlkVG9rZW4pIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBwcm9maWxlID0gZGVjb2RlSnd0KHRva2VuLmlkVG9rZW4pO1xuICAgICAgICB9IGNhdGNoIHtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgaWYgKCFwcm9maWxlKSB7XG4gICAgICAgIGNvbnN0IHsgZGF0YSB9ID0gYXdhaXQgYmV0dGVyRmV0Y2godXNlckluZm9FbmRwb2ludCwge1xuICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgIGF1dGhvcml6YXRpb246IGBCZWFyZXIgJHt0b2tlbi5hY2Nlc3NUb2tlbn1gXG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgICAgcHJvZmlsZSA9IGRhdGEgfHwgbnVsbDtcbiAgICAgIH1cbiAgICAgIGlmICghcHJvZmlsZSkgcmV0dXJuIG51bGw7XG4gICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4ocHJvZmlsZSk7XG4gICAgICBjb25zdCBpZCA9IHByb2ZpbGUuc3ViIHx8IHByb2ZpbGUudXNlcklkO1xuICAgICAgY29uc3QgbmFtZSA9IHByb2ZpbGUubmFtZSB8fCBwcm9maWxlLmRpc3BsYXlOYW1lO1xuICAgICAgY29uc3QgaW1hZ2UgPSBwcm9maWxlLnBpY3R1cmUgfHwgcHJvZmlsZS5waWN0dXJlVXJsIHx8IHZvaWQgMDtcbiAgICAgIGNvbnN0IGVtYWlsID0gcHJvZmlsZS5lbWFpbDtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICBpZCxcbiAgICAgICAgICBuYW1lLFxuICAgICAgICAgIGVtYWlsLFxuICAgICAgICAgIGltYWdlLFxuICAgICAgICAgIC8vIExJTkUgZG9lcyBub3QgZXhwb3NlIGVtYWlsIHZlcmlmaWNhdGlvbiBzdGF0dXMgaW4gSUQgdG9rZW4vdXNlcmluZm9cbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBmYWxzZSxcbiAgICAgICAgICAuLi51c2VyTWFwXG4gICAgICAgIH0sXG4gICAgICAgIGRhdGE6IHByb2ZpbGVcbiAgICAgIH07XG4gICAgfSxcbiAgICBvcHRpb25zXG4gIH07XG59O1xuXG5jb25zdCBwYXlwYWwgPSAob3B0aW9ucykgPT4ge1xuICBjb25zdCBlbnZpcm9ubWVudCA9IG9wdGlvbnMuZW52aXJvbm1lbnQgfHwgXCJzYW5kYm94XCI7XG4gIGNvbnN0IGlzU2FuZGJveCA9IGVudmlyb25tZW50ID09PSBcInNhbmRib3hcIjtcbiAgY29uc3QgYXV0aG9yaXphdGlvbkVuZHBvaW50ID0gaXNTYW5kYm94ID8gXCJodHRwczovL3d3dy5zYW5kYm94LnBheXBhbC5jb20vc2lnbmluL2F1dGhvcml6ZVwiIDogXCJodHRwczovL3d3dy5wYXlwYWwuY29tL3NpZ25pbi9hdXRob3JpemVcIjtcbiAgY29uc3QgdG9rZW5FbmRwb2ludCA9IGlzU2FuZGJveCA/IFwiaHR0cHM6Ly9hcGktbS5zYW5kYm94LnBheXBhbC5jb20vdjEvb2F1dGgyL3Rva2VuXCIgOiBcImh0dHBzOi8vYXBpLW0ucGF5cGFsLmNvbS92MS9vYXV0aDIvdG9rZW5cIjtcbiAgY29uc3QgdXNlckluZm9FbmRwb2ludCA9IGlzU2FuZGJveCA/IFwiaHR0cHM6Ly9hcGktbS5zYW5kYm94LnBheXBhbC5jb20vdjEvaWRlbnRpdHkvb2F1dGgyL3VzZXJpbmZvXCIgOiBcImh0dHBzOi8vYXBpLW0ucGF5cGFsLmNvbS92MS9pZGVudGl0eS9vYXV0aDIvdXNlcmluZm9cIjtcbiAgcmV0dXJuIHtcbiAgICBpZDogXCJwYXlwYWxcIixcbiAgICBuYW1lOiBcIlBheVBhbFwiLFxuICAgIGFzeW5jIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoeyBzdGF0ZSwgY29kZVZlcmlmaWVyLCByZWRpcmVjdFVSSSB9KSB7XG4gICAgICBpZiAoIW9wdGlvbnMuY2xpZW50SWQgfHwgIW9wdGlvbnMuY2xpZW50U2VjcmV0KSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcbiAgICAgICAgICBcIkNsaWVudCBJZCBhbmQgQ2xpZW50IFNlY3JldCBpcyByZXF1aXJlZCBmb3IgUGF5UGFsLiBNYWtlIHN1cmUgdG8gcHJvdmlkZSB0aGVtIGluIHRoZSBvcHRpb25zLlwiXG4gICAgICAgICk7XG4gICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJDTElFTlRfSURfQU5EX1NFQ1JFVF9SRVFVSVJFRFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IF9zY29wZXMgPSBbXTtcbiAgICAgIGNvbnN0IHVybCA9IGF3YWl0IGNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgICBpZDogXCJwYXlwYWxcIixcbiAgICAgICAgb3B0aW9ucyxcbiAgICAgICAgYXV0aG9yaXphdGlvbkVuZHBvaW50LFxuICAgICAgICBzY29wZXM6IF9zY29wZXMsXG4gICAgICAgIHN0YXRlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIHJlZGlyZWN0VVJJLFxuICAgICAgICBwcm9tcHQ6IG9wdGlvbnMucHJvbXB0XG4gICAgICB9KTtcbiAgICAgIHJldHVybiB1cmw7XG4gICAgfSxcbiAgICB2YWxpZGF0ZUF1dGhvcml6YXRpb25Db2RlOiBhc3luYyAoeyBjb2RlLCByZWRpcmVjdFVSSSB9KSA9PiB7XG4gICAgICBjb25zdCBjcmVkZW50aWFscyA9IGJhc2U2NC5lbmNvZGUoXG4gICAgICAgIGAke29wdGlvbnMuY2xpZW50SWR9OiR7b3B0aW9ucy5jbGllbnRTZWNyZXR9YFxuICAgICAgKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYmV0dGVyRmV0Y2godG9rZW5FbmRwb2ludCwge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJhc2ljICR7Y3JlZGVudGlhbHN9YCxcbiAgICAgICAgICAgIEFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgICAgICBcIkFjY2VwdC1MYW5ndWFnZVwiOiBcImVuX1VTXCIsXG4gICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiXG4gICAgICAgICAgfSxcbiAgICAgICAgICBib2R5OiBuZXcgVVJMU2VhcmNoUGFyYW1zKHtcbiAgICAgICAgICAgIGdyYW50X3R5cGU6IFwiYXV0aG9yaXphdGlvbl9jb2RlXCIsXG4gICAgICAgICAgICBjb2RlLFxuICAgICAgICAgICAgcmVkaXJlY3RfdXJpOiByZWRpcmVjdFVSSVxuICAgICAgICAgIH0pLnRvU3RyaW5nKClcbiAgICAgICAgfSk7XG4gICAgICAgIGlmICghcmVzcG9uc2UuZGF0YSkge1xuICAgICAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXCJGQUlMRURfVE9fR0VUX0FDQ0VTU19UT0tFTlwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBkYXRhID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0ge1xuICAgICAgICAgIGFjY2Vzc1Rva2VuOiBkYXRhLmFjY2Vzc190b2tlbixcbiAgICAgICAgICByZWZyZXNoVG9rZW46IGRhdGEucmVmcmVzaF90b2tlbixcbiAgICAgICAgICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDogZGF0YS5leHBpcmVzX2luID8gbmV3IERhdGUoRGF0ZS5ub3coKSArIGRhdGEuZXhwaXJlc19pbiAqIDFlMykgOiB2b2lkIDAsXG4gICAgICAgICAgaWRUb2tlbjogZGF0YS5pZF90b2tlblxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgICAgbG9nZ2VyLmVycm9yKFwiUGF5UGFsIHRva2VuIGV4Y2hhbmdlIGZhaWxlZDpcIiwgZXJyb3IpO1xuICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFwiRkFJTEVEX1RPX0dFVF9BQ0NFU1NfVE9LRU5cIik7XG4gICAgICB9XG4gICAgfSxcbiAgICByZWZyZXNoQWNjZXNzVG9rZW46IG9wdGlvbnMucmVmcmVzaEFjY2Vzc1Rva2VuID8gb3B0aW9ucy5yZWZyZXNoQWNjZXNzVG9rZW4gOiBhc3luYyAocmVmcmVzaFRva2VuKSA9PiB7XG4gICAgICBjb25zdCBjcmVkZW50aWFscyA9IGJhc2U2NC5lbmNvZGUoXG4gICAgICAgIGAke29wdGlvbnMuY2xpZW50SWR9OiR7b3B0aW9ucy5jbGllbnRTZWNyZXR9YFxuICAgICAgKTtcbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYmV0dGVyRmV0Y2godG9rZW5FbmRwb2ludCwge1xuICAgICAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICAgICAgaGVhZGVyczoge1xuICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJhc2ljICR7Y3JlZGVudGlhbHN9YCxcbiAgICAgICAgICAgIEFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICAgICAgICBcIkFjY2VwdC1MYW5ndWFnZVwiOiBcImVuX1VTXCIsXG4gICAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZFwiXG4gICAgICAgICAgfSxcbiAgICAgICAgICBib2R5OiBuZXcgVVJMU2VhcmNoUGFyYW1zKHtcbiAgICAgICAgICAgIGdyYW50X3R5cGU6IFwicmVmcmVzaF90b2tlblwiLFxuICAgICAgICAgICAgcmVmcmVzaF90b2tlbjogcmVmcmVzaFRva2VuXG4gICAgICAgICAgfSkudG9TdHJpbmcoKVxuICAgICAgICB9KTtcbiAgICAgICAgaWYgKCFyZXNwb25zZS5kYXRhKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcIkZBSUxFRF9UT19SRUZSRVNIX0FDQ0VTU19UT0tFTlwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBkYXRhID0gcmVzcG9uc2UuZGF0YTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICBhY2Nlc3NUb2tlbjogZGF0YS5hY2Nlc3NfdG9rZW4sXG4gICAgICAgICAgcmVmcmVzaFRva2VuOiBkYXRhLnJlZnJlc2hfdG9rZW4sXG4gICAgICAgICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IGRhdGEuZXhwaXJlc19pbiA/IG5ldyBEYXRlKERhdGUubm93KCkgKyBkYXRhLmV4cGlyZXNfaW4gKiAxZTMpIDogdm9pZCAwXG4gICAgICAgIH07XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXCJQYXlQYWwgdG9rZW4gcmVmcmVzaCBmYWlsZWQ6XCIsIGVycm9yKTtcbiAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcIkZBSUxFRF9UT19SRUZSRVNIX0FDQ0VTU19UT0tFTlwiKTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGFzeW5jIHZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKSB7XG4gICAgICBpZiAob3B0aW9ucy5kaXNhYmxlSWRUb2tlblNpZ25Jbikge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy52ZXJpZnlJZFRva2VuKSB7XG4gICAgICAgIHJldHVybiBvcHRpb25zLnZlcmlmeUlkVG9rZW4odG9rZW4sIG5vbmNlKTtcbiAgICAgIH1cbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHBheWxvYWQgPSBkZWNvZGVKd3QodG9rZW4pO1xuICAgICAgICByZXR1cm4gISFwYXlsb2FkLnN1YjtcbiAgICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byB2ZXJpZnkgUGF5UGFsIElEIHRva2VuOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgIH1cbiAgICB9LFxuICAgIGFzeW5jIGdldFVzZXJJbmZvKHRva2VuKSB7XG4gICAgICBpZiAob3B0aW9ucy5nZXRVc2VySW5mbykge1xuICAgICAgICByZXR1cm4gb3B0aW9ucy5nZXRVc2VySW5mbyh0b2tlbik7XG4gICAgICB9XG4gICAgICBpZiAoIXRva2VuLmFjY2Vzc1Rva2VuKSB7XG4gICAgICAgIGxvZ2dlci5lcnJvcihcIkFjY2VzcyB0b2tlbiBpcyByZXF1aXJlZCB0byBmZXRjaCBQYXlQYWwgdXNlciBpbmZvXCIpO1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIHRyeSB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgYmV0dGVyRmV0Y2goXG4gICAgICAgICAgYCR7dXNlckluZm9FbmRwb2ludH0/c2NoZW1hPXBheXBhbHYxLjFgLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke3Rva2VuLmFjY2Vzc1Rva2VufWAsXG4gICAgICAgICAgICAgIEFjY2VwdDogXCJhcHBsaWNhdGlvbi9qc29uXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIGlmICghcmVzcG9uc2UuZGF0YSkge1xuICAgICAgICAgIGxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBmZXRjaCB1c2VyIGluZm8gZnJvbSBQYXlQYWxcIik7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgdXNlckluZm8gPSByZXNwb25zZS5kYXRhO1xuICAgICAgICBjb25zdCB1c2VyTWFwID0gYXdhaXQgb3B0aW9ucy5tYXBQcm9maWxlVG9Vc2VyPy4odXNlckluZm8pO1xuICAgICAgICBjb25zdCByZXN1bHQgPSB7XG4gICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgaWQ6IHVzZXJJbmZvLnVzZXJfaWQsXG4gICAgICAgICAgICBuYW1lOiB1c2VySW5mby5uYW1lLFxuICAgICAgICAgICAgZW1haWw6IHVzZXJJbmZvLmVtYWlsLFxuICAgICAgICAgICAgaW1hZ2U6IHVzZXJJbmZvLnBpY3R1cmUsXG4gICAgICAgICAgICBlbWFpbFZlcmlmaWVkOiB1c2VySW5mby5lbWFpbF92ZXJpZmllZCxcbiAgICAgICAgICAgIC4uLnVzZXJNYXBcbiAgICAgICAgICB9LFxuICAgICAgICAgIGRhdGE6IHVzZXJJbmZvXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICBsb2dnZXIuZXJyb3IoXCJGYWlsZWQgdG8gZmV0Y2ggdXNlciBpbmZvIGZyb20gUGF5UGFsOlwiLCBlcnJvcik7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgIH0sXG4gICAgb3B0aW9uc1xuICB9O1xufTtcblxuY29uc3Qgc29jaWFsUHJvdmlkZXJzID0ge1xuICBhcHBsZSxcbiAgYXRsYXNzaWFuLFxuICBjb2duaXRvLFxuICBkaXNjb3JkLFxuICBmYWNlYm9vayxcbiAgZmlnbWEsXG4gIGdpdGh1YixcbiAgbWljcm9zb2Z0LFxuICBnb29nbGUsXG4gIGh1Z2dpbmdmYWNlLFxuICBzbGFjayxcbiAgc3BvdGlmeSxcbiAgdHdpdGNoLFxuICB0d2l0dGVyLFxuICBkcm9wYm94LFxuICBraWNrLFxuICBsaW5lYXIsXG4gIGxpbmtlZGluLFxuICBnaXRsYWIsXG4gIHRpa3RvayxcbiAgcmVkZGl0LFxuICByb2Jsb3gsXG4gIHNhbGVzZm9yY2UsXG4gIHZrLFxuICB6b29tLFxuICBub3Rpb24sXG4gIGtha2FvLFxuICBuYXZlcixcbiAgbGluZSxcbiAgcGF5cGFsXG59O1xuY29uc3Qgc29jaWFsUHJvdmlkZXJMaXN0ID0gT2JqZWN0LmtleXMoc29jaWFsUHJvdmlkZXJzKTtcbmNvbnN0IFNvY2lhbFByb3ZpZGVyTGlzdEVudW0gPSB6LmVudW0oc29jaWFsUHJvdmlkZXJMaXN0KS5vcih6LnN0cmluZygpKTtcblxuY29uc3Qgc2lnbkluU29jaWFsID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9zaWduLWluL3NvY2lhbFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAvKipcbiAgICAgICAqIENhbGxiYWNrIFVSTCB0byByZWRpcmVjdCB0byBhZnRlciB0aGUgdXNlclxuICAgICAgICogaGFzIHNpZ25lZCBpbi5cbiAgICAgICAqL1xuICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkNhbGxiYWNrIFVSTCB0byByZWRpcmVjdCB0byBhZnRlciB0aGUgdXNlciBoYXMgc2lnbmVkIGluXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIGNhbGxiYWNrIHVybCB0byByZWRpcmVjdCBpZiB0aGUgdXNlciBpcyBuZXdseSByZWdpc3RlcmVkLlxuICAgICAgICpcbiAgICAgICAqIHVzZWZ1bCBpZiB5b3UgaGF2ZSBkaWZmZXJlbnQgcm91dGVzIGZvciBleGlzdGluZyB1c2VycyBhbmQgbmV3IHVzZXJzXG4gICAgICAgKi9cbiAgICAgIG5ld1VzZXJDYWxsYmFja1VSTDogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBDYWxsYmFjayB1cmwgdG8gcmVkaXJlY3QgdG8gaWYgYW4gZXJyb3IgaGFwcGVuc1xuICAgICAgICpcbiAgICAgICAqIElmIGl0J3MgaW5pdGlhdGVkIGZyb20gdGhlIGNsaWVudCBzZGsgdGhpcyBkZWZhdWx0cyB0b1xuICAgICAgICogdGhlIGN1cnJlbnQgdXJsLlxuICAgICAgICovXG4gICAgICBlcnJvckNhbGxiYWNrVVJMOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJDYWxsYmFjayBVUkwgdG8gcmVkaXJlY3QgdG8gaWYgYW4gZXJyb3IgaGFwcGVuc1wiXG4gICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBPQXV0aDIgcHJvdmlkZXIgdG8gdXNlYFxuICAgICAgICovXG4gICAgICBwcm92aWRlcjogU29jaWFsUHJvdmlkZXJMaXN0RW51bSxcbiAgICAgIC8qKlxuICAgICAgICogRGlzYWJsZSBhdXRvbWF0aWMgcmVkaXJlY3Rpb24gdG8gdGhlIHByb3ZpZGVyXG4gICAgICAgKlxuICAgICAgICogVGhpcyBpcyB1c2VmdWwgaWYgeW91IHdhbnQgdG8gaGFuZGxlIHRoZSByZWRpcmVjdGlvblxuICAgICAgICogeW91cnNlbGYgbGlrZSBpbiBhIHBvcHVwIG9yIGEgZGlmZmVyZW50IHRhYi5cbiAgICAgICAqL1xuICAgICAgZGlzYWJsZVJlZGlyZWN0OiB6LmJvb2xlYW4oKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiRGlzYWJsZSBhdXRvbWF0aWMgcmVkaXJlY3Rpb24gdG8gdGhlIHByb3ZpZGVyLiBVc2VmdWwgZm9yIGhhbmRsaW5nIHRoZSByZWRpcmVjdGlvbiB5b3Vyc2VsZlwiXG4gICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBJRCB0b2tlbiBmcm9tIHRoZSBwcm92aWRlclxuICAgICAgICpcbiAgICAgICAqIFRoaXMgaXMgdXNlZCB0byBzaWduIGluIHRoZSB1c2VyXG4gICAgICAgKiBpZiB0aGUgdXNlciBpcyBhbHJlYWR5IHNpZ25lZCBpbiB3aXRoIHRoZVxuICAgICAgICogcHJvdmlkZXIgaW4gdGhlIGZyb250ZW5kLlxuICAgICAgICpcbiAgICAgICAqIE9ubHkgYXBwbGljYWJsZSBpZiB0aGUgcHJvdmlkZXIgc3VwcG9ydHNcbiAgICAgICAqIGl0LiBDdXJyZW50bHkgb25seSBgYXBwbGVgIGFuZCBgZ29vZ2xlYCBpc1xuICAgICAgICogc3VwcG9ydGVkIG91dCBvZiB0aGUgYm94LlxuICAgICAgICovXG4gICAgICBpZFRva2VuOiB6Lm9wdGlvbmFsKFxuICAgICAgICB6Lm9iamVjdCh7XG4gICAgICAgICAgLyoqXG4gICAgICAgICAgICogSUQgdG9rZW4gZnJvbSB0aGUgcHJvdmlkZXJcbiAgICAgICAgICAgKi9cbiAgICAgICAgICB0b2tlbjogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIklEIHRva2VuIGZyb20gdGhlIHByb3ZpZGVyXCJcbiAgICAgICAgICB9KSxcbiAgICAgICAgICAvKipcbiAgICAgICAgICAgKiBUaGUgbm9uY2UgdXNlZCB0byBnZW5lcmF0ZSB0aGUgdG9rZW5cbiAgICAgICAgICAgKi9cbiAgICAgICAgICBub25jZTogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIk5vbmNlIHVzZWQgdG8gZ2VuZXJhdGUgdGhlIHRva2VuXCJcbiAgICAgICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIEFjY2VzcyB0b2tlbiBmcm9tIHRoZSBwcm92aWRlclxuICAgICAgICAgICAqL1xuICAgICAgICAgIGFjY2Vzc1Rva2VuOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiQWNjZXNzIHRva2VuIGZyb20gdGhlIHByb3ZpZGVyXCJcbiAgICAgICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIFJlZnJlc2ggdG9rZW4gZnJvbSB0aGUgcHJvdmlkZXJcbiAgICAgICAgICAgKi9cbiAgICAgICAgICByZWZyZXNoVG9rZW46IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJSZWZyZXNoIHRva2VuIGZyb20gdGhlIHByb3ZpZGVyXCJcbiAgICAgICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIEV4cGlyeSBkYXRlIG9mIHRoZSB0b2tlblxuICAgICAgICAgICAqL1xuICAgICAgICAgIGV4cGlyZXNBdDogei5udW1iZXIoKS5tZXRhKHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkV4cGlyeSBkYXRlIG9mIHRoZSB0b2tlblwiXG4gICAgICAgICAgfSkub3B0aW9uYWwoKVxuICAgICAgICB9KVxuICAgICAgKSxcbiAgICAgIHNjb3Blczogei5hcnJheSh6LnN0cmluZygpKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQXJyYXkgb2Ygc2NvcGVzIHRvIHJlcXVlc3QgZnJvbSB0aGUgcHJvdmlkZXIuIFRoaXMgd2lsbCBvdmVycmlkZSB0aGUgZGVmYXVsdCBzY29wZXMgcGFzc2VkLlwiXG4gICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBFeHBsaWNpdGx5IHJlcXVlc3Qgc2lnbi11cFxuICAgICAgICpcbiAgICAgICAqIFNob3VsZCBiZSB1c2VkIHRvIGFsbG93IHNpZ24gdXAgd2hlblxuICAgICAgICogZGlzYWJsZUltcGxpY2l0U2lnblVwIGZvciB0aGlzIHByb3ZpZGVyIGlzXG4gICAgICAgKiB0cnVlXG4gICAgICAgKi9cbiAgICAgIHJlcXVlc3RTaWduVXA6IHouYm9vbGVhbigpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJFeHBsaWNpdGx5IHJlcXVlc3Qgc2lnbi11cC4gVXNlZnVsIHdoZW4gZGlzYWJsZUltcGxpY2l0U2lnblVwIGlzIHRydWUgZm9yIHRoaXMgcHJvdmlkZXJcIlxuICAgICAgfSkub3B0aW9uYWwoKSxcbiAgICAgIC8qKlxuICAgICAgICogVGhlIGxvZ2luIGhpbnQgdG8gdXNlIGZvciB0aGUgYXV0aG9yaXphdGlvbiBjb2RlIHJlcXVlc3RcbiAgICAgICAqL1xuICAgICAgbG9naW5IaW50OiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgbG9naW4gaGludCB0byB1c2UgZm9yIHRoZSBhdXRob3JpemF0aW9uIGNvZGUgcmVxdWVzdFwiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiU2lnbiBpbiB3aXRoIGEgc29jaWFsIHByb3ZpZGVyXCIsXG4gICAgICAgIG9wZXJhdGlvbklkOiBcInNvY2lhbFNpZ25JblwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzIC0gUmV0dXJucyBlaXRoZXIgc2Vzc2lvbiBkZXRhaWxzIG9yIHJlZGlyZWN0IFVSTFwiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgLy8gdG9kbzogd2UgbmVlZCBzdXBwb3J0IGZvciBtdWx0aXBsZSBzY2hlbWFcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTZXNzaW9uIHJlc3BvbnNlIHdoZW4gaWRUb2tlbiBpcyBwcm92aWRlZFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICByZWRpcmVjdDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGVudW06IFtmYWxzZV1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdG9rZW46IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlNlc3Npb24gdG9rZW5cIixcbiAgICAgICAgICAgICAgICAgICAgICB1cmw6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwibnVsbFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgbnVsbGFibGU6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZW1haWw6IHsgdHlwZTogXCJzdHJpbmdcIiB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBudWxsYWJsZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgICBpbWFnZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbGFibGU6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcImRhdGUtdGltZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICAgIHVwZGF0ZWRBdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcImRhdGUtdGltZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1xuICAgICAgICAgICAgICAgICAgICAgICAgICBcImlkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFwiZW1haWxcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgXCJlbWFpbFZlcmlmaWVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFwiY3JlYXRlZEF0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIFwidXBkYXRlZEF0XCJcbiAgICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wicmVkaXJlY3RcIiwgXCJ0b2tlblwiLCBcInVzZXJcIl1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjKSA9PiB7XG4gICAgY29uc3QgcHJvdmlkZXIgPSBjLmNvbnRleHQuc29jaWFsUHJvdmlkZXJzLmZpbmQoXG4gICAgICAocCkgPT4gcC5pZCA9PT0gYy5ib2R5LnByb3ZpZGVyXG4gICAgKTtcbiAgICBpZiAoIXByb3ZpZGVyKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBcIlByb3ZpZGVyIG5vdCBmb3VuZC4gTWFrZSBzdXJlIHRvIGFkZCB0aGUgcHJvdmlkZXIgaW4geW91ciBhdXRoIGNvbmZpZ1wiLFxuICAgICAgICB7XG4gICAgICAgICAgcHJvdmlkZXI6IGMuYm9keS5wcm92aWRlclxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiTk9UX0ZPVU5EXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5QUk9WSURFUl9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoYy5ib2R5LmlkVG9rZW4pIHtcbiAgICAgIGlmICghcHJvdmlkZXIudmVyaWZ5SWRUb2tlbikge1xuICAgICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICAgIFwiUHJvdmlkZXIgZG9lcyBub3Qgc3VwcG9ydCBpZCB0b2tlbiB2ZXJpZmljYXRpb25cIixcbiAgICAgICAgICB7XG4gICAgICAgICAgICBwcm92aWRlcjogYy5ib2R5LnByb3ZpZGVyXG4gICAgICAgICAgfVxuICAgICAgICApO1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSURfVE9LRU5fTk9UX1NVUFBPUlRFRFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHsgdG9rZW4sIG5vbmNlIH0gPSBjLmJvZHkuaWRUb2tlbjtcbiAgICAgIGNvbnN0IHZhbGlkID0gYXdhaXQgcHJvdmlkZXIudmVyaWZ5SWRUb2tlbih0b2tlbiwgbm9uY2UpO1xuICAgICAgaWYgKCF2YWxpZCkge1xuICAgICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiSW52YWxpZCBpZCB0b2tlblwiLCB7XG4gICAgICAgICAgcHJvdmlkZXI6IGMuYm9keS5wcm92aWRlclxuICAgICAgICB9KTtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfVE9LRU5cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCB1c2VySW5mbyA9IGF3YWl0IHByb3ZpZGVyLmdldFVzZXJJbmZvKHtcbiAgICAgICAgaWRUb2tlbjogdG9rZW4sXG4gICAgICAgIGFjY2Vzc1Rva2VuOiBjLmJvZHkuaWRUb2tlbi5hY2Nlc3NUb2tlbixcbiAgICAgICAgcmVmcmVzaFRva2VuOiBjLmJvZHkuaWRUb2tlbi5yZWZyZXNoVG9rZW5cbiAgICAgIH0pO1xuICAgICAgaWYgKCF1c2VySW5mbyB8fCAhdXNlckluZm8/LnVzZXIpIHtcbiAgICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBnZXQgdXNlciBpbmZvXCIsIHtcbiAgICAgICAgICBwcm92aWRlcjogYy5ib2R5LnByb3ZpZGVyXG4gICAgICAgIH0pO1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX0dFVF9VU0VSX0lORk9cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoIXVzZXJJbmZvLnVzZXIuZW1haWwpIHtcbiAgICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlVzZXIgZW1haWwgbm90IGZvdW5kXCIsIHtcbiAgICAgICAgICBwcm92aWRlcjogYy5ib2R5LnByb3ZpZGVyXG4gICAgICAgIH0pO1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuVVNFUl9FTUFJTF9OT1RfRk9VTkRcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgaGFuZGxlT0F1dGhVc2VySW5mbyhjLCB7XG4gICAgICAgIHVzZXJJbmZvOiB7XG4gICAgICAgICAgLi4udXNlckluZm8udXNlcixcbiAgICAgICAgICBlbWFpbDogdXNlckluZm8udXNlci5lbWFpbCxcbiAgICAgICAgICBpZDogU3RyaW5nKHVzZXJJbmZvLnVzZXIuaWQpLFxuICAgICAgICAgIG5hbWU6IHVzZXJJbmZvLnVzZXIubmFtZSB8fCBcIlwiLFxuICAgICAgICAgIGltYWdlOiB1c2VySW5mby51c2VyLmltYWdlLFxuICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVzZXJJbmZvLnVzZXIuZW1haWxWZXJpZmllZCB8fCBmYWxzZVxuICAgICAgICB9LFxuICAgICAgICBhY2NvdW50OiB7XG4gICAgICAgICAgcHJvdmlkZXJJZDogcHJvdmlkZXIuaWQsXG4gICAgICAgICAgYWNjb3VudElkOiBTdHJpbmcodXNlckluZm8udXNlci5pZCksXG4gICAgICAgICAgYWNjZXNzVG9rZW46IGMuYm9keS5pZFRva2VuLmFjY2Vzc1Rva2VuXG4gICAgICAgIH0sXG4gICAgICAgIGNhbGxiYWNrVVJMOiBjLmJvZHkuY2FsbGJhY2tVUkwsXG4gICAgICAgIGRpc2FibGVTaWduVXA6IHByb3ZpZGVyLmRpc2FibGVJbXBsaWNpdFNpZ25VcCAmJiAhYy5ib2R5LnJlcXVlc3RTaWduVXAgfHwgcHJvdmlkZXIuZGlzYWJsZVNpZ25VcFxuICAgICAgfSk7XG4gICAgICBpZiAoZGF0YS5lcnJvcikge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IGRhdGEuZXJyb3JcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGMsIGRhdGEuZGF0YSk7XG4gICAgICByZXR1cm4gYy5qc29uKHtcbiAgICAgICAgcmVkaXJlY3Q6IGZhbHNlLFxuICAgICAgICB0b2tlbjogZGF0YS5kYXRhLnNlc3Npb24udG9rZW4sXG4gICAgICAgIHVybDogdm9pZCAwLFxuICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgaWQ6IGRhdGEuZGF0YS51c2VyLmlkLFxuICAgICAgICAgIGVtYWlsOiBkYXRhLmRhdGEudXNlci5lbWFpbCxcbiAgICAgICAgICBuYW1lOiBkYXRhLmRhdGEudXNlci5uYW1lLFxuICAgICAgICAgIGltYWdlOiBkYXRhLmRhdGEudXNlci5pbWFnZSxcbiAgICAgICAgICBlbWFpbFZlcmlmaWVkOiBkYXRhLmRhdGEudXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICAgIGNyZWF0ZWRBdDogZGF0YS5kYXRhLnVzZXIuY3JlYXRlZEF0LFxuICAgICAgICAgIHVwZGF0ZWRBdDogZGF0YS5kYXRhLnVzZXIudXBkYXRlZEF0XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB7IGNvZGVWZXJpZmllciwgc3RhdGUgfSA9IGF3YWl0IGdlbmVyYXRlU3RhdGUoYyk7XG4gICAgY29uc3QgdXJsID0gYXdhaXQgcHJvdmlkZXIuY3JlYXRlQXV0aG9yaXphdGlvblVSTCh7XG4gICAgICBzdGF0ZSxcbiAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgIHJlZGlyZWN0VVJJOiBgJHtjLmNvbnRleHQuYmFzZVVSTH0vY2FsbGJhY2svJHtwcm92aWRlci5pZH1gLFxuICAgICAgc2NvcGVzOiBjLmJvZHkuc2NvcGVzLFxuICAgICAgbG9naW5IaW50OiBjLmJvZHkubG9naW5IaW50XG4gICAgfSk7XG4gICAgcmV0dXJuIGMuanNvbih7XG4gICAgICB1cmw6IHVybC50b1N0cmluZygpLFxuICAgICAgcmVkaXJlY3Q6ICFjLmJvZHkuZGlzYWJsZVJlZGlyZWN0XG4gICAgfSk7XG4gIH1cbik7XG5jb25zdCBzaWduSW5FbWFpbCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvc2lnbi1pbi9lbWFpbFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAvKipcbiAgICAgICAqIEVtYWlsIG9mIHRoZSB1c2VyXG4gICAgICAgKi9cbiAgICAgIGVtYWlsOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJFbWFpbCBvZiB0aGUgdXNlclwiXG4gICAgICB9KSxcbiAgICAgIC8qKlxuICAgICAgICogUGFzc3dvcmQgb2YgdGhlIHVzZXJcbiAgICAgICAqL1xuICAgICAgcGFzc3dvcmQ6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlBhc3N3b3JkIG9mIHRoZSB1c2VyXCJcbiAgICAgIH0pLFxuICAgICAgLyoqXG4gICAgICAgKiBDYWxsYmFjayBVUkwgdG8gdXNlIGFzIGEgcmVkaXJlY3QgZm9yIGVtYWlsXG4gICAgICAgKiB2ZXJpZmljYXRpb24gYW5kIGZvciBwb3NzaWJsZSByZWRpcmVjdHNcbiAgICAgICAqL1xuICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkNhbGxiYWNrIFVSTCB0byB1c2UgYXMgYSByZWRpcmVjdCBmb3IgZW1haWwgdmVyaWZpY2F0aW9uXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIElmIHRoaXMgaXMgZmFsc2UsIHRoZSBzZXNzaW9uIHdpbGwgbm90IGJlIHJlbWVtYmVyZWRcbiAgICAgICAqIEBkZWZhdWx0IHRydWVcbiAgICAgICAqL1xuICAgICAgcmVtZW1iZXJNZTogei5ib29sZWFuKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIklmIHRoaXMgaXMgZmFsc2UsIHRoZSBzZXNzaW9uIHdpbGwgbm90IGJlIHJlbWVtYmVyZWQuIERlZmF1bHQgaXMgYHRydWVgLlwiXG4gICAgICB9KS5kZWZhdWx0KHRydWUpLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJTaWduIGluIHdpdGggZW1haWwgYW5kIHBhc3N3b3JkXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3MgLSBSZXR1cm5zIGVpdGhlciBzZXNzaW9uIGRldGFpbHMgb3IgcmVkaXJlY3QgVVJMXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICAvLyB0b2RvOiB3ZSBuZWVkIHN1cHBvcnQgZm9yIG11bHRpcGxlIHNjaGVtYVxuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlNlc3Npb24gcmVzcG9uc2Ugd2hlbiBpZFRva2VuIGlzIHByb3ZpZGVkXCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHJlZGlyZWN0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZW51bTogW2ZhbHNlXVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0b2tlbjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU2Vzc2lvbiB0b2tlblwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHVybDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwibnVsbFwiLFxuICAgICAgICAgICAgICAgICAgICAgIG51bGxhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsOiB7IHR5cGU6IFwic3RyaW5nXCIgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgbnVsbGFibGU6IHRydWVcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBudWxsYWJsZTogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcImRhdGUtdGltZVwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogXCJkYXRlLXRpbWVcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW1haWxcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW1haWxWZXJpZmllZFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVkQXRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwidXBkYXRlZEF0XCJcbiAgICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wicmVkaXJlY3RcIiwgXCJ0b2tlblwiLCBcInVzZXJcIl1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnM/LmVtYWlsQW5kUGFzc3dvcmQ/LmVuYWJsZWQpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgXCJFbWFpbCBhbmQgcGFzc3dvcmQgaXMgbm90IGVuYWJsZWQuIE1ha2Ugc3VyZSB0byBlbmFibGUgaXQgaW4gdGhlIG9wdGlvbnMgb24geW91IGBhdXRoLnRzYCBmaWxlLiBDaGVjayBgaHR0cHM6Ly9iZXR0ZXItYXV0aC5jb20vZG9jcy9hdXRoZW50aWNhdGlvbi9lbWFpbC1wYXNzd29yZGAgZm9yIG1vcmUhXCJcbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiRW1haWwgYW5kIHBhc3N3b3JkIGlzIG5vdCBlbmFibGVkXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB7IGVtYWlsLCBwYXNzd29yZCB9ID0gY3R4LmJvZHk7XG4gICAgY29uc3QgaXNWYWxpZEVtYWlsID0gei5zdHJpbmcoKS5lbWFpbCgpLnNhZmVQYXJzZShlbWFpbCk7XG4gICAgaWYgKCFpc1ZhbGlkRW1haWwuc3VjY2Vzcykge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfRU1BSUxcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlFbWFpbChlbWFpbCwge1xuICAgICAgaW5jbHVkZUFjY291bnRzOiB0cnVlXG4gICAgfSk7XG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC5oYXNoKHBhc3N3b3JkKTtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlVzZXIgbm90IGZvdW5kXCIsIHsgZW1haWwgfSk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfRU1BSUxfT1JfUEFTU1dPUkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBjcmVkZW50aWFsQWNjb3VudCA9IHVzZXIuYWNjb3VudHMuZmluZChcbiAgICAgIChhKSA9PiBhLnByb3ZpZGVySWQgPT09IFwiY3JlZGVudGlhbFwiXG4gICAgKTtcbiAgICBpZiAoIWNyZWRlbnRpYWxBY2NvdW50KSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJDcmVkZW50aWFsIGFjY291bnQgbm90IGZvdW5kXCIsIHsgZW1haWwgfSk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfRU1BSUxfT1JfUEFTU1dPUkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBjdXJyZW50UGFzc3dvcmQgPSBjcmVkZW50aWFsQWNjb3VudD8ucGFzc3dvcmQ7XG4gICAgaWYgKCFjdXJyZW50UGFzc3dvcmQpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlBhc3N3b3JkIG5vdCBmb3VuZFwiLCB7IGVtYWlsIH0pO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiVU5BVVRIT1JJWkVEXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX0VNQUlMX09SX1BBU1NXT1JEXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgdmFsaWRQYXNzd29yZCA9IGF3YWl0IGN0eC5jb250ZXh0LnBhc3N3b3JkLnZlcmlmeSh7XG4gICAgICBoYXNoOiBjdXJyZW50UGFzc3dvcmQsXG4gICAgICBwYXNzd29yZFxuICAgIH0pO1xuICAgIGlmICghdmFsaWRQYXNzd29yZCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFwiSW52YWxpZCBwYXNzd29yZFwiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9FTUFJTF9PUl9QQVNTV09SRFxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChjdHguY29udGV4dC5vcHRpb25zPy5lbWFpbEFuZFBhc3N3b3JkPy5yZXF1aXJlRW1haWxWZXJpZmljYXRpb24gJiYgIXVzZXIudXNlci5lbWFpbFZlcmlmaWVkKSB7XG4gICAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnM/LmVtYWlsVmVyaWZpY2F0aW9uPy5zZW5kVmVyaWZpY2F0aW9uRW1haWwpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiRk9SQklEREVOXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkVNQUlMX05PVF9WRVJJRklFRFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChjdHguY29udGV4dC5vcHRpb25zPy5lbWFpbFZlcmlmaWNhdGlvbj8uc2VuZE9uU2lnbkluKSB7XG4gICAgICAgIGNvbnN0IHRva2VuID0gYXdhaXQgY3JlYXRlRW1haWxWZXJpZmljYXRpb25Ub2tlbihcbiAgICAgICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICAgICAgdXNlci51c2VyLmVtYWlsLFxuICAgICAgICAgIHZvaWQgMCxcbiAgICAgICAgICBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5leHBpcmVzSW5cbiAgICAgICAgKTtcbiAgICAgICAgY29uc3QgdXJsID0gYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vdmVyaWZ5LWVtYWlsP3Rva2VuPSR7dG9rZW59JmNhbGxiYWNrVVJMPSR7Y3R4LmJvZHkuY2FsbGJhY2tVUkwgfHwgXCIvXCJ9YDtcbiAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbi5zZW5kVmVyaWZpY2F0aW9uRW1haWwoXG4gICAgICAgICAge1xuICAgICAgICAgICAgdXNlcjogdXNlci51c2VyLFxuICAgICAgICAgICAgdXJsLFxuICAgICAgICAgICAgdG9rZW5cbiAgICAgICAgICB9LFxuICAgICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJGT1JCSURERU5cIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkVNQUlMX05PVF9WRVJJRklFRFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlU2Vzc2lvbihcbiAgICAgIHVzZXIudXNlci5pZCxcbiAgICAgIGN0eCxcbiAgICAgIGN0eC5ib2R5LnJlbWVtYmVyTWUgPT09IGZhbHNlXG4gICAgKTtcbiAgICBpZiAoIXNlc3Npb24pIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkZhaWxlZCB0byBjcmVhdGUgc2Vzc2lvblwiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX0NSRUFURV9TRVNTSU9OXG4gICAgICB9KTtcbiAgICB9XG4gICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShcbiAgICAgIGN0eCxcbiAgICAgIHtcbiAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgdXNlcjogdXNlci51c2VyXG4gICAgICB9LFxuICAgICAgY3R4LmJvZHkucmVtZW1iZXJNZSA9PT0gZmFsc2VcbiAgICApO1xuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICByZWRpcmVjdDogISFjdHguYm9keS5jYWxsYmFja1VSTCxcbiAgICAgIHRva2VuOiBzZXNzaW9uLnRva2VuLFxuICAgICAgdXJsOiBjdHguYm9keS5jYWxsYmFja1VSTCxcbiAgICAgIHVzZXI6IHtcbiAgICAgICAgaWQ6IHVzZXIudXNlci5pZCxcbiAgICAgICAgZW1haWw6IHVzZXIudXNlci5lbWFpbCxcbiAgICAgICAgbmFtZTogdXNlci51c2VyLm5hbWUsXG4gICAgICAgIGltYWdlOiB1c2VyLnVzZXIuaW1hZ2UsXG4gICAgICAgIGVtYWlsVmVyaWZpZWQ6IHVzZXIudXNlci5lbWFpbFZlcmlmaWVkLFxuICAgICAgICBjcmVhdGVkQXQ6IHVzZXIudXNlci5jcmVhdGVkQXQsXG4gICAgICAgIHVwZGF0ZWRBdDogdXNlci51c2VyLnVwZGF0ZWRBdFxuICAgICAgfVxuICAgIH0pO1xuICB9XG4pO1xuXG5jb25zdCBzY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGNvZGU6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgZXJyb3I6IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgZGV2aWNlX2lkOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIGVycm9yX2Rlc2NyaXB0aW9uOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIHN0YXRlOiB6LnN0cmluZygpLm9wdGlvbmFsKCksXG4gIHVzZXI6IHouc3RyaW5nKCkub3B0aW9uYWwoKVxufSk7XG5jb25zdCBjYWxsYmFja09BdXRoID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9jYWxsYmFjay86aWRcIixcbiAge1xuICAgIG1ldGhvZDogW1wiR0VUXCIsIFwiUE9TVFwiXSxcbiAgICBib2R5OiBzY2hlbWEub3B0aW9uYWwoKSxcbiAgICBxdWVyeTogc2NoZW1hLm9wdGlvbmFsKCksXG4gICAgbWV0YWRhdGE6IEhJREVfTUVUQURBVEFcbiAgfSxcbiAgYXN5bmMgKGMpID0+IHtcbiAgICBsZXQgcXVlcnlPckJvZHk7XG4gICAgY29uc3QgZGVmYXVsdEVycm9yVVJMID0gYy5jb250ZXh0Lm9wdGlvbnMub25BUElFcnJvcj8uZXJyb3JVUkwgfHwgYCR7Yy5jb250ZXh0LmJhc2VVUkx9L2Vycm9yYDtcbiAgICB0cnkge1xuICAgICAgaWYgKGMubWV0aG9kID09PSBcIkdFVFwiKSB7XG4gICAgICAgIHF1ZXJ5T3JCb2R5ID0gc2NoZW1hLnBhcnNlKGMucXVlcnkpO1xuICAgICAgfSBlbHNlIGlmIChjLm1ldGhvZCA9PT0gXCJQT1NUXCIpIHtcbiAgICAgICAgcXVlcnlPckJvZHkgPSBzY2hlbWEucGFyc2UoYy5ib2R5KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcIlVuc3VwcG9ydGVkIG1ldGhvZFwiKTtcbiAgICAgIH1cbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiSU5WQUxJRF9DQUxMQkFDS19SRVFVRVNUXCIsIGUpO1xuICAgICAgdGhyb3cgYy5yZWRpcmVjdChgJHtkZWZhdWx0RXJyb3JVUkx9P2Vycm9yPWludmFsaWRfY2FsbGJhY2tfcmVxdWVzdGApO1xuICAgIH1cbiAgICBjb25zdCB7IGNvZGUsIGVycm9yLCBzdGF0ZSwgZXJyb3JfZGVzY3JpcHRpb24sIGRldmljZV9pZCB9ID0gcXVlcnlPckJvZHk7XG4gICAgaWYgKGVycm9yKSB7XG4gICAgICB0aHJvdyBjLnJlZGlyZWN0KFxuICAgICAgICBgJHtkZWZhdWx0RXJyb3JVUkx9P2Vycm9yPSR7ZXJyb3J9JmVycm9yX2Rlc2NyaXB0aW9uPSR7ZXJyb3JfZGVzY3JpcHRpb259YFxuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKCFzdGF0ZSkge1xuICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlN0YXRlIG5vdCBmb3VuZFwiLCBlcnJvcik7XG4gICAgICB0aHJvdyBjLnJlZGlyZWN0KGAke2RlZmF1bHRFcnJvclVSTH0/ZXJyb3I9c3RhdGVfbm90X2ZvdW5kYCk7XG4gICAgfVxuICAgIGNvbnN0IHtcbiAgICAgIGNvZGVWZXJpZmllcixcbiAgICAgIGNhbGxiYWNrVVJMLFxuICAgICAgbGluayxcbiAgICAgIGVycm9yVVJMLFxuICAgICAgbmV3VXNlclVSTCxcbiAgICAgIHJlcXVlc3RTaWduVXBcbiAgICB9ID0gYXdhaXQgcGFyc2VTdGF0ZShjKTtcbiAgICBmdW5jdGlvbiByZWRpcmVjdE9uRXJyb3IoZXJyb3IyKSB7XG4gICAgICBsZXQgdXJsID0gZXJyb3JVUkwgfHwgZGVmYXVsdEVycm9yVVJMO1xuICAgICAgaWYgKHVybC5pbmNsdWRlcyhcIj9cIikpIHtcbiAgICAgICAgdXJsID0gYCR7dXJsfSZlcnJvcj0ke2Vycm9yMn1gO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdXJsID0gYCR7dXJsfT9lcnJvcj0ke2Vycm9yMn1gO1xuICAgICAgfVxuICAgICAgdGhyb3cgYy5yZWRpcmVjdCh1cmwpO1xuICAgIH1cbiAgICBpZiAoIWNvZGUpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJDb2RlIG5vdCBmb3VuZFwiKTtcbiAgICAgIHRocm93IHJlZGlyZWN0T25FcnJvcihcIm5vX2NvZGVcIik7XG4gICAgfVxuICAgIGNvbnN0IHByb3ZpZGVyID0gYy5jb250ZXh0LnNvY2lhbFByb3ZpZGVycy5maW5kKFxuICAgICAgKHApID0+IHAuaWQgPT09IGMucGFyYW1zLmlkXG4gICAgKTtcbiAgICBpZiAoIXByb3ZpZGVyKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBcIk9hdXRoIHByb3ZpZGVyIHdpdGggaWRcIixcbiAgICAgICAgYy5wYXJhbXMuaWQsXG4gICAgICAgIFwibm90IGZvdW5kXCJcbiAgICAgICk7XG4gICAgICB0aHJvdyByZWRpcmVjdE9uRXJyb3IoXCJvYXV0aF9wcm92aWRlcl9ub3RfZm91bmRcIik7XG4gICAgfVxuICAgIGxldCB0b2tlbnM7XG4gICAgdHJ5IHtcbiAgICAgIHRva2VucyA9IGF3YWl0IHByb3ZpZGVyLnZhbGlkYXRlQXV0aG9yaXphdGlvbkNvZGUoe1xuICAgICAgICBjb2RlLFxuICAgICAgICBjb2RlVmVyaWZpZXIsXG4gICAgICAgIGRldmljZUlkOiBkZXZpY2VfaWQsXG4gICAgICAgIHJlZGlyZWN0VVJJOiBgJHtjLmNvbnRleHQuYmFzZVVSTH0vY2FsbGJhY2svJHtwcm92aWRlci5pZH1gXG4gICAgICB9KTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiXCIsIGUpO1xuICAgICAgdGhyb3cgcmVkaXJlY3RPbkVycm9yKFwiaW52YWxpZF9jb2RlXCIpO1xuICAgIH1cbiAgICBjb25zdCB1c2VySW5mbyA9IGF3YWl0IHByb3ZpZGVyLmdldFVzZXJJbmZvKHtcbiAgICAgIC4uLnRva2VucyxcbiAgICAgIHVzZXI6IGMuYm9keT8udXNlciA/IHNhZmVKU09OUGFyc2UoYy5ib2R5LnVzZXIpIDogdm9pZCAwXG4gICAgfSkudGhlbigocmVzKSA9PiByZXM/LnVzZXIpO1xuICAgIGlmICghdXNlckluZm8pIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJVbmFibGUgdG8gZ2V0IHVzZXIgaW5mb1wiKTtcbiAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJ1bmFibGVfdG9fZ2V0X3VzZXJfaW5mb1wiKTtcbiAgICB9XG4gICAgaWYgKCFjYWxsYmFja1VSTCkge1xuICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcIk5vIGNhbGxiYWNrIFVSTCBmb3VuZFwiKTtcbiAgICAgIHRocm93IHJlZGlyZWN0T25FcnJvcihcIm5vX2NhbGxiYWNrX3VybFwiKTtcbiAgICB9XG4gICAgaWYgKGxpbmspIHtcbiAgICAgIGNvbnN0IHRydXN0ZWRQcm92aWRlcnMgPSBjLmNvbnRleHQub3B0aW9ucy5hY2NvdW50Py5hY2NvdW50TGlua2luZz8udHJ1c3RlZFByb3ZpZGVycztcbiAgICAgIGNvbnN0IGlzVHJ1c3RlZFByb3ZpZGVyID0gdHJ1c3RlZFByb3ZpZGVycz8uaW5jbHVkZXMoXG4gICAgICAgIHByb3ZpZGVyLmlkXG4gICAgICApO1xuICAgICAgaWYgKCFpc1RydXN0ZWRQcm92aWRlciAmJiAhdXNlckluZm8uZW1haWxWZXJpZmllZCB8fCBjLmNvbnRleHQub3B0aW9ucy5hY2NvdW50Py5hY2NvdW50TGlua2luZz8uZW5hYmxlZCA9PT0gZmFsc2UpIHtcbiAgICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlVuYWJsZSB0byBsaW5rIGFjY291bnQgLSB1bnRydXN0ZWQgcHJvdmlkZXJcIik7XG4gICAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IoXCJ1bmFibGVfdG9fbGlua19hY2NvdW50XCIpO1xuICAgICAgfVxuICAgICAgaWYgKHVzZXJJbmZvLmVtYWlsICE9PSBsaW5rLmVtYWlsICYmIGMuY29udGV4dC5vcHRpb25zLmFjY291bnQ/LmFjY291bnRMaW5raW5nPy5hbGxvd0RpZmZlcmVudEVtYWlscyAhPT0gdHJ1ZSkge1xuICAgICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKFwiZW1haWxfZG9lc24ndF9tYXRjaFwiKTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGV4aXN0aW5nQWNjb3VudCA9IGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnQoXG4gICAgICAgIFN0cmluZyh1c2VySW5mby5pZClcbiAgICAgICk7XG4gICAgICBpZiAoZXhpc3RpbmdBY2NvdW50KSB7XG4gICAgICAgIGlmIChleGlzdGluZ0FjY291bnQudXNlcklkLnRvU3RyaW5nKCkgIT09IGxpbmsudXNlcklkLnRvU3RyaW5nKCkpIHtcbiAgICAgICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKFwiYWNjb3VudF9hbHJlYWR5X2xpbmtlZF90b19kaWZmZXJlbnRfdXNlclwiKTtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCB1cGRhdGVEYXRhID0gT2JqZWN0LmZyb21FbnRyaWVzKFxuICAgICAgICAgIE9iamVjdC5lbnRyaWVzKHtcbiAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBhd2FpdCBzZXRUb2tlblV0aWwodG9rZW5zLmFjY2Vzc1Rva2VuLCBjLmNvbnRleHQpLFxuICAgICAgICAgICAgcmVmcmVzaFRva2VuOiBhd2FpdCBzZXRUb2tlblV0aWwodG9rZW5zLnJlZnJlc2hUb2tlbiwgYy5jb250ZXh0KSxcbiAgICAgICAgICAgIGlkVG9rZW46IHRva2Vucy5pZFRva2VuLFxuICAgICAgICAgICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IHRva2Vucy5hY2Nlc3NUb2tlbkV4cGlyZXNBdCxcbiAgICAgICAgICAgIHJlZnJlc2hUb2tlbkV4cGlyZXNBdDogdG9rZW5zLnJlZnJlc2hUb2tlbkV4cGlyZXNBdCxcbiAgICAgICAgICAgIHNjb3BlOiB0b2tlbnMuc2NvcGVzPy5qb2luKFwiLFwiKVxuICAgICAgICAgIH0pLmZpbHRlcigoW18sIHZhbHVlXSkgPT4gdmFsdWUgIT09IHZvaWQgMClcbiAgICAgICAgKTtcbiAgICAgICAgYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVBY2NvdW50KFxuICAgICAgICAgIGV4aXN0aW5nQWNjb3VudC5pZCxcbiAgICAgICAgICB1cGRhdGVEYXRhXG4gICAgICAgICk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCBuZXdBY2NvdW50ID0gYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVBY2NvdW50KFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHVzZXJJZDogbGluay51c2VySWQsXG4gICAgICAgICAgICBwcm92aWRlcklkOiBwcm92aWRlci5pZCxcbiAgICAgICAgICAgIGFjY291bnRJZDogU3RyaW5nKHVzZXJJbmZvLmlkKSxcbiAgICAgICAgICAgIC4uLnRva2VucyxcbiAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBhd2FpdCBzZXRUb2tlblV0aWwodG9rZW5zLmFjY2Vzc1Rva2VuLCBjLmNvbnRleHQpLFxuICAgICAgICAgICAgcmVmcmVzaFRva2VuOiBhd2FpdCBzZXRUb2tlblV0aWwodG9rZW5zLnJlZnJlc2hUb2tlbiwgYy5jb250ZXh0KSxcbiAgICAgICAgICAgIHNjb3BlOiB0b2tlbnMuc2NvcGVzPy5qb2luKFwiLFwiKVxuICAgICAgICAgIH0sXG4gICAgICAgICAgY1xuICAgICAgICApO1xuICAgICAgICBpZiAoIW5ld0FjY291bnQpIHtcbiAgICAgICAgICByZXR1cm4gcmVkaXJlY3RPbkVycm9yKFwidW5hYmxlX3RvX2xpbmtfYWNjb3VudFwiKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgbGV0IHRvUmVkaXJlY3RUbzI7XG4gICAgICB0cnkge1xuICAgICAgICBjb25zdCB1cmwgPSBjYWxsYmFja1VSTDtcbiAgICAgICAgdG9SZWRpcmVjdFRvMiA9IHVybC50b1N0cmluZygpO1xuICAgICAgfSBjYXRjaCB7XG4gICAgICAgIHRvUmVkaXJlY3RUbzIgPSBjYWxsYmFja1VSTDtcbiAgICAgIH1cbiAgICAgIHRocm93IGMucmVkaXJlY3QodG9SZWRpcmVjdFRvMik7XG4gICAgfVxuICAgIGlmICghdXNlckluZm8uZW1haWwpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIFwiUHJvdmlkZXIgZGlkIG5vdCByZXR1cm4gZW1haWwuIFRoaXMgY291bGQgYmUgZHVlIHRvIG1pc2NvbmZpZ3VyYXRpb24gaW4gdGhlIHByb3ZpZGVyIHNldHRpbmdzLlwiXG4gICAgICApO1xuICAgICAgcmV0dXJuIHJlZGlyZWN0T25FcnJvcihcImVtYWlsX25vdF9mb3VuZFwiKTtcbiAgICB9XG4gICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgaGFuZGxlT0F1dGhVc2VySW5mbyhjLCB7XG4gICAgICB1c2VySW5mbzoge1xuICAgICAgICAuLi51c2VySW5mbyxcbiAgICAgICAgaWQ6IFN0cmluZyh1c2VySW5mby5pZCksXG4gICAgICAgIGVtYWlsOiB1c2VySW5mby5lbWFpbCxcbiAgICAgICAgbmFtZTogdXNlckluZm8ubmFtZSB8fCB1c2VySW5mby5lbWFpbFxuICAgICAgfSxcbiAgICAgIGFjY291bnQ6IHtcbiAgICAgICAgcHJvdmlkZXJJZDogcHJvdmlkZXIuaWQsXG4gICAgICAgIGFjY291bnRJZDogU3RyaW5nKHVzZXJJbmZvLmlkKSxcbiAgICAgICAgLi4udG9rZW5zLFxuICAgICAgICBzY29wZTogdG9rZW5zLnNjb3Blcz8uam9pbihcIixcIilcbiAgICAgIH0sXG4gICAgICBjYWxsYmFja1VSTCxcbiAgICAgIGRpc2FibGVTaWduVXA6IHByb3ZpZGVyLmRpc2FibGVJbXBsaWNpdFNpZ25VcCAmJiAhcmVxdWVzdFNpZ25VcCB8fCBwcm92aWRlci5vcHRpb25zPy5kaXNhYmxlU2lnblVwLFxuICAgICAgb3ZlcnJpZGVVc2VySW5mbzogcHJvdmlkZXIub3B0aW9ucz8ub3ZlcnJpZGVVc2VySW5mb09uU2lnbkluXG4gICAgfSk7XG4gICAgaWYgKHJlc3VsdC5lcnJvcikge1xuICAgICAgYy5jb250ZXh0LmxvZ2dlci5lcnJvcihyZXN1bHQuZXJyb3Iuc3BsaXQoXCIgXCIpLmpvaW4oXCJfXCIpKTtcbiAgICAgIHJldHVybiByZWRpcmVjdE9uRXJyb3IocmVzdWx0LmVycm9yLnNwbGl0KFwiIFwiKS5qb2luKFwiX1wiKSk7XG4gICAgfVxuICAgIGNvbnN0IHsgc2Vzc2lvbiwgdXNlciB9ID0gcmVzdWx0LmRhdGE7XG4gICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjLCB7XG4gICAgICBzZXNzaW9uLFxuICAgICAgdXNlclxuICAgIH0pO1xuICAgIGxldCB0b1JlZGlyZWN0VG87XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHVybCA9IHJlc3VsdC5pc1JlZ2lzdGVyID8gbmV3VXNlclVSTCB8fCBjYWxsYmFja1VSTCA6IGNhbGxiYWNrVVJMO1xuICAgICAgdG9SZWRpcmVjdFRvID0gdXJsLnRvU3RyaW5nKCk7XG4gICAgfSBjYXRjaCB7XG4gICAgICB0b1JlZGlyZWN0VG8gPSByZXN1bHQuaXNSZWdpc3RlciA/IG5ld1VzZXJVUkwgfHwgY2FsbGJhY2tVUkwgOiBjYWxsYmFja1VSTDtcbiAgICB9XG4gICAgdGhyb3cgYy5yZWRpcmVjdCh0b1JlZGlyZWN0VG8pO1xuICB9XG4pO1xuXG5jb25zdCBzaWduT3V0ID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9zaWduLW91dFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJTaWduIG91dCB0aGUgY3VycmVudCB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHN1Y2Nlc3M6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbkNvb2tpZVRva2VuID0gYXdhaXQgY3R4LmdldFNpZ25lZENvb2tpZShcbiAgICAgIGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25Ub2tlbi5uYW1lLFxuICAgICAgY3R4LmNvbnRleHQuc2VjcmV0XG4gICAgKTtcbiAgICBpZiAoIXNlc3Npb25Db29raWVUb2tlbikge1xuICAgICAgZGVsZXRlU2Vzc2lvbkNvb2tpZShjdHgpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkZBSUxFRF9UT19HRVRfU0VTU0lPTlxuICAgICAgfSk7XG4gICAgfVxuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9uKHNlc3Npb25Db29raWVUb2tlbik7XG4gICAgZGVsZXRlU2Vzc2lvbkNvb2tpZShjdHgpO1xuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG5cbmZ1bmN0aW9uIHJlZGlyZWN0RXJyb3IoY3R4LCBjYWxsYmFja1VSTCwgcXVlcnkpIHtcbiAgY29uc3QgdXJsID0gY2FsbGJhY2tVUkwgPyBuZXcgVVJMKGNhbGxiYWNrVVJMLCBjdHguYmFzZVVSTCkgOiBuZXcgVVJMKGAke2N0eC5iYXNlVVJMfS9lcnJvcmApO1xuICBpZiAocXVlcnkpXG4gICAgT2JqZWN0LmVudHJpZXMocXVlcnkpLmZvckVhY2goKFtrLCB2XSkgPT4gdXJsLnNlYXJjaFBhcmFtcy5zZXQoaywgdikpO1xuICByZXR1cm4gdXJsLmhyZWY7XG59XG5mdW5jdGlvbiByZWRpcmVjdENhbGxiYWNrKGN0eCwgY2FsbGJhY2tVUkwsIHF1ZXJ5KSB7XG4gIGNvbnN0IHVybCA9IG5ldyBVUkwoY2FsbGJhY2tVUkwsIGN0eC5iYXNlVVJMKTtcbiAgaWYgKHF1ZXJ5KVxuICAgIE9iamVjdC5lbnRyaWVzKHF1ZXJ5KS5mb3JFYWNoKChbaywgdl0pID0+IHVybC5zZWFyY2hQYXJhbXMuc2V0KGssIHYpKTtcbiAgcmV0dXJuIHVybC5ocmVmO1xufVxuY29uc3QgcmVxdWVzdFBhc3N3b3JkUmVzZXQgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL3JlcXVlc3QtcGFzc3dvcmQtcmVzZXRcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgLyoqXG4gICAgICAgKiBUaGUgZW1haWwgYWRkcmVzcyBvZiB0aGUgdXNlciB0byBzZW5kIGEgcGFzc3dvcmQgcmVzZXQgZW1haWwgdG8uXG4gICAgICAgKi9cbiAgICAgIGVtYWlsOiB6LmVtYWlsKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBlbWFpbCBhZGRyZXNzIG9mIHRoZSB1c2VyIHRvIHNlbmQgYSBwYXNzd29yZCByZXNldCBlbWFpbCB0b1wiXG4gICAgICB9KSxcbiAgICAgIC8qKlxuICAgICAgICogVGhlIFVSTCB0byByZWRpcmVjdCB0aGUgdXNlciB0byByZXNldCB0aGVpciBwYXNzd29yZC5cbiAgICAgICAqIElmIHRoZSB0b2tlbiBpc24ndCB2YWxpZCBvciBleHBpcmVkLCBpdCdsbCBiZSByZWRpcmVjdGVkIHdpdGggYSBxdWVyeSBwYXJhbWV0ZXIgYD9cbiAgICAgICAqIGVycm9yPUlOVkFMSURfVE9LRU5gLiBJZiB0aGUgdG9rZW4gaXMgdmFsaWQsIGl0J2xsIGJlIHJlZGlyZWN0ZWQgd2l0aCBhIHF1ZXJ5IHBhcmFtZXRlciBgP1xuICAgICAgICogdG9rZW49VkFMSURfVE9LRU5cbiAgICAgICAqL1xuICAgICAgcmVkaXJlY3RUbzogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byByZWRpcmVjdCB0aGUgdXNlciB0byByZXNldCB0aGVpciBwYXNzd29yZC4gSWYgdGhlIHRva2VuIGlzbid0IHZhbGlkIG9yIGV4cGlyZWQsIGl0J2xsIGJlIHJlZGlyZWN0ZWQgd2l0aCBhIHF1ZXJ5IHBhcmFtZXRlciBgP2Vycm9yPUlOVkFMSURfVE9LRU5gLiBJZiB0aGUgdG9rZW4gaXMgdmFsaWQsIGl0J2xsIGJlIHJlZGlyZWN0ZWQgd2l0aCBhIHF1ZXJ5IHBhcmFtZXRlciBgP3Rva2VuPVZBTElEX1RPS0VOXCJcbiAgICAgIH0pLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJTZW5kIGEgcGFzc3dvcmQgcmVzZXQgZW1haWwgdG8gdGhlIHVzZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGlmICghY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5zZW5kUmVzZXRQYXNzd29yZCkge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBcIlJlc2V0IHBhc3N3b3JkIGlzbid0IGVuYWJsZWQuUGxlYXNlIHBhc3MgYW4gZW1haWxBbmRQYXNzd29yZC5zZW5kUmVzZXRQYXNzd29yZCBmdW5jdGlvbiBpbiB5b3VyIGF1dGggY29uZmlnIVwiXG4gICAgICApO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIlJlc2V0IHBhc3N3b3JkIGlzbid0IGVuYWJsZWRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHsgZW1haWwsIHJlZGlyZWN0VG8gfSA9IGN0eC5ib2R5O1xuICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUVtYWlsKGVtYWlsLCB7XG4gICAgICBpbmNsdWRlQWNjb3VudHM6IHRydWVcbiAgICB9KTtcbiAgICBpZiAoIXVzZXIpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlJlc2V0IFBhc3N3b3JkOiBVc2VyIG5vdCBmb3VuZFwiLCB7IGVtYWlsIH0pO1xuICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgc3RhdHVzOiB0cnVlLFxuICAgICAgICBtZXNzYWdlOiBcIklmIHRoaXMgZW1haWwgZXhpc3RzIGluIG91ciBzeXN0ZW0sIGNoZWNrIHlvdXIgZW1haWwgZm9yIHRoZSByZXNldCBsaW5rXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBkZWZhdWx0RXhwaXJlc0luID0gNjAgKiA2MCAqIDE7XG4gICAgY29uc3QgZXhwaXJlc0F0ID0gZ2V0RGF0ZShcbiAgICAgIGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZC5yZXNldFBhc3N3b3JkVG9rZW5FeHBpcmVzSW4gfHwgZGVmYXVsdEV4cGlyZXNJbixcbiAgICAgIFwic2VjXCJcbiAgICApO1xuICAgIGNvbnN0IHZlcmlmaWNhdGlvblRva2VuID0gZ2VuZXJhdGVJZCgyNCk7XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVZlcmlmaWNhdGlvblZhbHVlKFxuICAgICAge1xuICAgICAgICB2YWx1ZTogdXNlci51c2VyLmlkLFxuICAgICAgICBpZGVudGlmaWVyOiBgcmVzZXQtcGFzc3dvcmQ6JHt2ZXJpZmljYXRpb25Ub2tlbn1gLFxuICAgICAgICBleHBpcmVzQXRcbiAgICAgIH0sXG4gICAgICBjdHhcbiAgICApO1xuICAgIGNvbnN0IGNhbGxiYWNrVVJMID0gcmVkaXJlY3RUbyA/IGVuY29kZVVSSUNvbXBvbmVudChyZWRpcmVjdFRvKSA6IFwiXCI7XG4gICAgY29uc3QgdXJsID0gYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vcmVzZXQtcGFzc3dvcmQvJHt2ZXJpZmljYXRpb25Ub2tlbn0/Y2FsbGJhY2tVUkw9JHtjYWxsYmFja1VSTH1gO1xuICAgIGF3YWl0IGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZC5zZW5kUmVzZXRQYXNzd29yZChcbiAgICAgIHtcbiAgICAgICAgdXNlcjogdXNlci51c2VyLFxuICAgICAgICB1cmwsXG4gICAgICAgIHRva2VuOiB2ZXJpZmljYXRpb25Ub2tlblxuICAgICAgfSxcbiAgICAgIGN0eC5yZXF1ZXN0XG4gICAgKTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG5jb25zdCBmb3JnZXRQYXNzd29yZCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvZm9yZ2V0LXBhc3N3b3JkXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIC8qKlxuICAgICAgICogVGhlIGVtYWlsIGFkZHJlc3Mgb2YgdGhlIHVzZXIgdG8gc2VuZCBhIHBhc3N3b3JkIHJlc2V0IGVtYWlsIHRvLlxuICAgICAgICovXG4gICAgICBlbWFpbDogei5zdHJpbmcoKS5lbWFpbCgpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgZW1haWwgYWRkcmVzcyBvZiB0aGUgdXNlciB0byBzZW5kIGEgcGFzc3dvcmQgcmVzZXQgZW1haWwgdG9cIlxuICAgICAgfSksXG4gICAgICAvKipcbiAgICAgICAqIFRoZSBVUkwgdG8gcmVkaXJlY3QgdGhlIHVzZXIgdG8gcmVzZXQgdGhlaXIgcGFzc3dvcmQuXG4gICAgICAgKiBJZiB0aGUgdG9rZW4gaXNuJ3QgdmFsaWQgb3IgZXhwaXJlZCwgaXQnbGwgYmUgcmVkaXJlY3RlZCB3aXRoIGEgcXVlcnkgcGFyYW1ldGVyIGA/XG4gICAgICAgKiBlcnJvcj1JTlZBTElEX1RPS0VOYC4gSWYgdGhlIHRva2VuIGlzIHZhbGlkLCBpdCdsbCBiZSByZWRpcmVjdGVkIHdpdGggYSBxdWVyeSBwYXJhbWV0ZXIgYD9cbiAgICAgICAqIHRva2VuPVZBTElEX1RPS0VOXG4gICAgICAgKi9cbiAgICAgIHJlZGlyZWN0VG86IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gcmVkaXJlY3QgdGhlIHVzZXIgdG8gcmVzZXQgdGhlaXIgcGFzc3dvcmQuIElmIHRoZSB0b2tlbiBpc24ndCB2YWxpZCBvciBleHBpcmVkLCBpdCdsbCBiZSByZWRpcmVjdGVkIHdpdGggYSBxdWVyeSBwYXJhbWV0ZXIgYD9lcnJvcj1JTlZBTElEX1RPS0VOYC4gSWYgdGhlIHRva2VuIGlzIHZhbGlkLCBpdCdsbCBiZSByZWRpcmVjdGVkIHdpdGggYSBxdWVyeSBwYXJhbWV0ZXIgYD90b2tlbj1WQUxJRF9UT0tFTlwiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiU2VuZCBhIHBhc3N3b3JkIHJlc2V0IGVtYWlsIHRvIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8uc2VuZFJlc2V0UGFzc3dvcmQpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgXCJSZXNldCBwYXNzd29yZCBpc24ndCBlbmFibGVkLlBsZWFzZSBwYXNzIGFuIGVtYWlsQW5kUGFzc3dvcmQuc2VuZFJlc2V0UGFzc3dvcmQgZnVuY3Rpb24gaW4geW91ciBhdXRoIGNvbmZpZyFcIlxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJSZXNldCBwYXNzd29yZCBpc24ndCBlbmFibGVkXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB7IGVtYWlsLCByZWRpcmVjdFRvIH0gPSBjdHguYm9keTtcbiAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlFbWFpbChlbWFpbCwge1xuICAgICAgaW5jbHVkZUFjY291bnRzOiB0cnVlXG4gICAgfSk7XG4gICAgaWYgKCF1c2VyKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJSZXNldCBQYXNzd29yZDogVXNlciBub3QgZm91bmRcIiwgeyBlbWFpbCB9KTtcbiAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgIHN0YXR1czogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogXCJJZiB0aGlzIGVtYWlsIGV4aXN0cyBpbiBvdXIgc3lzdGVtLCBjaGVjayB5b3VyIGVtYWlsIGZvciB0aGUgcmVzZXQgbGlua1wiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgZGVmYXVsdEV4cGlyZXNJbiA9IDYwICogNjAgKiAxO1xuICAgIGNvbnN0IGV4cGlyZXNBdCA9IGdldERhdGUoXG4gICAgICBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQucmVzZXRQYXNzd29yZFRva2VuRXhwaXJlc0luIHx8IGRlZmF1bHRFeHBpcmVzSW4sXG4gICAgICBcInNlY1wiXG4gICAgKTtcbiAgICBjb25zdCB2ZXJpZmljYXRpb25Ub2tlbiA9IGdlbmVyYXRlSWQoMjQpO1xuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgIHtcbiAgICAgICAgdmFsdWU6IHVzZXIudXNlci5pZCxcbiAgICAgICAgaWRlbnRpZmllcjogYHJlc2V0LXBhc3N3b3JkOiR7dmVyaWZpY2F0aW9uVG9rZW59YCxcbiAgICAgICAgZXhwaXJlc0F0XG4gICAgICB9LFxuICAgICAgY3R4XG4gICAgKTtcbiAgICBjb25zdCBjYWxsYmFja1VSTCA9IHJlZGlyZWN0VG8gPyBlbmNvZGVVUklDb21wb25lbnQocmVkaXJlY3RUbykgOiBcIlwiO1xuICAgIGNvbnN0IHVybCA9IGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L3Jlc2V0LXBhc3N3b3JkLyR7dmVyaWZpY2F0aW9uVG9rZW59P2NhbGxiYWNrVVJMPSR7Y2FsbGJhY2tVUkx9YDtcbiAgICBhd2FpdCBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQuc2VuZFJlc2V0UGFzc3dvcmQoXG4gICAgICB7XG4gICAgICAgIHVzZXI6IHVzZXIudXNlcixcbiAgICAgICAgdXJsLFxuICAgICAgICB0b2tlbjogdmVyaWZpY2F0aW9uVG9rZW5cbiAgICAgIH0sXG4gICAgICBjdHgucmVxdWVzdFxuICAgICk7XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN0YXR1czogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xuY29uc3QgcmVxdWVzdFBhc3N3b3JkUmVzZXRDYWxsYmFjayA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvcmVzZXQtcGFzc3dvcmQvOnRva2VuXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgcXVlcnk6IHoub2JqZWN0KHtcbiAgICAgIGNhbGxiYWNrVVJMOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHJlZGlyZWN0IHRoZSB1c2VyIHRvIHJlc2V0IHRoZWlyIHBhc3N3b3JkXCJcbiAgICAgIH0pXG4gICAgfSksXG4gICAgdXNlOiBbb3JpZ2luQ2hlY2soKGN0eCkgPT4gY3R4LnF1ZXJ5LmNhbGxiYWNrVVJMKV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiUmVkaXJlY3RzIHRoZSB1c2VyIHRvIHRoZSBjYWxsYmFjayBVUkwgd2l0aCB0aGUgdG9rZW5cIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgdG9rZW46IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCB7IHRva2VuIH0gPSBjdHgucGFyYW1zO1xuICAgIGNvbnN0IHsgY2FsbGJhY2tVUkwgfSA9IGN0eC5xdWVyeTtcbiAgICBpZiAoIXRva2VuIHx8ICFjYWxsYmFja1VSTCkge1xuICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KFxuICAgICAgICByZWRpcmVjdEVycm9yKGN0eC5jb250ZXh0LCBjYWxsYmFja1VSTCwgeyBlcnJvcjogXCJJTlZBTElEX1RPS0VOXCIgfSlcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IHZlcmlmaWNhdGlvbiA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVmVyaWZpY2F0aW9uVmFsdWUoXG4gICAgICBgcmVzZXQtcGFzc3dvcmQ6JHt0b2tlbn1gXG4gICAgKTtcbiAgICBpZiAoIXZlcmlmaWNhdGlvbiB8fCB2ZXJpZmljYXRpb24uZXhwaXJlc0F0IDwgLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpIHtcbiAgICAgIHRocm93IGN0eC5yZWRpcmVjdChcbiAgICAgICAgcmVkaXJlY3RFcnJvcihjdHguY29udGV4dCwgY2FsbGJhY2tVUkwsIHsgZXJyb3I6IFwiSU5WQUxJRF9UT0tFTlwiIH0pXG4gICAgICApO1xuICAgIH1cbiAgICB0aHJvdyBjdHgucmVkaXJlY3QocmVkaXJlY3RDYWxsYmFjayhjdHguY29udGV4dCwgY2FsbGJhY2tVUkwsIHsgdG9rZW4gfSkpO1xuICB9XG4pO1xuY29uc3QgZm9yZ2V0UGFzc3dvcmRDYWxsYmFjayA9IHJlcXVlc3RQYXNzd29yZFJlc2V0Q2FsbGJhY2s7XG5jb25zdCByZXNldFBhc3N3b3JkID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9yZXNldC1wYXNzd29yZFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBxdWVyeTogei5vYmplY3Qoe1xuICAgICAgdG9rZW46IHouc3RyaW5nKCkub3B0aW9uYWwoKVxuICAgIH0pLm9wdGlvbmFsKCksXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgbmV3UGFzc3dvcmQ6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBuZXcgcGFzc3dvcmQgdG8gc2V0XCJcbiAgICAgIH0pLFxuICAgICAgdG9rZW46IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB0b2tlbiB0byByZXNldCB0aGUgcGFzc3dvcmRcIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlJlc2V0IHRoZSBwYXNzd29yZCBmb3IgYSB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCB0b2tlbiA9IGN0eC5ib2R5LnRva2VuIHx8IGN0eC5xdWVyeT8udG9rZW47XG4gICAgaWYgKCF0b2tlbikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfVE9LRU5cbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB7IG5ld1Bhc3N3b3JkIH0gPSBjdHguYm9keTtcbiAgICBjb25zdCBtaW5MZW5ndGggPSBjdHguY29udGV4dC5wYXNzd29yZD8uY29uZmlnLm1pblBhc3N3b3JkTGVuZ3RoO1xuICAgIGNvbnN0IG1heExlbmd0aCA9IGN0eC5jb250ZXh0LnBhc3N3b3JkPy5jb25maWcubWF4UGFzc3dvcmRMZW5ndGg7XG4gICAgaWYgKG5ld1Bhc3N3b3JkLmxlbmd0aCA8IG1pbkxlbmd0aCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlBBU1NXT1JEX1RPT19TSE9SVFxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChuZXdQYXNzd29yZC5sZW5ndGggPiBtYXhMZW5ndGgpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5QQVNTV09SRF9UT09fTE9OR1xuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGlkID0gYHJlc2V0LXBhc3N3b3JkOiR7dG9rZW59YDtcbiAgICBjb25zdCB2ZXJpZmljYXRpb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFZlcmlmaWNhdGlvblZhbHVlKGlkKTtcbiAgICBpZiAoIXZlcmlmaWNhdGlvbiB8fCB2ZXJpZmljYXRpb24uZXhwaXJlc0F0IDwgLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX1RPS0VOXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgdXNlcklkID0gdmVyaWZpY2F0aW9uLnZhbHVlO1xuICAgIGNvbnN0IGhhc2hlZFBhc3N3b3JkID0gYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQuaGFzaChuZXdQYXNzd29yZCk7XG4gICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKHVzZXJJZCk7XG4gICAgY29uc3QgYWNjb3VudCA9IGFjY291bnRzLmZpbmQoKGFjKSA9PiBhYy5wcm92aWRlcklkID09PSBcImNyZWRlbnRpYWxcIik7XG4gICAgaWYgKCFhY2NvdW50KSB7XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuY3JlYXRlQWNjb3VudChcbiAgICAgICAge1xuICAgICAgICAgIHVzZXJJZCxcbiAgICAgICAgICBwcm92aWRlcklkOiBcImNyZWRlbnRpYWxcIixcbiAgICAgICAgICBwYXNzd29yZDogaGFzaGVkUGFzc3dvcmQsXG4gICAgICAgICAgYWNjb3VudElkOiB1c2VySWRcbiAgICAgICAgfSxcbiAgICAgICAgY3R4XG4gICAgICApO1xuICAgIH0gZWxzZSB7XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlUGFzc3dvcmQoXG4gICAgICAgIHVzZXJJZCxcbiAgICAgICAgaGFzaGVkUGFzc3dvcmQsXG4gICAgICAgIGN0eFxuICAgICAgKTtcbiAgICB9XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVZlcmlmaWNhdGlvblZhbHVlKHZlcmlmaWNhdGlvbi5pZCk7XG4gICAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8ub25QYXNzd29yZFJlc2V0KSB7XG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRVc2VyQnlJZCh1c2VySWQpO1xuICAgICAgaWYgKHVzZXIpIHtcbiAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkLm9uUGFzc3dvcmRSZXNldChcbiAgICAgICAgICB7XG4gICAgICAgICAgICB1c2VyXG4gICAgICAgICAgfSxcbiAgICAgICAgICBjdHgucmVxdWVzdFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5yZXZva2VTZXNzaW9uc09uUGFzc3dvcmRSZXNldCkge1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb25zKHVzZXJJZCk7XG4gICAgfVxuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdGF0dXM6IHRydWVcbiAgICB9KTtcbiAgfVxuKTtcblxuY29uc3QgdXBkYXRlVXNlciA9ICgpID0+IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvdXBkYXRlLXVzZXJcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5yZWNvcmQoXG4gICAgICB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJGaWVsZCBuYW1lIG11c3QgYmUgYSBzdHJpbmdcIlxuICAgICAgfSksXG4gICAgICB6LmFueSgpXG4gICAgKSxcbiAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgICRJbmZlcjoge1xuICAgICAgICBib2R5OiB7fVxuICAgICAgfSxcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVXBkYXRlIHRoZSBjdXJyZW50IHVzZXJcIixcbiAgICAgICAgcmVxdWVzdEJvZHk6IHtcbiAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgIG5hbWU6IHtcbiAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG5hbWUgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIGltYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBpbWFnZSBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9LFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbmRpY2F0ZXMgaWYgdGhlIHVwZGF0ZSB3YXMgc3VjY2Vzc2Z1bFwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBib2R5ID0gY3R4LmJvZHk7XG4gICAgaWYgKGJvZHkuZW1haWwpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5FTUFJTF9DQU5fTk9UX0JFX1VQREFURURcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB7IG5hbWUsIGltYWdlLCAuLi5yZXN0IH0gPSBib2R5O1xuICAgIGNvbnN0IHNlc3Npb24gPSBjdHguY29udGV4dC5zZXNzaW9uO1xuICAgIGlmIChpbWFnZSA9PT0gdm9pZCAwICYmIG5hbWUgPT09IHZvaWQgMCAmJiBPYmplY3Qua2V5cyhyZXN0KS5sZW5ndGggPT09IDApIHtcbiAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgIHN0YXR1czogdHJ1ZVxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGFkZGl0aW9uYWxGaWVsZHMgPSBwYXJzZVVzZXJJbnB1dChcbiAgICAgIGN0eC5jb250ZXh0Lm9wdGlvbnMsXG4gICAgICByZXN0LFxuICAgICAgXCJ1cGRhdGVcIlxuICAgICk7XG4gICAgY29uc3QgdXNlciA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyKFxuICAgICAgc2Vzc2lvbi51c2VyLmlkLFxuICAgICAge1xuICAgICAgICBuYW1lLFxuICAgICAgICBpbWFnZSxcbiAgICAgICAgLi4uYWRkaXRpb25hbEZpZWxkc1xuICAgICAgfSxcbiAgICAgIGN0eFxuICAgICk7XG4gICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShjdHgsIHtcbiAgICAgIHNlc3Npb246IHNlc3Npb24uc2Vzc2lvbixcbiAgICAgIHVzZXJcbiAgICB9KTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG5jb25zdCBjaGFuZ2VQYXNzd29yZCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvY2hhbmdlLXBhc3N3b3JkXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIC8qKlxuICAgICAgICogVGhlIG5ldyBwYXNzd29yZCB0byBzZXRcbiAgICAgICAqL1xuICAgICAgbmV3UGFzc3dvcmQ6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBuZXcgcGFzc3dvcmQgdG8gc2V0XCJcbiAgICAgIH0pLFxuICAgICAgLyoqXG4gICAgICAgKiBUaGUgY3VycmVudCBwYXNzd29yZCBvZiB0aGUgdXNlclxuICAgICAgICovXG4gICAgICBjdXJyZW50UGFzc3dvcmQ6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBjdXJyZW50IHBhc3N3b3JkIGlzIHJlcXVpcmVkXCJcbiAgICAgIH0pLFxuICAgICAgLyoqXG4gICAgICAgKiByZXZva2UgYWxsIHNlc3Npb25zIHRoYXQgYXJlIG5vdCB0aGVcbiAgICAgICAqIGN1cnJlbnQgb25lIGxvZ2dlZCBpbiBieSB0aGUgdXNlclxuICAgICAgICovXG4gICAgICByZXZva2VPdGhlclNlc3Npb25zOiB6LmJvb2xlYW4oKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiTXVzdCBiZSBhIGJvb2xlYW4gdmFsdWVcIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJDaGFuZ2UgdGhlIHBhc3N3b3JkIG9mIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlBhc3N3b3JkIHN1Y2Nlc3NmdWxseSBjaGFuZ2VkXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICB0b2tlbjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgbnVsbGFibGU6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgICAgLy8gT25seSBwcmVzZW50IGlmIHJldm9rZU90aGVyU2Vzc2lvbnMgaXMgdHJ1ZVxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIk5ldyBzZXNzaW9uIHRva2VuIGlmIG90aGVyIHNlc3Npb25zIHdlcmUgcmV2b2tlZFwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlkOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB1bmlxdWUgaWRlbnRpZmllciBvZiB0aGUgdXNlclwiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW1haWw6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcImVtYWlsXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBlbWFpbCBhZGRyZXNzIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBuYW1lIG9mIHRoZSB1c2VyXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwidXJpXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIG51bGxhYmxlOiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgcHJvZmlsZSBpbWFnZSBVUkwgb2YgdGhlIHVzZXJcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsVmVyaWZpZWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIldoZXRoZXIgdGhlIGVtYWlsIGhhcyBiZWVuIHZlcmlmaWVkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBjcmVhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcImRhdGUtdGltZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJXaGVuIHRoZSB1c2VyIHdhcyBjcmVhdGVkXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICB1cGRhdGVkQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcImRhdGUtdGltZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJXaGVuIHRoZSB1c2VyIHdhcyBsYXN0IHVwZGF0ZWRcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiaWRcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwiZW1haWxcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIFwibmFtZVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJlbWFpbFZlcmlmaWVkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgICBcImNyZWF0ZWRBdFwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgXCJ1cGRhdGVkQXRcIlxuICAgICAgICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJ1c2VyXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3QgeyBuZXdQYXNzd29yZCwgY3VycmVudFBhc3N3b3JkLCByZXZva2VPdGhlclNlc3Npb25zIH0gPSBjdHguYm9keTtcbiAgICBjb25zdCBzZXNzaW9uID0gY3R4LmNvbnRleHQuc2Vzc2lvbjtcbiAgICBjb25zdCBtaW5QYXNzd29yZExlbmd0aCA9IGN0eC5jb250ZXh0LnBhc3N3b3JkLmNvbmZpZy5taW5QYXNzd29yZExlbmd0aDtcbiAgICBpZiAobmV3UGFzc3dvcmQubGVuZ3RoIDwgbWluUGFzc3dvcmRMZW5ndGgpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlBhc3N3b3JkIGlzIHRvbyBzaG9ydFwiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5QQVNTV09SRF9UT09fU0hPUlRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBtYXhQYXNzd29yZExlbmd0aCA9IGN0eC5jb250ZXh0LnBhc3N3b3JkLmNvbmZpZy5tYXhQYXNzd29yZExlbmd0aDtcbiAgICBpZiAobmV3UGFzc3dvcmQubGVuZ3RoID4gbWF4UGFzc3dvcmRMZW5ndGgpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlBhc3N3b3JkIGlzIHRvbyBsb25nXCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlBBU1NXT1JEX1RPT19MT05HXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKFxuICAgICAgc2Vzc2lvbi51c2VyLmlkXG4gICAgKTtcbiAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudHMuZmluZChcbiAgICAgIChhY2NvdW50MikgPT4gYWNjb3VudDIucHJvdmlkZXJJZCA9PT0gXCJjcmVkZW50aWFsXCIgJiYgYWNjb3VudDIucGFzc3dvcmRcbiAgICApO1xuICAgIGlmICghYWNjb3VudCB8fCAhYWNjb3VudC5wYXNzd29yZCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkNSRURFTlRJQUxfQUNDT1VOVF9OT1RfRk9VTkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBwYXNzd29yZEhhc2ggPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC5oYXNoKG5ld1Bhc3N3b3JkKTtcbiAgICBjb25zdCB2ZXJpZnkgPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC52ZXJpZnkoe1xuICAgICAgaGFzaDogYWNjb3VudC5wYXNzd29yZCxcbiAgICAgIHBhc3N3b3JkOiBjdXJyZW50UGFzc3dvcmRcbiAgICB9KTtcbiAgICBpZiAoIXZlcmlmeSkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfUEFTU1dPUkRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlQWNjb3VudChhY2NvdW50LmlkLCB7XG4gICAgICBwYXNzd29yZDogcGFzc3dvcmRIYXNoXG4gICAgfSk7XG4gICAgbGV0IHRva2VuID0gbnVsbDtcbiAgICBpZiAocmV2b2tlT3RoZXJTZXNzaW9ucykge1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb25zKHNlc3Npb24udXNlci5pZCk7XG4gICAgICBjb25zdCBuZXdTZXNzaW9uID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZVNlc3Npb24oXG4gICAgICAgIHNlc3Npb24udXNlci5pZCxcbiAgICAgICAgY3R4XG4gICAgICApO1xuICAgICAgaWYgKCFuZXdTZXNzaW9uKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fR0VUX1NFU1NJT05cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICBzZXNzaW9uOiBuZXdTZXNzaW9uLFxuICAgICAgICB1c2VyOiBzZXNzaW9uLnVzZXJcbiAgICAgIH0pO1xuICAgICAgdG9rZW4gPSBuZXdTZXNzaW9uLnRva2VuO1xuICAgIH1cbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgdG9rZW4sXG4gICAgICB1c2VyOiB7XG4gICAgICAgIGlkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgIGVtYWlsOiBzZXNzaW9uLnVzZXIuZW1haWwsXG4gICAgICAgIG5hbWU6IHNlc3Npb24udXNlci5uYW1lLFxuICAgICAgICBpbWFnZTogc2Vzc2lvbi51c2VyLmltYWdlLFxuICAgICAgICBlbWFpbFZlcmlmaWVkOiBzZXNzaW9uLnVzZXIuZW1haWxWZXJpZmllZCxcbiAgICAgICAgY3JlYXRlZEF0OiBzZXNzaW9uLnVzZXIuY3JlYXRlZEF0LFxuICAgICAgICB1cGRhdGVkQXQ6IHNlc3Npb24udXNlci51cGRhdGVkQXRcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuKTtcbmNvbnN0IHNldFBhc3N3b3JkID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9zZXQtcGFzc3dvcmRcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgLyoqXG4gICAgICAgKiBUaGUgbmV3IHBhc3N3b3JkIHRvIHNldFxuICAgICAgICovXG4gICAgICBuZXdQYXNzd29yZDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIG5ldyBwYXNzd29yZCB0byBzZXQgaXMgcmVxdWlyZWRcIlxuICAgICAgfSlcbiAgICB9KSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgU0VSVkVSX09OTFk6IHRydWVcbiAgICB9LFxuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3QgeyBuZXdQYXNzd29yZCB9ID0gY3R4LmJvZHk7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgY29uc3QgbWluUGFzc3dvcmRMZW5ndGggPSBjdHguY29udGV4dC5wYXNzd29yZC5jb25maWcubWluUGFzc3dvcmRMZW5ndGg7XG4gICAgaWYgKG5ld1Bhc3N3b3JkLmxlbmd0aCA8IG1pblBhc3N3b3JkTGVuZ3RoKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJQYXNzd29yZCBpcyB0b28gc2hvcnRcIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuUEFTU1dPUkRfVE9PX1NIT1JUXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgbWF4UGFzc3dvcmRMZW5ndGggPSBjdHguY29udGV4dC5wYXNzd29yZC5jb25maWcubWF4UGFzc3dvcmRMZW5ndGg7XG4gICAgaWYgKG5ld1Bhc3N3b3JkLmxlbmd0aCA+IG1heFBhc3N3b3JkTGVuZ3RoKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJQYXNzd29yZCBpcyB0b28gbG9uZ1wiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5QQVNTV09SRF9UT09fTE9OR1xuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50cyhcbiAgICAgIHNlc3Npb24udXNlci5pZFxuICAgICk7XG4gICAgY29uc3QgYWNjb3VudCA9IGFjY291bnRzLmZpbmQoXG4gICAgICAoYWNjb3VudDIpID0+IGFjY291bnQyLnByb3ZpZGVySWQgPT09IFwiY3JlZGVudGlhbFwiICYmIGFjY291bnQyLnBhc3N3b3JkXG4gICAgKTtcbiAgICBjb25zdCBwYXNzd29yZEhhc2ggPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC5oYXNoKG5ld1Bhc3N3b3JkKTtcbiAgICBpZiAoIWFjY291bnQpIHtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5saW5rQWNjb3VudChcbiAgICAgICAge1xuICAgICAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICAgIHByb3ZpZGVySWQ6IFwiY3JlZGVudGlhbFwiLFxuICAgICAgICAgIGFjY291bnRJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgICAgIHBhc3N3b3JkOiBwYXNzd29yZEhhc2hcbiAgICAgICAgfSxcbiAgICAgICAgY3R4XG4gICAgICApO1xuICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgc3RhdHVzOiB0cnVlXG4gICAgICB9KTtcbiAgICB9XG4gICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgbWVzc2FnZTogXCJ1c2VyIGFscmVhZHkgaGFzIGEgcGFzc3dvcmRcIlxuICAgIH0pO1xuICB9XG4pO1xuY29uc3QgZGVsZXRlVXNlciA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvZGVsZXRlLXVzZXJcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIGJvZHk6IHoub2JqZWN0KHtcbiAgICAgIC8qKlxuICAgICAgICogVGhlIGNhbGxiYWNrIFVSTCB0byByZWRpcmVjdCB0byBhZnRlciB0aGUgdXNlciBpcyBkZWxldGVkXG4gICAgICAgKiB0aGlzIGlzIG9ubHkgdXNlZCBvbiBkZWxldGUgdXNlciBjYWxsYmFja1xuICAgICAgICovXG4gICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGNhbGxiYWNrIFVSTCB0byByZWRpcmVjdCB0byBhZnRlciB0aGUgdXNlciBpcyBkZWxldGVkXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIFRoZSBwYXNzd29yZCBvZiB0aGUgdXNlci4gSWYgdGhlIHBhc3N3b3JkIGlzbid0IHByb3ZpZGVkLCBzZXNzaW9uIGZyZXNobmVzc1xuICAgICAgICogd2lsbCBiZSBjaGVja2VkLlxuICAgICAgICovXG4gICAgICBwYXNzd29yZDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHBhc3N3b3JkIG9mIHRoZSB1c2VyIGlzIHJlcXVpcmVkIHRvIGRlbGV0ZSB0aGUgdXNlclwiXG4gICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBUaGUgdG9rZW4gdG8gZGVsZXRlIHRoZSB1c2VyLiBJZiB0aGUgdG9rZW4gaXMgcHJvdmlkZWQsIHRoZSB1c2VyIHdpbGwgYmUgZGVsZXRlZFxuICAgICAgICovXG4gICAgICB0b2tlbjogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIHRva2VuIHRvIGRlbGV0ZSB0aGUgdXNlciBpcyByZXF1aXJlZFwiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiRGVsZXRlIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlVzZXIgZGVsZXRpb24gcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseVwiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2Vzczoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluZGljYXRlcyBpZiB0aGUgb3BlcmF0aW9uIHdhcyBzdWNjZXNzZnVsXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZW51bTogW1wiVXNlciBkZWxldGVkXCIsIFwiVmVyaWZpY2F0aW9uIGVtYWlsIHNlbnRcIl0sXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3RhdHVzIG1lc3NhZ2Ugb2YgdGhlIGRlbGV0aW9uIHByb2Nlc3NcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInN1Y2Nlc3NcIiwgXCJtZXNzYWdlXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zLnVzZXI/LmRlbGV0ZVVzZXI/LmVuYWJsZWQpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgXCJEZWxldGUgdXNlciBpcyBkaXNhYmxlZC4gRW5hYmxlIGl0IGluIHRoZSBvcHRpb25zXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBzZXNzaW9uOiBjdHguY29udGV4dC5zZXNzaW9uXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIik7XG4gICAgfVxuICAgIGNvbnN0IHNlc3Npb24gPSBjdHguY29udGV4dC5zZXNzaW9uO1xuICAgIGlmIChjdHguYm9keS5wYXNzd29yZCkge1xuICAgICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKFxuICAgICAgICBzZXNzaW9uLnVzZXIuaWRcbiAgICAgICk7XG4gICAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudHMuZmluZChcbiAgICAgICAgKGFjY291bnQyKSA9PiBhY2NvdW50Mi5wcm92aWRlcklkID09PSBcImNyZWRlbnRpYWxcIiAmJiBhY2NvdW50Mi5wYXNzd29yZFxuICAgICAgKTtcbiAgICAgIGlmICghYWNjb3VudCB8fCAhYWNjb3VudC5wYXNzd29yZCkge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5DUkVERU5USUFMX0FDQ09VTlRfTk9UX0ZPVU5EXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgdmVyaWZ5ID0gYXdhaXQgY3R4LmNvbnRleHQucGFzc3dvcmQudmVyaWZ5KHtcbiAgICAgICAgaGFzaDogYWNjb3VudC5wYXNzd29yZCxcbiAgICAgICAgcGFzc3dvcmQ6IGN0eC5ib2R5LnBhc3N3b3JkXG4gICAgICB9KTtcbiAgICAgIGlmICghdmVyaWZ5KSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfUEFTU1dPUkRcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICAgIGlmIChjdHguYm9keS50b2tlbikge1xuICAgICAgYXdhaXQgZGVsZXRlVXNlckNhbGxiYWNrKHtcbiAgICAgICAgLi4uY3R4LFxuICAgICAgICBxdWVyeToge1xuICAgICAgICAgIHRva2VuOiBjdHguYm9keS50b2tlblxuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICAgIG1lc3NhZ2U6IFwiVXNlciBkZWxldGVkXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoY3R4LmNvbnRleHQub3B0aW9ucy51c2VyLmRlbGV0ZVVzZXI/LnNlbmREZWxldGVBY2NvdW50VmVyaWZpY2F0aW9uKSB7XG4gICAgICBjb25zdCB0b2tlbiA9IGdlbmVyYXRlUmFuZG9tU3RyaW5nKDMyLCBcIjAtOVwiLCBcImEtelwiKTtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5jcmVhdGVWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgICAge1xuICAgICAgICAgIHZhbHVlOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgICAgaWRlbnRpZmllcjogYGRlbGV0ZS1hY2NvdW50LSR7dG9rZW59YCxcbiAgICAgICAgICBleHBpcmVzQXQ6IG5ldyBEYXRlKFxuICAgICAgICAgICAgRGF0ZS5ub3coKSArIChjdHguY29udGV4dC5vcHRpb25zLnVzZXIuZGVsZXRlVXNlcj8uZGVsZXRlVG9rZW5FeHBpcmVzSW4gfHwgNjAgKiA2MCAqIDI0KSAqIDFlM1xuICAgICAgICAgIClcbiAgICAgICAgfSxcbiAgICAgICAgY3R4XG4gICAgICApO1xuICAgICAgY29uc3QgdXJsID0gYCR7Y3R4LmNvbnRleHQuYmFzZVVSTH0vZGVsZXRlLXVzZXIvY2FsbGJhY2s/dG9rZW49JHt0b2tlbn0mY2FsbGJhY2tVUkw9JHtjdHguYm9keS5jYWxsYmFja1VSTCB8fCBcIi9cIn1gO1xuICAgICAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy51c2VyLmRlbGV0ZVVzZXIuc2VuZERlbGV0ZUFjY291bnRWZXJpZmljYXRpb24oXG4gICAgICAgIHtcbiAgICAgICAgICB1c2VyOiBzZXNzaW9uLnVzZXIsXG4gICAgICAgICAgdXJsLFxuICAgICAgICAgIHRva2VuXG4gICAgICAgIH0sXG4gICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICApO1xuICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgICAgbWVzc2FnZTogXCJWZXJpZmljYXRpb24gZW1haWwgc2VudFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKCFjdHguYm9keS5wYXNzd29yZCAmJiBjdHguY29udGV4dC5zZXNzaW9uQ29uZmlnLmZyZXNoQWdlICE9PSAwKSB7XG4gICAgICBjb25zdCBjdXJyZW50QWdlID0gbmV3IERhdGUoc2Vzc2lvbi5zZXNzaW9uLmNyZWF0ZWRBdCkuZ2V0VGltZSgpO1xuICAgICAgY29uc3QgZnJlc2hBZ2UgPSBjdHguY29udGV4dC5zZXNzaW9uQ29uZmlnLmZyZXNoQWdlICogMWUzO1xuICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgIGlmIChub3cgLSBjdXJyZW50QWdlID4gZnJlc2hBZ2UgKiAxZTMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuU0VTU0lPTl9FWFBJUkVEXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBiZWZvcmVEZWxldGUgPSBjdHguY29udGV4dC5vcHRpb25zLnVzZXIuZGVsZXRlVXNlcj8uYmVmb3JlRGVsZXRlO1xuICAgIGlmIChiZWZvcmVEZWxldGUpIHtcbiAgICAgIGF3YWl0IGJlZm9yZURlbGV0ZShzZXNzaW9uLnVzZXIsIGN0eC5yZXF1ZXN0KTtcbiAgICB9XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVVzZXIoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlU2Vzc2lvbnMoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZGVsZXRlQWNjb3VudHMoc2Vzc2lvbi51c2VyLmlkKTtcbiAgICBkZWxldGVTZXNzaW9uQ29va2llKGN0eCk7XG4gICAgY29uc3QgYWZ0ZXJEZWxldGUgPSBjdHguY29udGV4dC5vcHRpb25zLnVzZXIuZGVsZXRlVXNlcj8uYWZ0ZXJEZWxldGU7XG4gICAgaWYgKGFmdGVyRGVsZXRlKSB7XG4gICAgICBhd2FpdCBhZnRlckRlbGV0ZShzZXNzaW9uLnVzZXIsIGN0eC5yZXF1ZXN0KTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBtZXNzYWdlOiBcIlVzZXIgZGVsZXRlZFwiXG4gICAgfSk7XG4gIH1cbik7XG5jb25zdCBkZWxldGVVc2VyQ2FsbGJhY2sgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2RlbGV0ZS11c2VyL2NhbGxiYWNrXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgcXVlcnk6IHoub2JqZWN0KHtcbiAgICAgIHRva2VuOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgdG9rZW4gdG8gdmVyaWZ5IHRoZSBkZWxldGlvbiByZXF1ZXN0XCJcbiAgICAgIH0pLFxuICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gcmVkaXJlY3QgdG8gYWZ0ZXIgZGVsZXRpb25cIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIHVzZTogW29yaWdpbkNoZWNrKChjdHgpID0+IGN0eC5xdWVyeS5jYWxsYmFja1VSTCldLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkNhbGxiYWNrIHRvIGNvbXBsZXRlIHVzZXIgZGVsZXRpb24gd2l0aCB2ZXJpZmljYXRpb24gdG9rZW5cIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiVXNlciBzdWNjZXNzZnVsbHkgZGVsZXRlZFwiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3VjY2Vzczoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluZGljYXRlcyBpZiB0aGUgZGVsZXRpb24gd2FzIHN1Y2Nlc3NmdWxcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBtZXNzYWdlOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICBlbnVtOiBbXCJVc2VyIGRlbGV0ZWRcIl0sXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiQ29uZmlybWF0aW9uIG1lc3NhZ2VcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInN1Y2Nlc3NcIiwgXCJtZXNzYWdlXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgaWYgKCFjdHguY29udGV4dC5vcHRpb25zLnVzZXI/LmRlbGV0ZVVzZXI/LmVuYWJsZWQpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcbiAgICAgICAgXCJEZWxldGUgdXNlciBpcyBkaXNhYmxlZC4gRW5hYmxlIGl0IGluIHRoZSBvcHRpb25zXCJcbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIik7XG4gICAgfVxuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiTk9UX0ZPVU5EXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fR0VUX1VTRVJfSU5GT1xuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IHRva2VuID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRWZXJpZmljYXRpb25WYWx1ZShcbiAgICAgIGBkZWxldGUtYWNjb3VudC0ke2N0eC5xdWVyeS50b2tlbn1gXG4gICAgKTtcbiAgICBpZiAoIXRva2VuIHx8IHRva2VuLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLklOVkFMSURfVE9LRU5cbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAodG9rZW4udmFsdWUgIT09IHNlc3Npb24udXNlci5pZCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiTk9UX0ZPVU5EXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JTlZBTElEX1RPS0VOXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYmVmb3JlRGVsZXRlID0gY3R4LmNvbnRleHQub3B0aW9ucy51c2VyLmRlbGV0ZVVzZXI/LmJlZm9yZURlbGV0ZTtcbiAgICBpZiAoYmVmb3JlRGVsZXRlKSB7XG4gICAgICBhd2FpdCBiZWZvcmVEZWxldGUoc2Vzc2lvbi51c2VyLCBjdHgucmVxdWVzdCk7XG4gICAgfVxuICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVVc2VyKHNlc3Npb24udXNlci5pZCk7XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb25zKHNlc3Npb24udXNlci5pZCk7XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZUFjY291bnRzKHNlc3Npb24udXNlci5pZCk7XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVZlcmlmaWNhdGlvblZhbHVlKHRva2VuLmlkKTtcbiAgICBkZWxldGVTZXNzaW9uQ29va2llKGN0eCk7XG4gICAgY29uc3QgYWZ0ZXJEZWxldGUgPSBjdHguY29udGV4dC5vcHRpb25zLnVzZXIuZGVsZXRlVXNlcj8uYWZ0ZXJEZWxldGU7XG4gICAgaWYgKGFmdGVyRGVsZXRlKSB7XG4gICAgICBhd2FpdCBhZnRlckRlbGV0ZShzZXNzaW9uLnVzZXIsIGN0eC5yZXF1ZXN0KTtcbiAgICB9XG4gICAgaWYgKGN0eC5xdWVyeS5jYWxsYmFja1VSTCkge1xuICAgICAgdGhyb3cgY3R4LnJlZGlyZWN0KGN0eC5xdWVyeS5jYWxsYmFja1VSTCB8fCBcIi9cIik7XG4gICAgfVxuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgbWVzc2FnZTogXCJVc2VyIGRlbGV0ZWRcIlxuICAgIH0pO1xuICB9XG4pO1xuY29uc3QgY2hhbmdlRW1haWwgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL2NoYW5nZS1lbWFpbFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBuZXdFbWFpbDogei5lbWFpbCgpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgbmV3IGVtYWlsIGFkZHJlc3MgdG8gc2V0IG11c3QgYmUgYSB2YWxpZCBlbWFpbCBhZGRyZXNzXCJcbiAgICAgIH0pLFxuICAgICAgY2FsbGJhY2tVUkw6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBVUkwgdG8gcmVkaXJlY3QgdG8gYWZ0ZXIgZW1haWwgdmVyaWZpY2F0aW9uXCJcbiAgICAgIH0pLm9wdGlvbmFsKClcbiAgICB9KSxcbiAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiRW1haWwgY2hhbmdlIHJlcXVlc3QgcHJvY2Vzc2VkIHN1Y2Nlc3NmdWxseVwiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiSW5kaWNhdGVzIGlmIHRoZSByZXF1ZXN0IHdhcyBzdWNjZXNzZnVsXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgbWVzc2FnZToge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgICAgZW51bTogW1wiRW1haWwgdXBkYXRlZFwiLCBcIlZlcmlmaWNhdGlvbiBlbWFpbCBzZW50XCJdLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN0YXR1cyBtZXNzYWdlIG9mIHRoZSBlbWFpbCBjaGFuZ2UgcHJvY2Vzc1wiLFxuICAgICAgICAgICAgICAgICAgICAgIG51bGxhYmxlOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wic3RhdHVzXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBcIjQyMlwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJVbnByb2Nlc3NhYmxlIEVudGl0eS4gRW1haWwgYWxyZWFkeSBleGlzdHNcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIG1lc3NhZ2U6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnMudXNlcj8uY2hhbmdlRW1haWw/LmVuYWJsZWQpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkNoYW5nZSBlbWFpbCBpcyBkaXNhYmxlZC5cIik7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiQ2hhbmdlIGVtYWlsIGlzIGRpc2FibGVkXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBuZXdFbWFpbCA9IGN0eC5ib2R5Lm5ld0VtYWlsLnRvTG93ZXJDYXNlKCk7XG4gICAgaWYgKG5ld0VtYWlsID09PSBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuZW1haWwpIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIkVtYWlsIGlzIHRoZSBzYW1lXCIpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkVtYWlsIGlzIHRoZSBzYW1lXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBleGlzdGluZ1VzZXIgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFVzZXJCeUVtYWlsKG5ld0VtYWlsKTtcbiAgICBpZiAoZXhpc3RpbmdVc2VyKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJFbWFpbCBhbHJlYWR5IGV4aXN0c1wiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJDb3VsZG4ndCB1cGRhdGUgeW91ciBlbWFpbFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5lbWFpbFZlcmlmaWVkICE9PSB0cnVlKSB7XG4gICAgICBjb25zdCBleGlzdGluZyA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kVXNlckJ5RW1haWwobmV3RW1haWwpO1xuICAgICAgaWYgKGV4aXN0aW5nKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOUFJPQ0VTU0FCTEVfRU5USVRZXCIsIHtcbiAgICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlVTRVJfQUxSRUFEWV9FWElTVFNcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlVXNlckJ5RW1haWwoXG4gICAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5lbWFpbCxcbiAgICAgICAge1xuICAgICAgICAgIGVtYWlsOiBuZXdFbWFpbFxuICAgICAgICB9LFxuICAgICAgICBjdHhcbiAgICAgICk7XG4gICAgICBhd2FpdCBzZXRTZXNzaW9uQ29va2llKGN0eCwge1xuICAgICAgICBzZXNzaW9uOiBjdHguY29udGV4dC5zZXNzaW9uLnNlc3Npb24sXG4gICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAuLi5jdHguY29udGV4dC5zZXNzaW9uLnVzZXIsXG4gICAgICAgICAgZW1haWw6IG5ld0VtYWlsXG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgICAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LnNlbmRWZXJpZmljYXRpb25FbWFpbCkge1xuICAgICAgICBjb25zdCB0b2tlbjIgPSBhd2FpdCBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuKFxuICAgICAgICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICAgICAgICBuZXdFbWFpbCxcbiAgICAgICAgICB2b2lkIDAsXG4gICAgICAgICAgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uZXhwaXJlc0luXG4gICAgICAgICk7XG4gICAgICAgIGNvbnN0IHVybDIgPSBgJHtjdHguY29udGV4dC5iYXNlVVJMfS92ZXJpZnktZW1haWw/dG9rZW49JHt0b2tlbjJ9JmNhbGxiYWNrVVJMPSR7Y3R4LmJvZHkuY2FsbGJhY2tVUkwgfHwgXCIvXCJ9YDtcbiAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbi5zZW5kVmVyaWZpY2F0aW9uRW1haWwoXG4gICAgICAgICAge1xuICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAuLi5jdHguY29udGV4dC5zZXNzaW9uLnVzZXIsXG4gICAgICAgICAgICAgIGVtYWlsOiBuZXdFbWFpbFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHVybDogdXJsMixcbiAgICAgICAgICAgIHRva2VuOiB0b2tlbjJcbiAgICAgICAgICB9LFxuICAgICAgICAgIGN0eC5yZXF1ZXN0XG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgICBzdGF0dXM6IHRydWVcbiAgICAgIH0pO1xuICAgIH1cbiAgICBpZiAoIWN0eC5jb250ZXh0Lm9wdGlvbnMudXNlci5jaGFuZ2VFbWFpbC5zZW5kQ2hhbmdlRW1haWxWZXJpZmljYXRpb24pIHtcbiAgICAgIGN0eC5jb250ZXh0LmxvZ2dlci5lcnJvcihcIlZlcmlmaWNhdGlvbiBlbWFpbCBpc24ndCBlbmFibGVkLlwiKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJWZXJpZmljYXRpb24gZW1haWwgaXNuJ3QgZW5hYmxlZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgdG9rZW4gPSBhd2FpdCBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuKFxuICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmVtYWlsLFxuICAgICAgbmV3RW1haWwsXG4gICAgICBjdHguY29udGV4dC5vcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5leHBpcmVzSW5cbiAgICApO1xuICAgIGNvbnN0IHVybCA9IGAke2N0eC5jb250ZXh0LmJhc2VVUkx9L3ZlcmlmeS1lbWFpbD90b2tlbj0ke3Rva2VufSZjYWxsYmFja1VSTD0ke2N0eC5ib2R5LmNhbGxiYWNrVVJMIHx8IFwiL1wifWA7XG4gICAgYXdhaXQgY3R4LmNvbnRleHQub3B0aW9ucy51c2VyLmNoYW5nZUVtYWlsLnNlbmRDaGFuZ2VFbWFpbFZlcmlmaWNhdGlvbihcbiAgICAgIHtcbiAgICAgICAgdXNlcjogY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLFxuICAgICAgICBuZXdFbWFpbCxcbiAgICAgICAgdXJsLFxuICAgICAgICB0b2tlblxuICAgICAgfSxcbiAgICAgIGN0eC5yZXF1ZXN0XG4gICAgKTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG5cbmZ1bmN0aW9uIHNhbml0aXplKGlucHV0KSB7XG4gIHJldHVybiBpbnB1dC5yZXBsYWNlKC8mL2csIFwiJmFtcDtcIikucmVwbGFjZSgvPC9nLCBcIiZsdDtcIikucmVwbGFjZSgvPi9nLCBcIiZndDtcIikucmVwbGFjZSgvXCIvZywgXCImcXVvdDtcIikucmVwbGFjZSgvJy9nLCBcIiYjMzk7XCIpO1xufVxuY29uc3QgaHRtbCA9IChlcnJvckNvZGUgPSBcIlVua25vd25cIikgPT4gYDwhRE9DVFlQRSBodG1sPlxuPGh0bWwgbGFuZz1cImVuXCI+XG48aGVhZD5cbiAgICA8bWV0YSBjaGFyc2V0PVwiVVRGLThcIj5cbiAgICA8bWV0YSBuYW1lPVwidmlld3BvcnRcIiBjb250ZW50PVwid2lkdGg9ZGV2aWNlLXdpZHRoLCBpbml0aWFsLXNjYWxlPTEuMFwiPlxuICAgIDx0aXRsZT5BdXRoZW50aWNhdGlvbiBFcnJvcjwvdGl0bGU+XG4gICAgPHN0eWxlPlxuICAgICAgICA6cm9vdCB7XG4gICAgICAgICAgICAtLWJnLWNvbG9yOiAjZjhmOWZhO1xuICAgICAgICAgICAgLS10ZXh0LWNvbG9yOiAjMjEyNTI5O1xuICAgICAgICAgICAgLS1hY2NlbnQtY29sb3I6ICMwMDAwMDA7XG4gICAgICAgICAgICAtLWVycm9yLWNvbG9yOiAjZGMzNTQ1O1xuICAgICAgICAgICAgLS1ib3JkZXItY29sb3I6ICNlOWVjZWY7XG4gICAgICAgIH1cbiAgICAgICAgYm9keSB7XG4gICAgICAgICAgICBmb250LWZhbWlseTogLWFwcGxlLXN5c3RlbSwgQmxpbmtNYWNTeXN0ZW1Gb250LCAnU2Vnb2UgVUknLCBSb2JvdG8sICdIZWx2ZXRpY2EgTmV1ZScsIEFyaWFsLCBzYW5zLXNlcmlmO1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYmctY29sb3IpO1xuICAgICAgICAgICAgY29sb3I6IHZhcigtLXRleHQtY29sb3IpO1xuICAgICAgICAgICAgZGlzcGxheTogZmxleDtcbiAgICAgICAgICAgIGp1c3RpZnktY29udGVudDogY2VudGVyO1xuICAgICAgICAgICAgYWxpZ24taXRlbXM6IGNlbnRlcjtcbiAgICAgICAgICAgIGhlaWdodDogMTAwdmg7XG4gICAgICAgICAgICBtYXJnaW46IDA7XG4gICAgICAgICAgICBsaW5lLWhlaWdodDogMS41O1xuICAgICAgICB9XG4gICAgICAgIC5lcnJvci1jb250YWluZXIge1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogI2ZmZmZmZjtcbiAgICAgICAgICAgIGJvcmRlci1yYWRpdXM6IDEycHg7XG4gICAgICAgICAgICBib3gtc2hhZG93OiAwIDRweCA2cHggcmdiYSgwLCAwLCAwLCAwLjA1KTtcbiAgICAgICAgICAgIHBhZGRpbmc6IDIuNXJlbTtcbiAgICAgICAgICAgIHRleHQtYWxpZ246IGNlbnRlcjtcbiAgICAgICAgICAgIG1heC13aWR0aDogOTAlO1xuICAgICAgICAgICAgd2lkdGg6IDQwMHB4O1xuICAgICAgICB9XG4gICAgICAgIGgxIHtcbiAgICAgICAgICAgIGNvbG9yOiB2YXIoLS1lcnJvci1jb2xvcik7XG4gICAgICAgICAgICBmb250LXNpemU6IDEuNzVyZW07XG4gICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxcmVtO1xuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDYwMDtcbiAgICAgICAgfVxuICAgICAgICBwIHtcbiAgICAgICAgICAgIG1hcmdpbi1ib3R0b206IDEuNXJlbTtcbiAgICAgICAgICAgIGNvbG9yOiAjNDk1MDU3O1xuICAgICAgICB9XG4gICAgICAgIC5idG4ge1xuICAgICAgICAgICAgYmFja2dyb3VuZC1jb2xvcjogdmFyKC0tYWNjZW50LWNvbG9yKTtcbiAgICAgICAgICAgIGNvbG9yOiAjZmZmZmZmO1xuICAgICAgICAgICAgdGV4dC1kZWNvcmF0aW9uOiBub25lO1xuICAgICAgICAgICAgcGFkZGluZzogMC43NXJlbSAxLjVyZW07XG4gICAgICAgICAgICBib3JkZXItcmFkaXVzOiA2cHg7XG4gICAgICAgICAgICB0cmFuc2l0aW9uOiBhbGwgMC4zcyBlYXNlO1xuICAgICAgICAgICAgZGlzcGxheTogaW5saW5lLWJsb2NrO1xuICAgICAgICAgICAgZm9udC13ZWlnaHQ6IDUwMDtcbiAgICAgICAgICAgIGJvcmRlcjogMnB4IHNvbGlkIHZhcigtLWFjY2VudC1jb2xvcik7XG4gICAgICAgIH1cbiAgICAgICAgLmJ0bjpob3ZlciB7XG4gICAgICAgICAgICBiYWNrZ3JvdW5kLWNvbG9yOiAjMTMxNzIxO1xuICAgICAgICB9XG4gICAgICAgIC5lcnJvci1jb2RlIHtcbiAgICAgICAgICAgIGZvbnQtc2l6ZTogMC44NzVyZW07XG4gICAgICAgICAgICBjb2xvcjogIzZjNzU3ZDtcbiAgICAgICAgICAgIG1hcmdpbi10b3A6IDEuNXJlbTtcbiAgICAgICAgICAgIHBhZGRpbmctdG9wOiAxLjVyZW07XG4gICAgICAgICAgICBib3JkZXItdG9wOiAxcHggc29saWQgdmFyKC0tYm9yZGVyLWNvbG9yKTtcbiAgICAgICAgfVxuICAgICAgICAuaWNvbiB7XG4gICAgICAgICAgICBmb250LXNpemU6IDNyZW07XG4gICAgICAgICAgICBtYXJnaW4tYm90dG9tOiAxcmVtO1xuICAgICAgICB9XG4gICAgPC9zdHlsZT5cbjwvaGVhZD5cbjxib2R5PlxuICAgIDxkaXYgY2xhc3M9XCJlcnJvci1jb250YWluZXJcIj5cbiAgICAgICAgPGRpdiBjbGFzcz1cImljb25cIj5cXHUyNkEwXFx1RkUwRjwvZGl2PlxuICAgICAgICA8aDE+QmV0dGVyIEF1dGggRXJyb3I8L2gxPlxuICAgICAgICA8cD5XZSBlbmNvdW50ZXJlZCBhbiBpc3N1ZSB3aGlsZSBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdC4gUGxlYXNlIHRyeSBhZ2FpbiBvciBjb250YWN0IHRoZSBhcHBsaWNhdGlvbiBvd25lciBpZiB0aGUgcHJvYmxlbSBwZXJzaXN0cy48L3A+XG4gICAgICAgIDxhIGhyZWY9XCIvXCIgaWQ9XCJyZXR1cm5MaW5rXCIgY2xhc3M9XCJidG5cIj5SZXR1cm4gdG8gQXBwbGljYXRpb248L2E+XG4gICAgICAgIDxkaXYgY2xhc3M9XCJlcnJvci1jb2RlXCI+RXJyb3IgQ29kZTogPHNwYW4gaWQ9XCJlcnJvckNvZGVcIj4ke3Nhbml0aXplKFxuICBlcnJvckNvZGVcbil9PC9zcGFuPjwvZGl2PlxuICAgIDwvZGl2PlxuPC9ib2R5PlxuPC9odG1sPmA7XG5jb25zdCBlcnJvciA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvZXJyb3JcIixcbiAge1xuICAgIG1ldGhvZDogXCJHRVRcIixcbiAgICBtZXRhZGF0YToge1xuICAgICAgLi4uSElERV9NRVRBREFUQSxcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiRGlzcGxheXMgYW4gZXJyb3IgcGFnZVwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwidGV4dC9odG1sXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgSFRNTCBjb250ZW50IG9mIHRoZSBlcnJvciBwYWdlXCJcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjKSA9PiB7XG4gICAgY29uc3QgcXVlcnkgPSBuZXcgVVJMKGMucmVxdWVzdD8udXJsIHx8IFwiXCIpLnNlYXJjaFBhcmFtcy5nZXQoXCJlcnJvclwiKSB8fCBcIlVua25vd25cIjtcbiAgICByZXR1cm4gbmV3IFJlc3BvbnNlKGh0bWwocXVlcnkpLCB7XG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwidGV4dC9odG1sXCJcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuKTtcblxuY29uc3Qgb2sgPSBjcmVhdGVBdXRoRW5kcG9pbnQoXG4gIFwiL29rXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIC4uLkhJREVfTUVUQURBVEEsXG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkNoZWNrIGlmIHRoZSBBUEkgaXMgd29ya2luZ1wiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJBUEkgaXMgd29ya2luZ1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgb2s6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIixcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbmRpY2F0ZXMgaWYgdGhlIEFQSSBpcyB3b3JraW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgIHJlcXVpcmVkOiBbXCJva1wiXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBvazogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xuXG5jb25zdCBsaXN0VXNlckFjY291bnRzID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9saXN0LWFjY291bnRzXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkxpc3QgYWxsIGFjY291bnRzIGxpbmtlZCB0byB0aGUgdXNlclwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICBcIjIwMFwiOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJTdWNjZXNzXCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcImFycmF5XCIsXG4gICAgICAgICAgICAgICAgICBpdGVtczoge1xuICAgICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgaWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIHByb3ZpZGVySWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogXCJkYXRlLXRpbWVcIlxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgdXBkYXRlZEF0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBcImRhdGUtdGltZVwiXG4gICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICBhY2NvdW50SWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgIHNjb3Blczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJhcnJheVwiLFxuICAgICAgICAgICAgICAgICAgICAgICAgaXRlbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcbiAgICAgICAgICAgICAgICAgICAgICBcImlkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgXCJwcm92aWRlcklkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgXCJjcmVhdGVkQXRcIixcbiAgICAgICAgICAgICAgICAgICAgICBcInVwZGF0ZWRBdFwiLFxuICAgICAgICAgICAgICAgICAgICAgIFwiYWNjb3VudElkXCIsXG4gICAgICAgICAgICAgICAgICAgICAgXCJzY29wZXNcIlxuICAgICAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoYykgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBjLmNvbnRleHQuc2Vzc2lvbjtcbiAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKFxuICAgICAgc2Vzc2lvbi51c2VyLmlkXG4gICAgKTtcbiAgICByZXR1cm4gYy5qc29uKFxuICAgICAgYWNjb3VudHMubWFwKChhKSA9PiAoe1xuICAgICAgICBpZDogYS5pZCxcbiAgICAgICAgcHJvdmlkZXJJZDogYS5wcm92aWRlcklkLFxuICAgICAgICBjcmVhdGVkQXQ6IGEuY3JlYXRlZEF0LFxuICAgICAgICB1cGRhdGVkQXQ6IGEudXBkYXRlZEF0LFxuICAgICAgICBhY2NvdW50SWQ6IGEuYWNjb3VudElkLFxuICAgICAgICBzY29wZXM6IGEuc2NvcGU/LnNwbGl0KFwiLFwiKSB8fCBbXVxuICAgICAgfSkpXG4gICAgKTtcbiAgfVxuKTtcbmNvbnN0IGxpbmtTb2NpYWxBY2NvdW50ID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9saW5rLXNvY2lhbFwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICByZXF1aXJlSGVhZGVyczogdHJ1ZSxcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICAvKipcbiAgICAgICAqIENhbGxiYWNrIFVSTCB0byByZWRpcmVjdCB0byBhZnRlciB0aGUgdXNlciBoYXMgc2lnbmVkIGluLlxuICAgICAgICovXG4gICAgICBjYWxsYmFja1VSTDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIFVSTCB0byByZWRpcmVjdCB0byBhZnRlciB0aGUgdXNlciBoYXMgc2lnbmVkIGluXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIE9BdXRoMiBwcm92aWRlciB0byB1c2VcbiAgICAgICAqL1xuICAgICAgcHJvdmlkZXI6IFNvY2lhbFByb3ZpZGVyTGlzdEVudW0sXG4gICAgICAvKipcbiAgICAgICAqIElEIFRva2VuIGZvciBkaXJlY3QgYXV0aGVudGljYXRpb24gd2l0aG91dCByZWRpcmVjdFxuICAgICAgICovXG4gICAgICBpZFRva2VuOiB6Lm9iamVjdCh7XG4gICAgICAgIHRva2VuOiB6LnN0cmluZygpLFxuICAgICAgICBub25jZTogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgICAgICBhY2Nlc3NUb2tlbjogei5zdHJpbmcoKS5vcHRpb25hbCgpLFxuICAgICAgICByZWZyZXNoVG9rZW46IHouc3RyaW5nKCkub3B0aW9uYWwoKSxcbiAgICAgICAgc2NvcGVzOiB6LmFycmF5KHouc3RyaW5nKCkpLm9wdGlvbmFsKClcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIFdoZXRoZXIgdG8gYWxsb3cgc2lnbiB1cCBmb3IgbmV3IHVzZXJzXG4gICAgICAgKi9cbiAgICAgIHJlcXVlc3RTaWduVXA6IHouYm9vbGVhbigpLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIEFkZGl0aW9uYWwgc2NvcGVzIHRvIHJlcXVlc3Qgd2hlbiBsaW5raW5nIHRoZSBhY2NvdW50LlxuICAgICAgICogVGhpcyBpcyB1c2VmdWwgZm9yIHJlcXVlc3RpbmcgYWRkaXRpb25hbCBwZXJtaXNzaW9ucyB3aGVuXG4gICAgICAgKiBsaW5raW5nIGEgc29jaWFsIGFjY291bnQgY29tcGFyZWQgdG8gdGhlIGluaXRpYWwgYXV0aGVudGljYXRpb24uXG4gICAgICAgKi9cbiAgICAgIHNjb3Blczogei5hcnJheSh6LnN0cmluZygpKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiQWRkaXRpb25hbCBzY29wZXMgdG8gcmVxdWVzdCBmcm9tIHRoZSBwcm92aWRlclwiXG4gICAgICB9KS5vcHRpb25hbCgpLFxuICAgICAgLyoqXG4gICAgICAgKiBUaGUgVVJMIHRvIHJlZGlyZWN0IHRvIGlmIHRoZXJlIGlzIGFuIGVycm9yIGR1cmluZyB0aGUgbGluayBwcm9jZXNzLlxuICAgICAgICovXG4gICAgICBlcnJvckNhbGxiYWNrVVJMOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgVVJMIHRvIHJlZGlyZWN0IHRvIGlmIHRoZXJlIGlzIGFuIGVycm9yIGR1cmluZyB0aGUgbGluayBwcm9jZXNzXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICAvKipcbiAgICAgICAqIERpc2FibGUgYXV0b21hdGljIHJlZGlyZWN0aW9uIHRvIHRoZSBwcm92aWRlclxuICAgICAgICpcbiAgICAgICAqIFRoaXMgaXMgdXNlZnVsIGlmIHlvdSB3YW50IHRvIGhhbmRsZSB0aGUgcmVkaXJlY3Rpb25cbiAgICAgICAqIHlvdXJzZWxmIGxpa2UgaW4gYSBwb3B1cCBvciBhIGRpZmZlcmVudCB0YWIuXG4gICAgICAgKi9cbiAgICAgIGRpc2FibGVSZWRpcmVjdDogei5ib29sZWFuKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkRpc2FibGUgYXV0b21hdGljIHJlZGlyZWN0aW9uIHRvIHRoZSBwcm92aWRlci4gVXNlZnVsIGZvciBoYW5kbGluZyB0aGUgcmVkaXJlY3Rpb24geW91cnNlbGZcIlxuICAgICAgfSkub3B0aW9uYWwoKVxuICAgIH0pLFxuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJMaW5rIGEgc29jaWFsIGFjY291bnQgdG8gdGhlIHVzZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgdXJsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgYXV0aG9yaXphdGlvbiBVUkwgdG8gcmVkaXJlY3QgdGhlIHVzZXIgdG9cIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICByZWRpcmVjdDoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluZGljYXRlcyBpZiB0aGUgdXNlciBzaG91bGQgYmUgcmVkaXJlY3RlZCB0byB0aGUgYXV0aG9yaXphdGlvbiBVUkxcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBzdGF0dXM6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInJlZGlyZWN0XCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoYykgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBjLmNvbnRleHQuc2Vzc2lvbjtcbiAgICBjb25zdCBwcm92aWRlciA9IGMuY29udGV4dC5zb2NpYWxQcm92aWRlcnMuZmluZChcbiAgICAgIChwKSA9PiBwLmlkID09PSBjLmJvZHkucHJvdmlkZXJcbiAgICApO1xuICAgIGlmICghcHJvdmlkZXIpIHtcbiAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIFwiUHJvdmlkZXIgbm90IGZvdW5kLiBNYWtlIHN1cmUgdG8gYWRkIHRoZSBwcm92aWRlciBpbiB5b3VyIGF1dGggY29uZmlnXCIsXG4gICAgICAgIHtcbiAgICAgICAgICBwcm92aWRlcjogYy5ib2R5LnByb3ZpZGVyXG4gICAgICAgIH1cbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJOT1RfRk9VTkRcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLlBST1ZJREVSX05PVF9GT1VORFxuICAgICAgfSk7XG4gICAgfVxuICAgIGlmIChjLmJvZHkuaWRUb2tlbikge1xuICAgICAgaWYgKCFwcm92aWRlci52ZXJpZnlJZFRva2VuKSB7XG4gICAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgICAgXCJQcm92aWRlciBkb2VzIG5vdCBzdXBwb3J0IGlkIHRva2VuIHZlcmlmaWNhdGlvblwiLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIHByb3ZpZGVyOiBjLmJvZHkucHJvdmlkZXJcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIk5PVF9GT1VORFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5JRF9UT0tFTl9OT1RfU1VQUE9SVEVEXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgeyB0b2tlbiwgbm9uY2UgfSA9IGMuYm9keS5pZFRva2VuO1xuICAgICAgY29uc3QgdmFsaWQgPSBhd2FpdCBwcm92aWRlci52ZXJpZnlJZFRva2VuKHRva2VuLCBub25jZSk7XG4gICAgICBpZiAoIXZhbGlkKSB7XG4gICAgICAgIGMuY29udGV4dC5sb2dnZXIuZXJyb3IoXCJJbnZhbGlkIGlkIHRva2VuXCIsIHtcbiAgICAgICAgICBwcm92aWRlcjogYy5ib2R5LnByb3ZpZGVyXG4gICAgICAgIH0pO1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuSU5WQUxJRF9UT0tFTlxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGxpbmtpbmdVc2VySW5mbyA9IGF3YWl0IHByb3ZpZGVyLmdldFVzZXJJbmZvKHtcbiAgICAgICAgaWRUb2tlbjogdG9rZW4sXG4gICAgICAgIGFjY2Vzc1Rva2VuOiBjLmJvZHkuaWRUb2tlbi5hY2Nlc3NUb2tlbixcbiAgICAgICAgcmVmcmVzaFRva2VuOiBjLmJvZHkuaWRUb2tlbi5yZWZyZXNoVG9rZW5cbiAgICAgIH0pO1xuICAgICAgaWYgKCFsaW5raW5nVXNlckluZm8gfHwgIWxpbmtpbmdVc2VySW5mbz8udXNlcikge1xuICAgICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiRmFpbGVkIHRvIGdldCB1c2VyIGluZm9cIiwge1xuICAgICAgICAgIHByb3ZpZGVyOiBjLmJvZHkucHJvdmlkZXJcbiAgICAgICAgfSk7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fR0VUX1VTRVJfSU5GT1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGxpbmtpbmdVc2VySWQgPSBTdHJpbmcobGlua2luZ1VzZXJJbmZvLnVzZXIuaWQpO1xuICAgICAgaWYgKCFsaW5raW5nVXNlckluZm8udXNlci5lbWFpbCkge1xuICAgICAgICBjLmNvbnRleHQubG9nZ2VyLmVycm9yKFwiVXNlciBlbWFpbCBub3QgZm91bmRcIiwge1xuICAgICAgICAgIHByb3ZpZGVyOiBjLmJvZHkucHJvdmlkZXJcbiAgICAgICAgfSk7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5VU0VSX0VNQUlMX05PVF9GT1VORFxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGV4aXN0aW5nQWNjb3VudHMgPSBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50cyhcbiAgICAgICAgc2Vzc2lvbi51c2VyLmlkXG4gICAgICApO1xuICAgICAgY29uc3QgaGFzQmVlbkxpbmtlZCA9IGV4aXN0aW5nQWNjb3VudHMuZmluZChcbiAgICAgICAgKGEpID0+IGEucHJvdmlkZXJJZCA9PT0gcHJvdmlkZXIuaWQgJiYgYS5hY2NvdW50SWQgPT09IGxpbmtpbmdVc2VySWRcbiAgICAgICk7XG4gICAgICBpZiAoaGFzQmVlbkxpbmtlZCkge1xuICAgICAgICByZXR1cm4gYy5qc29uKHtcbiAgICAgICAgICB1cmw6IFwiXCIsXG4gICAgICAgICAgLy8gdGhpcyBpcyBmb3IgdHlwZSBpbmZlcmVuY2VcbiAgICAgICAgICBzdGF0dXM6IHRydWUsXG4gICAgICAgICAgcmVkaXJlY3Q6IGZhbHNlXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgdHJ1c3RlZFByb3ZpZGVycyA9IGMuY29udGV4dC5vcHRpb25zLmFjY291bnQ/LmFjY291bnRMaW5raW5nPy50cnVzdGVkUHJvdmlkZXJzO1xuICAgICAgY29uc3QgaXNUcnVzdGVkUHJvdmlkZXIgPSB0cnVzdGVkUHJvdmlkZXJzPy5pbmNsdWRlcyhwcm92aWRlci5pZCk7XG4gICAgICBpZiAoIWlzVHJ1c3RlZFByb3ZpZGVyICYmICFsaW5raW5nVXNlckluZm8udXNlci5lbWFpbFZlcmlmaWVkIHx8IGMuY29udGV4dC5vcHRpb25zLmFjY291bnQ/LmFjY291bnRMaW5raW5nPy5lbmFibGVkID09PSBmYWxzZSkge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IFwiQWNjb3VudCBub3QgbGlua2VkIC0gbGlua2luZyBub3QgYWxsb3dlZFwiXG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgaWYgKGxpbmtpbmdVc2VySW5mby51c2VyLmVtYWlsICE9PSBzZXNzaW9uLnVzZXIuZW1haWwgJiYgYy5jb250ZXh0Lm9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LmFsbG93RGlmZmVyZW50RW1haWxzICE9PSB0cnVlKSB7XG4gICAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiLCB7XG4gICAgICAgICAgbWVzc2FnZTogXCJBY2NvdW50IG5vdCBsaW5rZWQgLSBkaWZmZXJlbnQgZW1haWxzIG5vdCBhbGxvd2VkXCJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICB0cnkge1xuICAgICAgICBhd2FpdCBjLmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmNyZWF0ZUFjY291bnQoXG4gICAgICAgICAge1xuICAgICAgICAgICAgdXNlcklkOiBzZXNzaW9uLnVzZXIuaWQsXG4gICAgICAgICAgICBwcm92aWRlcklkOiBwcm92aWRlci5pZCxcbiAgICAgICAgICAgIGFjY291bnRJZDogbGlua2luZ1VzZXJJZCxcbiAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiBjLmJvZHkuaWRUb2tlbi5hY2Nlc3NUb2tlbixcbiAgICAgICAgICAgIGlkVG9rZW46IHRva2VuLFxuICAgICAgICAgICAgcmVmcmVzaFRva2VuOiBjLmJvZHkuaWRUb2tlbi5yZWZyZXNoVG9rZW4sXG4gICAgICAgICAgICBzY29wZTogYy5ib2R5LmlkVG9rZW4uc2NvcGVzPy5qb2luKFwiLFwiKVxuICAgICAgICAgIH0sXG4gICAgICAgICAgY1xuICAgICAgICApO1xuICAgICAgfSBjYXRjaCAoZSkge1xuICAgICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJFWFBFQ1RBVElPTl9GQUlMRURcIiwge1xuICAgICAgICAgIG1lc3NhZ2U6IFwiQWNjb3VudCBub3QgbGlua2VkIC0gdW5hYmxlIHRvIGNyZWF0ZSBhY2NvdW50XCJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAoYy5jb250ZXh0Lm9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LnVwZGF0ZVVzZXJJbmZvT25MaW5rID09PSB0cnVlKSB7XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgYXdhaXQgYy5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVVc2VyKHNlc3Npb24udXNlci5pZCwge1xuICAgICAgICAgICAgbmFtZTogbGlua2luZ1VzZXJJbmZvLnVzZXI/Lm5hbWUsXG4gICAgICAgICAgICBpbWFnZTogbGlua2luZ1VzZXJJbmZvLnVzZXI/LmltYWdlXG4gICAgICAgICAgfSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBjb25zb2xlLndhcm4oXCJDb3VsZCBub3QgdXBkYXRlIHVzZXIgLSBcIiArIGUudG9TdHJpbmcoKSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiBjLmpzb24oe1xuICAgICAgICB1cmw6IFwiXCIsXG4gICAgICAgIC8vIHRoaXMgaXMgZm9yIHR5cGUgaW5mZXJlbmNlXG4gICAgICAgIHN0YXR1czogdHJ1ZSxcbiAgICAgICAgcmVkaXJlY3Q6IGZhbHNlXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3Qgc3RhdGUgPSBhd2FpdCBnZW5lcmF0ZVN0YXRlKGMsIHtcbiAgICAgIHVzZXJJZDogc2Vzc2lvbi51c2VyLmlkLFxuICAgICAgZW1haWw6IHNlc3Npb24udXNlci5lbWFpbFxuICAgIH0pO1xuICAgIGNvbnN0IHVybCA9IGF3YWl0IHByb3ZpZGVyLmNyZWF0ZUF1dGhvcml6YXRpb25VUkwoe1xuICAgICAgc3RhdGU6IHN0YXRlLnN0YXRlLFxuICAgICAgY29kZVZlcmlmaWVyOiBzdGF0ZS5jb2RlVmVyaWZpZXIsXG4gICAgICByZWRpcmVjdFVSSTogYCR7Yy5jb250ZXh0LmJhc2VVUkx9L2NhbGxiYWNrLyR7cHJvdmlkZXIuaWR9YCxcbiAgICAgIHNjb3BlczogYy5ib2R5LnNjb3Blc1xuICAgIH0pO1xuICAgIHJldHVybiBjLmpzb24oe1xuICAgICAgdXJsOiB1cmwudG9TdHJpbmcoKSxcbiAgICAgIHJlZGlyZWN0OiAhYy5ib2R5LmRpc2FibGVSZWRpcmVjdFxuICAgIH0pO1xuICB9XG4pO1xuY29uc3QgdW5saW5rQWNjb3VudCA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvdW5saW5rLWFjY291bnRcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgcHJvdmlkZXJJZDogei5zdHJpbmcoKSxcbiAgICAgIGFjY291bnRJZDogei5zdHJpbmcoKS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgdXNlOiBbZnJlc2hTZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVW5saW5rIGFuIGFjY291bnRcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc3RhdHVzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJib29sZWFuXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHsgcHJvdmlkZXJJZCwgYWNjb3VudElkIH0gPSBjdHguYm9keTtcbiAgICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudHMoXG4gICAgICBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuaWRcbiAgICApO1xuICAgIGlmIChhY2NvdW50cy5sZW5ndGggPT09IDEgJiYgIWN0eC5jb250ZXh0Lm9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LmFsbG93VW5saW5raW5nQWxsKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IEJBU0VfRVJST1JfQ09ERVMuRkFJTEVEX1RPX1VOTElOS19MQVNUX0FDQ09VTlRcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBhY2NvdW50RXhpc3QgPSBhY2NvdW50cy5maW5kKFxuICAgICAgKGFjY291bnQpID0+IGFjY291bnRJZCA/IGFjY291bnQuYWNjb3VudElkID09PSBhY2NvdW50SWQgJiYgYWNjb3VudC5wcm92aWRlcklkID09PSBwcm92aWRlcklkIDogYWNjb3VudC5wcm92aWRlcklkID09PSBwcm92aWRlcklkXG4gICAgKTtcbiAgICBpZiAoIWFjY291bnRFeGlzdCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBCQVNFX0VSUk9SX0NPREVTLkFDQ09VTlRfTk9UX0ZPVU5EXG4gICAgICB9KTtcbiAgICB9XG4gICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZUFjY291bnQoYWNjb3VudEV4aXN0LmlkKTtcbiAgICByZXR1cm4gY3R4Lmpzb24oe1xuICAgICAgc3RhdHVzOiB0cnVlXG4gICAgfSk7XG4gIH1cbik7XG5jb25zdCBnZXRBY2Nlc3NUb2tlbiA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvZ2V0LWFjY2Vzcy10b2tlblwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBwcm92aWRlcklkOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgcHJvdmlkZXIgSUQgZm9yIHRoZSBPQXV0aCBwcm92aWRlclwiXG4gICAgICB9KSxcbiAgICAgIGFjY291bnRJZDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGFjY291bnQgSUQgYXNzb2NpYXRlZCB3aXRoIHRoZSByZWZyZXNoIHRva2VuXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICB1c2VySWQ6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB1c2VyIElEIGFzc29jaWF0ZWQgd2l0aCB0aGUgYWNjb3VudFwiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiR2V0IGEgdmFsaWQgYWNjZXNzIHRva2VuLCBkb2luZyBhIHJlZnJlc2ggaWYgbmVlZGVkXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIDIwMDoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiQSBWYWxpZCBhY2Nlc3MgdG9rZW5cIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHRva2VuVHlwZToge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgaWRUb2tlbjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYWNjZXNzVG9rZW46IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHJlZnJlc2hUb2tlbjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogXCJkYXRlLXRpbWVcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiLFxuICAgICAgICAgICAgICAgICAgICAgIGZvcm1hdDogXCJkYXRlLXRpbWVcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICA0MDA6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkludmFsaWQgcmVmcmVzaCB0b2tlbiBvciBwcm92aWRlciBjb25maWd1cmF0aW9uXCJcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCB7IHByb3ZpZGVySWQsIGFjY291bnRJZCwgdXNlcklkIH0gPSBjdHguYm9keTtcbiAgICBjb25zdCByZXEgPSBjdHgucmVxdWVzdDtcbiAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgZ2V0U2Vzc2lvbkZyb21DdHgoY3R4KTtcbiAgICBpZiAocmVxICYmICFzZXNzaW9uKSB7XG4gICAgICB0aHJvdyBjdHguZXJyb3IoXCJVTkFVVEhPUklaRURcIik7XG4gICAgfVxuICAgIGxldCByZXNvbHZlZFVzZXJJZCA9IHNlc3Npb24/LnVzZXI/LmlkIHx8IHVzZXJJZDtcbiAgICBpZiAoIXJlc29sdmVkVXNlcklkKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IGBFaXRoZXIgdXNlcklkIG9yIHNlc3Npb24gaXMgcmVxdWlyZWRgXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKCFjdHguY29udGV4dC5zb2NpYWxQcm92aWRlcnMuZmluZCgocCkgPT4gcC5pZCA9PT0gcHJvdmlkZXJJZCkpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogYFByb3ZpZGVyICR7cHJvdmlkZXJJZH0gaXMgbm90IHN1cHBvcnRlZC5gXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKHJlc29sdmVkVXNlcklkKTtcbiAgICBjb25zdCBhY2NvdW50ID0gYWNjb3VudHMuZmluZChcbiAgICAgIChhY2MpID0+IGFjY291bnRJZCA/IGFjYy5pZCA9PT0gYWNjb3VudElkICYmIGFjYy5wcm92aWRlcklkID09PSBwcm92aWRlcklkIDogYWNjLnByb3ZpZGVySWQgPT09IHByb3ZpZGVySWRcbiAgICApO1xuICAgIGlmICghYWNjb3VudCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkFjY291bnQgbm90IGZvdW5kXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBwcm92aWRlciA9IGN0eC5jb250ZXh0LnNvY2lhbFByb3ZpZGVycy5maW5kKFxuICAgICAgKHApID0+IHAuaWQgPT09IHByb3ZpZGVySWRcbiAgICApO1xuICAgIGlmICghcHJvdmlkZXIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogYFByb3ZpZGVyICR7cHJvdmlkZXJJZH0gbm90IGZvdW5kLmBcbiAgICAgIH0pO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgbGV0IG5ld1Rva2VucyA9IG51bGw7XG4gICAgICBjb25zdCBhY2Nlc3NUb2tlbkV4cGlyZWQgPSBhY2NvdW50LmFjY2Vzc1Rva2VuRXhwaXJlc0F0ICYmIG5ldyBEYXRlKGFjY291bnQuYWNjZXNzVG9rZW5FeHBpcmVzQXQpLmdldFRpbWUoKSAtIERhdGUubm93KCkgPCA1ZTM7XG4gICAgICBpZiAoYWNjb3VudC5yZWZyZXNoVG9rZW4gJiYgYWNjZXNzVG9rZW5FeHBpcmVkICYmIHByb3ZpZGVyLnJlZnJlc2hBY2Nlc3NUb2tlbikge1xuICAgICAgICBuZXdUb2tlbnMgPSBhd2FpdCBwcm92aWRlci5yZWZyZXNoQWNjZXNzVG9rZW4oXG4gICAgICAgICAgYWNjb3VudC5yZWZyZXNoVG9rZW5cbiAgICAgICAgKTtcbiAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLnVwZGF0ZUFjY291bnQoYWNjb3VudC5pZCwge1xuICAgICAgICAgIGFjY2Vzc1Rva2VuOiBhd2FpdCBzZXRUb2tlblV0aWwobmV3VG9rZW5zLmFjY2Vzc1Rva2VuLCBjdHguY29udGV4dCksXG4gICAgICAgICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IG5ld1Rva2Vucy5hY2Nlc3NUb2tlbkV4cGlyZXNBdCxcbiAgICAgICAgICByZWZyZXNoVG9rZW46IGF3YWl0IHNldFRva2VuVXRpbChuZXdUb2tlbnMucmVmcmVzaFRva2VuLCBjdHguY29udGV4dCksXG4gICAgICAgICAgcmVmcmVzaFRva2VuRXhwaXJlc0F0OiBuZXdUb2tlbnMucmVmcmVzaFRva2VuRXhwaXJlc0F0XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgICAgY29uc3QgdG9rZW5zID0ge1xuICAgICAgICBhY2Nlc3NUb2tlbjogYXdhaXQgZGVjcnlwdE9BdXRoVG9rZW4oXG4gICAgICAgICAgbmV3VG9rZW5zPy5hY2Nlc3NUb2tlbiA/PyBhY2NvdW50LmFjY2Vzc1Rva2VuID8/IFwiXCIsXG4gICAgICAgICAgY3R4LmNvbnRleHRcbiAgICAgICAgKSxcbiAgICAgICAgYWNjZXNzVG9rZW5FeHBpcmVzQXQ6IG5ld1Rva2Vucz8uYWNjZXNzVG9rZW5FeHBpcmVzQXQgPz8gYWNjb3VudC5hY2Nlc3NUb2tlbkV4cGlyZXNBdCA/PyB2b2lkIDAsXG4gICAgICAgIHNjb3BlczogYWNjb3VudC5zY29wZT8uc3BsaXQoXCIsXCIpID8/IFtdLFxuICAgICAgICBpZFRva2VuOiBuZXdUb2tlbnM/LmlkVG9rZW4gPz8gYWNjb3VudC5pZFRva2VuID8/IHZvaWQgMFxuICAgICAgfTtcbiAgICAgIHJldHVybiBjdHguanNvbih0b2tlbnMpO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IFwiRmFpbGVkIHRvIGdldCBhIHZhbGlkIGFjY2VzcyB0b2tlblwiLFxuICAgICAgICBjYXVzZTogZXJyb3JcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuKTtcbmNvbnN0IHJlZnJlc2hUb2tlbiA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvcmVmcmVzaC10b2tlblwiLFxuICB7XG4gICAgbWV0aG9kOiBcIlBPU1RcIixcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBwcm92aWRlcklkOiB6LnN0cmluZygpLm1ldGEoe1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJUaGUgcHJvdmlkZXIgSUQgZm9yIHRoZSBPQXV0aCBwcm92aWRlclwiXG4gICAgICB9KSxcbiAgICAgIGFjY291bnRJZDogei5zdHJpbmcoKS5tZXRhKHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiVGhlIGFjY291bnQgSUQgYXNzb2NpYXRlZCB3aXRoIHRoZSByZWZyZXNoIHRva2VuXCJcbiAgICAgIH0pLm9wdGlvbmFsKCksXG4gICAgICB1c2VySWQ6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB1c2VyIElEIGFzc29jaWF0ZWQgd2l0aCB0aGUgYWNjb3VudFwiXG4gICAgICB9KS5vcHRpb25hbCgpXG4gICAgfSksXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiUmVmcmVzaCB0aGUgYWNjZXNzIHRva2VuIHVzaW5nIGEgcmVmcmVzaCB0b2tlblwiLFxuICAgICAgICByZXNwb25zZXM6IHtcbiAgICAgICAgICAyMDA6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkFjY2VzcyB0b2tlbiByZWZyZXNoZWQgc3VjY2Vzc2Z1bGx5XCIsXG4gICAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICAgIFwiYXBwbGljYXRpb24vanNvblwiOiB7XG4gICAgICAgICAgICAgICAgc2NoZW1hOiB7XG4gICAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICB0b2tlblR5cGU6IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGlkVG9rZW46IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICByZWZyZXNoVG9rZW46IHtcbiAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIGFjY2Vzc1Rva2VuRXhwaXJlc0F0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwiZGF0ZS10aW1lXCJcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgcmVmcmVzaFRva2VuRXhwaXJlc0F0OiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgICAgICAgICBmb3JtYXQ6IFwiZGF0ZS10aW1lXCJcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgNDAwOiB7XG4gICAgICAgICAgICBkZXNjcmlwdGlvbjogXCJJbnZhbGlkIHJlZnJlc2ggdG9rZW4gb3IgcHJvdmlkZXIgY29uZmlndXJhdGlvblwiXG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3QgeyBwcm92aWRlcklkLCBhY2NvdW50SWQsIHVzZXJJZCB9ID0gY3R4LmJvZHk7XG4gICAgY29uc3QgcmVxID0gY3R4LnJlcXVlc3Q7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb25Gcm9tQ3R4KGN0eCk7XG4gICAgaWYgKHJlcSAmJiAhc2Vzc2lvbikge1xuICAgICAgdGhyb3cgY3R4LmVycm9yKFwiVU5BVVRIT1JJWkVEXCIpO1xuICAgIH1cbiAgICBsZXQgcmVzb2x2ZWRVc2VySWQgPSBzZXNzaW9uPy51c2VyPy5pZCB8fCB1c2VySWQ7XG4gICAgaWYgKCFyZXNvbHZlZFVzZXJJZCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBgRWl0aGVyIHVzZXJJZCBvciBzZXNzaW9uIGlzIHJlcXVpcmVkYFxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50cyhyZXNvbHZlZFVzZXJJZCk7XG4gICAgY29uc3QgYWNjb3VudCA9IGFjY291bnRzLmZpbmQoXG4gICAgICAoYWNjKSA9PiBhY2NvdW50SWQgPyBhY2MuaWQgPT09IGFjY291bnRJZCAmJiBhY2MucHJvdmlkZXJJZCA9PT0gcHJvdmlkZXJJZCA6IGFjYy5wcm92aWRlcklkID09PSBwcm92aWRlcklkXG4gICAgKTtcbiAgICBpZiAoIWFjY291bnQpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJBY2NvdW50IG5vdCBmb3VuZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgY29uc3QgcHJvdmlkZXIgPSBjdHguY29udGV4dC5zb2NpYWxQcm92aWRlcnMuZmluZChcbiAgICAgIChwKSA9PiBwLmlkID09PSBwcm92aWRlcklkXG4gICAgKTtcbiAgICBpZiAoIXByb3ZpZGVyKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICAgIG1lc3NhZ2U6IGBQcm92aWRlciAke3Byb3ZpZGVySWR9IG5vdCBmb3VuZC5gXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKCFwcm92aWRlci5yZWZyZXNoQWNjZXNzVG9rZW4pIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogYFByb3ZpZGVyICR7cHJvdmlkZXJJZH0gZG9lcyBub3Qgc3VwcG9ydCB0b2tlbiByZWZyZXNoaW5nLmBcbiAgICAgIH0pO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgY29uc3QgdG9rZW5zID0gYXdhaXQgcHJvdmlkZXIucmVmcmVzaEFjY2Vzc1Rva2VuKFxuICAgICAgICBhY2NvdW50LnJlZnJlc2hUb2tlblxuICAgICAgKTtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci51cGRhdGVBY2NvdW50KGFjY291bnQuaWQsIHtcbiAgICAgICAgYWNjZXNzVG9rZW46IGF3YWl0IHNldFRva2VuVXRpbCh0b2tlbnMuYWNjZXNzVG9rZW4sIGN0eC5jb250ZXh0KSxcbiAgICAgICAgcmVmcmVzaFRva2VuOiBhd2FpdCBzZXRUb2tlblV0aWwodG9rZW5zLnJlZnJlc2hUb2tlbiwgY3R4LmNvbnRleHQpLFxuICAgICAgICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDogdG9rZW5zLmFjY2Vzc1Rva2VuRXhwaXJlc0F0LFxuICAgICAgICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IHRva2Vucy5yZWZyZXNoVG9rZW5FeHBpcmVzQXRcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGN0eC5qc29uKHRva2Vucyk7XG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJGYWlsZWQgdG8gcmVmcmVzaCBhY2Nlc3MgdG9rZW5cIixcbiAgICAgICAgY2F1c2U6IGVycm9yXG4gICAgICB9KTtcbiAgICB9XG4gIH1cbik7XG5jb25zdCBhY2NvdW50SW5mbyA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvYWNjb3VudC1pbmZvXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJHZXQgdGhlIGFjY291bnQgaW5mbyBwcm92aWRlZCBieSB0aGUgcHJvdmlkZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgdXNlcjoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICAgICAgcHJvcGVydGllczoge1xuICAgICAgICAgICAgICAgICAgICAgICAgaWQ6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIlxuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGVtYWlsOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCJcbiAgICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgICBpbWFnZToge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcInN0cmluZ1wiXG4gICAgICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICAgICAgZW1haWxWZXJpZmllZDoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICB0eXBlOiBcImJvb2xlYW5cIlxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcImlkXCIsIFwiZW1haWxWZXJpZmllZFwiXVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICBkYXRhOiB7XG4gICAgICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7fSxcbiAgICAgICAgICAgICAgICAgICAgICBhZGRpdGlvbmFsUHJvcGVydGllczogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInVzZXJcIiwgXCJkYXRhXCJdLFxuICAgICAgICAgICAgICAgICAgYWRkaXRpb25hbFByb3BlcnRpZXM6IGZhbHNlXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfSxcbiAgICBib2R5OiB6Lm9iamVjdCh7XG4gICAgICBhY2NvdW50SWQ6IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSBwcm92aWRlciBnaXZlbiBhY2NvdW50IGlkIGZvciB3aGljaCB0byBnZXQgdGhlIGFjY291bnQgaW5mb1wiXG4gICAgICB9KVxuICAgIH0pXG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICBjb25zdCBhY2NvdW50ID0gYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmZpbmRBY2NvdW50KFxuICAgICAgY3R4LmJvZHkuYWNjb3VudElkXG4gICAgKTtcbiAgICBpZiAoIWFjY291bnQgfHwgYWNjb3VudC51c2VySWQgIT09IGN0eC5jb250ZXh0LnNlc3Npb24udXNlci5pZCkge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkFjY291bnQgbm90IGZvdW5kXCJcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCBwcm92aWRlciA9IGN0eC5jb250ZXh0LnNvY2lhbFByb3ZpZGVycy5maW5kKFxuICAgICAgKHApID0+IHAuaWQgPT09IGFjY291bnQucHJvdmlkZXJJZFxuICAgICk7XG4gICAgaWYgKCFwcm92aWRlcikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsIHtcbiAgICAgICAgbWVzc2FnZTogYFByb3ZpZGVyIGFjY291bnQgcHJvdmlkZXIgaXMgJHthY2NvdW50LnByb3ZpZGVySWR9IGJ1dCBpdCBpcyBub3QgY29uZmlndXJlZGBcbiAgICAgIH0pO1xuICAgIH1cbiAgICBjb25zdCB0b2tlbnMgPSBhd2FpdCBnZXRBY2Nlc3NUb2tlbih7XG4gICAgICAuLi5jdHgsXG4gICAgICBib2R5OiB7XG4gICAgICAgIGFjY291bnRJZDogYWNjb3VudC5pZCxcbiAgICAgICAgcHJvdmlkZXJJZDogYWNjb3VudC5wcm92aWRlcklkXG4gICAgICB9LFxuICAgICAgcmV0dXJuSGVhZGVyczogZmFsc2VcbiAgICB9KTtcbiAgICBpZiAoIXRva2Vucy5hY2Nlc3NUb2tlbikge1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiQkFEX1JFUVVFU1RcIiwge1xuICAgICAgICBtZXNzYWdlOiBcIkFjY2VzcyB0b2tlbiBub3QgZm91bmRcIlxuICAgICAgfSk7XG4gICAgfVxuICAgIGNvbnN0IGluZm8gPSBhd2FpdCBwcm92aWRlci5nZXRVc2VySW5mbyh7XG4gICAgICAuLi50b2tlbnMsXG4gICAgICBhY2Nlc3NUb2tlbjogdG9rZW5zLmFjY2Vzc1Rva2VuXG4gICAgfSk7XG4gICAgcmV0dXJuIGN0eC5qc29uKGluZm8pO1xuICB9XG4pO1xuXG5jb25zdCBkZWZ1UmVwbGFjZUFycmF5cyA9IGNyZWF0ZURlZnUoKG9iaiwga2V5LCB2YWx1ZSkgPT4ge1xuICBpZiAoQXJyYXkuaXNBcnJheShvYmpba2V5XSkgJiYgQXJyYXkuaXNBcnJheSh2YWx1ZSkpIHtcbiAgICBvYmpba2V5XSA9IHZhbHVlO1xuICAgIHJldHVybiB0cnVlO1xuICB9XG59KTtcbmZ1bmN0aW9uIHRvQXV0aEVuZHBvaW50cyhlbmRwb2ludHMsIGN0eCkge1xuICBjb25zdCBhcGkgPSB7fTtcbiAgZm9yIChjb25zdCBba2V5LCBlbmRwb2ludF0gb2YgT2JqZWN0LmVudHJpZXMoZW5kcG9pbnRzKSkge1xuICAgIGFwaVtrZXldID0gYXN5bmMgKGNvbnRleHQpID0+IHtcbiAgICAgIGNvbnN0IGF1dGhDb250ZXh0ID0gYXdhaXQgY3R4O1xuICAgICAgbGV0IGludGVybmFsQ29udGV4dCA9IHtcbiAgICAgICAgLi4uY29udGV4dCxcbiAgICAgICAgY29udGV4dDoge1xuICAgICAgICAgIC4uLmF1dGhDb250ZXh0LFxuICAgICAgICAgIHJldHVybmVkOiB2b2lkIDAsXG4gICAgICAgICAgcmVzcG9uc2VIZWFkZXJzOiB2b2lkIDAsXG4gICAgICAgICAgc2Vzc2lvbjogbnVsbFxuICAgICAgICB9LFxuICAgICAgICBwYXRoOiBlbmRwb2ludC5wYXRoLFxuICAgICAgICBoZWFkZXJzOiBjb250ZXh0Py5oZWFkZXJzID8gbmV3IEhlYWRlcnMoY29udGV4dD8uaGVhZGVycykgOiB2b2lkIDBcbiAgICAgIH07XG4gICAgICBjb25zdCB7IGJlZm9yZUhvb2tzLCBhZnRlckhvb2tzIH0gPSBnZXRIb29rcyhhdXRoQ29udGV4dCk7XG4gICAgICBjb25zdCBiZWZvcmUgPSBhd2FpdCBydW5CZWZvcmVIb29rcyhpbnRlcm5hbENvbnRleHQsIGJlZm9yZUhvb2tzKTtcbiAgICAgIGlmIChcImNvbnRleHRcIiBpbiBiZWZvcmUgJiYgYmVmb3JlLmNvbnRleHQgJiYgdHlwZW9mIGJlZm9yZS5jb250ZXh0ID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgIGNvbnN0IHsgaGVhZGVycywgLi4ucmVzdCB9ID0gYmVmb3JlLmNvbnRleHQ7XG4gICAgICAgIGlmIChoZWFkZXJzKSB7XG4gICAgICAgICAgaGVhZGVycy5mb3JFYWNoKCh2YWx1ZSwga2V5MikgPT4ge1xuICAgICAgICAgICAgaW50ZXJuYWxDb250ZXh0LmhlYWRlcnMuc2V0KGtleTIsIHZhbHVlKTtcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgICBpbnRlcm5hbENvbnRleHQgPSBkZWZ1UmVwbGFjZUFycmF5cyhyZXN0LCBpbnRlcm5hbENvbnRleHQpO1xuICAgICAgfSBlbHNlIGlmIChiZWZvcmUpIHtcbiAgICAgICAgcmV0dXJuIGJlZm9yZTtcbiAgICAgIH1cbiAgICAgIGludGVybmFsQ29udGV4dC5hc1Jlc3BvbnNlID0gZmFsc2U7XG4gICAgICBpbnRlcm5hbENvbnRleHQucmV0dXJuSGVhZGVycyA9IHRydWU7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBlbmRwb2ludChpbnRlcm5hbENvbnRleHQpLmNhdGNoKChlKSA9PiB7XG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgQVBJRXJyb3IpIHtcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgcmVzcG9uc2U6IGUsXG4gICAgICAgICAgICBoZWFkZXJzOiBlLmhlYWRlcnMgPyBuZXcgSGVhZGVycyhlLmhlYWRlcnMpIDogbnVsbFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgZTtcbiAgICAgIH0pO1xuICAgICAgaWYgKHJlc3VsdCAmJiByZXN1bHQgaW5zdGFuY2VvZiBSZXNwb25zZSkge1xuICAgICAgICByZXR1cm4gcmVzdWx0O1xuICAgICAgfVxuICAgICAgaW50ZXJuYWxDb250ZXh0LmNvbnRleHQucmV0dXJuZWQgPSByZXN1bHQucmVzcG9uc2U7XG4gICAgICBpbnRlcm5hbENvbnRleHQuY29udGV4dC5yZXNwb25zZUhlYWRlcnMgPSByZXN1bHQuaGVhZGVycztcbiAgICAgIGNvbnN0IGFmdGVyID0gYXdhaXQgcnVuQWZ0ZXJIb29rcyhpbnRlcm5hbENvbnRleHQsIGFmdGVySG9va3MpO1xuICAgICAgaWYgKGFmdGVyLnJlc3BvbnNlKSB7XG4gICAgICAgIHJlc3VsdC5yZXNwb25zZSA9IGFmdGVyLnJlc3BvbnNlO1xuICAgICAgfVxuICAgICAgaWYgKHJlc3VsdC5yZXNwb25zZSBpbnN0YW5jZW9mIEFQSUVycm9yICYmIHNob3VsZFB1Ymxpc2hMb2coYXV0aENvbnRleHQubG9nZ2VyLmxldmVsLCBcImRlYnVnXCIpKSB7XG4gICAgICAgIHJlc3VsdC5yZXNwb25zZS5zdGFjayA9IHJlc3VsdC5yZXNwb25zZS5lcnJvclN0YWNrO1xuICAgICAgfVxuICAgICAgaWYgKHJlc3VsdC5yZXNwb25zZSBpbnN0YW5jZW9mIEFQSUVycm9yICYmICFjb250ZXh0Py5hc1Jlc3BvbnNlKSB7XG4gICAgICAgIHRocm93IHJlc3VsdC5yZXNwb25zZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHJlc3BvbnNlID0gY29udGV4dD8uYXNSZXNwb25zZSA/IHRvUmVzcG9uc2UocmVzdWx0LnJlc3BvbnNlLCB7XG4gICAgICAgIGhlYWRlcnM6IHJlc3VsdC5oZWFkZXJzXG4gICAgICB9KSA6IGNvbnRleHQ/LnJldHVybkhlYWRlcnMgPyB7XG4gICAgICAgIGhlYWRlcnM6IHJlc3VsdC5oZWFkZXJzLFxuICAgICAgICByZXNwb25zZTogcmVzdWx0LnJlc3BvbnNlXG4gICAgICB9IDogcmVzdWx0LnJlc3BvbnNlO1xuICAgICAgcmV0dXJuIHJlc3BvbnNlO1xuICAgIH07XG4gICAgYXBpW2tleV0ucGF0aCA9IGVuZHBvaW50LnBhdGg7XG4gICAgYXBpW2tleV0ub3B0aW9ucyA9IGVuZHBvaW50Lm9wdGlvbnM7XG4gIH1cbiAgcmV0dXJuIGFwaTtcbn1cbmFzeW5jIGZ1bmN0aW9uIHJ1bkJlZm9yZUhvb2tzKGNvbnRleHQsIGhvb2tzKSB7XG4gIGxldCBtb2RpZmllZENvbnRleHQgPSB7fTtcbiAgZm9yIChjb25zdCBob29rIG9mIGhvb2tzKSB7XG4gICAgaWYgKGhvb2subWF0Y2hlcihjb250ZXh0KSkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgaG9vay5oYW5kbGVyKHtcbiAgICAgICAgLi4uY29udGV4dCxcbiAgICAgICAgcmV0dXJuSGVhZGVyczogZmFsc2VcbiAgICAgIH0pLmNhdGNoKChlKSA9PiB7XG4gICAgICAgIGlmIChlIGluc3RhbmNlb2YgQVBJRXJyb3IgJiYgc2hvdWxkUHVibGlzaExvZyhjb250ZXh0LmNvbnRleHQubG9nZ2VyLmxldmVsLCBcImRlYnVnXCIpKSB7XG4gICAgICAgICAgZS5zdGFjayA9IGUuZXJyb3JTdGFjaztcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBlO1xuICAgICAgfSk7XG4gICAgICBpZiAocmVzdWx0ICYmIHR5cGVvZiByZXN1bHQgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgaWYgKFwiY29udGV4dFwiIGluIHJlc3VsdCAmJiB0eXBlb2YgcmVzdWx0LmNvbnRleHQgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgICAgICBjb25zdCB7IGhlYWRlcnMsIC4uLnJlc3QgfSA9IHJlc3VsdC5jb250ZXh0O1xuICAgICAgICAgIGlmIChoZWFkZXJzIGluc3RhbmNlb2YgSGVhZGVycykge1xuICAgICAgICAgICAgaWYgKG1vZGlmaWVkQ29udGV4dC5oZWFkZXJzKSB7XG4gICAgICAgICAgICAgIGhlYWRlcnMuZm9yRWFjaCgodmFsdWUsIGtleSkgPT4ge1xuICAgICAgICAgICAgICAgIG1vZGlmaWVkQ29udGV4dC5oZWFkZXJzPy5zZXQoa2V5LCB2YWx1ZSk7XG4gICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgbW9kaWZpZWRDb250ZXh0LmhlYWRlcnMgPSBoZWFkZXJzO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICBtb2RpZmllZENvbnRleHQgPSBkZWZ1UmVwbGFjZUFycmF5cyhyZXN0LCBtb2RpZmllZENvbnRleHQpO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiB7IGNvbnRleHQ6IG1vZGlmaWVkQ29udGV4dCB9O1xufVxuYXN5bmMgZnVuY3Rpb24gcnVuQWZ0ZXJIb29rcyhjb250ZXh0LCBob29rcykge1xuICBmb3IgKGNvbnN0IGhvb2sgb2YgaG9va3MpIHtcbiAgICBpZiAoaG9vay5tYXRjaGVyKGNvbnRleHQpKSB7XG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBob29rLmhhbmRsZXIoY29udGV4dCkuY2F0Y2goKGUpID0+IHtcbiAgICAgICAgaWYgKGUgaW5zdGFuY2VvZiBBUElFcnJvcikge1xuICAgICAgICAgIGlmIChzaG91bGRQdWJsaXNoTG9nKGNvbnRleHQuY29udGV4dC5sb2dnZXIubGV2ZWwsIFwiZGVidWdcIikpIHtcbiAgICAgICAgICAgIGUuc3RhY2sgPSBlLmVycm9yU3RhY2s7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICByZXNwb25zZTogZSxcbiAgICAgICAgICAgIGhlYWRlcnM6IGUuaGVhZGVycyA/IG5ldyBIZWFkZXJzKGUuaGVhZGVycykgOiBudWxsXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgICB0aHJvdyBlO1xuICAgICAgfSk7XG4gICAgICBpZiAocmVzdWx0LmhlYWRlcnMpIHtcbiAgICAgICAgcmVzdWx0LmhlYWRlcnMuZm9yRWFjaCgodmFsdWUsIGtleSkgPT4ge1xuICAgICAgICAgIGlmICghY29udGV4dC5jb250ZXh0LnJlc3BvbnNlSGVhZGVycykge1xuICAgICAgICAgICAgY29udGV4dC5jb250ZXh0LnJlc3BvbnNlSGVhZGVycyA9IG5ldyBIZWFkZXJzKHtcbiAgICAgICAgICAgICAgW2tleV06IHZhbHVlXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKGtleS50b0xvd2VyQ2FzZSgpID09PSBcInNldC1jb29raWVcIikge1xuICAgICAgICAgICAgICBjb250ZXh0LmNvbnRleHQucmVzcG9uc2VIZWFkZXJzLmFwcGVuZChrZXksIHZhbHVlKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGNvbnRleHQuY29udGV4dC5yZXNwb25zZUhlYWRlcnMuc2V0KGtleSwgdmFsdWUpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBpZiAocmVzdWx0LnJlc3BvbnNlKSB7XG4gICAgICAgIGNvbnRleHQuY29udGV4dC5yZXR1cm5lZCA9IHJlc3VsdC5yZXNwb25zZTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgcmV0dXJuIHtcbiAgICByZXNwb25zZTogY29udGV4dC5jb250ZXh0LnJldHVybmVkLFxuICAgIGhlYWRlcnM6IGNvbnRleHQuY29udGV4dC5yZXNwb25zZUhlYWRlcnNcbiAgfTtcbn1cbmZ1bmN0aW9uIGdldEhvb2tzKGF1dGhDb250ZXh0KSB7XG4gIGNvbnN0IHBsdWdpbnMgPSBhdXRoQ29udGV4dC5vcHRpb25zLnBsdWdpbnMgfHwgW107XG4gIGNvbnN0IGJlZm9yZUhvb2tzID0gW107XG4gIGNvbnN0IGFmdGVySG9va3MgPSBbXTtcbiAgaWYgKGF1dGhDb250ZXh0Lm9wdGlvbnMuaG9va3M/LmJlZm9yZSkge1xuICAgIGJlZm9yZUhvb2tzLnB1c2goe1xuICAgICAgbWF0Y2hlcjogKCkgPT4gdHJ1ZSxcbiAgICAgIGhhbmRsZXI6IGF1dGhDb250ZXh0Lm9wdGlvbnMuaG9va3MuYmVmb3JlXG4gICAgfSk7XG4gIH1cbiAgaWYgKGF1dGhDb250ZXh0Lm9wdGlvbnMuaG9va3M/LmFmdGVyKSB7XG4gICAgYWZ0ZXJIb29rcy5wdXNoKHtcbiAgICAgIG1hdGNoZXI6ICgpID0+IHRydWUsXG4gICAgICBoYW5kbGVyOiBhdXRoQ29udGV4dC5vcHRpb25zLmhvb2tzLmFmdGVyXG4gICAgfSk7XG4gIH1cbiAgY29uc3QgcGx1Z2luQmVmb3JlSG9va3MgPSBwbHVnaW5zLm1hcCgocGx1Z2luKSA9PiB7XG4gICAgaWYgKHBsdWdpbi5ob29rcz8uYmVmb3JlKSB7XG4gICAgICByZXR1cm4gcGx1Z2luLmhvb2tzLmJlZm9yZTtcbiAgICB9XG4gIH0pLmZpbHRlcigocGx1Z2luKSA9PiBwbHVnaW4gIT09IHZvaWQgMCkuZmxhdCgpO1xuICBjb25zdCBwbHVnaW5BZnRlckhvb2tzID0gcGx1Z2lucy5tYXAoKHBsdWdpbikgPT4ge1xuICAgIGlmIChwbHVnaW4uaG9va3M/LmFmdGVyKSB7XG4gICAgICByZXR1cm4gcGx1Z2luLmhvb2tzLmFmdGVyO1xuICAgIH1cbiAgfSkuZmlsdGVyKChwbHVnaW4pID0+IHBsdWdpbiAhPT0gdm9pZCAwKS5mbGF0KCk7XG4gIHBsdWdpbkJlZm9yZUhvb2tzLmxlbmd0aCAmJiBiZWZvcmVIb29rcy5wdXNoKC4uLnBsdWdpbkJlZm9yZUhvb2tzKTtcbiAgcGx1Z2luQWZ0ZXJIb29rcy5sZW5ndGggJiYgYWZ0ZXJIb29rcy5wdXNoKC4uLnBsdWdpbkFmdGVySG9va3MpO1xuICByZXR1cm4ge1xuICAgIGJlZm9yZUhvb2tzLFxuICAgIGFmdGVySG9va3NcbiAgfTtcbn1cblxuZXhwb3J0IHsgZ2V0Q29nbml0b1B1YmxpY0tleSBhcyAkLCBkZWxldGVVc2VyQ2FsbGJhY2sgYXMgQSwgbGlzdFVzZXJBY2NvdW50cyBhcyBCLCBsaW5rU29jaWFsQWNjb3VudCBhcyBDLCByZXF1ZXN0UGFzc3dvcmRSZXNldENhbGxiYWNrIGFzIEQsIHJlcXVlc3RQYXNzd29yZFJlc2V0IGFzIEUsIGZvcmdldFBhc3N3b3JkQ2FsbGJhY2sgYXMgRiwgZGVsZXRlVXNlciBhcyBHLCBISURFX01FVEFEQVRBIGFzIEgsIHNldFBhc3N3b3JkIGFzIEksIGNoYW5nZVBhc3N3b3JkIGFzIEosIGNoYW5nZUVtYWlsIGFzIEssIHNlbmRWZXJpZmljYXRpb25FbWFpbCBhcyBMLCB2ZXJpZnlFbWFpbCBhcyBNLCByZXNldFBhc3N3b3JkIGFzIE4sIGZvcmdldFBhc3N3b3JkIGFzIE8sIHNpZ25JbkVtYWlsIGFzIFAsIHNpZ25PdXQgYXMgUSwgY2FsbGJhY2tPQXV0aCBhcyBSLCBzaWduSW5Tb2NpYWwgYXMgUywgc2VuZFZlcmlmaWNhdGlvbkVtYWlsRm4gYXMgVCwgc29jaWFsUHJvdmlkZXJzIGFzIFUsIHNvY2lhbFByb3ZpZGVyTGlzdCBhcyBWLCBTb2NpYWxQcm92aWRlckxpc3RFbnVtIGFzIFcsIGFwcGxlIGFzIFgsIGdldEFwcGxlUHVibGljS2V5IGFzIFksIGF0bGFzc2lhbiBhcyBaLCBjb2duaXRvIGFzIF8sIGNyZWF0ZUF1dGhvcml6YXRpb25Db2RlUmVxdWVzdCBhcyBhLCBkaXNjb3JkIGFzIGEwLCBkcm9wYm94IGFzIGExLCBmYWNlYm9vayBhcyBhMiwgZmlnbWEgYXMgYTMsIGdpdGh1YiBhcyBhNCwgbGluZWFyIGFzIGE1LCBsaW5rZWRpbiBhcyBhNiwgZ2l0bGFiIGFzIGE3LCBnb29nbGUgYXMgYTgsIGtpY2sgYXMgYTksIG1pY3Jvc29mdCBhcyBhYSwgbm90aW9uIGFzIGFiLCByZWRkaXQgYXMgYWMsIHJvYmxveCBhcyBhZCwgc2FsZXNmb3JjZSBhcyBhZSwgc3BvdGlmeSBhcyBhZiwgdGlrdG9rIGFzIGFnLCB0d2l0Y2ggYXMgYWgsIHR3aXR0ZXIgYXMgYWksIHZrIGFzIGFqLCB6b29tIGFzIGFrLCBodWdnaW5nZmFjZSBhcyBhbCwgc2xhY2sgYXMgYW0sIGtha2FvIGFzIGFuLCBuYXZlciBhcyBhbywgbGluZSBhcyBhcCwgcGF5cGFsIGFzIGFxLCB2YWxpZGF0ZVRva2VuIGFzIGIsIGNyZWF0ZUF1dGhvcml6YXRpb25VUkwgYXMgYywgY3JlYXRlUmVmcmVzaEFjY2Vzc1Rva2VuUmVxdWVzdCBhcyBkLCBnZW5lcmF0ZUNvZGVDaGFsbGVuZ2UgYXMgZSwgZ2V0T0F1dGgyVG9rZW5zIGFzIGYsIGdlbmVyYXRlU3RhdGUgYXMgZywgZW5jb2RlT0F1dGhQYXJhbWV0ZXIgYXMgaCwgZGVjcnlwdE9BdXRoVG9rZW4gYXMgaSwgaGFuZGxlT0F1dGhVc2VySW5mbyBhcyBqLCBjcmVhdGVFbWFpbFZlcmlmaWNhdGlvblRva2VuIGFzIGssIG9yaWdpbkNoZWNrTWlkZGxld2FyZSBhcyBsLCBlcnJvciBhcyBtLCBvayBhcyBuLCBvcmlnaW5DaGVjayBhcyBvLCBwYXJzZVN0YXRlIGFzIHAsIGFjY291bnRJbmZvIGFzIHEsIHJlZnJlc2hBY2Nlc3NUb2tlbiBhcyByLCBzZXRUb2tlblV0aWwgYXMgcywgdG9BdXRoRW5kcG9pbnRzIGFzIHQsIHVwZGF0ZVVzZXIgYXMgdSwgdmFsaWRhdGVBdXRob3JpemF0aW9uQ29kZSBhcyB2LCB3aWxkY2FyZE1hdGNoIGFzIHcsIGdldEFjY2Vzc1Rva2VuIGFzIHgsIHJlZnJlc2hUb2tlbiBhcyB5LCB1bmxpbmtBY2NvdW50IGFzIHogfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.CewjboYP.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.CuS_eDdK.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.CuS_eDdK.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ getBaseURL),\n/* harmony export */   b: () => (/* binding */ getHost),\n/* harmony export */   c: () => (/* binding */ getProtocol),\n/* harmony export */   g: () => (/* binding */ getOrigin)\n/* harmony export */ });\n/* harmony import */ var _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./better-auth.CMQ3rA-I.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CMQ3rA-I.mjs\");\n/* harmony import */ var _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./better-auth.DdzSJf-n.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DdzSJf-n.mjs\");\n\n\n\nfunction checkHasPath(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.pathname !== \"/\";\n  } catch (error) {\n    throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_1__.B(\n      `Invalid base URL: ${url}. Please provide a valid base URL.`\n    );\n  }\n}\nfunction withPath(url, path = \"/api/auth\") {\n  const hasPath = checkHasPath(url);\n  if (hasPath) {\n    return url;\n  }\n  path = path.startsWith(\"/\") ? path : `/${path}`;\n  return `${url.replace(/\\/+$/, \"\")}${path}`;\n}\nfunction getBaseURL(url, path, request) {\n  if (url) {\n    return withPath(url, path);\n  }\n  const fromEnv = _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_0__.e.BETTER_AUTH_URL || _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_0__.e.NEXT_PUBLIC_BETTER_AUTH_URL || _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_0__.e.PUBLIC_BETTER_AUTH_URL || _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_0__.e.NUXT_PUBLIC_BETTER_AUTH_URL || _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_0__.e.NUXT_PUBLIC_AUTH_URL || (_better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_0__.e.BASE_URL !== \"/\" ? _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_0__.e.BASE_URL : void 0);\n  if (fromEnv) {\n    return withPath(fromEnv, path);\n  }\n  const fromRequest = request?.headers.get(\"x-forwarded-host\");\n  const fromRequestProto = request?.headers.get(\"x-forwarded-proto\");\n  if (fromRequest && fromRequestProto) {\n    return withPath(`${fromRequestProto}://${fromRequest}`, path);\n  }\n  if (request) {\n    const url2 = getOrigin(request.url);\n    if (!url2) {\n      throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_1__.B(\n        \"Could not get origin from request. Please provide a valid base URL.\"\n      );\n    }\n    return withPath(url2, path);\n  }\n  if (typeof window !== \"undefined\" && window.location) {\n    return withPath(window.location.origin, path);\n  }\n  return void 0;\n}\nfunction getOrigin(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.origin;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getProtocol(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.protocol;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getHost(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.host;\n  } catch (error) {\n    return url;\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQ3VTX2VEZEsubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFzRDtBQUNZOztBQUVsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixjQUFjLHdEQUFlO0FBQzdCLDJCQUEyQixJQUFJO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsS0FBSztBQUNoRCxZQUFZLHdCQUF3QixFQUFFLEtBQUs7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQix3REFBRyxvQkFBb0Isd0RBQUcsZ0NBQWdDLHdEQUFHLDJCQUEyQix3REFBRyxnQ0FBZ0Msd0RBQUcsMEJBQTBCLHdEQUFHLG9CQUFvQix3REFBRztBQUNwTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsaUJBQWlCLEtBQUssWUFBWTtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix3REFBZTtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFMkUiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXGRpc3RcXHNoYXJlZFxcYmV0dGVyLWF1dGguQ3VTX2VEZEsubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGUgYXMgZW52IH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5DTVEzckEtSS5tanMnO1xuaW1wb3J0IHsgQiBhcyBCZXR0ZXJBdXRoRXJyb3IgfSBmcm9tICcuL2JldHRlci1hdXRoLkRkelNKZi1uLm1qcyc7XG5cbmZ1bmN0aW9uIGNoZWNrSGFzUGF0aCh1cmwpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKHVybCk7XG4gICAgcmV0dXJuIHBhcnNlZFVybC5wYXRobmFtZSAhPT0gXCIvXCI7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgIGBJbnZhbGlkIGJhc2UgVVJMOiAke3VybH0uIFBsZWFzZSBwcm92aWRlIGEgdmFsaWQgYmFzZSBVUkwuYFxuICAgICk7XG4gIH1cbn1cbmZ1bmN0aW9uIHdpdGhQYXRoKHVybCwgcGF0aCA9IFwiL2FwaS9hdXRoXCIpIHtcbiAgY29uc3QgaGFzUGF0aCA9IGNoZWNrSGFzUGF0aCh1cmwpO1xuICBpZiAoaGFzUGF0aCkge1xuICAgIHJldHVybiB1cmw7XG4gIH1cbiAgcGF0aCA9IHBhdGguc3RhcnRzV2l0aChcIi9cIikgPyBwYXRoIDogYC8ke3BhdGh9YDtcbiAgcmV0dXJuIGAke3VybC5yZXBsYWNlKC9cXC8rJC8sIFwiXCIpfSR7cGF0aH1gO1xufVxuZnVuY3Rpb24gZ2V0QmFzZVVSTCh1cmwsIHBhdGgsIHJlcXVlc3QpIHtcbiAgaWYgKHVybCkge1xuICAgIHJldHVybiB3aXRoUGF0aCh1cmwsIHBhdGgpO1xuICB9XG4gIGNvbnN0IGZyb21FbnYgPSBlbnYuQkVUVEVSX0FVVEhfVVJMIHx8IGVudi5ORVhUX1BVQkxJQ19CRVRURVJfQVVUSF9VUkwgfHwgZW52LlBVQkxJQ19CRVRURVJfQVVUSF9VUkwgfHwgZW52Lk5VWFRfUFVCTElDX0JFVFRFUl9BVVRIX1VSTCB8fCBlbnYuTlVYVF9QVUJMSUNfQVVUSF9VUkwgfHwgKGVudi5CQVNFX1VSTCAhPT0gXCIvXCIgPyBlbnYuQkFTRV9VUkwgOiB2b2lkIDApO1xuICBpZiAoZnJvbUVudikge1xuICAgIHJldHVybiB3aXRoUGF0aChmcm9tRW52LCBwYXRoKTtcbiAgfVxuICBjb25zdCBmcm9tUmVxdWVzdCA9IHJlcXVlc3Q/LmhlYWRlcnMuZ2V0KFwieC1mb3J3YXJkZWQtaG9zdFwiKTtcbiAgY29uc3QgZnJvbVJlcXVlc3RQcm90byA9IHJlcXVlc3Q/LmhlYWRlcnMuZ2V0KFwieC1mb3J3YXJkZWQtcHJvdG9cIik7XG4gIGlmIChmcm9tUmVxdWVzdCAmJiBmcm9tUmVxdWVzdFByb3RvKSB7XG4gICAgcmV0dXJuIHdpdGhQYXRoKGAke2Zyb21SZXF1ZXN0UHJvdG99Oi8vJHtmcm9tUmVxdWVzdH1gLCBwYXRoKTtcbiAgfVxuICBpZiAocmVxdWVzdCkge1xuICAgIGNvbnN0IHVybDIgPSBnZXRPcmlnaW4ocmVxdWVzdC51cmwpO1xuICAgIGlmICghdXJsMikge1xuICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgXCJDb3VsZCBub3QgZ2V0IG9yaWdpbiBmcm9tIHJlcXVlc3QuIFBsZWFzZSBwcm92aWRlIGEgdmFsaWQgYmFzZSBVUkwuXCJcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiB3aXRoUGF0aCh1cmwyLCBwYXRoKTtcbiAgfVxuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB3aW5kb3cubG9jYXRpb24pIHtcbiAgICByZXR1cm4gd2l0aFBhdGgod2luZG93LmxvY2F0aW9uLm9yaWdpbiwgcGF0aCk7XG4gIH1cbiAgcmV0dXJuIHZvaWQgMDtcbn1cbmZ1bmN0aW9uIGdldE9yaWdpbih1cmwpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKHVybCk7XG4gICAgcmV0dXJuIHBhcnNlZFVybC5vcmlnaW47XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cbmZ1bmN0aW9uIGdldFByb3RvY29sKHVybCkge1xuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZFVybCA9IG5ldyBVUkwodXJsKTtcbiAgICByZXR1cm4gcGFyc2VkVXJsLnByb3RvY29sO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5mdW5jdGlvbiBnZXRIb3N0KHVybCkge1xuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZFVybCA9IG5ldyBVUkwodXJsKTtcbiAgICByZXR1cm4gcGFyc2VkVXJsLmhvc3Q7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHVybDtcbiAgfVxufVxuXG5leHBvcnQgeyBnZXRCYXNlVVJMIGFzIGEsIGdldEhvc3QgYXMgYiwgZ2V0UHJvdG9jb2wgYXMgYywgZ2V0T3JpZ2luIGFzIGcgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.CuS_eDdK.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.CujFcMib.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.CujFcMib.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   b: () => (/* binding */ betterAuth),\n/* harmony export */   c: () => (/* binding */ createTelemetry),\n/* harmony export */   g: () => (/* binding */ getTelemetryAuthConfig)\n/* harmony export */ });\n/* harmony import */ var _api_index_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../api/index.mjs */ \"(rsc)/./node_modules/better-auth/dist/api/index.mjs\");\n/* harmony import */ var defu__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! defu */ \"(rsc)/./node_modules/defu/dist/defu.mjs\");\n/* harmony import */ var _crypto_index_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../crypto/index.mjs */ \"(rsc)/./node_modules/better-auth/dist/crypto/index.mjs\");\n/* harmony import */ var _better_auth_DV0Lly8_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./better-auth.DV0Lly8-.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DV0Lly8-.mjs\");\n/* harmony import */ var _better_auth_B_PTVODM_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./better-auth.B_PTVODM.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B_PTVODM.mjs\");\n/* harmony import */ var zod_v4__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! zod/v4 */ \"(rsc)/./node_modules/zod/v4/index.js\");\n/* harmony import */ var _better_auth_Dcv8PS7T_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./better-auth.Dcv8PS7T.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.Dcv8PS7T.mjs\");\n/* harmony import */ var _better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ./better-auth.UfVWArIB.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.UfVWArIB.mjs\");\n/* harmony import */ var _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./better-auth.BjBlybv-.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BjBlybv-.mjs\");\n/* harmony import */ var _better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./better-auth.CewjboYP.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CewjboYP.mjs\");\n/* harmony import */ var _better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ./better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./better-auth.CMQ3rA-I.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CMQ3rA-I.mjs\");\n/* harmony import */ var _better_auth_YwDQhoPc_mjs__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./better-auth.YwDQhoPc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.YwDQhoPc.mjs\");\n/* harmony import */ var _better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./better-auth.CuS_eDdK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CuS_eDdK.mjs\");\n/* harmony import */ var _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./better-auth.DdzSJf-n.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DdzSJf-n.mjs\");\n/* harmony import */ var _better_auth_utils__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! @better-auth/utils */ \"(rsc)/./node_modules/@better-auth/utils/dist/index.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_20__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_21__ = __webpack_require__(/*! @better-fetch/fetch */ \"(rsc)/./node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_22__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var _better_auth_BduPtJy8_mjs__WEBPACK_IMPORTED_MODULE_23__ = __webpack_require__(/*! ./better-auth.BduPtJy8.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BduPtJy8.mjs\");\n/* harmony import */ var _better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_24__ = __webpack_require__(/*! ./better-auth.DV5EHeYG.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DV5EHeYG.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nconst DEFAULT_SECRET = \"better-auth-secret-123456789\";\n\nlet packageJSONCache;\nasync function readRootPackageJson() {\n  if (packageJSONCache) return packageJSONCache;\n  try {\n    const cwd = typeof process !== \"undefined\" && typeof process.cwd === \"function\" ? process.cwd() : \"\";\n    if (!cwd) return void 0;\n    const importRuntime = (m) => Function(\"mm\", \"return import(mm)\")(m);\n    const [{ default: fs }, { default: path }] = await Promise.all([\n      importRuntime(\"fs/promises\"),\n      importRuntime(\"path\")\n    ]);\n    const raw = await fs.readFile(path.join(cwd, \"package.json\"), \"utf-8\");\n    packageJSONCache = JSON.parse(raw);\n    return packageJSONCache;\n  } catch {\n  }\n  return void 0;\n}\nasync function getPackageVersion(pkg) {\n  if (packageJSONCache) {\n    return packageJSONCache.dependencies?.[pkg] || packageJSONCache.devDependencies?.[pkg] || packageJSONCache.peerDependencies?.[pkg];\n  }\n  try {\n    const cwd = typeof process !== \"undefined\" && typeof process.cwd === \"function\" ? process.cwd() : \"\";\n    if (!cwd) throw new Error(\"no-cwd\");\n    const importRuntime = (m) => Function(\"mm\", \"return import(mm)\")(m);\n    const [{ default: fs }, { default: path }] = await Promise.all([\n      importRuntime(\"fs/promises\"),\n      importRuntime(\"path\")\n    ]);\n    const pkgJsonPath = path.join(cwd, \"node_modules\", pkg, \"package.json\");\n    const raw = await fs.readFile(pkgJsonPath, \"utf-8\");\n    const json = JSON.parse(raw);\n    const resolved = json.version || await getVersionFromLocalPackageJson(pkg) || void 0;\n    return resolved;\n  } catch {\n  }\n  const fromRoot = await getVersionFromLocalPackageJson(pkg);\n  return fromRoot;\n}\nasync function getVersionFromLocalPackageJson(pkg) {\n  const json = await readRootPackageJson();\n  if (!json) return void 0;\n  const allDeps = {\n    ...json.dependencies,\n    ...json.devDependencies,\n    ...json.peerDependencies\n  };\n  return allDeps[pkg];\n}\nasync function getNameFromLocalPackageJson() {\n  const json = await readRootPackageJson();\n  return json?.name;\n}\n\nlet projectIdCached = null;\nasync function getProjectId(baseUrl) {\n  if (projectIdCached) return projectIdCached;\n  const projectName = await getNameFromLocalPackageJson();\n  if (projectName) {\n    projectIdCached = await (0,_crypto_index_mjs__WEBPACK_IMPORTED_MODULE_2__.hashToBase64)(\n      baseUrl ? baseUrl + projectName : projectName\n    );\n    return projectIdCached;\n  }\n  if (baseUrl) {\n    projectIdCached = await (0,_crypto_index_mjs__WEBPACK_IMPORTED_MODULE_2__.hashToBase64)(baseUrl);\n    return projectIdCached;\n  }\n  projectIdCached = (0,_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_10__.g)(32);\n  return projectIdCached;\n}\n\nconst importRuntime = (m) => {\n  return Function(\"mm\", \"return import(mm)\")(m);\n};\n\nfunction getVendor() {\n  const hasAny = (...keys) => keys.some((k) => Boolean(_better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.e[k]));\n  if (hasAny(\"CF_PAGES\", \"CF_PAGES_URL\", \"CF_ACCOUNT_ID\") || typeof navigator !== \"undefined\" && navigator.userAgent === \"Cloudflare-Workers\") {\n    return \"cloudflare\";\n  }\n  if (hasAny(\"VERCEL\", \"VERCEL_URL\", \"VERCEL_ENV\")) return \"vercel\";\n  if (hasAny(\"NETLIFY\", \"NETLIFY_URL\")) return \"netlify\";\n  if (hasAny(\n    \"RENDER\",\n    \"RENDER_URL\",\n    \"RENDER_INTERNAL_HOSTNAME\",\n    \"RENDER_SERVICE_ID\"\n  )) {\n    return \"render\";\n  }\n  if (hasAny(\"AWS_LAMBDA_FUNCTION_NAME\", \"AWS_EXECUTION_ENV\", \"LAMBDA_TASK_ROOT\")) {\n    return \"aws\";\n  }\n  if (hasAny(\n    \"GOOGLE_CLOUD_FUNCTION_NAME\",\n    \"GOOGLE_CLOUD_PROJECT\",\n    \"GCP_PROJECT\",\n    \"K_SERVICE\"\n  )) {\n    return \"gcp\";\n  }\n  if (hasAny(\n    \"AZURE_FUNCTION_NAME\",\n    \"FUNCTIONS_WORKER_RUNTIME\",\n    \"WEBSITE_INSTANCE_ID\",\n    \"WEBSITE_SITE_NAME\"\n  )) {\n    return \"azure\";\n  }\n  if (hasAny(\"DENO_DEPLOYMENT_ID\", \"DENO_REGION\")) return \"deno-deploy\";\n  if (hasAny(\"FLY_APP_NAME\", \"FLY_REGION\", \"FLY_ALLOC_ID\")) return \"fly-io\";\n  if (hasAny(\"RAILWAY_STATIC_URL\", \"RAILWAY_ENVIRONMENT_NAME\"))\n    return \"railway\";\n  if (hasAny(\"DYNO\", \"HEROKU_APP_NAME\")) return \"heroku\";\n  if (hasAny(\"DO_DEPLOYMENT_ID\", \"DO_APP_NAME\", \"DIGITALOCEAN\"))\n    return \"digitalocean\";\n  if (hasAny(\"KOYEB\", \"KOYEB_DEPLOYMENT_ID\", \"KOYEB_APP_NAME\")) return \"koyeb\";\n  return null;\n}\nasync function detectSystemInfo() {\n  try {\n    if (getVendor() === \"cloudflare\") return \"cloudflare\";\n    const os = await importRuntime(\"os\");\n    const cpus = os.cpus();\n    return {\n      deploymentVendor: getVendor(),\n      systemPlatform: os.platform(),\n      systemRelease: os.release(),\n      systemArchitecture: os.arch(),\n      cpuCount: cpus.length,\n      cpuModel: cpus.length ? cpus[0].model : null,\n      cpuSpeed: cpus.length ? cpus[0].speed : null,\n      memory: os.totalmem(),\n      isWSL: await isWsl(),\n      isDocker: await isDocker(),\n      isTTY: typeof process !== \"undefined\" && process.stdout ? process.stdout.isTTY : null\n    };\n  } catch (e) {\n    return {\n      systemPlatform: null,\n      systemRelease: null,\n      systemArchitecture: null,\n      cpuCount: null,\n      cpuModel: null,\n      cpuSpeed: null,\n      memory: null,\n      isWSL: null,\n      isDocker: null,\n      isTTY: null\n    };\n  }\n}\nlet isDockerCached;\nasync function hasDockerEnv() {\n  if (getVendor() === \"cloudflare\") return false;\n  try {\n    const fs = await importRuntime(\"fs\");\n    fs.statSync(\"/.dockerenv\");\n    return true;\n  } catch {\n    return false;\n  }\n}\nasync function hasDockerCGroup() {\n  if (getVendor() === \"cloudflare\") return false;\n  try {\n    const fs = await importRuntime(\"fs\");\n    return fs.readFileSync(\"/proc/self/cgroup\", \"utf8\").includes(\"docker\");\n  } catch {\n    return false;\n  }\n}\nasync function isDocker() {\n  if (getVendor() === \"cloudflare\") return false;\n  if (isDockerCached === void 0) {\n    isDockerCached = await hasDockerEnv() || await hasDockerCGroup();\n  }\n  return isDockerCached;\n}\nasync function isWsl() {\n  try {\n    if (getVendor() === \"cloudflare\") return false;\n    if (typeof process === \"undefined\" || process.platform !== \"linux\") {\n      return false;\n    }\n    const fs = await importRuntime(\"fs\");\n    const os = await importRuntime(\"os\");\n    if (os.release().toLowerCase().includes(\"microsoft\")) {\n      if (await isInsideContainer()) {\n        return false;\n      }\n      return true;\n    }\n    return fs.readFileSync(\"/proc/version\", \"utf8\").toLowerCase().includes(\"microsoft\") ? !await isInsideContainer() : false;\n  } catch {\n    return false;\n  }\n}\nlet isInsideContainerCached;\nconst hasContainerEnv = async () => {\n  if (getVendor() === \"cloudflare\") return false;\n  try {\n    const fs = await importRuntime(\"fs\");\n    fs.statSync(\"/run/.containerenv\");\n    return true;\n  } catch {\n    return false;\n  }\n};\nasync function isInsideContainer() {\n  if (isInsideContainerCached === void 0) {\n    isInsideContainerCached = await hasContainerEnv() || await isDocker();\n  }\n  return isInsideContainerCached;\n}\nfunction isCI() {\n  return _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.e.CI !== \"false\" && (\"BUILD_ID\" in _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.e || // Jenkins, Cloudbees\n  \"BUILD_NUMBER\" in _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.e || // Jenkins, TeamCity (fixed typo: extra space removed)\n  \"CI\" in _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.e || // Travis CI, CircleCI, Cirrus CI, Gitlab CI, Appveyor, CodeShip, dsari, Cloudflare\n  \"CI_APP_ID\" in _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.e || // Appflow\n  \"CI_BUILD_ID\" in _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.e || // Appflow\n  \"CI_BUILD_NUMBER\" in _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.e || // Appflow\n  \"CI_NAME\" in _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.e || // Codeship and others\n  \"CONTINUOUS_INTEGRATION\" in _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.e || // Travis CI, Cirrus CI\n  \"RUN_ID\" in _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.e);\n}\n\nfunction detectRuntime() {\n  if (typeof Deno !== \"undefined\") {\n    const denoVersion = Deno?.version?.deno ?? null;\n    return { name: \"deno\", version: denoVersion };\n  }\n  if (typeof Bun !== \"undefined\") {\n    const bunVersion = Bun?.version ?? null;\n    return { name: \"bun\", version: bunVersion };\n  }\n  if (typeof process !== \"undefined\" && process?.versions?.node) {\n    return { name: \"node\", version: process.versions.node ?? null };\n  }\n  return { name: \"edge\", version: null };\n}\nfunction detectEnvironment() {\n  return (0,_better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.g)(\"NODE_ENV\") === \"production\" ? \"production\" : isCI() ? \"ci\" : (0,_better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.i)() ? \"test\" : \"development\";\n}\n\nconst DATABASES = {\n  pg: \"postgresql\",\n  mysql: \"mysql\",\n  mariadb: \"mariadb\",\n  sqlite3: \"sqlite\",\n  \"better-sqlite3\": \"sqlite\",\n  \"@prisma/client\": \"prisma\",\n  mongoose: \"mongodb\",\n  mongodb: \"mongodb\",\n  \"drizzle-orm\": \"drizzle\"\n};\nasync function detectDatabase() {\n  for (const [pkg, name] of Object.entries(DATABASES)) {\n    const version = await getPackageVersion(pkg);\n    if (version) return { name, version };\n  }\n  return void 0;\n}\n\nconst FRAMEWORKS = {\n  next: \"next\",\n  nuxt: \"nuxt\",\n  \"@remix-run/server-runtime\": \"remix\",\n  astro: \"astro\",\n  \"@sveltejs/kit\": \"sveltekit\",\n  \"solid-start\": \"solid-start\",\n  \"tanstack-start\": \"tanstack-start\",\n  hono: \"hono\",\n  express: \"express\",\n  elysia: \"elysia\",\n  expo: \"expo\"\n};\nasync function detectFramework() {\n  for (const [pkg, name] of Object.entries(FRAMEWORKS)) {\n    const version = await getPackageVersion(pkg);\n    if (version) return { name, version };\n  }\n  return void 0;\n}\n\nfunction detectPackageManager() {\n  const userAgent = _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.e.npm_config_user_agent;\n  if (!userAgent) {\n    return void 0;\n  }\n  const pmSpec = userAgent.split(\" \")[0];\n  const separatorPos = pmSpec.lastIndexOf(\"/\");\n  const name = pmSpec.substring(0, separatorPos);\n  return {\n    name: name === \"npminstall\" ? \"cnpm\" : name,\n    version: pmSpec.substring(separatorPos + 1)\n  };\n}\n\nfunction getTelemetryAuthConfig(options, context) {\n  return {\n    database: context?.database,\n    adapter: context?.adapter,\n    emailVerification: {\n      sendVerificationEmail: !!options.emailVerification?.sendVerificationEmail,\n      sendOnSignUp: !!options.emailVerification?.sendOnSignUp,\n      sendOnSignIn: !!options.emailVerification?.sendOnSignIn,\n      autoSignInAfterVerification: !!options.emailVerification?.autoSignInAfterVerification,\n      expiresIn: options.emailVerification?.expiresIn,\n      onEmailVerification: !!options.emailVerification?.onEmailVerification,\n      afterEmailVerification: !!options.emailVerification?.afterEmailVerification\n    },\n    emailAndPassword: {\n      enabled: !!options.emailAndPassword?.enabled,\n      disableSignUp: !!options.emailAndPassword?.disableSignUp,\n      requireEmailVerification: !!options.emailAndPassword?.requireEmailVerification,\n      maxPasswordLength: options.emailAndPassword?.maxPasswordLength,\n      minPasswordLength: options.emailAndPassword?.minPasswordLength,\n      sendResetPassword: !!options.emailAndPassword?.sendResetPassword,\n      resetPasswordTokenExpiresIn: options.emailAndPassword?.resetPasswordTokenExpiresIn,\n      onPasswordReset: !!options.emailAndPassword?.onPasswordReset,\n      password: {\n        hash: !!options.emailAndPassword?.password?.hash,\n        verify: !!options.emailAndPassword?.password?.verify\n      },\n      autoSignIn: !!options.emailAndPassword?.autoSignIn,\n      revokeSessionsOnPasswordReset: !!options.emailAndPassword?.revokeSessionsOnPasswordReset\n    },\n    socialProviders: Object.keys(options.socialProviders || {}).map((p) => {\n      const provider = options.socialProviders?.[p];\n      if (!provider) return {};\n      return {\n        id: p,\n        mapProfileToUser: !!provider.mapProfileToUser,\n        disableDefaultScope: !!provider.disableDefaultScope,\n        disableIdTokenSignIn: !!provider.disableIdTokenSignIn,\n        disableImplicitSignUp: provider.disableImplicitSignUp,\n        disableSignUp: provider.disableSignUp,\n        getUserInfo: !!provider.getUserInfo,\n        overrideUserInfoOnSignIn: !!provider.overrideUserInfoOnSignIn,\n        prompt: provider.prompt,\n        verifyIdToken: !!provider.verifyIdToken,\n        scope: provider.scope,\n        refreshAccessToken: !!provider.refreshAccessToken\n      };\n    }),\n    plugins: options.plugins?.map((p) => p.id.toString()),\n    user: {\n      modelName: options.user?.modelName,\n      fields: options.user?.fields,\n      additionalFields: options.user?.additionalFields,\n      changeEmail: {\n        enabled: options.user?.changeEmail?.enabled,\n        sendChangeEmailVerification: !!options.user?.changeEmail?.sendChangeEmailVerification\n      }\n    },\n    verification: {\n      modelName: options.verification?.modelName,\n      disableCleanup: options.verification?.disableCleanup,\n      fields: options.verification?.fields\n    },\n    session: {\n      modelName: options.session?.modelName,\n      additionalFields: options.session?.additionalFields,\n      cookieCache: {\n        enabled: options.session?.cookieCache?.enabled,\n        maxAge: options.session?.cookieCache?.maxAge\n      },\n      disableSessionRefresh: options.session?.disableSessionRefresh,\n      expiresIn: options.session?.expiresIn,\n      fields: options.session?.fields,\n      freshAge: options.session?.freshAge,\n      preserveSessionInDatabase: options.session?.preserveSessionInDatabase,\n      storeSessionInDatabase: options.session?.storeSessionInDatabase,\n      updateAge: options.session?.updateAge\n    },\n    account: {\n      modelName: options.account?.modelName,\n      fields: options.account?.fields,\n      encryptOAuthTokens: options.account?.encryptOAuthTokens,\n      updateAccountOnSignIn: options.account?.updateAccountOnSignIn,\n      accountLinking: {\n        enabled: options.account?.accountLinking?.enabled,\n        trustedProviders: options.account?.accountLinking?.trustedProviders,\n        updateUserInfoOnLink: options.account?.accountLinking?.updateUserInfoOnLink,\n        allowUnlinkingAll: options.account?.accountLinking?.allowUnlinkingAll\n      }\n    },\n    hooks: {\n      after: !!options.hooks?.after,\n      before: !!options.hooks?.before\n    },\n    secondaryStorage: !!options.secondaryStorage,\n    advanced: {\n      cookiePrefix: !!options.advanced?.cookiePrefix,\n      //this shouldn't be tracked\n      cookies: !!options.advanced?.cookies,\n      crossSubDomainCookies: {\n        domain: !!options.advanced?.crossSubDomainCookies?.domain,\n        enabled: options.advanced?.crossSubDomainCookies?.enabled,\n        additionalCookies: options.advanced?.crossSubDomainCookies?.additionalCookies\n      },\n      database: {\n        useNumberId: !!options.advanced?.database?.useNumberId,\n        generateId: options.advanced?.database?.generateId,\n        defaultFindManyLimit: options.advanced?.database?.defaultFindManyLimit\n      },\n      useSecureCookies: options.advanced?.useSecureCookies,\n      ipAddress: {\n        disableIpTracking: options.advanced?.ipAddress?.disableIpTracking,\n        ipAddressHeaders: options.advanced?.ipAddress?.ipAddressHeaders\n      },\n      disableCSRFCheck: options.advanced?.disableCSRFCheck,\n      cookieAttributes: {\n        expires: options.advanced?.defaultCookieAttributes?.expires,\n        secure: options.advanced?.defaultCookieAttributes?.secure,\n        sameSite: options.advanced?.defaultCookieAttributes?.sameSite,\n        domain: !!options.advanced?.defaultCookieAttributes?.domain,\n        path: options.advanced?.defaultCookieAttributes?.path,\n        httpOnly: options.advanced?.defaultCookieAttributes?.httpOnly\n      }\n    },\n    trustedOrigins: options.trustedOrigins?.length,\n    rateLimit: {\n      storage: options.rateLimit?.storage,\n      modelName: options.rateLimit?.modelName,\n      window: options.rateLimit?.window,\n      customStorage: !!options.rateLimit?.customStorage,\n      enabled: options.rateLimit?.enabled,\n      max: options.rateLimit?.max\n    },\n    onAPIError: {\n      errorURL: options.onAPIError?.errorURL,\n      onError: !!options.onAPIError?.onError,\n      throw: options.onAPIError?.throw\n    },\n    logger: {\n      disabled: options.logger?.disabled,\n      level: options.logger?.level,\n      log: !!options.logger?.log\n    },\n    databaseHooks: {\n      user: {\n        create: {\n          after: !!options.databaseHooks?.user?.create?.after,\n          before: !!options.databaseHooks?.user?.create?.before\n        },\n        update: {\n          after: !!options.databaseHooks?.user?.update?.after,\n          before: !!options.databaseHooks?.user?.update?.before\n        }\n      },\n      session: {\n        create: {\n          after: !!options.databaseHooks?.session?.create?.after,\n          before: !!options.databaseHooks?.session?.create?.before\n        },\n        update: {\n          after: !!options.databaseHooks?.session?.update?.after,\n          before: !!options.databaseHooks?.session?.update?.before\n        }\n      },\n      account: {\n        create: {\n          after: !!options.databaseHooks?.account?.create?.after,\n          before: !!options.databaseHooks?.account?.create?.before\n        },\n        update: {\n          after: !!options.databaseHooks?.account?.update?.after,\n          before: !!options.databaseHooks?.account?.update?.before\n        }\n      },\n      verification: {\n        create: {\n          after: !!options.databaseHooks?.verification?.create?.after,\n          before: !!options.databaseHooks?.verification?.create?.before\n        },\n        update: {\n          after: !!options.databaseHooks?.verification?.update?.after,\n          before: !!options.databaseHooks?.verification?.update?.before\n        }\n      }\n    }\n  };\n}\n\nasync function createTelemetry(options, context) {\n  const debugEnabled = options.telemetry?.debug || (0,_better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.c)(\"BETTER_AUTH_TELEMETRY_DEBUG\", false);\n  const TELEMETRY_ENDPOINT = _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.E.BETTER_AUTH_TELEMETRY_ENDPOINT;\n  const track = async (event) => {\n    try {\n      if (context?.customTrack) {\n        await context.customTrack(event);\n      } else {\n        if (debugEnabled) {\n          await Promise.resolve(\n            _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_8__.a.info(\"telemetry event\", JSON.stringify(event, null, 2))\n          );\n        } else {\n          await (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_21__.betterFetch)(TELEMETRY_ENDPOINT, {\n            method: \"POST\",\n            body: event\n          });\n        }\n      }\n    } catch {\n    }\n  };\n  const isEnabled = async () => {\n    const telemetryEnabled = options.telemetry?.enabled !== void 0 ? options.telemetry.enabled : false;\n    const envEnabled = (0,_better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.c)(\"BETTER_AUTH_TELEMETRY\", false);\n    return (envEnabled || telemetryEnabled) && (context?.skipTestCheck || !(0,_better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.i)());\n  };\n  const enabled = await isEnabled();\n  let anonymousId;\n  if (enabled) {\n    anonymousId = await getProjectId(options.baseURL);\n    const payload = {\n      config: getTelemetryAuthConfig(options),\n      runtime: detectRuntime(),\n      database: await detectDatabase(),\n      framework: await detectFramework(),\n      environment: detectEnvironment(),\n      systemInfo: await detectSystemInfo(),\n      packageManager: detectPackageManager()\n    };\n    void track({ type: \"init\", payload, anonymousId });\n  }\n  return {\n    publish: async (event) => {\n      if (!enabled) return;\n      if (!anonymousId) {\n        anonymousId = await getProjectId(options.baseURL);\n      }\n      await track({\n        type: event.type,\n        payload: event.payload,\n        anonymousId\n      });\n    }\n  };\n}\n\nconst init = async (options) => {\n  const adapter = await (0,_better_auth_DV0Lly8_mjs__WEBPACK_IMPORTED_MODULE_3__.a)(options);\n  const plugins = options.plugins || [];\n  const internalPlugins = getInternalPlugins(options);\n  const logger = (0,_better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_8__.c)(options.logger);\n  const baseURL = (0,_better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_17__.a)(options.baseURL, options.basePath);\n  const secret = options.secret || _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.e.BETTER_AUTH_SECRET || _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.e.AUTH_SECRET || DEFAULT_SECRET;\n  if (secret === DEFAULT_SECRET) {\n    if (_better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.a) {\n      logger.error(\n        \"You are using the default secret. Please set `BETTER_AUTH_SECRET` in your environment variables or pass `secret` in your auth config.\"\n      );\n    }\n  }\n  options = {\n    ...options,\n    secret,\n    baseURL: baseURL ? new URL(baseURL).origin : \"\",\n    basePath: options.basePath || \"/api/auth\",\n    plugins: plugins.concat(internalPlugins)\n  };\n  (0,_api_index_mjs__WEBPACK_IMPORTED_MODULE_0__.checkEndpointConflicts)(options, logger);\n  const cookies = (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_7__.g)(options);\n  const tables = (0,_better_auth_B_PTVODM_mjs__WEBPACK_IMPORTED_MODULE_4__.g)(options);\n  const providers = Object.entries(\n    options.socialProviders || {}\n  ).map(([key, config]) => {\n    if (config == null) {\n      return null;\n    }\n    if (config.enabled === false) {\n      return null;\n    }\n    if (!config.clientId) {\n      logger.warn(\n        `Social provider ${key} is missing clientId or clientSecret`\n      );\n    }\n    const provider = _better_auth_CewjboYP_mjs__WEBPACK_IMPORTED_MODULE_9__.U[key](config);\n    provider.disableImplicitSignUp = config.disableImplicitSignUp;\n    return provider;\n  }).filter((x) => x !== null);\n  const generateIdFunc = ({ model, size }) => {\n    if (typeof options.advanced?.generateId === \"function\") {\n      return options.advanced.generateId({ model, size });\n    }\n    if (typeof options?.advanced?.database?.generateId === \"function\") {\n      return options.advanced.database.generateId({ model, size });\n    }\n    return (0,_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_10__.g)(size);\n  };\n  const { publish } = await createTelemetry(options, {\n    adapter: adapter.id,\n    database: typeof options.database === \"function\" ? \"adapter\" : (0,_better_auth_BduPtJy8_mjs__WEBPACK_IMPORTED_MODULE_23__.g)(options.database) || \"unknown\"\n  });\n  let ctx = {\n    appName: options.appName || \"Better Auth\",\n    socialProviders: providers,\n    options,\n    tables,\n    trustedOrigins: getTrustedOrigins(options),\n    baseURL: baseURL || \"\",\n    sessionConfig: {\n      updateAge: options.session?.updateAge !== void 0 ? options.session.updateAge : 24 * 60 * 60,\n      // 24 hours\n      expiresIn: options.session?.expiresIn || 60 * 60 * 24 * 7,\n      // 7 days\n      freshAge: options.session?.freshAge === void 0 ? 60 * 60 * 24 : options.session.freshAge\n    },\n    secret,\n    rateLimit: {\n      ...options.rateLimit,\n      enabled: options.rateLimit?.enabled ?? _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.a,\n      window: options.rateLimit?.window || 10,\n      max: options.rateLimit?.max || 100,\n      storage: options.rateLimit?.storage || (options.secondaryStorage ? \"secondary-storage\" : \"memory\")\n    },\n    authCookies: cookies,\n    logger,\n    generateId: generateIdFunc,\n    session: null,\n    secondaryStorage: options.secondaryStorage,\n    password: {\n      hash: options.emailAndPassword?.password?.hash || _crypto_index_mjs__WEBPACK_IMPORTED_MODULE_2__.hashPassword,\n      verify: options.emailAndPassword?.password?.verify || _crypto_index_mjs__WEBPACK_IMPORTED_MODULE_2__.verifyPassword,\n      config: {\n        minPasswordLength: options.emailAndPassword?.minPasswordLength || 8,\n        maxPasswordLength: options.emailAndPassword?.maxPasswordLength || 128\n      },\n      checkPassword: _better_auth_YwDQhoPc_mjs__WEBPACK_IMPORTED_MODULE_16__.c\n    },\n    setNewSession(session) {\n      this.newSession = session;\n    },\n    newSession: null,\n    adapter,\n    internalAdapter: (0,_better_auth_DV0Lly8_mjs__WEBPACK_IMPORTED_MODULE_3__.c)(adapter, {\n      options,\n      logger,\n      hooks: options.databaseHooks ? [options.databaseHooks] : []}),\n    createAuthCookie: (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_7__.c)(options),\n    async runMigrations() {\n      if (!options.database || \"updateMany\" in options.database) {\n        throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_18__.B(\n          \"Database is not provided or it's an adapter. Migrations are only supported with a database instance.\"\n        );\n      }\n      const { runMigrations } = await (0,_better_auth_DV0Lly8_mjs__WEBPACK_IMPORTED_MODULE_3__.e)(options);\n      await runMigrations();\n    },\n    publishTelemetry: publish\n  };\n  let { context } = runPluginInit(ctx);\n  return context;\n};\nfunction runPluginInit(ctx) {\n  let options = ctx.options;\n  const plugins = options.plugins || [];\n  let context = ctx;\n  const dbHooks = [];\n  for (const plugin of plugins) {\n    if (plugin.init) {\n      const result = plugin.init(context);\n      if (typeof result === \"object\") {\n        if (result.options) {\n          const { databaseHooks, ...restOpts } = result.options;\n          if (databaseHooks) {\n            dbHooks.push(databaseHooks);\n          }\n          options = (0,defu__WEBPACK_IMPORTED_MODULE_1__.defu)(options, restOpts);\n        }\n        if (result.context) {\n          context = {\n            ...context,\n            ...result.context\n          };\n        }\n      }\n    }\n  }\n  dbHooks.push(options.databaseHooks);\n  context.internalAdapter = (0,_better_auth_DV0Lly8_mjs__WEBPACK_IMPORTED_MODULE_3__.c)(ctx.adapter, {\n    options,\n    logger: ctx.logger,\n    hooks: dbHooks.filter((u) => u !== void 0),\n    generateId: ctx.generateId\n  });\n  context.options = options;\n  return { context };\n}\nfunction getInternalPlugins(options) {\n  const plugins = [];\n  if (options.advanced?.crossSubDomainCookies?.enabled) ;\n  return plugins;\n}\nfunction getTrustedOrigins(options) {\n  const baseURL = (0,_better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_17__.a)(options.baseURL, options.basePath);\n  if (!baseURL) {\n    return [];\n  }\n  const trustedOrigins = [new URL(baseURL).origin];\n  if (options.trustedOrigins && Array.isArray(options.trustedOrigins)) {\n    trustedOrigins.push(...options.trustedOrigins);\n  }\n  const envTrustedOrigins = _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_15__.e.BETTER_AUTH_TRUSTED_ORIGINS;\n  if (envTrustedOrigins) {\n    trustedOrigins.push(...envTrustedOrigins.split(\",\"));\n  }\n  if (trustedOrigins.filter((x) => !x).length) {\n    throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_18__.B(\n      \"A provided trusted origin is invalid, make sure your trusted origins list is properly defined.\"\n    );\n  }\n  return trustedOrigins;\n}\n\nconst betterAuth = (options) => {\n  const authContext = init(options);\n  const { api } = (0,_api_index_mjs__WEBPACK_IMPORTED_MODULE_0__.getEndpoints)(authContext, options);\n  const errorCodes = options.plugins?.reduce((acc, plugin) => {\n    if (plugin.$ERROR_CODES) {\n      return {\n        ...acc,\n        ...plugin.$ERROR_CODES\n      };\n    }\n    return acc;\n  }, {});\n  return {\n    handler: async (request) => {\n      const ctx = await authContext;\n      const basePath = ctx.options.basePath || \"/api/auth\";\n      if (!ctx.options.baseURL) {\n        const baseURL = (0,_better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_17__.a)(void 0, basePath, request);\n        if (baseURL) {\n          ctx.baseURL = baseURL;\n          ctx.options.baseURL = (0,_better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_17__.g)(ctx.baseURL) || void 0;\n        } else {\n          throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_18__.B(\n            \"Could not get base URL from request. Please provide a valid base URL.\"\n          );\n        }\n      }\n      ctx.trustedOrigins = [\n        ...options.trustedOrigins ? Array.isArray(options.trustedOrigins) ? options.trustedOrigins : await options.trustedOrigins(request) : [],\n        ctx.options.baseURL\n      ];\n      const { handler } = (0,_api_index_mjs__WEBPACK_IMPORTED_MODULE_0__.router)(ctx, options);\n      return handler(request);\n    },\n    api,\n    options,\n    $context: authContext,\n    $Infer: {},\n    $ERROR_CODES: {\n      ...errorCodes,\n      ..._better_auth_DV5EHeYG_mjs__WEBPACK_IMPORTED_MODULE_24__.B\n    }\n  };\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQ3VqRmNNaWIubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBZ0Y7QUFDcEQ7QUFDcUQ7QUFDNEI7QUFDN0M7QUFDaEQ7QUFDb0I7QUFDa0Q7QUFDVjtBQUNWO0FBQ0w7QUFDeEM7QUFDWTtBQUNDO0FBQ0Q7QUFDRTtBQUNyQjtBQUNzQjtBQUNtRztBQUN2RTtBQUNhO0FBQ1g7QUFDakM7QUFDTDtBQUNJO0FBQ0E7QUFDa0I7QUFDZjtBQUNxQztBQUNMOztBQUVuRTs7QUFFQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsYUFBYSxJQUFJLGVBQWU7QUFDN0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhLGFBQWEsSUFBSSxlQUFlO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsK0RBQVk7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QiwrREFBWTtBQUN4QztBQUNBO0FBQ0Esb0JBQW9CLDZEQUFVO0FBQzlCO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0EsdURBQXVELHlEQUFHO0FBQzFEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7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LDJEQUFhO0FBQ25EO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxRQUFRLFVBQVU7QUFDbEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLDZCQUE2QjtBQUMvQztBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsMENBQUk7QUFDeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRCQUE0QiwyREFBcUI7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsNkRBQVU7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIseURBQUc7QUFDL0I7QUFDQTtBQUNBO0FBQ0E7QUFDQSxjQUFjLHlEQUFlO0FBQzdCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLFVBQVUsTUFBTSxFQUFFLDREQUFZO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHLElBQUk7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLDZEQUFVO0FBQ2xDO0FBQ0E7QUFDQSxnQ0FBZ0MsNkRBQVM7QUFDekMsVUFBVTtBQUNWLG9CQUFvQix5REFBZTtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsY0FBYyxVQUFVLEVBQUUsc0RBQU07QUFDaEM7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0EsY0FBYztBQUNkO0FBQ0E7QUFDQSxTQUFTLHlEQUFnQjtBQUN6QjtBQUNBO0FBQ0E7O0FBRThFIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxzaGFyZWRcXGJldHRlci1hdXRoLkN1akZjTWliLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjaGVja0VuZHBvaW50Q29uZmxpY3RzLCBnZXRFbmRwb2ludHMsIHJvdXRlciB9IGZyb20gJy4uL2FwaS9pbmRleC5tanMnO1xuaW1wb3J0IHsgZGVmdSB9IGZyb20gJ2RlZnUnO1xuaW1wb3J0IHsgaGFzaFRvQmFzZTY0LCB2ZXJpZnlQYXNzd29yZCwgaGFzaFBhc3N3b3JkIH0gZnJvbSAnLi4vY3J5cHRvL2luZGV4Lm1qcyc7XG5pbXBvcnQgeyBhIGFzIGdldEFkYXB0ZXIsIGMgYXMgY3JlYXRlSW50ZXJuYWxBZGFwdGVyLCBlIGFzIGdldE1pZ3JhdGlvbnMgfSBmcm9tICcuL2JldHRlci1hdXRoLkRWMExseTgtLm1qcyc7XG5pbXBvcnQgeyBnIGFzIGdldEF1dGhUYWJsZXMgfSBmcm9tICcuL2JldHRlci1hdXRoLkJfUFRWT0RNLm1qcyc7XG5pbXBvcnQgJ3pvZC92NCc7XG5pbXBvcnQgJy4vYmV0dGVyLWF1dGguRGN2OFBTN1QubWpzJztcbmltcG9ydCB7IGcgYXMgZ2V0Q29va2llcywgYyBhcyBjcmVhdGVDb29raWVHZXR0ZXIgfSBmcm9tICcuL2JldHRlci1hdXRoLlVmVldBcklCLm1qcyc7XG5pbXBvcnQgeyBhIGFzIGxvZ2dlciwgYyBhcyBjcmVhdGVMb2dnZXIgfSBmcm9tICcuL2JldHRlci1hdXRoLkJqQmx5YnYtLm1qcyc7XG5pbXBvcnQgeyBVIGFzIHNvY2lhbFByb3ZpZGVycyB9IGZyb20gJy4vYmV0dGVyLWF1dGguQ2V3amJvWVAubWpzJztcbmltcG9ydCB7IGcgYXMgZ2VuZXJhdGVJZCB9IGZyb20gJy4vYmV0dGVyLWF1dGguQlVQUFJYZksubWpzJztcbmltcG9ydCAnYmV0dGVyLWNhbGwnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaGFzaCc7XG5pbXBvcnQgJ0Bub2JsZS9jaXBoZXJzL2NoYWNoYS5qcyc7XG5pbXBvcnQgJ0Bub2JsZS9jaXBoZXJzL3V0aWxzLmpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2Jhc2U2NCc7XG5pbXBvcnQgJ2pvc2UnO1xuaW1wb3J0ICcuL2JldHRlci1hdXRoLkI0UW94ZGdjLm1qcyc7XG5pbXBvcnQgeyBlIGFzIGVudiwgZyBhcyBnZXRFbnZWYXIsIGkgYXMgaXNUZXN0LCBjIGFzIGdldEJvb2xlYW5FbnZWYXIsIEUgYXMgRU5WLCBhIGFzIGlzUHJvZHVjdGlvbiB9IGZyb20gJy4vYmV0dGVyLWF1dGguQ01RM3JBLUkubWpzJztcbmltcG9ydCB7IGMgYXMgY2hlY2tQYXNzd29yZCB9IGZyb20gJy4vYmV0dGVyLWF1dGguWXdEUWhvUGMubWpzJztcbmltcG9ydCB7IGEgYXMgZ2V0QmFzZVVSTCwgZyBhcyBnZXRPcmlnaW4gfSBmcm9tICcuL2JldHRlci1hdXRoLkN1U19lRGRLLm1qcyc7XG5pbXBvcnQgeyBCIGFzIEJldHRlckF1dGhFcnJvciB9IGZyb20gJy4vYmV0dGVyLWF1dGguRGR6U0pmLW4ubWpzJztcbmltcG9ydCAnQG5vYmxlL2hhc2hlcy9zY3J5cHQuanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaGV4JztcbmltcG9ydCAnQG5vYmxlL2hhc2hlcy91dGlscy5qcyc7XG5pbXBvcnQgeyBiZXR0ZXJGZXRjaCB9IGZyb20gJ0BiZXR0ZXItZmV0Y2gvZmV0Y2gnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvcmFuZG9tJztcbmltcG9ydCB7IGcgYXMgZ2V0S3lzZWx5RGF0YWJhc2VUeXBlIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5CZHVQdEp5OC5tanMnO1xuaW1wb3J0IHsgQiBhcyBCQVNFX0VSUk9SX0NPREVTIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5EVjVFSGVZRy5tanMnO1xuXG5jb25zdCBERUZBVUxUX1NFQ1JFVCA9IFwiYmV0dGVyLWF1dGgtc2VjcmV0LTEyMzQ1Njc4OVwiO1xuXG5sZXQgcGFja2FnZUpTT05DYWNoZTtcbmFzeW5jIGZ1bmN0aW9uIHJlYWRSb290UGFja2FnZUpzb24oKSB7XG4gIGlmIChwYWNrYWdlSlNPTkNhY2hlKSByZXR1cm4gcGFja2FnZUpTT05DYWNoZTtcbiAgdHJ5IHtcbiAgICBjb25zdCBjd2QgPSB0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0eXBlb2YgcHJvY2Vzcy5jd2QgPT09IFwiZnVuY3Rpb25cIiA/IHByb2Nlc3MuY3dkKCkgOiBcIlwiO1xuICAgIGlmICghY3dkKSByZXR1cm4gdm9pZCAwO1xuICAgIGNvbnN0IGltcG9ydFJ1bnRpbWUgPSAobSkgPT4gRnVuY3Rpb24oXCJtbVwiLCBcInJldHVybiBpbXBvcnQobW0pXCIpKG0pO1xuICAgIGNvbnN0IFt7IGRlZmF1bHQ6IGZzIH0sIHsgZGVmYXVsdDogcGF0aCB9XSA9IGF3YWl0IFByb21pc2UuYWxsKFtcbiAgICAgIGltcG9ydFJ1bnRpbWUoXCJmcy9wcm9taXNlc1wiKSxcbiAgICAgIGltcG9ydFJ1bnRpbWUoXCJwYXRoXCIpXG4gICAgXSk7XG4gICAgY29uc3QgcmF3ID0gYXdhaXQgZnMucmVhZEZpbGUocGF0aC5qb2luKGN3ZCwgXCJwYWNrYWdlLmpzb25cIiksIFwidXRmLThcIik7XG4gICAgcGFja2FnZUpTT05DYWNoZSA9IEpTT04ucGFyc2UocmF3KTtcbiAgICByZXR1cm4gcGFja2FnZUpTT05DYWNoZTtcbiAgfSBjYXRjaCB7XG4gIH1cbiAgcmV0dXJuIHZvaWQgMDtcbn1cbmFzeW5jIGZ1bmN0aW9uIGdldFBhY2thZ2VWZXJzaW9uKHBrZykge1xuICBpZiAocGFja2FnZUpTT05DYWNoZSkge1xuICAgIHJldHVybiBwYWNrYWdlSlNPTkNhY2hlLmRlcGVuZGVuY2llcz8uW3BrZ10gfHwgcGFja2FnZUpTT05DYWNoZS5kZXZEZXBlbmRlbmNpZXM/Lltwa2ddIHx8IHBhY2thZ2VKU09OQ2FjaGUucGVlckRlcGVuZGVuY2llcz8uW3BrZ107XG4gIH1cbiAgdHJ5IHtcbiAgICBjb25zdCBjd2QgPSB0eXBlb2YgcHJvY2VzcyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB0eXBlb2YgcHJvY2Vzcy5jd2QgPT09IFwiZnVuY3Rpb25cIiA/IHByb2Nlc3MuY3dkKCkgOiBcIlwiO1xuICAgIGlmICghY3dkKSB0aHJvdyBuZXcgRXJyb3IoXCJuby1jd2RcIik7XG4gICAgY29uc3QgaW1wb3J0UnVudGltZSA9IChtKSA9PiBGdW5jdGlvbihcIm1tXCIsIFwicmV0dXJuIGltcG9ydChtbSlcIikobSk7XG4gICAgY29uc3QgW3sgZGVmYXVsdDogZnMgfSwgeyBkZWZhdWx0OiBwYXRoIH1dID0gYXdhaXQgUHJvbWlzZS5hbGwoW1xuICAgICAgaW1wb3J0UnVudGltZShcImZzL3Byb21pc2VzXCIpLFxuICAgICAgaW1wb3J0UnVudGltZShcInBhdGhcIilcbiAgICBdKTtcbiAgICBjb25zdCBwa2dKc29uUGF0aCA9IHBhdGguam9pbihjd2QsIFwibm9kZV9tb2R1bGVzXCIsIHBrZywgXCJwYWNrYWdlLmpzb25cIik7XG4gICAgY29uc3QgcmF3ID0gYXdhaXQgZnMucmVhZEZpbGUocGtnSnNvblBhdGgsIFwidXRmLThcIik7XG4gICAgY29uc3QganNvbiA9IEpTT04ucGFyc2UocmF3KTtcbiAgICBjb25zdCByZXNvbHZlZCA9IGpzb24udmVyc2lvbiB8fCBhd2FpdCBnZXRWZXJzaW9uRnJvbUxvY2FsUGFja2FnZUpzb24ocGtnKSB8fCB2b2lkIDA7XG4gICAgcmV0dXJuIHJlc29sdmVkO1xuICB9IGNhdGNoIHtcbiAgfVxuICBjb25zdCBmcm9tUm9vdCA9IGF3YWl0IGdldFZlcnNpb25Gcm9tTG9jYWxQYWNrYWdlSnNvbihwa2cpO1xuICByZXR1cm4gZnJvbVJvb3Q7XG59XG5hc3luYyBmdW5jdGlvbiBnZXRWZXJzaW9uRnJvbUxvY2FsUGFja2FnZUpzb24ocGtnKSB7XG4gIGNvbnN0IGpzb24gPSBhd2FpdCByZWFkUm9vdFBhY2thZ2VKc29uKCk7XG4gIGlmICghanNvbikgcmV0dXJuIHZvaWQgMDtcbiAgY29uc3QgYWxsRGVwcyA9IHtcbiAgICAuLi5qc29uLmRlcGVuZGVuY2llcyxcbiAgICAuLi5qc29uLmRldkRlcGVuZGVuY2llcyxcbiAgICAuLi5qc29uLnBlZXJEZXBlbmRlbmNpZXNcbiAgfTtcbiAgcmV0dXJuIGFsbERlcHNbcGtnXTtcbn1cbmFzeW5jIGZ1bmN0aW9uIGdldE5hbWVGcm9tTG9jYWxQYWNrYWdlSnNvbigpIHtcbiAgY29uc3QganNvbiA9IGF3YWl0IHJlYWRSb290UGFja2FnZUpzb24oKTtcbiAgcmV0dXJuIGpzb24/Lm5hbWU7XG59XG5cbmxldCBwcm9qZWN0SWRDYWNoZWQgPSBudWxsO1xuYXN5bmMgZnVuY3Rpb24gZ2V0UHJvamVjdElkKGJhc2VVcmwpIHtcbiAgaWYgKHByb2plY3RJZENhY2hlZCkgcmV0dXJuIHByb2plY3RJZENhY2hlZDtcbiAgY29uc3QgcHJvamVjdE5hbWUgPSBhd2FpdCBnZXROYW1lRnJvbUxvY2FsUGFja2FnZUpzb24oKTtcbiAgaWYgKHByb2plY3ROYW1lKSB7XG4gICAgcHJvamVjdElkQ2FjaGVkID0gYXdhaXQgaGFzaFRvQmFzZTY0KFxuICAgICAgYmFzZVVybCA/IGJhc2VVcmwgKyBwcm9qZWN0TmFtZSA6IHByb2plY3ROYW1lXG4gICAgKTtcbiAgICByZXR1cm4gcHJvamVjdElkQ2FjaGVkO1xuICB9XG4gIGlmIChiYXNlVXJsKSB7XG4gICAgcHJvamVjdElkQ2FjaGVkID0gYXdhaXQgaGFzaFRvQmFzZTY0KGJhc2VVcmwpO1xuICAgIHJldHVybiBwcm9qZWN0SWRDYWNoZWQ7XG4gIH1cbiAgcHJvamVjdElkQ2FjaGVkID0gZ2VuZXJhdGVJZCgzMik7XG4gIHJldHVybiBwcm9qZWN0SWRDYWNoZWQ7XG59XG5cbmNvbnN0IGltcG9ydFJ1bnRpbWUgPSAobSkgPT4ge1xuICByZXR1cm4gRnVuY3Rpb24oXCJtbVwiLCBcInJldHVybiBpbXBvcnQobW0pXCIpKG0pO1xufTtcblxuZnVuY3Rpb24gZ2V0VmVuZG9yKCkge1xuICBjb25zdCBoYXNBbnkgPSAoLi4ua2V5cykgPT4ga2V5cy5zb21lKChrKSA9PiBCb29sZWFuKGVudltrXSkpO1xuICBpZiAoaGFzQW55KFwiQ0ZfUEFHRVNcIiwgXCJDRl9QQUdFU19VUkxcIiwgXCJDRl9BQ0NPVU5UX0lEXCIpIHx8IHR5cGVvZiBuYXZpZ2F0b3IgIT09IFwidW5kZWZpbmVkXCIgJiYgbmF2aWdhdG9yLnVzZXJBZ2VudCA9PT0gXCJDbG91ZGZsYXJlLVdvcmtlcnNcIikge1xuICAgIHJldHVybiBcImNsb3VkZmxhcmVcIjtcbiAgfVxuICBpZiAoaGFzQW55KFwiVkVSQ0VMXCIsIFwiVkVSQ0VMX1VSTFwiLCBcIlZFUkNFTF9FTlZcIikpIHJldHVybiBcInZlcmNlbFwiO1xuICBpZiAoaGFzQW55KFwiTkVUTElGWVwiLCBcIk5FVExJRllfVVJMXCIpKSByZXR1cm4gXCJuZXRsaWZ5XCI7XG4gIGlmIChoYXNBbnkoXG4gICAgXCJSRU5ERVJcIixcbiAgICBcIlJFTkRFUl9VUkxcIixcbiAgICBcIlJFTkRFUl9JTlRFUk5BTF9IT1NUTkFNRVwiLFxuICAgIFwiUkVOREVSX1NFUlZJQ0VfSURcIlxuICApKSB7XG4gICAgcmV0dXJuIFwicmVuZGVyXCI7XG4gIH1cbiAgaWYgKGhhc0FueShcIkFXU19MQU1CREFfRlVOQ1RJT05fTkFNRVwiLCBcIkFXU19FWEVDVVRJT05fRU5WXCIsIFwiTEFNQkRBX1RBU0tfUk9PVFwiKSkge1xuICAgIHJldHVybiBcImF3c1wiO1xuICB9XG4gIGlmIChoYXNBbnkoXG4gICAgXCJHT09HTEVfQ0xPVURfRlVOQ1RJT05fTkFNRVwiLFxuICAgIFwiR09PR0xFX0NMT1VEX1BST0pFQ1RcIixcbiAgICBcIkdDUF9QUk9KRUNUXCIsXG4gICAgXCJLX1NFUlZJQ0VcIlxuICApKSB7XG4gICAgcmV0dXJuIFwiZ2NwXCI7XG4gIH1cbiAgaWYgKGhhc0FueShcbiAgICBcIkFaVVJFX0ZVTkNUSU9OX05BTUVcIixcbiAgICBcIkZVTkNUSU9OU19XT1JLRVJfUlVOVElNRVwiLFxuICAgIFwiV0VCU0lURV9JTlNUQU5DRV9JRFwiLFxuICAgIFwiV0VCU0lURV9TSVRFX05BTUVcIlxuICApKSB7XG4gICAgcmV0dXJuIFwiYXp1cmVcIjtcbiAgfVxuICBpZiAoaGFzQW55KFwiREVOT19ERVBMT1lNRU5UX0lEXCIsIFwiREVOT19SRUdJT05cIikpIHJldHVybiBcImRlbm8tZGVwbG95XCI7XG4gIGlmIChoYXNBbnkoXCJGTFlfQVBQX05BTUVcIiwgXCJGTFlfUkVHSU9OXCIsIFwiRkxZX0FMTE9DX0lEXCIpKSByZXR1cm4gXCJmbHktaW9cIjtcbiAgaWYgKGhhc0FueShcIlJBSUxXQVlfU1RBVElDX1VSTFwiLCBcIlJBSUxXQVlfRU5WSVJPTk1FTlRfTkFNRVwiKSlcbiAgICByZXR1cm4gXCJyYWlsd2F5XCI7XG4gIGlmIChoYXNBbnkoXCJEWU5PXCIsIFwiSEVST0tVX0FQUF9OQU1FXCIpKSByZXR1cm4gXCJoZXJva3VcIjtcbiAgaWYgKGhhc0FueShcIkRPX0RFUExPWU1FTlRfSURcIiwgXCJET19BUFBfTkFNRVwiLCBcIkRJR0lUQUxPQ0VBTlwiKSlcbiAgICByZXR1cm4gXCJkaWdpdGFsb2NlYW5cIjtcbiAgaWYgKGhhc0FueShcIktPWUVCXCIsIFwiS09ZRUJfREVQTE9ZTUVOVF9JRFwiLCBcIktPWUVCX0FQUF9OQU1FXCIpKSByZXR1cm4gXCJrb3llYlwiO1xuICByZXR1cm4gbnVsbDtcbn1cbmFzeW5jIGZ1bmN0aW9uIGRldGVjdFN5c3RlbUluZm8oKSB7XG4gIHRyeSB7XG4gICAgaWYgKGdldFZlbmRvcigpID09PSBcImNsb3VkZmxhcmVcIikgcmV0dXJuIFwiY2xvdWRmbGFyZVwiO1xuICAgIGNvbnN0IG9zID0gYXdhaXQgaW1wb3J0UnVudGltZShcIm9zXCIpO1xuICAgIGNvbnN0IGNwdXMgPSBvcy5jcHVzKCk7XG4gICAgcmV0dXJuIHtcbiAgICAgIGRlcGxveW1lbnRWZW5kb3I6IGdldFZlbmRvcigpLFxuICAgICAgc3lzdGVtUGxhdGZvcm06IG9zLnBsYXRmb3JtKCksXG4gICAgICBzeXN0ZW1SZWxlYXNlOiBvcy5yZWxlYXNlKCksXG4gICAgICBzeXN0ZW1BcmNoaXRlY3R1cmU6IG9zLmFyY2goKSxcbiAgICAgIGNwdUNvdW50OiBjcHVzLmxlbmd0aCxcbiAgICAgIGNwdU1vZGVsOiBjcHVzLmxlbmd0aCA/IGNwdXNbMF0ubW9kZWwgOiBudWxsLFxuICAgICAgY3B1U3BlZWQ6IGNwdXMubGVuZ3RoID8gY3B1c1swXS5zcGVlZCA6IG51bGwsXG4gICAgICBtZW1vcnk6IG9zLnRvdGFsbWVtKCksXG4gICAgICBpc1dTTDogYXdhaXQgaXNXc2woKSxcbiAgICAgIGlzRG9ja2VyOiBhd2FpdCBpc0RvY2tlcigpLFxuICAgICAgaXNUVFk6IHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3Muc3Rkb3V0ID8gcHJvY2Vzcy5zdGRvdXQuaXNUVFkgOiBudWxsXG4gICAgfTtcbiAgfSBjYXRjaCAoZSkge1xuICAgIHJldHVybiB7XG4gICAgICBzeXN0ZW1QbGF0Zm9ybTogbnVsbCxcbiAgICAgIHN5c3RlbVJlbGVhc2U6IG51bGwsXG4gICAgICBzeXN0ZW1BcmNoaXRlY3R1cmU6IG51bGwsXG4gICAgICBjcHVDb3VudDogbnVsbCxcbiAgICAgIGNwdU1vZGVsOiBudWxsLFxuICAgICAgY3B1U3BlZWQ6IG51bGwsXG4gICAgICBtZW1vcnk6IG51bGwsXG4gICAgICBpc1dTTDogbnVsbCxcbiAgICAgIGlzRG9ja2VyOiBudWxsLFxuICAgICAgaXNUVFk6IG51bGxcbiAgICB9O1xuICB9XG59XG5sZXQgaXNEb2NrZXJDYWNoZWQ7XG5hc3luYyBmdW5jdGlvbiBoYXNEb2NrZXJFbnYoKSB7XG4gIGlmIChnZXRWZW5kb3IoKSA9PT0gXCJjbG91ZGZsYXJlXCIpIHJldHVybiBmYWxzZTtcbiAgdHJ5IHtcbiAgICBjb25zdCBmcyA9IGF3YWl0IGltcG9ydFJ1bnRpbWUoXCJmc1wiKTtcbiAgICBmcy5zdGF0U3luYyhcIi8uZG9ja2VyZW52XCIpO1xuICAgIHJldHVybiB0cnVlO1xuICB9IGNhdGNoIHtcbiAgICByZXR1cm4gZmFsc2U7XG4gIH1cbn1cbmFzeW5jIGZ1bmN0aW9uIGhhc0RvY2tlckNHcm91cCgpIHtcbiAgaWYgKGdldFZlbmRvcigpID09PSBcImNsb3VkZmxhcmVcIikgcmV0dXJuIGZhbHNlO1xuICB0cnkge1xuICAgIGNvbnN0IGZzID0gYXdhaXQgaW1wb3J0UnVudGltZShcImZzXCIpO1xuICAgIHJldHVybiBmcy5yZWFkRmlsZVN5bmMoXCIvcHJvYy9zZWxmL2Nncm91cFwiLCBcInV0ZjhcIikuaW5jbHVkZXMoXCJkb2NrZXJcIik7XG4gIH0gY2F0Y2gge1xuICAgIHJldHVybiBmYWxzZTtcbiAgfVxufVxuYXN5bmMgZnVuY3Rpb24gaXNEb2NrZXIoKSB7XG4gIGlmIChnZXRWZW5kb3IoKSA9PT0gXCJjbG91ZGZsYXJlXCIpIHJldHVybiBmYWxzZTtcbiAgaWYgKGlzRG9ja2VyQ2FjaGVkID09PSB2b2lkIDApIHtcbiAgICBpc0RvY2tlckNhY2hlZCA9IGF3YWl0IGhhc0RvY2tlckVudigpIHx8IGF3YWl0IGhhc0RvY2tlckNHcm91cCgpO1xuICB9XG4gIHJldHVybiBpc0RvY2tlckNhY2hlZDtcbn1cbmFzeW5jIGZ1bmN0aW9uIGlzV3NsKCkge1xuICB0cnkge1xuICAgIGlmIChnZXRWZW5kb3IoKSA9PT0gXCJjbG91ZGZsYXJlXCIpIHJldHVybiBmYWxzZTtcbiAgICBpZiAodHlwZW9mIHByb2Nlc3MgPT09IFwidW5kZWZpbmVkXCIgfHwgcHJvY2Vzcy5wbGF0Zm9ybSAhPT0gXCJsaW51eFwiKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IGZzID0gYXdhaXQgaW1wb3J0UnVudGltZShcImZzXCIpO1xuICAgIGNvbnN0IG9zID0gYXdhaXQgaW1wb3J0UnVudGltZShcIm9zXCIpO1xuICAgIGlmIChvcy5yZWxlYXNlKCkudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhcIm1pY3Jvc29mdFwiKSkge1xuICAgICAgaWYgKGF3YWl0IGlzSW5zaWRlQ29udGFpbmVyKCkpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIHJldHVybiBmcy5yZWFkRmlsZVN5bmMoXCIvcHJvYy92ZXJzaW9uXCIsIFwidXRmOFwiKS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwibWljcm9zb2Z0XCIpID8gIWF3YWl0IGlzSW5zaWRlQ29udGFpbmVyKCkgOiBmYWxzZTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59XG5sZXQgaXNJbnNpZGVDb250YWluZXJDYWNoZWQ7XG5jb25zdCBoYXNDb250YWluZXJFbnYgPSBhc3luYyAoKSA9PiB7XG4gIGlmIChnZXRWZW5kb3IoKSA9PT0gXCJjbG91ZGZsYXJlXCIpIHJldHVybiBmYWxzZTtcbiAgdHJ5IHtcbiAgICBjb25zdCBmcyA9IGF3YWl0IGltcG9ydFJ1bnRpbWUoXCJmc1wiKTtcbiAgICBmcy5zdGF0U3luYyhcIi9ydW4vLmNvbnRhaW5lcmVudlwiKTtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG59O1xuYXN5bmMgZnVuY3Rpb24gaXNJbnNpZGVDb250YWluZXIoKSB7XG4gIGlmIChpc0luc2lkZUNvbnRhaW5lckNhY2hlZCA9PT0gdm9pZCAwKSB7XG4gICAgaXNJbnNpZGVDb250YWluZXJDYWNoZWQgPSBhd2FpdCBoYXNDb250YWluZXJFbnYoKSB8fCBhd2FpdCBpc0RvY2tlcigpO1xuICB9XG4gIHJldHVybiBpc0luc2lkZUNvbnRhaW5lckNhY2hlZDtcbn1cbmZ1bmN0aW9uIGlzQ0koKSB7XG4gIHJldHVybiBlbnYuQ0kgIT09IFwiZmFsc2VcIiAmJiAoXCJCVUlMRF9JRFwiIGluIGVudiB8fCAvLyBKZW5raW5zLCBDbG91ZGJlZXNcbiAgXCJCVUlMRF9OVU1CRVJcIiBpbiBlbnYgfHwgLy8gSmVua2lucywgVGVhbUNpdHkgKGZpeGVkIHR5cG86IGV4dHJhIHNwYWNlIHJlbW92ZWQpXG4gIFwiQ0lcIiBpbiBlbnYgfHwgLy8gVHJhdmlzIENJLCBDaXJjbGVDSSwgQ2lycnVzIENJLCBHaXRsYWIgQ0ksIEFwcHZleW9yLCBDb2RlU2hpcCwgZHNhcmksIENsb3VkZmxhcmVcbiAgXCJDSV9BUFBfSURcIiBpbiBlbnYgfHwgLy8gQXBwZmxvd1xuICBcIkNJX0JVSUxEX0lEXCIgaW4gZW52IHx8IC8vIEFwcGZsb3dcbiAgXCJDSV9CVUlMRF9OVU1CRVJcIiBpbiBlbnYgfHwgLy8gQXBwZmxvd1xuICBcIkNJX05BTUVcIiBpbiBlbnYgfHwgLy8gQ29kZXNoaXAgYW5kIG90aGVyc1xuICBcIkNPTlRJTlVPVVNfSU5URUdSQVRJT05cIiBpbiBlbnYgfHwgLy8gVHJhdmlzIENJLCBDaXJydXMgQ0lcbiAgXCJSVU5fSURcIiBpbiBlbnYpO1xufVxuXG5mdW5jdGlvbiBkZXRlY3RSdW50aW1lKCkge1xuICBpZiAodHlwZW9mIERlbm8gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICBjb25zdCBkZW5vVmVyc2lvbiA9IERlbm8/LnZlcnNpb24/LmRlbm8gPz8gbnVsbDtcbiAgICByZXR1cm4geyBuYW1lOiBcImRlbm9cIiwgdmVyc2lvbjogZGVub1ZlcnNpb24gfTtcbiAgfVxuICBpZiAodHlwZW9mIEJ1biAhPT0gXCJ1bmRlZmluZWRcIikge1xuICAgIGNvbnN0IGJ1blZlcnNpb24gPSBCdW4/LnZlcnNpb24gPz8gbnVsbDtcbiAgICByZXR1cm4geyBuYW1lOiBcImJ1blwiLCB2ZXJzaW9uOiBidW5WZXJzaW9uIH07XG4gIH1cbiAgaWYgKHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3M/LnZlcnNpb25zPy5ub2RlKSB7XG4gICAgcmV0dXJuIHsgbmFtZTogXCJub2RlXCIsIHZlcnNpb246IHByb2Nlc3MudmVyc2lvbnMubm9kZSA/PyBudWxsIH07XG4gIH1cbiAgcmV0dXJuIHsgbmFtZTogXCJlZGdlXCIsIHZlcnNpb246IG51bGwgfTtcbn1cbmZ1bmN0aW9uIGRldGVjdEVudmlyb25tZW50KCkge1xuICByZXR1cm4gZ2V0RW52VmFyKFwiTk9ERV9FTlZcIikgPT09IFwicHJvZHVjdGlvblwiID8gXCJwcm9kdWN0aW9uXCIgOiBpc0NJKCkgPyBcImNpXCIgOiBpc1Rlc3QoKSA/IFwidGVzdFwiIDogXCJkZXZlbG9wbWVudFwiO1xufVxuXG5jb25zdCBEQVRBQkFTRVMgPSB7XG4gIHBnOiBcInBvc3RncmVzcWxcIixcbiAgbXlzcWw6IFwibXlzcWxcIixcbiAgbWFyaWFkYjogXCJtYXJpYWRiXCIsXG4gIHNxbGl0ZTM6IFwic3FsaXRlXCIsXG4gIFwiYmV0dGVyLXNxbGl0ZTNcIjogXCJzcWxpdGVcIixcbiAgXCJAcHJpc21hL2NsaWVudFwiOiBcInByaXNtYVwiLFxuICBtb25nb29zZTogXCJtb25nb2RiXCIsXG4gIG1vbmdvZGI6IFwibW9uZ29kYlwiLFxuICBcImRyaXp6bGUtb3JtXCI6IFwiZHJpenpsZVwiXG59O1xuYXN5bmMgZnVuY3Rpb24gZGV0ZWN0RGF0YWJhc2UoKSB7XG4gIGZvciAoY29uc3QgW3BrZywgbmFtZV0gb2YgT2JqZWN0LmVudHJpZXMoREFUQUJBU0VTKSkge1xuICAgIGNvbnN0IHZlcnNpb24gPSBhd2FpdCBnZXRQYWNrYWdlVmVyc2lvbihwa2cpO1xuICAgIGlmICh2ZXJzaW9uKSByZXR1cm4geyBuYW1lLCB2ZXJzaW9uIH07XG4gIH1cbiAgcmV0dXJuIHZvaWQgMDtcbn1cblxuY29uc3QgRlJBTUVXT1JLUyA9IHtcbiAgbmV4dDogXCJuZXh0XCIsXG4gIG51eHQ6IFwibnV4dFwiLFxuICBcIkByZW1peC1ydW4vc2VydmVyLXJ1bnRpbWVcIjogXCJyZW1peFwiLFxuICBhc3RybzogXCJhc3Ryb1wiLFxuICBcIkBzdmVsdGVqcy9raXRcIjogXCJzdmVsdGVraXRcIixcbiAgXCJzb2xpZC1zdGFydFwiOiBcInNvbGlkLXN0YXJ0XCIsXG4gIFwidGFuc3RhY2stc3RhcnRcIjogXCJ0YW5zdGFjay1zdGFydFwiLFxuICBob25vOiBcImhvbm9cIixcbiAgZXhwcmVzczogXCJleHByZXNzXCIsXG4gIGVseXNpYTogXCJlbHlzaWFcIixcbiAgZXhwbzogXCJleHBvXCJcbn07XG5hc3luYyBmdW5jdGlvbiBkZXRlY3RGcmFtZXdvcmsoKSB7XG4gIGZvciAoY29uc3QgW3BrZywgbmFtZV0gb2YgT2JqZWN0LmVudHJpZXMoRlJBTUVXT1JLUykpIHtcbiAgICBjb25zdCB2ZXJzaW9uID0gYXdhaXQgZ2V0UGFja2FnZVZlcnNpb24ocGtnKTtcbiAgICBpZiAodmVyc2lvbikgcmV0dXJuIHsgbmFtZSwgdmVyc2lvbiB9O1xuICB9XG4gIHJldHVybiB2b2lkIDA7XG59XG5cbmZ1bmN0aW9uIGRldGVjdFBhY2thZ2VNYW5hZ2VyKCkge1xuICBjb25zdCB1c2VyQWdlbnQgPSBlbnYubnBtX2NvbmZpZ191c2VyX2FnZW50O1xuICBpZiAoIXVzZXJBZ2VudCkge1xuICAgIHJldHVybiB2b2lkIDA7XG4gIH1cbiAgY29uc3QgcG1TcGVjID0gdXNlckFnZW50LnNwbGl0KFwiIFwiKVswXTtcbiAgY29uc3Qgc2VwYXJhdG9yUG9zID0gcG1TcGVjLmxhc3RJbmRleE9mKFwiL1wiKTtcbiAgY29uc3QgbmFtZSA9IHBtU3BlYy5zdWJzdHJpbmcoMCwgc2VwYXJhdG9yUG9zKTtcbiAgcmV0dXJuIHtcbiAgICBuYW1lOiBuYW1lID09PSBcIm5wbWluc3RhbGxcIiA/IFwiY25wbVwiIDogbmFtZSxcbiAgICB2ZXJzaW9uOiBwbVNwZWMuc3Vic3RyaW5nKHNlcGFyYXRvclBvcyArIDEpXG4gIH07XG59XG5cbmZ1bmN0aW9uIGdldFRlbGVtZXRyeUF1dGhDb25maWcob3B0aW9ucywgY29udGV4dCkge1xuICByZXR1cm4ge1xuICAgIGRhdGFiYXNlOiBjb250ZXh0Py5kYXRhYmFzZSxcbiAgICBhZGFwdGVyOiBjb250ZXh0Py5hZGFwdGVyLFxuICAgIGVtYWlsVmVyaWZpY2F0aW9uOiB7XG4gICAgICBzZW5kVmVyaWZpY2F0aW9uRW1haWw6ICEhb3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uc2VuZFZlcmlmaWNhdGlvbkVtYWlsLFxuICAgICAgc2VuZE9uU2lnblVwOiAhIW9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LnNlbmRPblNpZ25VcCxcbiAgICAgIHNlbmRPblNpZ25JbjogISFvcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5zZW5kT25TaWduSW4sXG4gICAgICBhdXRvU2lnbkluQWZ0ZXJWZXJpZmljYXRpb246ICEhb3B0aW9ucy5lbWFpbFZlcmlmaWNhdGlvbj8uYXV0b1NpZ25JbkFmdGVyVmVyaWZpY2F0aW9uLFxuICAgICAgZXhwaXJlc0luOiBvcHRpb25zLmVtYWlsVmVyaWZpY2F0aW9uPy5leHBpcmVzSW4sXG4gICAgICBvbkVtYWlsVmVyaWZpY2F0aW9uOiAhIW9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/Lm9uRW1haWxWZXJpZmljYXRpb24sXG4gICAgICBhZnRlckVtYWlsVmVyaWZpY2F0aW9uOiAhIW9wdGlvbnMuZW1haWxWZXJpZmljYXRpb24/LmFmdGVyRW1haWxWZXJpZmljYXRpb25cbiAgICB9LFxuICAgIGVtYWlsQW5kUGFzc3dvcmQ6IHtcbiAgICAgIGVuYWJsZWQ6ICEhb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5lbmFibGVkLFxuICAgICAgZGlzYWJsZVNpZ25VcDogISFvcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/LmRpc2FibGVTaWduVXAsXG4gICAgICByZXF1aXJlRW1haWxWZXJpZmljYXRpb246ICEhb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5yZXF1aXJlRW1haWxWZXJpZmljYXRpb24sXG4gICAgICBtYXhQYXNzd29yZExlbmd0aDogb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5tYXhQYXNzd29yZExlbmd0aCxcbiAgICAgIG1pblBhc3N3b3JkTGVuZ3RoOiBvcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/Lm1pblBhc3N3b3JkTGVuZ3RoLFxuICAgICAgc2VuZFJlc2V0UGFzc3dvcmQ6ICEhb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5zZW5kUmVzZXRQYXNzd29yZCxcbiAgICAgIHJlc2V0UGFzc3dvcmRUb2tlbkV4cGlyZXNJbjogb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5yZXNldFBhc3N3b3JkVG9rZW5FeHBpcmVzSW4sXG4gICAgICBvblBhc3N3b3JkUmVzZXQ6ICEhb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5vblBhc3N3b3JkUmVzZXQsXG4gICAgICBwYXNzd29yZDoge1xuICAgICAgICBoYXNoOiAhIW9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8ucGFzc3dvcmQ/Lmhhc2gsXG4gICAgICAgIHZlcmlmeTogISFvcHRpb25zLmVtYWlsQW5kUGFzc3dvcmQ/LnBhc3N3b3JkPy52ZXJpZnlcbiAgICAgIH0sXG4gICAgICBhdXRvU2lnbkluOiAhIW9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8uYXV0b1NpZ25JbixcbiAgICAgIHJldm9rZVNlc3Npb25zT25QYXNzd29yZFJlc2V0OiAhIW9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8ucmV2b2tlU2Vzc2lvbnNPblBhc3N3b3JkUmVzZXRcbiAgICB9LFxuICAgIHNvY2lhbFByb3ZpZGVyczogT2JqZWN0LmtleXMob3B0aW9ucy5zb2NpYWxQcm92aWRlcnMgfHwge30pLm1hcCgocCkgPT4ge1xuICAgICAgY29uc3QgcHJvdmlkZXIgPSBvcHRpb25zLnNvY2lhbFByb3ZpZGVycz8uW3BdO1xuICAgICAgaWYgKCFwcm92aWRlcikgcmV0dXJuIHt9O1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgaWQ6IHAsXG4gICAgICAgIG1hcFByb2ZpbGVUb1VzZXI6ICEhcHJvdmlkZXIubWFwUHJvZmlsZVRvVXNlcixcbiAgICAgICAgZGlzYWJsZURlZmF1bHRTY29wZTogISFwcm92aWRlci5kaXNhYmxlRGVmYXVsdFNjb3BlLFxuICAgICAgICBkaXNhYmxlSWRUb2tlblNpZ25JbjogISFwcm92aWRlci5kaXNhYmxlSWRUb2tlblNpZ25JbixcbiAgICAgICAgZGlzYWJsZUltcGxpY2l0U2lnblVwOiBwcm92aWRlci5kaXNhYmxlSW1wbGljaXRTaWduVXAsXG4gICAgICAgIGRpc2FibGVTaWduVXA6IHByb3ZpZGVyLmRpc2FibGVTaWduVXAsXG4gICAgICAgIGdldFVzZXJJbmZvOiAhIXByb3ZpZGVyLmdldFVzZXJJbmZvLFxuICAgICAgICBvdmVycmlkZVVzZXJJbmZvT25TaWduSW46ICEhcHJvdmlkZXIub3ZlcnJpZGVVc2VySW5mb09uU2lnbkluLFxuICAgICAgICBwcm9tcHQ6IHByb3ZpZGVyLnByb21wdCxcbiAgICAgICAgdmVyaWZ5SWRUb2tlbjogISFwcm92aWRlci52ZXJpZnlJZFRva2VuLFxuICAgICAgICBzY29wZTogcHJvdmlkZXIuc2NvcGUsXG4gICAgICAgIHJlZnJlc2hBY2Nlc3NUb2tlbjogISFwcm92aWRlci5yZWZyZXNoQWNjZXNzVG9rZW5cbiAgICAgIH07XG4gICAgfSksXG4gICAgcGx1Z2luczogb3B0aW9ucy5wbHVnaW5zPy5tYXAoKHApID0+IHAuaWQudG9TdHJpbmcoKSksXG4gICAgdXNlcjoge1xuICAgICAgbW9kZWxOYW1lOiBvcHRpb25zLnVzZXI/Lm1vZGVsTmFtZSxcbiAgICAgIGZpZWxkczogb3B0aW9ucy51c2VyPy5maWVsZHMsXG4gICAgICBhZGRpdGlvbmFsRmllbGRzOiBvcHRpb25zLnVzZXI/LmFkZGl0aW9uYWxGaWVsZHMsXG4gICAgICBjaGFuZ2VFbWFpbDoge1xuICAgICAgICBlbmFibGVkOiBvcHRpb25zLnVzZXI/LmNoYW5nZUVtYWlsPy5lbmFibGVkLFxuICAgICAgICBzZW5kQ2hhbmdlRW1haWxWZXJpZmljYXRpb246ICEhb3B0aW9ucy51c2VyPy5jaGFuZ2VFbWFpbD8uc2VuZENoYW5nZUVtYWlsVmVyaWZpY2F0aW9uXG4gICAgICB9XG4gICAgfSxcbiAgICB2ZXJpZmljYXRpb246IHtcbiAgICAgIG1vZGVsTmFtZTogb3B0aW9ucy52ZXJpZmljYXRpb24/Lm1vZGVsTmFtZSxcbiAgICAgIGRpc2FibGVDbGVhbnVwOiBvcHRpb25zLnZlcmlmaWNhdGlvbj8uZGlzYWJsZUNsZWFudXAsXG4gICAgICBmaWVsZHM6IG9wdGlvbnMudmVyaWZpY2F0aW9uPy5maWVsZHNcbiAgICB9LFxuICAgIHNlc3Npb246IHtcbiAgICAgIG1vZGVsTmFtZTogb3B0aW9ucy5zZXNzaW9uPy5tb2RlbE5hbWUsXG4gICAgICBhZGRpdGlvbmFsRmllbGRzOiBvcHRpb25zLnNlc3Npb24/LmFkZGl0aW9uYWxGaWVsZHMsXG4gICAgICBjb29raWVDYWNoZToge1xuICAgICAgICBlbmFibGVkOiBvcHRpb25zLnNlc3Npb24/LmNvb2tpZUNhY2hlPy5lbmFibGVkLFxuICAgICAgICBtYXhBZ2U6IG9wdGlvbnMuc2Vzc2lvbj8uY29va2llQ2FjaGU/Lm1heEFnZVxuICAgICAgfSxcbiAgICAgIGRpc2FibGVTZXNzaW9uUmVmcmVzaDogb3B0aW9ucy5zZXNzaW9uPy5kaXNhYmxlU2Vzc2lvblJlZnJlc2gsXG4gICAgICBleHBpcmVzSW46IG9wdGlvbnMuc2Vzc2lvbj8uZXhwaXJlc0luLFxuICAgICAgZmllbGRzOiBvcHRpb25zLnNlc3Npb24/LmZpZWxkcyxcbiAgICAgIGZyZXNoQWdlOiBvcHRpb25zLnNlc3Npb24/LmZyZXNoQWdlLFxuICAgICAgcHJlc2VydmVTZXNzaW9uSW5EYXRhYmFzZTogb3B0aW9ucy5zZXNzaW9uPy5wcmVzZXJ2ZVNlc3Npb25JbkRhdGFiYXNlLFxuICAgICAgc3RvcmVTZXNzaW9uSW5EYXRhYmFzZTogb3B0aW9ucy5zZXNzaW9uPy5zdG9yZVNlc3Npb25JbkRhdGFiYXNlLFxuICAgICAgdXBkYXRlQWdlOiBvcHRpb25zLnNlc3Npb24/LnVwZGF0ZUFnZVxuICAgIH0sXG4gICAgYWNjb3VudDoge1xuICAgICAgbW9kZWxOYW1lOiBvcHRpb25zLmFjY291bnQ/Lm1vZGVsTmFtZSxcbiAgICAgIGZpZWxkczogb3B0aW9ucy5hY2NvdW50Py5maWVsZHMsXG4gICAgICBlbmNyeXB0T0F1dGhUb2tlbnM6IG9wdGlvbnMuYWNjb3VudD8uZW5jcnlwdE9BdXRoVG9rZW5zLFxuICAgICAgdXBkYXRlQWNjb3VudE9uU2lnbkluOiBvcHRpb25zLmFjY291bnQ/LnVwZGF0ZUFjY291bnRPblNpZ25JbixcbiAgICAgIGFjY291bnRMaW5raW5nOiB7XG4gICAgICAgIGVuYWJsZWQ6IG9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LmVuYWJsZWQsXG4gICAgICAgIHRydXN0ZWRQcm92aWRlcnM6IG9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LnRydXN0ZWRQcm92aWRlcnMsXG4gICAgICAgIHVwZGF0ZVVzZXJJbmZvT25MaW5rOiBvcHRpb25zLmFjY291bnQ/LmFjY291bnRMaW5raW5nPy51cGRhdGVVc2VySW5mb09uTGluayxcbiAgICAgICAgYWxsb3dVbmxpbmtpbmdBbGw6IG9wdGlvbnMuYWNjb3VudD8uYWNjb3VudExpbmtpbmc/LmFsbG93VW5saW5raW5nQWxsXG4gICAgICB9XG4gICAgfSxcbiAgICBob29rczoge1xuICAgICAgYWZ0ZXI6ICEhb3B0aW9ucy5ob29rcz8uYWZ0ZXIsXG4gICAgICBiZWZvcmU6ICEhb3B0aW9ucy5ob29rcz8uYmVmb3JlXG4gICAgfSxcbiAgICBzZWNvbmRhcnlTdG9yYWdlOiAhIW9wdGlvbnMuc2Vjb25kYXJ5U3RvcmFnZSxcbiAgICBhZHZhbmNlZDoge1xuICAgICAgY29va2llUHJlZml4OiAhIW9wdGlvbnMuYWR2YW5jZWQ/LmNvb2tpZVByZWZpeCxcbiAgICAgIC8vdGhpcyBzaG91bGRuJ3QgYmUgdHJhY2tlZFxuICAgICAgY29va2llczogISFvcHRpb25zLmFkdmFuY2VkPy5jb29raWVzLFxuICAgICAgY3Jvc3NTdWJEb21haW5Db29raWVzOiB7XG4gICAgICAgIGRvbWFpbjogISFvcHRpb25zLmFkdmFuY2VkPy5jcm9zc1N1YkRvbWFpbkNvb2tpZXM/LmRvbWFpbixcbiAgICAgICAgZW5hYmxlZDogb3B0aW9ucy5hZHZhbmNlZD8uY3Jvc3NTdWJEb21haW5Db29raWVzPy5lbmFibGVkLFxuICAgICAgICBhZGRpdGlvbmFsQ29va2llczogb3B0aW9ucy5hZHZhbmNlZD8uY3Jvc3NTdWJEb21haW5Db29raWVzPy5hZGRpdGlvbmFsQ29va2llc1xuICAgICAgfSxcbiAgICAgIGRhdGFiYXNlOiB7XG4gICAgICAgIHVzZU51bWJlcklkOiAhIW9wdGlvbnMuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCxcbiAgICAgICAgZ2VuZXJhdGVJZDogb3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LmdlbmVyYXRlSWQsXG4gICAgICAgIGRlZmF1bHRGaW5kTWFueUxpbWl0OiBvcHRpb25zLmFkdmFuY2VkPy5kYXRhYmFzZT8uZGVmYXVsdEZpbmRNYW55TGltaXRcbiAgICAgIH0sXG4gICAgICB1c2VTZWN1cmVDb29raWVzOiBvcHRpb25zLmFkdmFuY2VkPy51c2VTZWN1cmVDb29raWVzLFxuICAgICAgaXBBZGRyZXNzOiB7XG4gICAgICAgIGRpc2FibGVJcFRyYWNraW5nOiBvcHRpb25zLmFkdmFuY2VkPy5pcEFkZHJlc3M/LmRpc2FibGVJcFRyYWNraW5nLFxuICAgICAgICBpcEFkZHJlc3NIZWFkZXJzOiBvcHRpb25zLmFkdmFuY2VkPy5pcEFkZHJlc3M/LmlwQWRkcmVzc0hlYWRlcnNcbiAgICAgIH0sXG4gICAgICBkaXNhYmxlQ1NSRkNoZWNrOiBvcHRpb25zLmFkdmFuY2VkPy5kaXNhYmxlQ1NSRkNoZWNrLFxuICAgICAgY29va2llQXR0cmlidXRlczoge1xuICAgICAgICBleHBpcmVzOiBvcHRpb25zLmFkdmFuY2VkPy5kZWZhdWx0Q29va2llQXR0cmlidXRlcz8uZXhwaXJlcyxcbiAgICAgICAgc2VjdXJlOiBvcHRpb25zLmFkdmFuY2VkPy5kZWZhdWx0Q29va2llQXR0cmlidXRlcz8uc2VjdXJlLFxuICAgICAgICBzYW1lU2l0ZTogb3B0aW9ucy5hZHZhbmNlZD8uZGVmYXVsdENvb2tpZUF0dHJpYnV0ZXM/LnNhbWVTaXRlLFxuICAgICAgICBkb21haW46ICEhb3B0aW9ucy5hZHZhbmNlZD8uZGVmYXVsdENvb2tpZUF0dHJpYnV0ZXM/LmRvbWFpbixcbiAgICAgICAgcGF0aDogb3B0aW9ucy5hZHZhbmNlZD8uZGVmYXVsdENvb2tpZUF0dHJpYnV0ZXM/LnBhdGgsXG4gICAgICAgIGh0dHBPbmx5OiBvcHRpb25zLmFkdmFuY2VkPy5kZWZhdWx0Q29va2llQXR0cmlidXRlcz8uaHR0cE9ubHlcbiAgICAgIH1cbiAgICB9LFxuICAgIHRydXN0ZWRPcmlnaW5zOiBvcHRpb25zLnRydXN0ZWRPcmlnaW5zPy5sZW5ndGgsXG4gICAgcmF0ZUxpbWl0OiB7XG4gICAgICBzdG9yYWdlOiBvcHRpb25zLnJhdGVMaW1pdD8uc3RvcmFnZSxcbiAgICAgIG1vZGVsTmFtZTogb3B0aW9ucy5yYXRlTGltaXQ/Lm1vZGVsTmFtZSxcbiAgICAgIHdpbmRvdzogb3B0aW9ucy5yYXRlTGltaXQ/LndpbmRvdyxcbiAgICAgIGN1c3RvbVN0b3JhZ2U6ICEhb3B0aW9ucy5yYXRlTGltaXQ/LmN1c3RvbVN0b3JhZ2UsXG4gICAgICBlbmFibGVkOiBvcHRpb25zLnJhdGVMaW1pdD8uZW5hYmxlZCxcbiAgICAgIG1heDogb3B0aW9ucy5yYXRlTGltaXQ/Lm1heFxuICAgIH0sXG4gICAgb25BUElFcnJvcjoge1xuICAgICAgZXJyb3JVUkw6IG9wdGlvbnMub25BUElFcnJvcj8uZXJyb3JVUkwsXG4gICAgICBvbkVycm9yOiAhIW9wdGlvbnMub25BUElFcnJvcj8ub25FcnJvcixcbiAgICAgIHRocm93OiBvcHRpb25zLm9uQVBJRXJyb3I/LnRocm93XG4gICAgfSxcbiAgICBsb2dnZXI6IHtcbiAgICAgIGRpc2FibGVkOiBvcHRpb25zLmxvZ2dlcj8uZGlzYWJsZWQsXG4gICAgICBsZXZlbDogb3B0aW9ucy5sb2dnZXI/LmxldmVsLFxuICAgICAgbG9nOiAhIW9wdGlvbnMubG9nZ2VyPy5sb2dcbiAgICB9LFxuICAgIGRhdGFiYXNlSG9va3M6IHtcbiAgICAgIHVzZXI6IHtcbiAgICAgICAgY3JlYXRlOiB7XG4gICAgICAgICAgYWZ0ZXI6ICEhb3B0aW9ucy5kYXRhYmFzZUhvb2tzPy51c2VyPy5jcmVhdGU/LmFmdGVyLFxuICAgICAgICAgIGJlZm9yZTogISFvcHRpb25zLmRhdGFiYXNlSG9va3M/LnVzZXI/LmNyZWF0ZT8uYmVmb3JlXG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZToge1xuICAgICAgICAgIGFmdGVyOiAhIW9wdGlvbnMuZGF0YWJhc2VIb29rcz8udXNlcj8udXBkYXRlPy5hZnRlcixcbiAgICAgICAgICBiZWZvcmU6ICEhb3B0aW9ucy5kYXRhYmFzZUhvb2tzPy51c2VyPy51cGRhdGU/LmJlZm9yZVxuICAgICAgICB9XG4gICAgICB9LFxuICAgICAgc2Vzc2lvbjoge1xuICAgICAgICBjcmVhdGU6IHtcbiAgICAgICAgICBhZnRlcjogISFvcHRpb25zLmRhdGFiYXNlSG9va3M/LnNlc3Npb24/LmNyZWF0ZT8uYWZ0ZXIsXG4gICAgICAgICAgYmVmb3JlOiAhIW9wdGlvbnMuZGF0YWJhc2VIb29rcz8uc2Vzc2lvbj8uY3JlYXRlPy5iZWZvcmVcbiAgICAgICAgfSxcbiAgICAgICAgdXBkYXRlOiB7XG4gICAgICAgICAgYWZ0ZXI6ICEhb3B0aW9ucy5kYXRhYmFzZUhvb2tzPy5zZXNzaW9uPy51cGRhdGU/LmFmdGVyLFxuICAgICAgICAgIGJlZm9yZTogISFvcHRpb25zLmRhdGFiYXNlSG9va3M/LnNlc3Npb24/LnVwZGF0ZT8uYmVmb3JlXG4gICAgICAgIH1cbiAgICAgIH0sXG4gICAgICBhY2NvdW50OiB7XG4gICAgICAgIGNyZWF0ZToge1xuICAgICAgICAgIGFmdGVyOiAhIW9wdGlvbnMuZGF0YWJhc2VIb29rcz8uYWNjb3VudD8uY3JlYXRlPy5hZnRlcixcbiAgICAgICAgICBiZWZvcmU6ICEhb3B0aW9ucy5kYXRhYmFzZUhvb2tzPy5hY2NvdW50Py5jcmVhdGU/LmJlZm9yZVxuICAgICAgICB9LFxuICAgICAgICB1cGRhdGU6IHtcbiAgICAgICAgICBhZnRlcjogISFvcHRpb25zLmRhdGFiYXNlSG9va3M/LmFjY291bnQ/LnVwZGF0ZT8uYWZ0ZXIsXG4gICAgICAgICAgYmVmb3JlOiAhIW9wdGlvbnMuZGF0YWJhc2VIb29rcz8uYWNjb3VudD8udXBkYXRlPy5iZWZvcmVcbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIHZlcmlmaWNhdGlvbjoge1xuICAgICAgICBjcmVhdGU6IHtcbiAgICAgICAgICBhZnRlcjogISFvcHRpb25zLmRhdGFiYXNlSG9va3M/LnZlcmlmaWNhdGlvbj8uY3JlYXRlPy5hZnRlcixcbiAgICAgICAgICBiZWZvcmU6ICEhb3B0aW9ucy5kYXRhYmFzZUhvb2tzPy52ZXJpZmljYXRpb24/LmNyZWF0ZT8uYmVmb3JlXG4gICAgICAgIH0sXG4gICAgICAgIHVwZGF0ZToge1xuICAgICAgICAgIGFmdGVyOiAhIW9wdGlvbnMuZGF0YWJhc2VIb29rcz8udmVyaWZpY2F0aW9uPy51cGRhdGU/LmFmdGVyLFxuICAgICAgICAgIGJlZm9yZTogISFvcHRpb25zLmRhdGFiYXNlSG9va3M/LnZlcmlmaWNhdGlvbj8udXBkYXRlPy5iZWZvcmVcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfTtcbn1cblxuYXN5bmMgZnVuY3Rpb24gY3JlYXRlVGVsZW1ldHJ5KG9wdGlvbnMsIGNvbnRleHQpIHtcbiAgY29uc3QgZGVidWdFbmFibGVkID0gb3B0aW9ucy50ZWxlbWV0cnk/LmRlYnVnIHx8IGdldEJvb2xlYW5FbnZWYXIoXCJCRVRURVJfQVVUSF9URUxFTUVUUllfREVCVUdcIiwgZmFsc2UpO1xuICBjb25zdCBURUxFTUVUUllfRU5EUE9JTlQgPSBFTlYuQkVUVEVSX0FVVEhfVEVMRU1FVFJZX0VORFBPSU5UO1xuICBjb25zdCB0cmFjayA9IGFzeW5jIChldmVudCkgPT4ge1xuICAgIHRyeSB7XG4gICAgICBpZiAoY29udGV4dD8uY3VzdG9tVHJhY2spIHtcbiAgICAgICAgYXdhaXQgY29udGV4dC5jdXN0b21UcmFjayhldmVudCk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBpZiAoZGVidWdFbmFibGVkKSB7XG4gICAgICAgICAgYXdhaXQgUHJvbWlzZS5yZXNvbHZlKFxuICAgICAgICAgICAgbG9nZ2VyLmluZm8oXCJ0ZWxlbWV0cnkgZXZlbnRcIiwgSlNPTi5zdHJpbmdpZnkoZXZlbnQsIG51bGwsIDIpKVxuICAgICAgICAgICk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgYXdhaXQgYmV0dGVyRmV0Y2goVEVMRU1FVFJZX0VORFBPSU5ULCB7XG4gICAgICAgICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgICAgICAgYm9keTogZXZlbnRcbiAgICAgICAgICB9KTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gY2F0Y2gge1xuICAgIH1cbiAgfTtcbiAgY29uc3QgaXNFbmFibGVkID0gYXN5bmMgKCkgPT4ge1xuICAgIGNvbnN0IHRlbGVtZXRyeUVuYWJsZWQgPSBvcHRpb25zLnRlbGVtZXRyeT8uZW5hYmxlZCAhPT0gdm9pZCAwID8gb3B0aW9ucy50ZWxlbWV0cnkuZW5hYmxlZCA6IGZhbHNlO1xuICAgIGNvbnN0IGVudkVuYWJsZWQgPSBnZXRCb29sZWFuRW52VmFyKFwiQkVUVEVSX0FVVEhfVEVMRU1FVFJZXCIsIGZhbHNlKTtcbiAgICByZXR1cm4gKGVudkVuYWJsZWQgfHwgdGVsZW1ldHJ5RW5hYmxlZCkgJiYgKGNvbnRleHQ/LnNraXBUZXN0Q2hlY2sgfHwgIWlzVGVzdCgpKTtcbiAgfTtcbiAgY29uc3QgZW5hYmxlZCA9IGF3YWl0IGlzRW5hYmxlZCgpO1xuICBsZXQgYW5vbnltb3VzSWQ7XG4gIGlmIChlbmFibGVkKSB7XG4gICAgYW5vbnltb3VzSWQgPSBhd2FpdCBnZXRQcm9qZWN0SWQob3B0aW9ucy5iYXNlVVJMKTtcbiAgICBjb25zdCBwYXlsb2FkID0ge1xuICAgICAgY29uZmlnOiBnZXRUZWxlbWV0cnlBdXRoQ29uZmlnKG9wdGlvbnMpLFxuICAgICAgcnVudGltZTogZGV0ZWN0UnVudGltZSgpLFxuICAgICAgZGF0YWJhc2U6IGF3YWl0IGRldGVjdERhdGFiYXNlKCksXG4gICAgICBmcmFtZXdvcms6IGF3YWl0IGRldGVjdEZyYW1ld29yaygpLFxuICAgICAgZW52aXJvbm1lbnQ6IGRldGVjdEVudmlyb25tZW50KCksXG4gICAgICBzeXN0ZW1JbmZvOiBhd2FpdCBkZXRlY3RTeXN0ZW1JbmZvKCksXG4gICAgICBwYWNrYWdlTWFuYWdlcjogZGV0ZWN0UGFja2FnZU1hbmFnZXIoKVxuICAgIH07XG4gICAgdm9pZCB0cmFjayh7IHR5cGU6IFwiaW5pdFwiLCBwYXlsb2FkLCBhbm9ueW1vdXNJZCB9KTtcbiAgfVxuICByZXR1cm4ge1xuICAgIHB1Ymxpc2g6IGFzeW5jIChldmVudCkgPT4ge1xuICAgICAgaWYgKCFlbmFibGVkKSByZXR1cm47XG4gICAgICBpZiAoIWFub255bW91c0lkKSB7XG4gICAgICAgIGFub255bW91c0lkID0gYXdhaXQgZ2V0UHJvamVjdElkKG9wdGlvbnMuYmFzZVVSTCk7XG4gICAgICB9XG4gICAgICBhd2FpdCB0cmFjayh7XG4gICAgICAgIHR5cGU6IGV2ZW50LnR5cGUsXG4gICAgICAgIHBheWxvYWQ6IGV2ZW50LnBheWxvYWQsXG4gICAgICAgIGFub255bW91c0lkXG4gICAgICB9KTtcbiAgICB9XG4gIH07XG59XG5cbmNvbnN0IGluaXQgPSBhc3luYyAob3B0aW9ucykgPT4ge1xuICBjb25zdCBhZGFwdGVyID0gYXdhaXQgZ2V0QWRhcHRlcihvcHRpb25zKTtcbiAgY29uc3QgcGx1Z2lucyA9IG9wdGlvbnMucGx1Z2lucyB8fCBbXTtcbiAgY29uc3QgaW50ZXJuYWxQbHVnaW5zID0gZ2V0SW50ZXJuYWxQbHVnaW5zKG9wdGlvbnMpO1xuICBjb25zdCBsb2dnZXIgPSBjcmVhdGVMb2dnZXIob3B0aW9ucy5sb2dnZXIpO1xuICBjb25zdCBiYXNlVVJMID0gZ2V0QmFzZVVSTChvcHRpb25zLmJhc2VVUkwsIG9wdGlvbnMuYmFzZVBhdGgpO1xuICBjb25zdCBzZWNyZXQgPSBvcHRpb25zLnNlY3JldCB8fCBlbnYuQkVUVEVSX0FVVEhfU0VDUkVUIHx8IGVudi5BVVRIX1NFQ1JFVCB8fCBERUZBVUxUX1NFQ1JFVDtcbiAgaWYgKHNlY3JldCA9PT0gREVGQVVMVF9TRUNSRVQpIHtcbiAgICBpZiAoaXNQcm9kdWN0aW9uKSB7XG4gICAgICBsb2dnZXIuZXJyb3IoXG4gICAgICAgIFwiWW91IGFyZSB1c2luZyB0aGUgZGVmYXVsdCBzZWNyZXQuIFBsZWFzZSBzZXQgYEJFVFRFUl9BVVRIX1NFQ1JFVGAgaW4geW91ciBlbnZpcm9ubWVudCB2YXJpYWJsZXMgb3IgcGFzcyBgc2VjcmV0YCBpbiB5b3VyIGF1dGggY29uZmlnLlwiXG4gICAgICApO1xuICAgIH1cbiAgfVxuICBvcHRpb25zID0ge1xuICAgIC4uLm9wdGlvbnMsXG4gICAgc2VjcmV0LFxuICAgIGJhc2VVUkw6IGJhc2VVUkwgPyBuZXcgVVJMKGJhc2VVUkwpLm9yaWdpbiA6IFwiXCIsXG4gICAgYmFzZVBhdGg6IG9wdGlvbnMuYmFzZVBhdGggfHwgXCIvYXBpL2F1dGhcIixcbiAgICBwbHVnaW5zOiBwbHVnaW5zLmNvbmNhdChpbnRlcm5hbFBsdWdpbnMpXG4gIH07XG4gIGNoZWNrRW5kcG9pbnRDb25mbGljdHMob3B0aW9ucywgbG9nZ2VyKTtcbiAgY29uc3QgY29va2llcyA9IGdldENvb2tpZXMob3B0aW9ucyk7XG4gIGNvbnN0IHRhYmxlcyA9IGdldEF1dGhUYWJsZXMob3B0aW9ucyk7XG4gIGNvbnN0IHByb3ZpZGVycyA9IE9iamVjdC5lbnRyaWVzKFxuICAgIG9wdGlvbnMuc29jaWFsUHJvdmlkZXJzIHx8IHt9XG4gICkubWFwKChba2V5LCBjb25maWddKSA9PiB7XG4gICAgaWYgKGNvbmZpZyA9PSBudWxsKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgaWYgKGNvbmZpZy5lbmFibGVkID09PSBmYWxzZSkge1xuICAgICAgcmV0dXJuIG51bGw7XG4gICAgfVxuICAgIGlmICghY29uZmlnLmNsaWVudElkKSB7XG4gICAgICBsb2dnZXIud2FybihcbiAgICAgICAgYFNvY2lhbCBwcm92aWRlciAke2tleX0gaXMgbWlzc2luZyBjbGllbnRJZCBvciBjbGllbnRTZWNyZXRgXG4gICAgICApO1xuICAgIH1cbiAgICBjb25zdCBwcm92aWRlciA9IHNvY2lhbFByb3ZpZGVyc1trZXldKGNvbmZpZyk7XG4gICAgcHJvdmlkZXIuZGlzYWJsZUltcGxpY2l0U2lnblVwID0gY29uZmlnLmRpc2FibGVJbXBsaWNpdFNpZ25VcDtcbiAgICByZXR1cm4gcHJvdmlkZXI7XG4gIH0pLmZpbHRlcigoeCkgPT4geCAhPT0gbnVsbCk7XG4gIGNvbnN0IGdlbmVyYXRlSWRGdW5jID0gKHsgbW9kZWwsIHNpemUgfSkgPT4ge1xuICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5hZHZhbmNlZD8uZ2VuZXJhdGVJZCA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICByZXR1cm4gb3B0aW9ucy5hZHZhbmNlZC5nZW5lcmF0ZUlkKHsgbW9kZWwsIHNpemUgfSk7XG4gICAgfVxuICAgIGlmICh0eXBlb2Ygb3B0aW9ucz8uYWR2YW5jZWQ/LmRhdGFiYXNlPy5nZW5lcmF0ZUlkID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICAgIHJldHVybiBvcHRpb25zLmFkdmFuY2VkLmRhdGFiYXNlLmdlbmVyYXRlSWQoeyBtb2RlbCwgc2l6ZSB9KTtcbiAgICB9XG4gICAgcmV0dXJuIGdlbmVyYXRlSWQoc2l6ZSk7XG4gIH07XG4gIGNvbnN0IHsgcHVibGlzaCB9ID0gYXdhaXQgY3JlYXRlVGVsZW1ldHJ5KG9wdGlvbnMsIHtcbiAgICBhZGFwdGVyOiBhZGFwdGVyLmlkLFxuICAgIGRhdGFiYXNlOiB0eXBlb2Ygb3B0aW9ucy5kYXRhYmFzZSA9PT0gXCJmdW5jdGlvblwiID8gXCJhZGFwdGVyXCIgOiBnZXRLeXNlbHlEYXRhYmFzZVR5cGUob3B0aW9ucy5kYXRhYmFzZSkgfHwgXCJ1bmtub3duXCJcbiAgfSk7XG4gIGxldCBjdHggPSB7XG4gICAgYXBwTmFtZTogb3B0aW9ucy5hcHBOYW1lIHx8IFwiQmV0dGVyIEF1dGhcIixcbiAgICBzb2NpYWxQcm92aWRlcnM6IHByb3ZpZGVycyxcbiAgICBvcHRpb25zLFxuICAgIHRhYmxlcyxcbiAgICB0cnVzdGVkT3JpZ2luczogZ2V0VHJ1c3RlZE9yaWdpbnMob3B0aW9ucyksXG4gICAgYmFzZVVSTDogYmFzZVVSTCB8fCBcIlwiLFxuICAgIHNlc3Npb25Db25maWc6IHtcbiAgICAgIHVwZGF0ZUFnZTogb3B0aW9ucy5zZXNzaW9uPy51cGRhdGVBZ2UgIT09IHZvaWQgMCA/IG9wdGlvbnMuc2Vzc2lvbi51cGRhdGVBZ2UgOiAyNCAqIDYwICogNjAsXG4gICAgICAvLyAyNCBob3Vyc1xuICAgICAgZXhwaXJlc0luOiBvcHRpb25zLnNlc3Npb24/LmV4cGlyZXNJbiB8fCA2MCAqIDYwICogMjQgKiA3LFxuICAgICAgLy8gNyBkYXlzXG4gICAgICBmcmVzaEFnZTogb3B0aW9ucy5zZXNzaW9uPy5mcmVzaEFnZSA9PT0gdm9pZCAwID8gNjAgKiA2MCAqIDI0IDogb3B0aW9ucy5zZXNzaW9uLmZyZXNoQWdlXG4gICAgfSxcbiAgICBzZWNyZXQsXG4gICAgcmF0ZUxpbWl0OiB7XG4gICAgICAuLi5vcHRpb25zLnJhdGVMaW1pdCxcbiAgICAgIGVuYWJsZWQ6IG9wdGlvbnMucmF0ZUxpbWl0Py5lbmFibGVkID8/IGlzUHJvZHVjdGlvbixcbiAgICAgIHdpbmRvdzogb3B0aW9ucy5yYXRlTGltaXQ/LndpbmRvdyB8fCAxMCxcbiAgICAgIG1heDogb3B0aW9ucy5yYXRlTGltaXQ/Lm1heCB8fCAxMDAsXG4gICAgICBzdG9yYWdlOiBvcHRpb25zLnJhdGVMaW1pdD8uc3RvcmFnZSB8fCAob3B0aW9ucy5zZWNvbmRhcnlTdG9yYWdlID8gXCJzZWNvbmRhcnktc3RvcmFnZVwiIDogXCJtZW1vcnlcIilcbiAgICB9LFxuICAgIGF1dGhDb29raWVzOiBjb29raWVzLFxuICAgIGxvZ2dlcixcbiAgICBnZW5lcmF0ZUlkOiBnZW5lcmF0ZUlkRnVuYyxcbiAgICBzZXNzaW9uOiBudWxsLFxuICAgIHNlY29uZGFyeVN0b3JhZ2U6IG9wdGlvbnMuc2Vjb25kYXJ5U3RvcmFnZSxcbiAgICBwYXNzd29yZDoge1xuICAgICAgaGFzaDogb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5wYXNzd29yZD8uaGFzaCB8fCBoYXNoUGFzc3dvcmQsXG4gICAgICB2ZXJpZnk6IG9wdGlvbnMuZW1haWxBbmRQYXNzd29yZD8ucGFzc3dvcmQ/LnZlcmlmeSB8fCB2ZXJpZnlQYXNzd29yZCxcbiAgICAgIGNvbmZpZzoge1xuICAgICAgICBtaW5QYXNzd29yZExlbmd0aDogb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5taW5QYXNzd29yZExlbmd0aCB8fCA4LFxuICAgICAgICBtYXhQYXNzd29yZExlbmd0aDogb3B0aW9ucy5lbWFpbEFuZFBhc3N3b3JkPy5tYXhQYXNzd29yZExlbmd0aCB8fCAxMjhcbiAgICAgIH0sXG4gICAgICBjaGVja1Bhc3N3b3JkXG4gICAgfSxcbiAgICBzZXROZXdTZXNzaW9uKHNlc3Npb24pIHtcbiAgICAgIHRoaXMubmV3U2Vzc2lvbiA9IHNlc3Npb247XG4gICAgfSxcbiAgICBuZXdTZXNzaW9uOiBudWxsLFxuICAgIGFkYXB0ZXIsXG4gICAgaW50ZXJuYWxBZGFwdGVyOiBjcmVhdGVJbnRlcm5hbEFkYXB0ZXIoYWRhcHRlciwge1xuICAgICAgb3B0aW9ucyxcbiAgICAgIGxvZ2dlcixcbiAgICAgIGhvb2tzOiBvcHRpb25zLmRhdGFiYXNlSG9va3MgPyBbb3B0aW9ucy5kYXRhYmFzZUhvb2tzXSA6IFtdfSksXG4gICAgY3JlYXRlQXV0aENvb2tpZTogY3JlYXRlQ29va2llR2V0dGVyKG9wdGlvbnMpLFxuICAgIGFzeW5jIHJ1bk1pZ3JhdGlvbnMoKSB7XG4gICAgICBpZiAoIW9wdGlvbnMuZGF0YWJhc2UgfHwgXCJ1cGRhdGVNYW55XCIgaW4gb3B0aW9ucy5kYXRhYmFzZSkge1xuICAgICAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgICAgIFwiRGF0YWJhc2UgaXMgbm90IHByb3ZpZGVkIG9yIGl0J3MgYW4gYWRhcHRlci4gTWlncmF0aW9ucyBhcmUgb25seSBzdXBwb3J0ZWQgd2l0aCBhIGRhdGFiYXNlIGluc3RhbmNlLlwiXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBjb25zdCB7IHJ1bk1pZ3JhdGlvbnMgfSA9IGF3YWl0IGdldE1pZ3JhdGlvbnMob3B0aW9ucyk7XG4gICAgICBhd2FpdCBydW5NaWdyYXRpb25zKCk7XG4gICAgfSxcbiAgICBwdWJsaXNoVGVsZW1ldHJ5OiBwdWJsaXNoXG4gIH07XG4gIGxldCB7IGNvbnRleHQgfSA9IHJ1blBsdWdpbkluaXQoY3R4KTtcbiAgcmV0dXJuIGNvbnRleHQ7XG59O1xuZnVuY3Rpb24gcnVuUGx1Z2luSW5pdChjdHgpIHtcbiAgbGV0IG9wdGlvbnMgPSBjdHgub3B0aW9ucztcbiAgY29uc3QgcGx1Z2lucyA9IG9wdGlvbnMucGx1Z2lucyB8fCBbXTtcbiAgbGV0IGNvbnRleHQgPSBjdHg7XG4gIGNvbnN0IGRiSG9va3MgPSBbXTtcbiAgZm9yIChjb25zdCBwbHVnaW4gb2YgcGx1Z2lucykge1xuICAgIGlmIChwbHVnaW4uaW5pdCkge1xuICAgICAgY29uc3QgcmVzdWx0ID0gcGx1Z2luLmluaXQoY29udGV4dCk7XG4gICAgICBpZiAodHlwZW9mIHJlc3VsdCA9PT0gXCJvYmplY3RcIikge1xuICAgICAgICBpZiAocmVzdWx0Lm9wdGlvbnMpIHtcbiAgICAgICAgICBjb25zdCB7IGRhdGFiYXNlSG9va3MsIC4uLnJlc3RPcHRzIH0gPSByZXN1bHQub3B0aW9ucztcbiAgICAgICAgICBpZiAoZGF0YWJhc2VIb29rcykge1xuICAgICAgICAgICAgZGJIb29rcy5wdXNoKGRhdGFiYXNlSG9va3MpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBvcHRpb25zID0gZGVmdShvcHRpb25zLCByZXN0T3B0cyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHJlc3VsdC5jb250ZXh0KSB7XG4gICAgICAgICAgY29udGV4dCA9IHtcbiAgICAgICAgICAgIC4uLmNvbnRleHQsXG4gICAgICAgICAgICAuLi5yZXN1bHQuY29udGV4dFxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgZGJIb29rcy5wdXNoKG9wdGlvbnMuZGF0YWJhc2VIb29rcyk7XG4gIGNvbnRleHQuaW50ZXJuYWxBZGFwdGVyID0gY3JlYXRlSW50ZXJuYWxBZGFwdGVyKGN0eC5hZGFwdGVyLCB7XG4gICAgb3B0aW9ucyxcbiAgICBsb2dnZXI6IGN0eC5sb2dnZXIsXG4gICAgaG9va3M6IGRiSG9va3MuZmlsdGVyKCh1KSA9PiB1ICE9PSB2b2lkIDApLFxuICAgIGdlbmVyYXRlSWQ6IGN0eC5nZW5lcmF0ZUlkXG4gIH0pO1xuICBjb250ZXh0Lm9wdGlvbnMgPSBvcHRpb25zO1xuICByZXR1cm4geyBjb250ZXh0IH07XG59XG5mdW5jdGlvbiBnZXRJbnRlcm5hbFBsdWdpbnMob3B0aW9ucykge1xuICBjb25zdCBwbHVnaW5zID0gW107XG4gIGlmIChvcHRpb25zLmFkdmFuY2VkPy5jcm9zc1N1YkRvbWFpbkNvb2tpZXM/LmVuYWJsZWQpIDtcbiAgcmV0dXJuIHBsdWdpbnM7XG59XG5mdW5jdGlvbiBnZXRUcnVzdGVkT3JpZ2lucyhvcHRpb25zKSB7XG4gIGNvbnN0IGJhc2VVUkwgPSBnZXRCYXNlVVJMKG9wdGlvbnMuYmFzZVVSTCwgb3B0aW9ucy5iYXNlUGF0aCk7XG4gIGlmICghYmFzZVVSTCkge1xuICAgIHJldHVybiBbXTtcbiAgfVxuICBjb25zdCB0cnVzdGVkT3JpZ2lucyA9IFtuZXcgVVJMKGJhc2VVUkwpLm9yaWdpbl07XG4gIGlmIChvcHRpb25zLnRydXN0ZWRPcmlnaW5zICYmIEFycmF5LmlzQXJyYXkob3B0aW9ucy50cnVzdGVkT3JpZ2lucykpIHtcbiAgICB0cnVzdGVkT3JpZ2lucy5wdXNoKC4uLm9wdGlvbnMudHJ1c3RlZE9yaWdpbnMpO1xuICB9XG4gIGNvbnN0IGVudlRydXN0ZWRPcmlnaW5zID0gZW52LkJFVFRFUl9BVVRIX1RSVVNURURfT1JJR0lOUztcbiAgaWYgKGVudlRydXN0ZWRPcmlnaW5zKSB7XG4gICAgdHJ1c3RlZE9yaWdpbnMucHVzaCguLi5lbnZUcnVzdGVkT3JpZ2lucy5zcGxpdChcIixcIikpO1xuICB9XG4gIGlmICh0cnVzdGVkT3JpZ2lucy5maWx0ZXIoKHgpID0+ICF4KS5sZW5ndGgpIHtcbiAgICB0aHJvdyBuZXcgQmV0dGVyQXV0aEVycm9yKFxuICAgICAgXCJBIHByb3ZpZGVkIHRydXN0ZWQgb3JpZ2luIGlzIGludmFsaWQsIG1ha2Ugc3VyZSB5b3VyIHRydXN0ZWQgb3JpZ2lucyBsaXN0IGlzIHByb3Blcmx5IGRlZmluZWQuXCJcbiAgICApO1xuICB9XG4gIHJldHVybiB0cnVzdGVkT3JpZ2lucztcbn1cblxuY29uc3QgYmV0dGVyQXV0aCA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IGF1dGhDb250ZXh0ID0gaW5pdChvcHRpb25zKTtcbiAgY29uc3QgeyBhcGkgfSA9IGdldEVuZHBvaW50cyhhdXRoQ29udGV4dCwgb3B0aW9ucyk7XG4gIGNvbnN0IGVycm9yQ29kZXMgPSBvcHRpb25zLnBsdWdpbnM/LnJlZHVjZSgoYWNjLCBwbHVnaW4pID0+IHtcbiAgICBpZiAocGx1Z2luLiRFUlJPUl9DT0RFUykge1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgLi4uYWNjLFxuICAgICAgICAuLi5wbHVnaW4uJEVSUk9SX0NPREVTXG4gICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gYWNjO1xuICB9LCB7fSk7XG4gIHJldHVybiB7XG4gICAgaGFuZGxlcjogYXN5bmMgKHJlcXVlc3QpID0+IHtcbiAgICAgIGNvbnN0IGN0eCA9IGF3YWl0IGF1dGhDb250ZXh0O1xuICAgICAgY29uc3QgYmFzZVBhdGggPSBjdHgub3B0aW9ucy5iYXNlUGF0aCB8fCBcIi9hcGkvYXV0aFwiO1xuICAgICAgaWYgKCFjdHgub3B0aW9ucy5iYXNlVVJMKSB7XG4gICAgICAgIGNvbnN0IGJhc2VVUkwgPSBnZXRCYXNlVVJMKHZvaWQgMCwgYmFzZVBhdGgsIHJlcXVlc3QpO1xuICAgICAgICBpZiAoYmFzZVVSTCkge1xuICAgICAgICAgIGN0eC5iYXNlVVJMID0gYmFzZVVSTDtcbiAgICAgICAgICBjdHgub3B0aW9ucy5iYXNlVVJMID0gZ2V0T3JpZ2luKGN0eC5iYXNlVVJMKSB8fCB2b2lkIDA7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgICAgIFwiQ291bGQgbm90IGdldCBiYXNlIFVSTCBmcm9tIHJlcXVlc3QuIFBsZWFzZSBwcm92aWRlIGEgdmFsaWQgYmFzZSBVUkwuXCJcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjdHgudHJ1c3RlZE9yaWdpbnMgPSBbXG4gICAgICAgIC4uLm9wdGlvbnMudHJ1c3RlZE9yaWdpbnMgPyBBcnJheS5pc0FycmF5KG9wdGlvbnMudHJ1c3RlZE9yaWdpbnMpID8gb3B0aW9ucy50cnVzdGVkT3JpZ2lucyA6IGF3YWl0IG9wdGlvbnMudHJ1c3RlZE9yaWdpbnMocmVxdWVzdCkgOiBbXSxcbiAgICAgICAgY3R4Lm9wdGlvbnMuYmFzZVVSTFxuICAgICAgXTtcbiAgICAgIGNvbnN0IHsgaGFuZGxlciB9ID0gcm91dGVyKGN0eCwgb3B0aW9ucyk7XG4gICAgICByZXR1cm4gaGFuZGxlcihyZXF1ZXN0KTtcbiAgICB9LFxuICAgIGFwaSxcbiAgICBvcHRpb25zLFxuICAgICRjb250ZXh0OiBhdXRoQ29udGV4dCxcbiAgICAkSW5mZXI6IHt9LFxuICAgICRFUlJPUl9DT0RFUzoge1xuICAgICAgLi4uZXJyb3JDb2RlcyxcbiAgICAgIC4uLkJBU0VfRVJST1JfQ09ERVNcbiAgICB9XG4gIH07XG59O1xuXG5leHBvcnQgeyBiZXR0ZXJBdXRoIGFzIGIsIGNyZWF0ZVRlbGVtZXRyeSBhcyBjLCBnZXRUZWxlbWV0cnlBdXRoQ29uZmlnIGFzIGcgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.CujFcMib.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.D-2CmEwz.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.D-2CmEwz.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   c: () => (/* binding */ capitalizeFirstLetter)\n/* harmony export */ });\nfunction capitalizeFirstLetter(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguRC0yQ21Fd3oubWpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBO0FBQ0E7O0FBRXNDIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxzaGFyZWRcXGJldHRlci1hdXRoLkQtMkNtRXd6Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiBjYXBpdGFsaXplRmlyc3RMZXR0ZXIoc3RyKSB7XG4gIHJldHVybiBzdHIuY2hhckF0KDApLnRvVXBwZXJDYXNlKCkgKyBzdHIuc2xpY2UoMSk7XG59XG5cbmV4cG9ydCB7IGNhcGl0YWxpemVGaXJzdExldHRlciBhcyBjIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.D-2CmEwz.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.DOXaXTC6.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.DOXaXTC6.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   c: () => (/* binding */ createAdapter)\n/* harmony export */ });\n/* harmony import */ var _better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./better-auth.BZZKN1g7.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BZZKN1g7.mjs\");\n/* harmony import */ var _better_auth_B_PTVODM_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./better-auth.B_PTVODM.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B_PTVODM.mjs\");\n/* harmony import */ var _better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var zod_v4__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! zod/v4 */ \"(rsc)/./node_modules/zod/v4/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @better-auth/utils */ \"(rsc)/./node_modules/@better-auth/utils/dist/index.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./better-auth.BjBlybv-.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BjBlybv-.mjs\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction withApplyDefault(value, field, action) {\n  if (action === \"update\") {\n    if (value === void 0 && field.onUpdate !== void 0) {\n      if (typeof field.onUpdate === \"function\") {\n        return field.onUpdate();\n      }\n      return field.onUpdate;\n    }\n    return value;\n  }\n  if (value === void 0 || value === null) {\n    if (field.defaultValue !== void 0) {\n      if (typeof field.defaultValue === \"function\") {\n        return field.defaultValue();\n      }\n      return field.defaultValue;\n    }\n  }\n  return value;\n}\n\nlet debugLogs = [];\nlet transactionId = -1;\nconst colors = {\n  reset: \"\\x1B[0m\",\n  bright: \"\\x1B[1m\",\n  dim: \"\\x1B[2m\",\n  fg: {\n    yellow: \"\\x1B[33m\",\n    magenta: \"\\x1B[35m\"},\n  bg: {\n    black: \"\\x1B[40m\"}\n};\nconst createAdapter = ({\n  adapter,\n  config: cfg\n}) => (options) => {\n  const config = {\n    ...cfg,\n    supportsBooleans: cfg.supportsBooleans ?? true,\n    supportsDates: cfg.supportsDates ?? true,\n    supportsJSON: cfg.supportsJSON ?? false,\n    adapterName: cfg.adapterName ?? cfg.adapterId,\n    supportsNumericIds: cfg.supportsNumericIds ?? true\n  };\n  if (options.advanced?.database?.useNumberId === true && config.supportsNumericIds === false) {\n    throw new Error(\n      `[${config.adapterName}] Your database or database adapter does not support numeric ids. Please disable \"useNumberId\" in your config.`\n    );\n  }\n  const schema = (0,_better_auth_B_PTVODM_mjs__WEBPACK_IMPORTED_MODULE_1__.g)(options);\n  const getDefaultFieldName = ({\n    field,\n    model: unsafe_model\n  }) => {\n    if (field === \"id\" || field === \"_id\") {\n      return \"id\";\n    }\n    const model = getDefaultModelName(unsafe_model);\n    let f = schema[model]?.fields[field];\n    if (!f) {\n      f = Object.values(schema[model]?.fields).find(\n        (f2) => f2.fieldName === field\n      );\n    }\n    if (!f) {\n      debugLog(`Field ${field} not found in model ${model}`);\n      debugLog(`Schema:`, schema);\n      throw new Error(`Field ${field} not found in model ${model}`);\n    }\n    return field;\n  };\n  const getDefaultModelName = (model) => {\n    if (config.usePlural && model.charAt(model.length - 1) === \"s\") {\n      let pluralessModel = model.slice(0, -1);\n      let m2 = schema[pluralessModel] ? pluralessModel : void 0;\n      if (!m2) {\n        m2 = Object.entries(schema).find(\n          ([_, f]) => f.modelName === pluralessModel\n        )?.[0];\n      }\n      if (m2) {\n        return m2;\n      }\n    }\n    let m = schema[model] ? model : void 0;\n    if (!m) {\n      m = Object.entries(schema).find(([_, f]) => f.modelName === model)?.[0];\n    }\n    if (!m) {\n      debugLog(`Model \"${model}\" not found in schema`);\n      debugLog(`Schema:`, schema);\n      throw new Error(`Model \"${model}\" not found in schema`);\n    }\n    return m;\n  };\n  const getModelName = (model) => {\n    const defaultModelKey = getDefaultModelName(model);\n    const usePlural = config && config.usePlural;\n    const useCustomModelName = schema && schema[defaultModelKey] && schema[defaultModelKey].modelName !== model;\n    if (useCustomModelName) {\n      return usePlural ? `${schema[defaultModelKey].modelName}s` : schema[defaultModelKey].modelName;\n    }\n    return usePlural ? `${model}s` : model;\n  };\n  function getFieldName({\n    model: model_name,\n    field: field_name\n  }) {\n    const model = getDefaultModelName(model_name);\n    const field = getDefaultFieldName({ model, field: field_name });\n    return schema[model]?.fields[field]?.fieldName || field;\n  }\n  const debugLog = (...args) => {\n    if (config.debugLogs === true || typeof config.debugLogs === \"object\") {\n      if (typeof config.debugLogs === \"object\" && \"isRunningAdapterTests\" in config.debugLogs) {\n        if (config.debugLogs.isRunningAdapterTests) {\n          args.shift();\n          debugLogs.push(args);\n        }\n        return;\n      }\n      if (typeof config.debugLogs === \"object\" && config.debugLogs.logCondition && !config.debugLogs.logCondition?.()) {\n        return;\n      }\n      if (typeof args[0] === \"object\" && \"method\" in args[0]) {\n        const method = args.shift().method;\n        if (typeof config.debugLogs === \"object\") {\n          if (method === \"create\" && !config.debugLogs.create) {\n            return;\n          } else if (method === \"update\" && !config.debugLogs.update) {\n            return;\n          } else if (method === \"updateMany\" && !config.debugLogs.updateMany) {\n            return;\n          } else if (method === \"findOne\" && !config.debugLogs.findOne) {\n            return;\n          } else if (method === \"findMany\" && !config.debugLogs.findMany) {\n            return;\n          } else if (method === \"delete\" && !config.debugLogs.delete) {\n            return;\n          } else if (method === \"deleteMany\" && !config.debugLogs.deleteMany) {\n            return;\n          } else if (method === \"count\" && !config.debugLogs.count) {\n            return;\n          }\n        }\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_10__.a.info(`[${config.adapterName}]`, ...args);\n      } else {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_10__.a.info(`[${config.adapterName}]`, ...args);\n      }\n    }\n  };\n  const idField = ({\n    customModelName,\n    forceAllowId\n  }) => {\n    const shouldGenerateId = !config.disableIdGeneration && !options.advanced?.database?.useNumberId && !forceAllowId;\n    const model = getDefaultModelName(customModelName ?? \"id\");\n    return {\n      type: options.advanced?.database?.useNumberId ? \"number\" : \"string\",\n      required: shouldGenerateId ? true : false,\n      ...shouldGenerateId ? {\n        defaultValue() {\n          if (config.disableIdGeneration) return void 0;\n          const useNumberId = options.advanced?.database?.useNumberId;\n          let generateId$1 = options.advanced?.database?.generateId;\n          if (options.advanced?.generateId !== void 0) {\n            _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_10__.a.warn(\n              \"Your Better Auth config includes advanced.generateId which is deprecated. Please use advanced.database.generateId instead. This will be removed in future releases.\"\n            );\n            generateId$1 = options.advanced?.generateId;\n          }\n          if (generateId$1 === false || useNumberId) return void 0;\n          if (generateId$1) {\n            return generateId$1({\n              model\n            });\n          }\n          if (config.customIdGenerator) {\n            return config.customIdGenerator({ model });\n          }\n          return (0,_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_2__.g)();\n        }\n      } : {}\n    };\n  };\n  const getFieldAttributes = ({\n    model,\n    field\n  }) => {\n    const defaultModelName = getDefaultModelName(model);\n    const defaultFieldName = getDefaultFieldName({\n      field,\n      model\n    });\n    const fields = schema[defaultModelName].fields;\n    fields.id = idField({ customModelName: defaultModelName });\n    return fields[defaultFieldName];\n  };\n  const adapterInstance = adapter({\n    options,\n    schema,\n    debugLog,\n    getFieldName,\n    getModelName,\n    getDefaultModelName,\n    getDefaultFieldName,\n    getFieldAttributes\n  });\n  const transformInput = async (data, unsafe_model, action, forceAllowId) => {\n    const transformedData = {};\n    const fields = schema[unsafe_model].fields;\n    const newMappedKeys = config.mapKeysTransformInput ?? {};\n    if (!config.disableIdGeneration && !options.advanced?.database?.useNumberId) {\n      fields.id = idField({\n        customModelName: unsafe_model,\n        forceAllowId: forceAllowId && \"id\" in data\n      });\n    }\n    for (const field in fields) {\n      const value = data[field];\n      const fieldAttributes = fields[field];\n      let newFieldName = newMappedKeys[field] || fields[field].fieldName || field;\n      if (value === void 0 && (fieldAttributes.defaultValue === void 0 && !fieldAttributes.transform?.input && !(action === \"update\" && fieldAttributes.onUpdate) || action === \"update\" && !fieldAttributes.onUpdate)) {\n        continue;\n      }\n      let newValue = withApplyDefault(value, fieldAttributes, action);\n      if (fieldAttributes.transform?.input) {\n        newValue = await fieldAttributes.transform.input(newValue);\n      }\n      if (fieldAttributes.references?.field === \"id\" && options.advanced?.database?.useNumberId) {\n        if (Array.isArray(newValue)) {\n          newValue = newValue.map(Number);\n        } else {\n          newValue = Number(newValue);\n        }\n      } else if (config.supportsJSON === false && typeof newValue === \"object\" && fieldAttributes.type === \"json\") {\n        newValue = JSON.stringify(newValue);\n      } else if (config.supportsDates === false && newValue instanceof Date && fieldAttributes.type === \"date\") {\n        newValue = newValue.toISOString();\n      } else if (config.supportsBooleans === false && typeof newValue === \"boolean\") {\n        newValue = newValue ? 1 : 0;\n      }\n      if (config.customTransformInput) {\n        newValue = config.customTransformInput({\n          data: newValue,\n          action,\n          field: newFieldName,\n          fieldAttributes,\n          model: unsafe_model,\n          schema,\n          options\n        });\n      }\n      if (newValue !== void 0) {\n        transformedData[newFieldName] = newValue;\n      }\n    }\n    return transformedData;\n  };\n  const transformOutput = async (data, unsafe_model, select = []) => {\n    if (!data) return null;\n    const newMappedKeys = config.mapKeysTransformOutput ?? {};\n    const transformedData = {};\n    const tableSchema = schema[unsafe_model].fields;\n    const idKey = Object.entries(newMappedKeys).find(\n      ([_, v]) => v === \"id\"\n    )?.[0];\n    tableSchema[idKey ?? \"id\"] = {\n      type: options.advanced?.database?.useNumberId ? \"number\" : \"string\"\n    };\n    for (const key in tableSchema) {\n      if (select.length && !select.includes(key)) {\n        continue;\n      }\n      const field = tableSchema[key];\n      if (field) {\n        const originalKey = field.fieldName || key;\n        let newValue = data[Object.entries(newMappedKeys).find(\n          ([_, v]) => v === originalKey\n        )?.[0] || originalKey];\n        if (field.transform?.output) {\n          newValue = await field.transform.output(newValue);\n        }\n        let newFieldName = newMappedKeys[key] || key;\n        if (originalKey === \"id\" || field.references?.field === \"id\") {\n          if (typeof newValue !== \"undefined\") newValue = String(newValue);\n        } else if (config.supportsJSON === false && typeof newValue === \"string\" && field.type === \"json\") {\n          newValue = (0,_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_0__.s)(newValue);\n        } else if (config.supportsDates === false && typeof newValue === \"string\" && field.type === \"date\") {\n          newValue = new Date(newValue);\n        } else if (config.supportsBooleans === false && typeof newValue === \"number\" && field.type === \"boolean\") {\n          newValue = newValue === 1;\n        }\n        if (config.customTransformOutput) {\n          newValue = config.customTransformOutput({\n            data: newValue,\n            field: newFieldName,\n            fieldAttributes: field,\n            select,\n            model: unsafe_model,\n            schema,\n            options\n          });\n        }\n        transformedData[newFieldName] = newValue;\n      }\n    }\n    return transformedData;\n  };\n  const transformWhereClause = ({\n    model,\n    where\n  }) => {\n    if (!where) return void 0;\n    const newMappedKeys = config.mapKeysTransformInput ?? {};\n    return where.map((w) => {\n      const {\n        field: unsafe_field,\n        value,\n        operator = \"eq\",\n        connector = \"AND\"\n      } = w;\n      if (operator === \"in\") {\n        if (!Array.isArray(value)) {\n          throw new Error(\"Value must be an array\");\n        }\n      }\n      const defaultModelName = getDefaultModelName(model);\n      const defaultFieldName = getDefaultFieldName({\n        field: unsafe_field,\n        model\n      });\n      const fieldName = newMappedKeys[defaultFieldName] || getFieldName({\n        field: defaultFieldName,\n        model: defaultModelName\n      });\n      const fieldAttr = getFieldAttributes({\n        field: defaultFieldName,\n        model: defaultModelName\n      });\n      if (defaultFieldName === \"id\" || fieldAttr.references?.field === \"id\") {\n        if (options.advanced?.database?.useNumberId) {\n          if (Array.isArray(value)) {\n            return {\n              operator,\n              connector,\n              field: fieldName,\n              value: value.map(Number)\n            };\n          }\n          return {\n            operator,\n            connector,\n            field: fieldName,\n            value: Number(value)\n          };\n        }\n      }\n      return {\n        operator,\n        connector,\n        field: fieldName,\n        value\n      };\n    });\n  };\n  return {\n    create: async ({\n      data: unsafeData,\n      model: unsafeModel,\n      select,\n      forceAllowId = false\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      if (\"id\" in unsafeData && !forceAllowId) {\n        _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_10__.a.warn(\n          `[${config.adapterName}] - You are trying to create a record with an id. This is not allowed as we handle id generation for you, unless you pass in the \\`forceAllowId\\` parameter. The id will be ignored.`\n        );\n        const err = new Error();\n        const stack = err.stack?.split(\"\\n\").filter((_, i) => i !== 1).join(\"\\n\").replace(\"Error:\", \"Create method with `id` being called at:\");\n        console.log(stack);\n        unsafeData.id = void 0;\n      }\n      debugLog(\n        { method: \"create\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 4)}`,\n        `${formatMethod(\"create\")} ${formatAction(\"Unsafe Input\")}:`,\n        { model, data: unsafeData }\n      );\n      const data = await transformInput(\n        unsafeData,\n        unsafeModel,\n        \"create\",\n        forceAllowId\n      );\n      debugLog(\n        { method: \"create\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 4)}`,\n        `${formatMethod(\"create\")} ${formatAction(\"Parsed Input\")}:`,\n        { model, data }\n      );\n      const res = await adapterInstance.create({ data, model });\n      debugLog(\n        { method: \"create\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(3, 4)}`,\n        `${formatMethod(\"create\")} ${formatAction(\"DB Result\")}:`,\n        { model, res }\n      );\n      const transformed = await transformOutput(res, unsafeModel, select);\n      debugLog(\n        { method: \"create\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(4, 4)}`,\n        `${formatMethod(\"create\")} ${formatAction(\"Parsed Result\")}:`,\n        { model, data: transformed }\n      );\n      return transformed;\n    },\n    update: async ({\n      model: unsafeModel,\n      where: unsafeWhere,\n      update: unsafeData\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      debugLog(\n        { method: \"update\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 4)}`,\n        `${formatMethod(\"update\")} ${formatAction(\"Unsafe Input\")}:`,\n        { model, data: unsafeData }\n      );\n      const data = await transformInput(\n        unsafeData,\n        unsafeModel,\n        \"update\"\n      );\n      debugLog(\n        { method: \"update\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 4)}`,\n        `${formatMethod(\"update\")} ${formatAction(\"Parsed Input\")}:`,\n        { model, data }\n      );\n      const res = await adapterInstance.update({\n        model,\n        where,\n        update: data\n      });\n      debugLog(\n        { method: \"update\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(3, 4)}`,\n        `${formatMethod(\"update\")} ${formatAction(\"DB Result\")}:`,\n        { model, data: res }\n      );\n      const transformed = await transformOutput(res, unsafeModel);\n      debugLog(\n        { method: \"update\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(4, 4)}`,\n        `${formatMethod(\"update\")} ${formatAction(\"Parsed Result\")}:`,\n        { model, data: transformed }\n      );\n      return transformed;\n    },\n    updateMany: async ({\n      model: unsafeModel,\n      where: unsafeWhere,\n      update: unsafeData\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      debugLog(\n        { method: \"updateMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 4)}`,\n        `${formatMethod(\"updateMany\")} ${formatAction(\"Unsafe Input\")}:`,\n        { model, data: unsafeData }\n      );\n      const data = await transformInput(unsafeData, unsafeModel, \"update\");\n      debugLog(\n        { method: \"updateMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 4)}`,\n        `${formatMethod(\"updateMany\")} ${formatAction(\"Parsed Input\")}:`,\n        { model, data }\n      );\n      const updatedCount = await adapterInstance.updateMany({\n        model,\n        where,\n        update: data\n      });\n      debugLog(\n        { method: \"updateMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(3, 4)}`,\n        `${formatMethod(\"updateMany\")} ${formatAction(\"DB Result\")}:`,\n        { model, data: updatedCount }\n      );\n      debugLog(\n        { method: \"updateMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(4, 4)}`,\n        `${formatMethod(\"updateMany\")} ${formatAction(\"Parsed Result\")}:`,\n        { model, data: updatedCount }\n      );\n      return updatedCount;\n    },\n    findOne: async ({\n      model: unsafeModel,\n      where: unsafeWhere,\n      select\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      debugLog(\n        { method: \"findOne\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 3)}`,\n        `${formatMethod(\"findOne\")}:`,\n        { model, where, select }\n      );\n      const res = await adapterInstance.findOne({\n        model,\n        where,\n        select\n      });\n      debugLog(\n        { method: \"findOne\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 3)}`,\n        `${formatMethod(\"findOne\")} ${formatAction(\"DB Result\")}:`,\n        { model, data: res }\n      );\n      const transformed = await transformOutput(\n        res,\n        unsafeModel,\n        select\n      );\n      debugLog(\n        { method: \"findOne\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(3, 3)}`,\n        `${formatMethod(\"findOne\")} ${formatAction(\"Parsed Result\")}:`,\n        { model, data: transformed }\n      );\n      return transformed;\n    },\n    findMany: async ({\n      model: unsafeModel,\n      where: unsafeWhere,\n      limit: unsafeLimit,\n      sortBy,\n      offset\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const limit = unsafeLimit ?? options.advanced?.database?.defaultFindManyLimit ?? 100;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      debugLog(\n        { method: \"findMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 3)}`,\n        `${formatMethod(\"findMany\")}:`,\n        { model, where, limit, sortBy, offset }\n      );\n      const res = await adapterInstance.findMany({\n        model,\n        where,\n        limit,\n        sortBy,\n        offset\n      });\n      debugLog(\n        { method: \"findMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 3)}`,\n        `${formatMethod(\"findMany\")} ${formatAction(\"DB Result\")}:`,\n        { model, data: res }\n      );\n      const transformed = await Promise.all(\n        res.map(async (r) => await transformOutput(r, unsafeModel))\n      );\n      debugLog(\n        { method: \"findMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(3, 3)}`,\n        `${formatMethod(\"findMany\")} ${formatAction(\"Parsed Result\")}:`,\n        { model, data: transformed }\n      );\n      return transformed;\n    },\n    delete: async ({\n      model: unsafeModel,\n      where: unsafeWhere\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      debugLog(\n        { method: \"delete\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 2)}`,\n        `${formatMethod(\"delete\")}:`,\n        { model, where }\n      );\n      await adapterInstance.delete({\n        model,\n        where\n      });\n      debugLog(\n        { method: \"delete\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 2)}`,\n        `${formatMethod(\"delete\")} ${formatAction(\"DB Result\")}:`,\n        { model }\n      );\n    },\n    deleteMany: async ({\n      model: unsafeModel,\n      where: unsafeWhere\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      debugLog(\n        { method: \"deleteMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 2)}`,\n        `${formatMethod(\"deleteMany\")} ${formatAction(\"DeleteMany\")}:`,\n        { model, where }\n      );\n      const res = await adapterInstance.deleteMany({\n        model,\n        where\n      });\n      debugLog(\n        { method: \"deleteMany\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 2)}`,\n        `${formatMethod(\"deleteMany\")} ${formatAction(\"DB Result\")}:`,\n        { model, data: res }\n      );\n      return res;\n    },\n    count: async ({\n      model: unsafeModel,\n      where: unsafeWhere\n    }) => {\n      transactionId++;\n      let thisTransactionId = transactionId;\n      const model = getModelName(unsafeModel);\n      const where = transformWhereClause({\n        model: unsafeModel,\n        where: unsafeWhere\n      });\n      debugLog(\n        { method: \"count\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(1, 2)}`,\n        `${formatMethod(\"count\")}:`,\n        {\n          model,\n          where\n        }\n      );\n      const res = await adapterInstance.count({\n        model,\n        where\n      });\n      debugLog(\n        { method: \"count\" },\n        `${formatTransactionId(thisTransactionId)} ${formatStep(2, 2)}`,\n        `${formatMethod(\"count\")}:`,\n        {\n          model,\n          data: res\n        }\n      );\n      return res;\n    },\n    createSchema: adapterInstance.createSchema ? async (_, file) => {\n      const tables = (0,_better_auth_B_PTVODM_mjs__WEBPACK_IMPORTED_MODULE_1__.g)(options);\n      if (options.secondaryStorage && !options.session?.storeSessionInDatabase) {\n        delete tables.session;\n      }\n      if (options.rateLimit && options.rateLimit.storage === \"database\" && // rate-limit will default to enabled in production,\n      // and given storage is database, it will try to use the rate-limit table,\n      // so we should make sure to generate rate-limit table schema\n      (typeof options.rateLimit.enabled === \"undefined\" || // and of course if they forcefully set to true, then they want rate-limit,\n      // thus we should also generate rate-limit table schema\n      options.rateLimit.enabled === true)) {\n        tables.ratelimit = {\n          modelName: options.rateLimit.modelName ?? \"ratelimit\",\n          fields: {\n            key: {\n              type: \"string\",\n              unique: true,\n              required: true,\n              fieldName: options.rateLimit.fields?.key ?? \"key\"\n            },\n            count: {\n              type: \"number\",\n              required: true,\n              fieldName: options.rateLimit.fields?.count ?? \"count\"\n            },\n            lastRequest: {\n              type: \"number\",\n              required: true,\n              bigint: true,\n              defaultValue: () => Date.now(),\n              fieldName: options.rateLimit.fields?.lastRequest ?? \"lastRequest\"\n            }\n          }\n        };\n      }\n      return adapterInstance.createSchema({ file, tables });\n    } : void 0,\n    options: {\n      adapterConfig: config,\n      ...adapterInstance.options ?? {}\n    },\n    id: config.adapterId,\n    // Secretly export values ONLY if this adapter has enabled adapter-test-debug-logs.\n    // This would then be used during our adapter-tests to help print debug logs if a test fails.\n    //@ts-expect-error - ^^\n    ...config.debugLogs?.isRunningAdapterTests ? {\n      adapterTestDebugLogs: {\n        resetDebugLogs() {\n          debugLogs = [];\n        },\n        printDebugLogs() {\n          const separator = `\\u2500`.repeat(80);\n          let log = debugLogs.reverse().map((log2) => {\n            log2[0] = `\n${log2[0]}`;\n            return [...log2, \"\\n\"];\n          }).reduce(\n            (prev, curr) => {\n              return [...curr, ...prev];\n            },\n            [`\n${separator}`]\n          );\n          console.log(...log);\n        }\n      }\n    } : {}\n  };\n};\nfunction formatTransactionId(transactionId2) {\n  return `${colors.fg.magenta}#${transactionId2}${colors.reset}`;\n}\nfunction formatStep(step, total) {\n  return `${colors.bg.black}${colors.fg.yellow}[${step}/${total}]${colors.reset}`;\n}\nfunction formatMethod(method) {\n  return `${colors.bright}${method}${colors.reset}`;\n}\nfunction formatAction(action) {\n  return `${colors.dim}(${action})${colors.reset}`;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguRE9YYVhUQzYubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUFnRTtBQUNBO0FBQ0g7QUFDN0M7QUFDSztBQUNZO0FBQ0M7QUFDRDtBQUNFO0FBQ3JCO0FBQ21CO0FBQ0w7QUFDSTtBQUNBO0FBQ0k7QUFDcUI7O0FBRXpEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QjtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLG1CQUFtQjtBQUM3QjtBQUNBO0FBQ0EsaUJBQWlCLDREQUFhO0FBQzlCO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLE9BQU8scUJBQXFCLE1BQU07QUFDMUQ7QUFDQSwrQkFBK0IsT0FBTyxxQkFBcUIsTUFBTTtBQUNqRTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsTUFBTTtBQUMvQjtBQUNBLGdDQUFnQyxNQUFNO0FBQ3RDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0QkFBNEIsa0NBQWtDO0FBQzlEO0FBQ0EsMEJBQTBCLE1BQU07QUFDaEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFH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R0FBRyxlQUFlLEVBQUUsYUFBYTtBQUMvRDtBQUNBO0FBQ0EsWUFBWSxnQkFBZ0IsRUFBRSxpQkFBaUIsR0FBRyxLQUFLLEdBQUcsTUFBTSxHQUFHLGFBQWE7QUFDaEY7QUFDQTtBQUNBLFlBQVksY0FBYyxFQUFFLE9BQU8sRUFBRSxhQUFhO0FBQ2xEO0FBQ0E7QUFDQSxZQUFZLFdBQVcsR0FBRyxPQUFPLEdBQUcsYUFBYTtBQUNqRDs7QUFFOEIiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXGRpc3RcXHNoYXJlZFxcYmV0dGVyLWF1dGguRE9YYVhUQzYubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IHMgYXMgc2FmZUpTT05QYXJzZSB9IGZyb20gJy4vYmV0dGVyLWF1dGguQlpaS04xZzcubWpzJztcbmltcG9ydCB7IGcgYXMgZ2V0QXV0aFRhYmxlcyB9IGZyb20gJy4vYmV0dGVyLWF1dGguQl9QVFZPRE0ubWpzJztcbmltcG9ydCB7IGcgYXMgZ2VuZXJhdGVJZCB9IGZyb20gJy4vYmV0dGVyLWF1dGguQlVQUFJYZksubWpzJztcbmltcG9ydCAnem9kL3Y0JztcbmltcG9ydCAnYmV0dGVyLWNhbGwnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaGFzaCc7XG5pbXBvcnQgJ0Bub2JsZS9jaXBoZXJzL2NoYWNoYS5qcyc7XG5pbXBvcnQgJ0Bub2JsZS9jaXBoZXJzL3V0aWxzLmpzJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2Jhc2U2NCc7XG5pbXBvcnQgJ2pvc2UnO1xuaW1wb3J0ICdAbm9ibGUvaGFzaGVzL3NjcnlwdC5qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9oZXgnO1xuaW1wb3J0ICdAbm9ibGUvaGFzaGVzL3V0aWxzLmpzJztcbmltcG9ydCAnLi9iZXR0ZXItYXV0aC5CNFFveGRnYy5tanMnO1xuaW1wb3J0IHsgYSBhcyBsb2dnZXIgfSBmcm9tICcuL2JldHRlci1hdXRoLkJqQmx5YnYtLm1qcyc7XG5cbmZ1bmN0aW9uIHdpdGhBcHBseURlZmF1bHQodmFsdWUsIGZpZWxkLCBhY3Rpb24pIHtcbiAgaWYgKGFjdGlvbiA9PT0gXCJ1cGRhdGVcIikge1xuICAgIGlmICh2YWx1ZSA9PT0gdm9pZCAwICYmIGZpZWxkLm9uVXBkYXRlICE9PSB2b2lkIDApIHtcbiAgICAgIGlmICh0eXBlb2YgZmllbGQub25VcGRhdGUgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICByZXR1cm4gZmllbGQub25VcGRhdGUoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmaWVsZC5vblVwZGF0ZTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIGlmICh2YWx1ZSA9PT0gdm9pZCAwIHx8IHZhbHVlID09PSBudWxsKSB7XG4gICAgaWYgKGZpZWxkLmRlZmF1bHRWYWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICBpZiAodHlwZW9mIGZpZWxkLmRlZmF1bHRWYWx1ZSA9PT0gXCJmdW5jdGlvblwiKSB7XG4gICAgICAgIHJldHVybiBmaWVsZC5kZWZhdWx0VmFsdWUoKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBmaWVsZC5kZWZhdWx0VmFsdWU7XG4gICAgfVxuICB9XG4gIHJldHVybiB2YWx1ZTtcbn1cblxubGV0IGRlYnVnTG9ncyA9IFtdO1xubGV0IHRyYW5zYWN0aW9uSWQgPSAtMTtcbmNvbnN0IGNvbG9ycyA9IHtcbiAgcmVzZXQ6IFwiXFx4MUJbMG1cIixcbiAgYnJpZ2h0OiBcIlxceDFCWzFtXCIsXG4gIGRpbTogXCJcXHgxQlsybVwiLFxuICBmZzoge1xuICAgIHllbGxvdzogXCJcXHgxQlszM21cIixcbiAgICBtYWdlbnRhOiBcIlxceDFCWzM1bVwifSxcbiAgYmc6IHtcbiAgICBibGFjazogXCJcXHgxQls0MG1cIn1cbn07XG5jb25zdCBjcmVhdGVBZGFwdGVyID0gKHtcbiAgYWRhcHRlcixcbiAgY29uZmlnOiBjZmdcbn0pID0+IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IGNvbmZpZyA9IHtcbiAgICAuLi5jZmcsXG4gICAgc3VwcG9ydHNCb29sZWFuczogY2ZnLnN1cHBvcnRzQm9vbGVhbnMgPz8gdHJ1ZSxcbiAgICBzdXBwb3J0c0RhdGVzOiBjZmcuc3VwcG9ydHNEYXRlcyA/PyB0cnVlLFxuICAgIHN1cHBvcnRzSlNPTjogY2ZnLnN1cHBvcnRzSlNPTiA/PyBmYWxzZSxcbiAgICBhZGFwdGVyTmFtZTogY2ZnLmFkYXB0ZXJOYW1lID8/IGNmZy5hZGFwdGVySWQsXG4gICAgc3VwcG9ydHNOdW1lcmljSWRzOiBjZmcuc3VwcG9ydHNOdW1lcmljSWRzID8/IHRydWVcbiAgfTtcbiAgaWYgKG9wdGlvbnMuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCA9PT0gdHJ1ZSAmJiBjb25maWcuc3VwcG9ydHNOdW1lcmljSWRzID09PSBmYWxzZSkge1xuICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgIGBbJHtjb25maWcuYWRhcHRlck5hbWV9XSBZb3VyIGRhdGFiYXNlIG9yIGRhdGFiYXNlIGFkYXB0ZXIgZG9lcyBub3Qgc3VwcG9ydCBudW1lcmljIGlkcy4gUGxlYXNlIGRpc2FibGUgXCJ1c2VOdW1iZXJJZFwiIGluIHlvdXIgY29uZmlnLmBcbiAgICApO1xuICB9XG4gIGNvbnN0IHNjaGVtYSA9IGdldEF1dGhUYWJsZXMob3B0aW9ucyk7XG4gIGNvbnN0IGdldERlZmF1bHRGaWVsZE5hbWUgPSAoe1xuICAgIGZpZWxkLFxuICAgIG1vZGVsOiB1bnNhZmVfbW9kZWxcbiAgfSkgPT4ge1xuICAgIGlmIChmaWVsZCA9PT0gXCJpZFwiIHx8IGZpZWxkID09PSBcIl9pZFwiKSB7XG4gICAgICByZXR1cm4gXCJpZFwiO1xuICAgIH1cbiAgICBjb25zdCBtb2RlbCA9IGdldERlZmF1bHRNb2RlbE5hbWUodW5zYWZlX21vZGVsKTtcbiAgICBsZXQgZiA9IHNjaGVtYVttb2RlbF0/LmZpZWxkc1tmaWVsZF07XG4gICAgaWYgKCFmKSB7XG4gICAgICBmID0gT2JqZWN0LnZhbHVlcyhzY2hlbWFbbW9kZWxdPy5maWVsZHMpLmZpbmQoXG4gICAgICAgIChmMikgPT4gZjIuZmllbGROYW1lID09PSBmaWVsZFxuICAgICAgKTtcbiAgICB9XG4gICAgaWYgKCFmKSB7XG4gICAgICBkZWJ1Z0xvZyhgRmllbGQgJHtmaWVsZH0gbm90IGZvdW5kIGluIG1vZGVsICR7bW9kZWx9YCk7XG4gICAgICBkZWJ1Z0xvZyhgU2NoZW1hOmAsIHNjaGVtYSk7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoYEZpZWxkICR7ZmllbGR9IG5vdCBmb3VuZCBpbiBtb2RlbCAke21vZGVsfWApO1xuICAgIH1cbiAgICByZXR1cm4gZmllbGQ7XG4gIH07XG4gIGNvbnN0IGdldERlZmF1bHRNb2RlbE5hbWUgPSAobW9kZWwpID0+IHtcbiAgICBpZiAoY29uZmlnLnVzZVBsdXJhbCAmJiBtb2RlbC5jaGFyQXQobW9kZWwubGVuZ3RoIC0gMSkgPT09IFwic1wiKSB7XG4gICAgICBsZXQgcGx1cmFsZXNzTW9kZWwgPSBtb2RlbC5zbGljZSgwLCAtMSk7XG4gICAgICBsZXQgbTIgPSBzY2hlbWFbcGx1cmFsZXNzTW9kZWxdID8gcGx1cmFsZXNzTW9kZWwgOiB2b2lkIDA7XG4gICAgICBpZiAoIW0yKSB7XG4gICAgICAgIG0yID0gT2JqZWN0LmVudHJpZXMoc2NoZW1hKS5maW5kKFxuICAgICAgICAgIChbXywgZl0pID0+IGYubW9kZWxOYW1lID09PSBwbHVyYWxlc3NNb2RlbFxuICAgICAgICApPy5bMF07XG4gICAgICB9XG4gICAgICBpZiAobTIpIHtcbiAgICAgICAgcmV0dXJuIG0yO1xuICAgICAgfVxuICAgIH1cbiAgICBsZXQgbSA9IHNjaGVtYVttb2RlbF0gPyBtb2RlbCA6IHZvaWQgMDtcbiAgICBpZiAoIW0pIHtcbiAgICAgIG0gPSBPYmplY3QuZW50cmllcyhzY2hlbWEpLmZpbmQoKFtfLCBmXSkgPT4gZi5tb2RlbE5hbWUgPT09IG1vZGVsKT8uWzBdO1xuICAgIH1cbiAgICBpZiAoIW0pIHtcbiAgICAgIGRlYnVnTG9nKGBNb2RlbCBcIiR7bW9kZWx9XCIgbm90IGZvdW5kIGluIHNjaGVtYWApO1xuICAgICAgZGVidWdMb2coYFNjaGVtYTpgLCBzY2hlbWEpO1xuICAgICAgdGhyb3cgbmV3IEVycm9yKGBNb2RlbCBcIiR7bW9kZWx9XCIgbm90IGZvdW5kIGluIHNjaGVtYWApO1xuICAgIH1cbiAgICByZXR1cm4gbTtcbiAgfTtcbiAgY29uc3QgZ2V0TW9kZWxOYW1lID0gKG1vZGVsKSA9PiB7XG4gICAgY29uc3QgZGVmYXVsdE1vZGVsS2V5ID0gZ2V0RGVmYXVsdE1vZGVsTmFtZShtb2RlbCk7XG4gICAgY29uc3QgdXNlUGx1cmFsID0gY29uZmlnICYmIGNvbmZpZy51c2VQbHVyYWw7XG4gICAgY29uc3QgdXNlQ3VzdG9tTW9kZWxOYW1lID0gc2NoZW1hICYmIHNjaGVtYVtkZWZhdWx0TW9kZWxLZXldICYmIHNjaGVtYVtkZWZhdWx0TW9kZWxLZXldLm1vZGVsTmFtZSAhPT0gbW9kZWw7XG4gICAgaWYgKHVzZUN1c3RvbU1vZGVsTmFtZSkge1xuICAgICAgcmV0dXJuIHVzZVBsdXJhbCA/IGAke3NjaGVtYVtkZWZhdWx0TW9kZWxLZXldLm1vZGVsTmFtZX1zYCA6IHNjaGVtYVtkZWZhdWx0TW9kZWxLZXldLm1vZGVsTmFtZTtcbiAgICB9XG4gICAgcmV0dXJuIHVzZVBsdXJhbCA/IGAke21vZGVsfXNgIDogbW9kZWw7XG4gIH07XG4gIGZ1bmN0aW9uIGdldEZpZWxkTmFtZSh7XG4gICAgbW9kZWw6IG1vZGVsX25hbWUsXG4gICAgZmllbGQ6IGZpZWxkX25hbWVcbiAgfSkge1xuICAgIGNvbnN0IG1vZGVsID0gZ2V0RGVmYXVsdE1vZGVsTmFtZShtb2RlbF9uYW1lKTtcbiAgICBjb25zdCBmaWVsZCA9IGdldERlZmF1bHRGaWVsZE5hbWUoeyBtb2RlbCwgZmllbGQ6IGZpZWxkX25hbWUgfSk7XG4gICAgcmV0dXJuIHNjaGVtYVttb2RlbF0/LmZpZWxkc1tmaWVsZF0/LmZpZWxkTmFtZSB8fCBmaWVsZDtcbiAgfVxuICBjb25zdCBkZWJ1Z0xvZyA9ICguLi5hcmdzKSA9PiB7XG4gICAgaWYgKGNvbmZpZy5kZWJ1Z0xvZ3MgPT09IHRydWUgfHwgdHlwZW9mIGNvbmZpZy5kZWJ1Z0xvZ3MgPT09IFwib2JqZWN0XCIpIHtcbiAgICAgIGlmICh0eXBlb2YgY29uZmlnLmRlYnVnTG9ncyA9PT0gXCJvYmplY3RcIiAmJiBcImlzUnVubmluZ0FkYXB0ZXJUZXN0c1wiIGluIGNvbmZpZy5kZWJ1Z0xvZ3MpIHtcbiAgICAgICAgaWYgKGNvbmZpZy5kZWJ1Z0xvZ3MuaXNSdW5uaW5nQWRhcHRlclRlc3RzKSB7XG4gICAgICAgICAgYXJncy5zaGlmdCgpO1xuICAgICAgICAgIGRlYnVnTG9ncy5wdXNoKGFyZ3MpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgY29uZmlnLmRlYnVnTG9ncyA9PT0gXCJvYmplY3RcIiAmJiBjb25maWcuZGVidWdMb2dzLmxvZ0NvbmRpdGlvbiAmJiAhY29uZmlnLmRlYnVnTG9ncy5sb2dDb25kaXRpb24/LigpKSB7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGlmICh0eXBlb2YgYXJnc1swXSA9PT0gXCJvYmplY3RcIiAmJiBcIm1ldGhvZFwiIGluIGFyZ3NbMF0pIHtcbiAgICAgICAgY29uc3QgbWV0aG9kID0gYXJncy5zaGlmdCgpLm1ldGhvZDtcbiAgICAgICAgaWYgKHR5cGVvZiBjb25maWcuZGVidWdMb2dzID09PSBcIm9iamVjdFwiKSB7XG4gICAgICAgICAgaWYgKG1ldGhvZCA9PT0gXCJjcmVhdGVcIiAmJiAhY29uZmlnLmRlYnVnTG9ncy5jcmVhdGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IGVsc2UgaWYgKG1ldGhvZCA9PT0gXCJ1cGRhdGVcIiAmJiAhY29uZmlnLmRlYnVnTG9ncy51cGRhdGUpIHtcbiAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICB9IGVsc2UgaWYgKG1ldGhvZCA9PT0gXCJ1cGRhdGVNYW55XCIgJiYgIWNvbmZpZy5kZWJ1Z0xvZ3MudXBkYXRlTWFueSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gZWxzZSBpZiAobWV0aG9kID09PSBcImZpbmRPbmVcIiAmJiAhY29uZmlnLmRlYnVnTG9ncy5maW5kT25lKSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSBlbHNlIGlmIChtZXRob2QgPT09IFwiZmluZE1hbnlcIiAmJiAhY29uZmlnLmRlYnVnTG9ncy5maW5kTWFueSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gZWxzZSBpZiAobWV0aG9kID09PSBcImRlbGV0ZVwiICYmICFjb25maWcuZGVidWdMb2dzLmRlbGV0ZSkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH0gZWxzZSBpZiAobWV0aG9kID09PSBcImRlbGV0ZU1hbnlcIiAmJiAhY29uZmlnLmRlYnVnTG9ncy5kZWxldGVNYW55KSB7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfSBlbHNlIGlmIChtZXRob2QgPT09IFwiY291bnRcIiAmJiAhY29uZmlnLmRlYnVnTG9ncy5jb3VudCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBsb2dnZXIuaW5mbyhgWyR7Y29uZmlnLmFkYXB0ZXJOYW1lfV1gLCAuLi5hcmdzKTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIGxvZ2dlci5pbmZvKGBbJHtjb25maWcuYWRhcHRlck5hbWV9XWAsIC4uLmFyZ3MpO1xuICAgICAgfVxuICAgIH1cbiAgfTtcbiAgY29uc3QgaWRGaWVsZCA9ICh7XG4gICAgY3VzdG9tTW9kZWxOYW1lLFxuICAgIGZvcmNlQWxsb3dJZFxuICB9KSA9PiB7XG4gICAgY29uc3Qgc2hvdWxkR2VuZXJhdGVJZCA9ICFjb25maWcuZGlzYWJsZUlkR2VuZXJhdGlvbiAmJiAhb3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkICYmICFmb3JjZUFsbG93SWQ7XG4gICAgY29uc3QgbW9kZWwgPSBnZXREZWZhdWx0TW9kZWxOYW1lKGN1c3RvbU1vZGVsTmFtZSA/PyBcImlkXCIpO1xuICAgIHJldHVybiB7XG4gICAgICB0eXBlOiBvcHRpb25zLmFkdmFuY2VkPy5kYXRhYmFzZT8udXNlTnVtYmVySWQgPyBcIm51bWJlclwiIDogXCJzdHJpbmdcIixcbiAgICAgIHJlcXVpcmVkOiBzaG91bGRHZW5lcmF0ZUlkID8gdHJ1ZSA6IGZhbHNlLFxuICAgICAgLi4uc2hvdWxkR2VuZXJhdGVJZCA/IHtcbiAgICAgICAgZGVmYXVsdFZhbHVlKCkge1xuICAgICAgICAgIGlmIChjb25maWcuZGlzYWJsZUlkR2VuZXJhdGlvbikgcmV0dXJuIHZvaWQgMDtcbiAgICAgICAgICBjb25zdCB1c2VOdW1iZXJJZCA9IG9wdGlvbnMuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZDtcbiAgICAgICAgICBsZXQgZ2VuZXJhdGVJZCQxID0gb3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LmdlbmVyYXRlSWQ7XG4gICAgICAgICAgaWYgKG9wdGlvbnMuYWR2YW5jZWQ/LmdlbmVyYXRlSWQgIT09IHZvaWQgMCkge1xuICAgICAgICAgICAgbG9nZ2VyLndhcm4oXG4gICAgICAgICAgICAgIFwiWW91ciBCZXR0ZXIgQXV0aCBjb25maWcgaW5jbHVkZXMgYWR2YW5jZWQuZ2VuZXJhdGVJZCB3aGljaCBpcyBkZXByZWNhdGVkLiBQbGVhc2UgdXNlIGFkdmFuY2VkLmRhdGFiYXNlLmdlbmVyYXRlSWQgaW5zdGVhZC4gVGhpcyB3aWxsIGJlIHJlbW92ZWQgaW4gZnV0dXJlIHJlbGVhc2VzLlwiXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgZ2VuZXJhdGVJZCQxID0gb3B0aW9ucy5hZHZhbmNlZD8uZ2VuZXJhdGVJZDtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGdlbmVyYXRlSWQkMSA9PT0gZmFsc2UgfHwgdXNlTnVtYmVySWQpIHJldHVybiB2b2lkIDA7XG4gICAgICAgICAgaWYgKGdlbmVyYXRlSWQkMSkge1xuICAgICAgICAgICAgcmV0dXJuIGdlbmVyYXRlSWQkMSh7XG4gICAgICAgICAgICAgIG1vZGVsXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgICB9XG4gICAgICAgICAgaWYgKGNvbmZpZy5jdXN0b21JZEdlbmVyYXRvcikge1xuICAgICAgICAgICAgcmV0dXJuIGNvbmZpZy5jdXN0b21JZEdlbmVyYXRvcih7IG1vZGVsIH0pO1xuICAgICAgICAgIH1cbiAgICAgICAgICByZXR1cm4gZ2VuZXJhdGVJZCgpO1xuICAgICAgICB9XG4gICAgICB9IDoge31cbiAgICB9O1xuICB9O1xuICBjb25zdCBnZXRGaWVsZEF0dHJpYnV0ZXMgPSAoe1xuICAgIG1vZGVsLFxuICAgIGZpZWxkXG4gIH0pID0+IHtcbiAgICBjb25zdCBkZWZhdWx0TW9kZWxOYW1lID0gZ2V0RGVmYXVsdE1vZGVsTmFtZShtb2RlbCk7XG4gICAgY29uc3QgZGVmYXVsdEZpZWxkTmFtZSA9IGdldERlZmF1bHRGaWVsZE5hbWUoe1xuICAgICAgZmllbGQsXG4gICAgICBtb2RlbFxuICAgIH0pO1xuICAgIGNvbnN0IGZpZWxkcyA9IHNjaGVtYVtkZWZhdWx0TW9kZWxOYW1lXS5maWVsZHM7XG4gICAgZmllbGRzLmlkID0gaWRGaWVsZCh7IGN1c3RvbU1vZGVsTmFtZTogZGVmYXVsdE1vZGVsTmFtZSB9KTtcbiAgICByZXR1cm4gZmllbGRzW2RlZmF1bHRGaWVsZE5hbWVdO1xuICB9O1xuICBjb25zdCBhZGFwdGVySW5zdGFuY2UgPSBhZGFwdGVyKHtcbiAgICBvcHRpb25zLFxuICAgIHNjaGVtYSxcbiAgICBkZWJ1Z0xvZyxcbiAgICBnZXRGaWVsZE5hbWUsXG4gICAgZ2V0TW9kZWxOYW1lLFxuICAgIGdldERlZmF1bHRNb2RlbE5hbWUsXG4gICAgZ2V0RGVmYXVsdEZpZWxkTmFtZSxcbiAgICBnZXRGaWVsZEF0dHJpYnV0ZXNcbiAgfSk7XG4gIGNvbnN0IHRyYW5zZm9ybUlucHV0ID0gYXN5bmMgKGRhdGEsIHVuc2FmZV9tb2RlbCwgYWN0aW9uLCBmb3JjZUFsbG93SWQpID0+IHtcbiAgICBjb25zdCB0cmFuc2Zvcm1lZERhdGEgPSB7fTtcbiAgICBjb25zdCBmaWVsZHMgPSBzY2hlbWFbdW5zYWZlX21vZGVsXS5maWVsZHM7XG4gICAgY29uc3QgbmV3TWFwcGVkS2V5cyA9IGNvbmZpZy5tYXBLZXlzVHJhbnNmb3JtSW5wdXQgPz8ge307XG4gICAgaWYgKCFjb25maWcuZGlzYWJsZUlkR2VuZXJhdGlvbiAmJiAhb3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkKSB7XG4gICAgICBmaWVsZHMuaWQgPSBpZEZpZWxkKHtcbiAgICAgICAgY3VzdG9tTW9kZWxOYW1lOiB1bnNhZmVfbW9kZWwsXG4gICAgICAgIGZvcmNlQWxsb3dJZDogZm9yY2VBbGxvd0lkICYmIFwiaWRcIiBpbiBkYXRhXG4gICAgICB9KTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBmaWVsZCBpbiBmaWVsZHMpIHtcbiAgICAgIGNvbnN0IHZhbHVlID0gZGF0YVtmaWVsZF07XG4gICAgICBjb25zdCBmaWVsZEF0dHJpYnV0ZXMgPSBmaWVsZHNbZmllbGRdO1xuICAgICAgbGV0IG5ld0ZpZWxkTmFtZSA9IG5ld01hcHBlZEtleXNbZmllbGRdIHx8IGZpZWxkc1tmaWVsZF0uZmllbGROYW1lIHx8IGZpZWxkO1xuICAgICAgaWYgKHZhbHVlID09PSB2b2lkIDAgJiYgKGZpZWxkQXR0cmlidXRlcy5kZWZhdWx0VmFsdWUgPT09IHZvaWQgMCAmJiAhZmllbGRBdHRyaWJ1dGVzLnRyYW5zZm9ybT8uaW5wdXQgJiYgIShhY3Rpb24gPT09IFwidXBkYXRlXCIgJiYgZmllbGRBdHRyaWJ1dGVzLm9uVXBkYXRlKSB8fCBhY3Rpb24gPT09IFwidXBkYXRlXCIgJiYgIWZpZWxkQXR0cmlidXRlcy5vblVwZGF0ZSkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9XG4gICAgICBsZXQgbmV3VmFsdWUgPSB3aXRoQXBwbHlEZWZhdWx0KHZhbHVlLCBmaWVsZEF0dHJpYnV0ZXMsIGFjdGlvbik7XG4gICAgICBpZiAoZmllbGRBdHRyaWJ1dGVzLnRyYW5zZm9ybT8uaW5wdXQpIHtcbiAgICAgICAgbmV3VmFsdWUgPSBhd2FpdCBmaWVsZEF0dHJpYnV0ZXMudHJhbnNmb3JtLmlucHV0KG5ld1ZhbHVlKTtcbiAgICAgIH1cbiAgICAgIGlmIChmaWVsZEF0dHJpYnV0ZXMucmVmZXJlbmNlcz8uZmllbGQgPT09IFwiaWRcIiAmJiBvcHRpb25zLmFkdmFuY2VkPy5kYXRhYmFzZT8udXNlTnVtYmVySWQpIHtcbiAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkobmV3VmFsdWUpKSB7XG4gICAgICAgICAgbmV3VmFsdWUgPSBuZXdWYWx1ZS5tYXAoTnVtYmVyKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBuZXdWYWx1ZSA9IE51bWJlcihuZXdWYWx1ZSk7XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAoY29uZmlnLnN1cHBvcnRzSlNPTiA9PT0gZmFsc2UgJiYgdHlwZW9mIG5ld1ZhbHVlID09PSBcIm9iamVjdFwiICYmIGZpZWxkQXR0cmlidXRlcy50eXBlID09PSBcImpzb25cIikge1xuICAgICAgICBuZXdWYWx1ZSA9IEpTT04uc3RyaW5naWZ5KG5ld1ZhbHVlKTtcbiAgICAgIH0gZWxzZSBpZiAoY29uZmlnLnN1cHBvcnRzRGF0ZXMgPT09IGZhbHNlICYmIG5ld1ZhbHVlIGluc3RhbmNlb2YgRGF0ZSAmJiBmaWVsZEF0dHJpYnV0ZXMudHlwZSA9PT0gXCJkYXRlXCIpIHtcbiAgICAgICAgbmV3VmFsdWUgPSBuZXdWYWx1ZS50b0lTT1N0cmluZygpO1xuICAgICAgfSBlbHNlIGlmIChjb25maWcuc3VwcG9ydHNCb29sZWFucyA9PT0gZmFsc2UgJiYgdHlwZW9mIG5ld1ZhbHVlID09PSBcImJvb2xlYW5cIikge1xuICAgICAgICBuZXdWYWx1ZSA9IG5ld1ZhbHVlID8gMSA6IDA7XG4gICAgICB9XG4gICAgICBpZiAoY29uZmlnLmN1c3RvbVRyYW5zZm9ybUlucHV0KSB7XG4gICAgICAgIG5ld1ZhbHVlID0gY29uZmlnLmN1c3RvbVRyYW5zZm9ybUlucHV0KHtcbiAgICAgICAgICBkYXRhOiBuZXdWYWx1ZSxcbiAgICAgICAgICBhY3Rpb24sXG4gICAgICAgICAgZmllbGQ6IG5ld0ZpZWxkTmFtZSxcbiAgICAgICAgICBmaWVsZEF0dHJpYnV0ZXMsXG4gICAgICAgICAgbW9kZWw6IHVuc2FmZV9tb2RlbCxcbiAgICAgICAgICBzY2hlbWEsXG4gICAgICAgICAgb3B0aW9uc1xuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGlmIChuZXdWYWx1ZSAhPT0gdm9pZCAwKSB7XG4gICAgICAgIHRyYW5zZm9ybWVkRGF0YVtuZXdGaWVsZE5hbWVdID0gbmV3VmFsdWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cmFuc2Zvcm1lZERhdGE7XG4gIH07XG4gIGNvbnN0IHRyYW5zZm9ybU91dHB1dCA9IGFzeW5jIChkYXRhLCB1bnNhZmVfbW9kZWwsIHNlbGVjdCA9IFtdKSA9PiB7XG4gICAgaWYgKCFkYXRhKSByZXR1cm4gbnVsbDtcbiAgICBjb25zdCBuZXdNYXBwZWRLZXlzID0gY29uZmlnLm1hcEtleXNUcmFuc2Zvcm1PdXRwdXQgPz8ge307XG4gICAgY29uc3QgdHJhbnNmb3JtZWREYXRhID0ge307XG4gICAgY29uc3QgdGFibGVTY2hlbWEgPSBzY2hlbWFbdW5zYWZlX21vZGVsXS5maWVsZHM7XG4gICAgY29uc3QgaWRLZXkgPSBPYmplY3QuZW50cmllcyhuZXdNYXBwZWRLZXlzKS5maW5kKFxuICAgICAgKFtfLCB2XSkgPT4gdiA9PT0gXCJpZFwiXG4gICAgKT8uWzBdO1xuICAgIHRhYmxlU2NoZW1hW2lkS2V5ID8/IFwiaWRcIl0gPSB7XG4gICAgICB0eXBlOiBvcHRpb25zLmFkdmFuY2VkPy5kYXRhYmFzZT8udXNlTnVtYmVySWQgPyBcIm51bWJlclwiIDogXCJzdHJpbmdcIlxuICAgIH07XG4gICAgZm9yIChjb25zdCBrZXkgaW4gdGFibGVTY2hlbWEpIHtcbiAgICAgIGlmIChzZWxlY3QubGVuZ3RoICYmICFzZWxlY3QuaW5jbHVkZXMoa2V5KSkge1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGZpZWxkID0gdGFibGVTY2hlbWFba2V5XTtcbiAgICAgIGlmIChmaWVsZCkge1xuICAgICAgICBjb25zdCBvcmlnaW5hbEtleSA9IGZpZWxkLmZpZWxkTmFtZSB8fCBrZXk7XG4gICAgICAgIGxldCBuZXdWYWx1ZSA9IGRhdGFbT2JqZWN0LmVudHJpZXMobmV3TWFwcGVkS2V5cykuZmluZChcbiAgICAgICAgICAoW18sIHZdKSA9PiB2ID09PSBvcmlnaW5hbEtleVxuICAgICAgICApPy5bMF0gfHwgb3JpZ2luYWxLZXldO1xuICAgICAgICBpZiAoZmllbGQudHJhbnNmb3JtPy5vdXRwdXQpIHtcbiAgICAgICAgICBuZXdWYWx1ZSA9IGF3YWl0IGZpZWxkLnRyYW5zZm9ybS5vdXRwdXQobmV3VmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGxldCBuZXdGaWVsZE5hbWUgPSBuZXdNYXBwZWRLZXlzW2tleV0gfHwga2V5O1xuICAgICAgICBpZiAob3JpZ2luYWxLZXkgPT09IFwiaWRcIiB8fCBmaWVsZC5yZWZlcmVuY2VzPy5maWVsZCA9PT0gXCJpZFwiKSB7XG4gICAgICAgICAgaWYgKHR5cGVvZiBuZXdWYWx1ZSAhPT0gXCJ1bmRlZmluZWRcIikgbmV3VmFsdWUgPSBTdHJpbmcobmV3VmFsdWUpO1xuICAgICAgICB9IGVsc2UgaWYgKGNvbmZpZy5zdXBwb3J0c0pTT04gPT09IGZhbHNlICYmIHR5cGVvZiBuZXdWYWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiBmaWVsZC50eXBlID09PSBcImpzb25cIikge1xuICAgICAgICAgIG5ld1ZhbHVlID0gc2FmZUpTT05QYXJzZShuZXdWYWx1ZSk7XG4gICAgICAgIH0gZWxzZSBpZiAoY29uZmlnLnN1cHBvcnRzRGF0ZXMgPT09IGZhbHNlICYmIHR5cGVvZiBuZXdWYWx1ZSA9PT0gXCJzdHJpbmdcIiAmJiBmaWVsZC50eXBlID09PSBcImRhdGVcIikge1xuICAgICAgICAgIG5ld1ZhbHVlID0gbmV3IERhdGUobmV3VmFsdWUpO1xuICAgICAgICB9IGVsc2UgaWYgKGNvbmZpZy5zdXBwb3J0c0Jvb2xlYW5zID09PSBmYWxzZSAmJiB0eXBlb2YgbmV3VmFsdWUgPT09IFwibnVtYmVyXCIgJiYgZmllbGQudHlwZSA9PT0gXCJib29sZWFuXCIpIHtcbiAgICAgICAgICBuZXdWYWx1ZSA9IG5ld1ZhbHVlID09PSAxO1xuICAgICAgICB9XG4gICAgICAgIGlmIChjb25maWcuY3VzdG9tVHJhbnNmb3JtT3V0cHV0KSB7XG4gICAgICAgICAgbmV3VmFsdWUgPSBjb25maWcuY3VzdG9tVHJhbnNmb3JtT3V0cHV0KHtcbiAgICAgICAgICAgIGRhdGE6IG5ld1ZhbHVlLFxuICAgICAgICAgICAgZmllbGQ6IG5ld0ZpZWxkTmFtZSxcbiAgICAgICAgICAgIGZpZWxkQXR0cmlidXRlczogZmllbGQsXG4gICAgICAgICAgICBzZWxlY3QsXG4gICAgICAgICAgICBtb2RlbDogdW5zYWZlX21vZGVsLFxuICAgICAgICAgICAgc2NoZW1hLFxuICAgICAgICAgICAgb3B0aW9uc1xuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICAgIHRyYW5zZm9ybWVkRGF0YVtuZXdGaWVsZE5hbWVdID0gbmV3VmFsdWU7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cmFuc2Zvcm1lZERhdGE7XG4gIH07XG4gIGNvbnN0IHRyYW5zZm9ybVdoZXJlQ2xhdXNlID0gKHtcbiAgICBtb2RlbCxcbiAgICB3aGVyZVxuICB9KSA9PiB7XG4gICAgaWYgKCF3aGVyZSkgcmV0dXJuIHZvaWQgMDtcbiAgICBjb25zdCBuZXdNYXBwZWRLZXlzID0gY29uZmlnLm1hcEtleXNUcmFuc2Zvcm1JbnB1dCA/PyB7fTtcbiAgICByZXR1cm4gd2hlcmUubWFwKCh3KSA9PiB7XG4gICAgICBjb25zdCB7XG4gICAgICAgIGZpZWxkOiB1bnNhZmVfZmllbGQsXG4gICAgICAgIHZhbHVlLFxuICAgICAgICBvcGVyYXRvciA9IFwiZXFcIixcbiAgICAgICAgY29ubmVjdG9yID0gXCJBTkRcIlxuICAgICAgfSA9IHc7XG4gICAgICBpZiAob3BlcmF0b3IgPT09IFwiaW5cIikge1xuICAgICAgICBpZiAoIUFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgdGhyb3cgbmV3IEVycm9yKFwiVmFsdWUgbXVzdCBiZSBhbiBhcnJheVwiKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgY29uc3QgZGVmYXVsdE1vZGVsTmFtZSA9IGdldERlZmF1bHRNb2RlbE5hbWUobW9kZWwpO1xuICAgICAgY29uc3QgZGVmYXVsdEZpZWxkTmFtZSA9IGdldERlZmF1bHRGaWVsZE5hbWUoe1xuICAgICAgICBmaWVsZDogdW5zYWZlX2ZpZWxkLFxuICAgICAgICBtb2RlbFxuICAgICAgfSk7XG4gICAgICBjb25zdCBmaWVsZE5hbWUgPSBuZXdNYXBwZWRLZXlzW2RlZmF1bHRGaWVsZE5hbWVdIHx8IGdldEZpZWxkTmFtZSh7XG4gICAgICAgIGZpZWxkOiBkZWZhdWx0RmllbGROYW1lLFxuICAgICAgICBtb2RlbDogZGVmYXVsdE1vZGVsTmFtZVxuICAgICAgfSk7XG4gICAgICBjb25zdCBmaWVsZEF0dHIgPSBnZXRGaWVsZEF0dHJpYnV0ZXMoe1xuICAgICAgICBmaWVsZDogZGVmYXVsdEZpZWxkTmFtZSxcbiAgICAgICAgbW9kZWw6IGRlZmF1bHRNb2RlbE5hbWVcbiAgICAgIH0pO1xuICAgICAgaWYgKGRlZmF1bHRGaWVsZE5hbWUgPT09IFwiaWRcIiB8fCBmaWVsZEF0dHIucmVmZXJlbmNlcz8uZmllbGQgPT09IFwiaWRcIikge1xuICAgICAgICBpZiAob3B0aW9ucy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkKSB7XG4gICAgICAgICAgaWYgKEFycmF5LmlzQXJyYXkodmFsdWUpKSB7XG4gICAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgICBvcGVyYXRvcixcbiAgICAgICAgICAgICAgY29ubmVjdG9yLFxuICAgICAgICAgICAgICBmaWVsZDogZmllbGROYW1lLFxuICAgICAgICAgICAgICB2YWx1ZTogdmFsdWUubWFwKE51bWJlcilcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICBvcGVyYXRvcixcbiAgICAgICAgICAgIGNvbm5lY3RvcixcbiAgICAgICAgICAgIGZpZWxkOiBmaWVsZE5hbWUsXG4gICAgICAgICAgICB2YWx1ZTogTnVtYmVyKHZhbHVlKVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB7XG4gICAgICAgIG9wZXJhdG9yLFxuICAgICAgICBjb25uZWN0b3IsXG4gICAgICAgIGZpZWxkOiBmaWVsZE5hbWUsXG4gICAgICAgIHZhbHVlXG4gICAgICB9O1xuICAgIH0pO1xuICB9O1xuICByZXR1cm4ge1xuICAgIGNyZWF0ZTogYXN5bmMgKHtcbiAgICAgIGRhdGE6IHVuc2FmZURhdGEsXG4gICAgICBtb2RlbDogdW5zYWZlTW9kZWwsXG4gICAgICBzZWxlY3QsXG4gICAgICBmb3JjZUFsbG93SWQgPSBmYWxzZVxuICAgIH0pID0+IHtcbiAgICAgIHRyYW5zYWN0aW9uSWQrKztcbiAgICAgIGxldCB0aGlzVHJhbnNhY3Rpb25JZCA9IHRyYW5zYWN0aW9uSWQ7XG4gICAgICBjb25zdCBtb2RlbCA9IGdldE1vZGVsTmFtZSh1bnNhZmVNb2RlbCk7XG4gICAgICBpZiAoXCJpZFwiIGluIHVuc2FmZURhdGEgJiYgIWZvcmNlQWxsb3dJZCkge1xuICAgICAgICBsb2dnZXIud2FybihcbiAgICAgICAgICBgWyR7Y29uZmlnLmFkYXB0ZXJOYW1lfV0gLSBZb3UgYXJlIHRyeWluZyB0byBjcmVhdGUgYSByZWNvcmQgd2l0aCBhbiBpZC4gVGhpcyBpcyBub3QgYWxsb3dlZCBhcyB3ZSBoYW5kbGUgaWQgZ2VuZXJhdGlvbiBmb3IgeW91LCB1bmxlc3MgeW91IHBhc3MgaW4gdGhlIFxcYGZvcmNlQWxsb3dJZFxcYCBwYXJhbWV0ZXIuIFRoZSBpZCB3aWxsIGJlIGlnbm9yZWQuYFxuICAgICAgICApO1xuICAgICAgICBjb25zdCBlcnIgPSBuZXcgRXJyb3IoKTtcbiAgICAgICAgY29uc3Qgc3RhY2sgPSBlcnIuc3RhY2s/LnNwbGl0KFwiXFxuXCIpLmZpbHRlcigoXywgaSkgPT4gaSAhPT0gMSkuam9pbihcIlxcblwiKS5yZXBsYWNlKFwiRXJyb3I6XCIsIFwiQ3JlYXRlIG1ldGhvZCB3aXRoIGBpZGAgYmVpbmcgY2FsbGVkIGF0OlwiKTtcbiAgICAgICAgY29uc29sZS5sb2coc3RhY2spO1xuICAgICAgICB1bnNhZmVEYXRhLmlkID0gdm9pZCAwO1xuICAgICAgfVxuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcImNyZWF0ZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMSwgNCl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiY3JlYXRlXCIpfSAke2Zvcm1hdEFjdGlvbihcIlVuc2FmZSBJbnB1dFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgZGF0YTogdW5zYWZlRGF0YSB9XG4gICAgICApO1xuICAgICAgY29uc3QgZGF0YSA9IGF3YWl0IHRyYW5zZm9ybUlucHV0KFxuICAgICAgICB1bnNhZmVEYXRhLFxuICAgICAgICB1bnNhZmVNb2RlbCxcbiAgICAgICAgXCJjcmVhdGVcIixcbiAgICAgICAgZm9yY2VBbGxvd0lkXG4gICAgICApO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcImNyZWF0ZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMiwgNCl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiY3JlYXRlXCIpfSAke2Zvcm1hdEFjdGlvbihcIlBhcnNlZCBJbnB1dFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgZGF0YSB9XG4gICAgICApO1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgYWRhcHRlckluc3RhbmNlLmNyZWF0ZSh7IGRhdGEsIG1vZGVsIH0pO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcImNyZWF0ZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMywgNCl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiY3JlYXRlXCIpfSAke2Zvcm1hdEFjdGlvbihcIkRCIFJlc3VsdFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgcmVzIH1cbiAgICAgICk7XG4gICAgICBjb25zdCB0cmFuc2Zvcm1lZCA9IGF3YWl0IHRyYW5zZm9ybU91dHB1dChyZXMsIHVuc2FmZU1vZGVsLCBzZWxlY3QpO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcImNyZWF0ZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoNCwgNCl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiY3JlYXRlXCIpfSAke2Zvcm1hdEFjdGlvbihcIlBhcnNlZCBSZXN1bHRcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIGRhdGE6IHRyYW5zZm9ybWVkIH1cbiAgICAgICk7XG4gICAgICByZXR1cm4gdHJhbnNmb3JtZWQ7XG4gICAgfSxcbiAgICB1cGRhdGU6IGFzeW5jICh7XG4gICAgICBtb2RlbDogdW5zYWZlTW9kZWwsXG4gICAgICB3aGVyZTogdW5zYWZlV2hlcmUsXG4gICAgICB1cGRhdGU6IHVuc2FmZURhdGFcbiAgICB9KSA9PiB7XG4gICAgICB0cmFuc2FjdGlvbklkKys7XG4gICAgICBsZXQgdGhpc1RyYW5zYWN0aW9uSWQgPSB0cmFuc2FjdGlvbklkO1xuICAgICAgY29uc3QgbW9kZWwgPSBnZXRNb2RlbE5hbWUodW5zYWZlTW9kZWwpO1xuICAgICAgY29uc3Qgd2hlcmUgPSB0cmFuc2Zvcm1XaGVyZUNsYXVzZSh7XG4gICAgICAgIG1vZGVsOiB1bnNhZmVNb2RlbCxcbiAgICAgICAgd2hlcmU6IHVuc2FmZVdoZXJlXG4gICAgICB9KTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJ1cGRhdGVcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDEsIDQpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcInVwZGF0ZVwiKX0gJHtmb3JtYXRBY3Rpb24oXCJVbnNhZmUgSW5wdXRcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIGRhdGE6IHVuc2FmZURhdGEgfVxuICAgICAgKTtcbiAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCB0cmFuc2Zvcm1JbnB1dChcbiAgICAgICAgdW5zYWZlRGF0YSxcbiAgICAgICAgdW5zYWZlTW9kZWwsXG4gICAgICAgIFwidXBkYXRlXCJcbiAgICAgICk7XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwidXBkYXRlXCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgyLCA0KX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJ1cGRhdGVcIil9ICR7Zm9ybWF0QWN0aW9uKFwiUGFyc2VkIElucHV0XCIpfTpgLFxuICAgICAgICB7IG1vZGVsLCBkYXRhIH1cbiAgICAgICk7XG4gICAgICBjb25zdCByZXMgPSBhd2FpdCBhZGFwdGVySW5zdGFuY2UudXBkYXRlKHtcbiAgICAgICAgbW9kZWwsXG4gICAgICAgIHdoZXJlLFxuICAgICAgICB1cGRhdGU6IGRhdGFcbiAgICAgIH0pO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcInVwZGF0ZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMywgNCl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwidXBkYXRlXCIpfSAke2Zvcm1hdEFjdGlvbihcIkRCIFJlc3VsdFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgZGF0YTogcmVzIH1cbiAgICAgICk7XG4gICAgICBjb25zdCB0cmFuc2Zvcm1lZCA9IGF3YWl0IHRyYW5zZm9ybU91dHB1dChyZXMsIHVuc2FmZU1vZGVsKTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJ1cGRhdGVcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDQsIDQpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcInVwZGF0ZVwiKX0gJHtmb3JtYXRBY3Rpb24oXCJQYXJzZWQgUmVzdWx0XCIpfTpgLFxuICAgICAgICB7IG1vZGVsLCBkYXRhOiB0cmFuc2Zvcm1lZCB9XG4gICAgICApO1xuICAgICAgcmV0dXJuIHRyYW5zZm9ybWVkO1xuICAgIH0sXG4gICAgdXBkYXRlTWFueTogYXN5bmMgKHtcbiAgICAgIG1vZGVsOiB1bnNhZmVNb2RlbCxcbiAgICAgIHdoZXJlOiB1bnNhZmVXaGVyZSxcbiAgICAgIHVwZGF0ZTogdW5zYWZlRGF0YVxuICAgIH0pID0+IHtcbiAgICAgIHRyYW5zYWN0aW9uSWQrKztcbiAgICAgIGxldCB0aGlzVHJhbnNhY3Rpb25JZCA9IHRyYW5zYWN0aW9uSWQ7XG4gICAgICBjb25zdCBtb2RlbCA9IGdldE1vZGVsTmFtZSh1bnNhZmVNb2RlbCk7XG4gICAgICBjb25zdCB3aGVyZSA9IHRyYW5zZm9ybVdoZXJlQ2xhdXNlKHtcbiAgICAgICAgbW9kZWw6IHVuc2FmZU1vZGVsLFxuICAgICAgICB3aGVyZTogdW5zYWZlV2hlcmVcbiAgICAgIH0pO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcInVwZGF0ZU1hbnlcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDEsIDQpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcInVwZGF0ZU1hbnlcIil9ICR7Zm9ybWF0QWN0aW9uKFwiVW5zYWZlIElucHV0XCIpfTpgLFxuICAgICAgICB7IG1vZGVsLCBkYXRhOiB1bnNhZmVEYXRhIH1cbiAgICAgICk7XG4gICAgICBjb25zdCBkYXRhID0gYXdhaXQgdHJhbnNmb3JtSW5wdXQodW5zYWZlRGF0YSwgdW5zYWZlTW9kZWwsIFwidXBkYXRlXCIpO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcInVwZGF0ZU1hbnlcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDIsIDQpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcInVwZGF0ZU1hbnlcIil9ICR7Zm9ybWF0QWN0aW9uKFwiUGFyc2VkIElucHV0XCIpfTpgLFxuICAgICAgICB7IG1vZGVsLCBkYXRhIH1cbiAgICAgICk7XG4gICAgICBjb25zdCB1cGRhdGVkQ291bnQgPSBhd2FpdCBhZGFwdGVySW5zdGFuY2UudXBkYXRlTWFueSh7XG4gICAgICAgIG1vZGVsLFxuICAgICAgICB3aGVyZSxcbiAgICAgICAgdXBkYXRlOiBkYXRhXG4gICAgICB9KTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJ1cGRhdGVNYW55XCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgzLCA0KX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJ1cGRhdGVNYW55XCIpfSAke2Zvcm1hdEFjdGlvbihcIkRCIFJlc3VsdFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgZGF0YTogdXBkYXRlZENvdW50IH1cbiAgICAgICk7XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwidXBkYXRlTWFueVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoNCwgNCl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwidXBkYXRlTWFueVwiKX0gJHtmb3JtYXRBY3Rpb24oXCJQYXJzZWQgUmVzdWx0XCIpfTpgLFxuICAgICAgICB7IG1vZGVsLCBkYXRhOiB1cGRhdGVkQ291bnQgfVxuICAgICAgKTtcbiAgICAgIHJldHVybiB1cGRhdGVkQ291bnQ7XG4gICAgfSxcbiAgICBmaW5kT25lOiBhc3luYyAoe1xuICAgICAgbW9kZWw6IHVuc2FmZU1vZGVsLFxuICAgICAgd2hlcmU6IHVuc2FmZVdoZXJlLFxuICAgICAgc2VsZWN0XG4gICAgfSkgPT4ge1xuICAgICAgdHJhbnNhY3Rpb25JZCsrO1xuICAgICAgbGV0IHRoaXNUcmFuc2FjdGlvbklkID0gdHJhbnNhY3Rpb25JZDtcbiAgICAgIGNvbnN0IG1vZGVsID0gZ2V0TW9kZWxOYW1lKHVuc2FmZU1vZGVsKTtcbiAgICAgIGNvbnN0IHdoZXJlID0gdHJhbnNmb3JtV2hlcmVDbGF1c2Uoe1xuICAgICAgICBtb2RlbDogdW5zYWZlTW9kZWwsXG4gICAgICAgIHdoZXJlOiB1bnNhZmVXaGVyZVxuICAgICAgfSk7XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwiZmluZE9uZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMSwgMyl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiZmluZE9uZVwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgd2hlcmUsIHNlbGVjdCB9XG4gICAgICApO1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgYWRhcHRlckluc3RhbmNlLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbCxcbiAgICAgICAgd2hlcmUsXG4gICAgICAgIHNlbGVjdFxuICAgICAgfSk7XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwiZmluZE9uZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMiwgMyl9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiZmluZE9uZVwiKX0gJHtmb3JtYXRBY3Rpb24oXCJEQiBSZXN1bHRcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIGRhdGE6IHJlcyB9XG4gICAgICApO1xuICAgICAgY29uc3QgdHJhbnNmb3JtZWQgPSBhd2FpdCB0cmFuc2Zvcm1PdXRwdXQoXG4gICAgICAgIHJlcyxcbiAgICAgICAgdW5zYWZlTW9kZWwsXG4gICAgICAgIHNlbGVjdFxuICAgICAgKTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJmaW5kT25lXCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgzLCAzKX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJmaW5kT25lXCIpfSAke2Zvcm1hdEFjdGlvbihcIlBhcnNlZCBSZXN1bHRcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIGRhdGE6IHRyYW5zZm9ybWVkIH1cbiAgICAgICk7XG4gICAgICByZXR1cm4gdHJhbnNmb3JtZWQ7XG4gICAgfSxcbiAgICBmaW5kTWFueTogYXN5bmMgKHtcbiAgICAgIG1vZGVsOiB1bnNhZmVNb2RlbCxcbiAgICAgIHdoZXJlOiB1bnNhZmVXaGVyZSxcbiAgICAgIGxpbWl0OiB1bnNhZmVMaW1pdCxcbiAgICAgIHNvcnRCeSxcbiAgICAgIG9mZnNldFxuICAgIH0pID0+IHtcbiAgICAgIHRyYW5zYWN0aW9uSWQrKztcbiAgICAgIGxldCB0aGlzVHJhbnNhY3Rpb25JZCA9IHRyYW5zYWN0aW9uSWQ7XG4gICAgICBjb25zdCBsaW1pdCA9IHVuc2FmZUxpbWl0ID8/IG9wdGlvbnMuYWR2YW5jZWQ/LmRhdGFiYXNlPy5kZWZhdWx0RmluZE1hbnlMaW1pdCA/PyAxMDA7XG4gICAgICBjb25zdCBtb2RlbCA9IGdldE1vZGVsTmFtZSh1bnNhZmVNb2RlbCk7XG4gICAgICBjb25zdCB3aGVyZSA9IHRyYW5zZm9ybVdoZXJlQ2xhdXNlKHtcbiAgICAgICAgbW9kZWw6IHVuc2FmZU1vZGVsLFxuICAgICAgICB3aGVyZTogdW5zYWZlV2hlcmVcbiAgICAgIH0pO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcImZpbmRNYW55XCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgxLCAzKX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJmaW5kTWFueVwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgd2hlcmUsIGxpbWl0LCBzb3J0QnksIG9mZnNldCB9XG4gICAgICApO1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgYWRhcHRlckluc3RhbmNlLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWwsXG4gICAgICAgIHdoZXJlLFxuICAgICAgICBsaW1pdCxcbiAgICAgICAgc29ydEJ5LFxuICAgICAgICBvZmZzZXRcbiAgICAgIH0pO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcImZpbmRNYW55XCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgyLCAzKX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJmaW5kTWFueVwiKX0gJHtmb3JtYXRBY3Rpb24oXCJEQiBSZXN1bHRcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIGRhdGE6IHJlcyB9XG4gICAgICApO1xuICAgICAgY29uc3QgdHJhbnNmb3JtZWQgPSBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgICAgcmVzLm1hcChhc3luYyAocikgPT4gYXdhaXQgdHJhbnNmb3JtT3V0cHV0KHIsIHVuc2FmZU1vZGVsKSlcbiAgICAgICk7XG4gICAgICBkZWJ1Z0xvZyhcbiAgICAgICAgeyBtZXRob2Q6IFwiZmluZE1hbnlcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDMsIDMpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcImZpbmRNYW55XCIpfSAke2Zvcm1hdEFjdGlvbihcIlBhcnNlZCBSZXN1bHRcIil9OmAsXG4gICAgICAgIHsgbW9kZWwsIGRhdGE6IHRyYW5zZm9ybWVkIH1cbiAgICAgICk7XG4gICAgICByZXR1cm4gdHJhbnNmb3JtZWQ7XG4gICAgfSxcbiAgICBkZWxldGU6IGFzeW5jICh7XG4gICAgICBtb2RlbDogdW5zYWZlTW9kZWwsXG4gICAgICB3aGVyZTogdW5zYWZlV2hlcmVcbiAgICB9KSA9PiB7XG4gICAgICB0cmFuc2FjdGlvbklkKys7XG4gICAgICBsZXQgdGhpc1RyYW5zYWN0aW9uSWQgPSB0cmFuc2FjdGlvbklkO1xuICAgICAgY29uc3QgbW9kZWwgPSBnZXRNb2RlbE5hbWUodW5zYWZlTW9kZWwpO1xuICAgICAgY29uc3Qgd2hlcmUgPSB0cmFuc2Zvcm1XaGVyZUNsYXVzZSh7XG4gICAgICAgIG1vZGVsOiB1bnNhZmVNb2RlbCxcbiAgICAgICAgd2hlcmU6IHVuc2FmZVdoZXJlXG4gICAgICB9KTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJkZWxldGVcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDEsIDIpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcImRlbGV0ZVwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgd2hlcmUgfVxuICAgICAgKTtcbiAgICAgIGF3YWl0IGFkYXB0ZXJJbnN0YW5jZS5kZWxldGUoe1xuICAgICAgICBtb2RlbCxcbiAgICAgICAgd2hlcmVcbiAgICAgIH0pO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcImRlbGV0ZVwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMiwgMil9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiZGVsZXRlXCIpfSAke2Zvcm1hdEFjdGlvbihcIkRCIFJlc3VsdFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCB9XG4gICAgICApO1xuICAgIH0sXG4gICAgZGVsZXRlTWFueTogYXN5bmMgKHtcbiAgICAgIG1vZGVsOiB1bnNhZmVNb2RlbCxcbiAgICAgIHdoZXJlOiB1bnNhZmVXaGVyZVxuICAgIH0pID0+IHtcbiAgICAgIHRyYW5zYWN0aW9uSWQrKztcbiAgICAgIGxldCB0aGlzVHJhbnNhY3Rpb25JZCA9IHRyYW5zYWN0aW9uSWQ7XG4gICAgICBjb25zdCBtb2RlbCA9IGdldE1vZGVsTmFtZSh1bnNhZmVNb2RlbCk7XG4gICAgICBjb25zdCB3aGVyZSA9IHRyYW5zZm9ybVdoZXJlQ2xhdXNlKHtcbiAgICAgICAgbW9kZWw6IHVuc2FmZU1vZGVsLFxuICAgICAgICB3aGVyZTogdW5zYWZlV2hlcmVcbiAgICAgIH0pO1xuICAgICAgZGVidWdMb2coXG4gICAgICAgIHsgbWV0aG9kOiBcImRlbGV0ZU1hbnlcIiB9LFxuICAgICAgICBgJHtmb3JtYXRUcmFuc2FjdGlvbklkKHRoaXNUcmFuc2FjdGlvbklkKX0gJHtmb3JtYXRTdGVwKDEsIDIpfWAsXG4gICAgICAgIGAke2Zvcm1hdE1ldGhvZChcImRlbGV0ZU1hbnlcIil9ICR7Zm9ybWF0QWN0aW9uKFwiRGVsZXRlTWFueVwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgd2hlcmUgfVxuICAgICAgKTtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGFkYXB0ZXJJbnN0YW5jZS5kZWxldGVNYW55KHtcbiAgICAgICAgbW9kZWwsXG4gICAgICAgIHdoZXJlXG4gICAgICB9KTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJkZWxldGVNYW55XCIgfSxcbiAgICAgICAgYCR7Zm9ybWF0VHJhbnNhY3Rpb25JZCh0aGlzVHJhbnNhY3Rpb25JZCl9ICR7Zm9ybWF0U3RlcCgyLCAyKX1gLFxuICAgICAgICBgJHtmb3JtYXRNZXRob2QoXCJkZWxldGVNYW55XCIpfSAke2Zvcm1hdEFjdGlvbihcIkRCIFJlc3VsdFwiKX06YCxcbiAgICAgICAgeyBtb2RlbCwgZGF0YTogcmVzIH1cbiAgICAgICk7XG4gICAgICByZXR1cm4gcmVzO1xuICAgIH0sXG4gICAgY291bnQ6IGFzeW5jICh7XG4gICAgICBtb2RlbDogdW5zYWZlTW9kZWwsXG4gICAgICB3aGVyZTogdW5zYWZlV2hlcmVcbiAgICB9KSA9PiB7XG4gICAgICB0cmFuc2FjdGlvbklkKys7XG4gICAgICBsZXQgdGhpc1RyYW5zYWN0aW9uSWQgPSB0cmFuc2FjdGlvbklkO1xuICAgICAgY29uc3QgbW9kZWwgPSBnZXRNb2RlbE5hbWUodW5zYWZlTW9kZWwpO1xuICAgICAgY29uc3Qgd2hlcmUgPSB0cmFuc2Zvcm1XaGVyZUNsYXVzZSh7XG4gICAgICAgIG1vZGVsOiB1bnNhZmVNb2RlbCxcbiAgICAgICAgd2hlcmU6IHVuc2FmZVdoZXJlXG4gICAgICB9KTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJjb3VudFwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMSwgMil9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiY291bnRcIil9OmAsXG4gICAgICAgIHtcbiAgICAgICAgICBtb2RlbCxcbiAgICAgICAgICB3aGVyZVxuICAgICAgICB9XG4gICAgICApO1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgYWRhcHRlckluc3RhbmNlLmNvdW50KHtcbiAgICAgICAgbW9kZWwsXG4gICAgICAgIHdoZXJlXG4gICAgICB9KTtcbiAgICAgIGRlYnVnTG9nKFxuICAgICAgICB7IG1ldGhvZDogXCJjb3VudFwiIH0sXG4gICAgICAgIGAke2Zvcm1hdFRyYW5zYWN0aW9uSWQodGhpc1RyYW5zYWN0aW9uSWQpfSAke2Zvcm1hdFN0ZXAoMiwgMil9YCxcbiAgICAgICAgYCR7Zm9ybWF0TWV0aG9kKFwiY291bnRcIil9OmAsXG4gICAgICAgIHtcbiAgICAgICAgICBtb2RlbCxcbiAgICAgICAgICBkYXRhOiByZXNcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIHJldHVybiByZXM7XG4gICAgfSxcbiAgICBjcmVhdGVTY2hlbWE6IGFkYXB0ZXJJbnN0YW5jZS5jcmVhdGVTY2hlbWEgPyBhc3luYyAoXywgZmlsZSkgPT4ge1xuICAgICAgY29uc3QgdGFibGVzID0gZ2V0QXV0aFRhYmxlcyhvcHRpb25zKTtcbiAgICAgIGlmIChvcHRpb25zLnNlY29uZGFyeVN0b3JhZ2UgJiYgIW9wdGlvbnMuc2Vzc2lvbj8uc3RvcmVTZXNzaW9uSW5EYXRhYmFzZSkge1xuICAgICAgICBkZWxldGUgdGFibGVzLnNlc3Npb247XG4gICAgICB9XG4gICAgICBpZiAob3B0aW9ucy5yYXRlTGltaXQgJiYgb3B0aW9ucy5yYXRlTGltaXQuc3RvcmFnZSA9PT0gXCJkYXRhYmFzZVwiICYmIC8vIHJhdGUtbGltaXQgd2lsbCBkZWZhdWx0IHRvIGVuYWJsZWQgaW4gcHJvZHVjdGlvbixcbiAgICAgIC8vIGFuZCBnaXZlbiBzdG9yYWdlIGlzIGRhdGFiYXNlLCBpdCB3aWxsIHRyeSB0byB1c2UgdGhlIHJhdGUtbGltaXQgdGFibGUsXG4gICAgICAvLyBzbyB3ZSBzaG91bGQgbWFrZSBzdXJlIHRvIGdlbmVyYXRlIHJhdGUtbGltaXQgdGFibGUgc2NoZW1hXG4gICAgICAodHlwZW9mIG9wdGlvbnMucmF0ZUxpbWl0LmVuYWJsZWQgPT09IFwidW5kZWZpbmVkXCIgfHwgLy8gYW5kIG9mIGNvdXJzZSBpZiB0aGV5IGZvcmNlZnVsbHkgc2V0IHRvIHRydWUsIHRoZW4gdGhleSB3YW50IHJhdGUtbGltaXQsXG4gICAgICAvLyB0aHVzIHdlIHNob3VsZCBhbHNvIGdlbmVyYXRlIHJhdGUtbGltaXQgdGFibGUgc2NoZW1hXG4gICAgICBvcHRpb25zLnJhdGVMaW1pdC5lbmFibGVkID09PSB0cnVlKSkge1xuICAgICAgICB0YWJsZXMucmF0ZWxpbWl0ID0ge1xuICAgICAgICAgIG1vZGVsTmFtZTogb3B0aW9ucy5yYXRlTGltaXQubW9kZWxOYW1lID8/IFwicmF0ZWxpbWl0XCIsXG4gICAgICAgICAgZmllbGRzOiB7XG4gICAgICAgICAgICBrZXk6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJzdHJpbmdcIixcbiAgICAgICAgICAgICAgdW5pcXVlOiB0cnVlLFxuICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgZmllbGROYW1lOiBvcHRpb25zLnJhdGVMaW1pdC5maWVsZHM/LmtleSA/PyBcImtleVwiXG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgY291bnQ6IHtcbiAgICAgICAgICAgICAgdHlwZTogXCJudW1iZXJcIixcbiAgICAgICAgICAgICAgcmVxdWlyZWQ6IHRydWUsXG4gICAgICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5yYXRlTGltaXQuZmllbGRzPy5jb3VudCA/PyBcImNvdW50XCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBsYXN0UmVxdWVzdDoge1xuICAgICAgICAgICAgICB0eXBlOiBcIm51bWJlclwiLFxuICAgICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSxcbiAgICAgICAgICAgICAgYmlnaW50OiB0cnVlLFxuICAgICAgICAgICAgICBkZWZhdWx0VmFsdWU6ICgpID0+IERhdGUubm93KCksXG4gICAgICAgICAgICAgIGZpZWxkTmFtZTogb3B0aW9ucy5yYXRlTGltaXQuZmllbGRzPy5sYXN0UmVxdWVzdCA/PyBcImxhc3RSZXF1ZXN0XCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4gYWRhcHRlckluc3RhbmNlLmNyZWF0ZVNjaGVtYSh7IGZpbGUsIHRhYmxlcyB9KTtcbiAgICB9IDogdm9pZCAwLFxuICAgIG9wdGlvbnM6IHtcbiAgICAgIGFkYXB0ZXJDb25maWc6IGNvbmZpZyxcbiAgICAgIC4uLmFkYXB0ZXJJbnN0YW5jZS5vcHRpb25zID8/IHt9XG4gICAgfSxcbiAgICBpZDogY29uZmlnLmFkYXB0ZXJJZCxcbiAgICAvLyBTZWNyZXRseSBleHBvcnQgdmFsdWVzIE9OTFkgaWYgdGhpcyBhZGFwdGVyIGhhcyBlbmFibGVkIGFkYXB0ZXItdGVzdC1kZWJ1Zy1sb2dzLlxuICAgIC8vIFRoaXMgd291bGQgdGhlbiBiZSB1c2VkIGR1cmluZyBvdXIgYWRhcHRlci10ZXN0cyB0byBoZWxwIHByaW50IGRlYnVnIGxvZ3MgaWYgYSB0ZXN0IGZhaWxzLlxuICAgIC8vQHRzLWV4cGVjdC1lcnJvciAtIF5eXG4gICAgLi4uY29uZmlnLmRlYnVnTG9ncz8uaXNSdW5uaW5nQWRhcHRlclRlc3RzID8ge1xuICAgICAgYWRhcHRlclRlc3REZWJ1Z0xvZ3M6IHtcbiAgICAgICAgcmVzZXREZWJ1Z0xvZ3MoKSB7XG4gICAgICAgICAgZGVidWdMb2dzID0gW107XG4gICAgICAgIH0sXG4gICAgICAgIHByaW50RGVidWdMb2dzKCkge1xuICAgICAgICAgIGNvbnN0IHNlcGFyYXRvciA9IGBcXHUyNTAwYC5yZXBlYXQoODApO1xuICAgICAgICAgIGxldCBsb2cgPSBkZWJ1Z0xvZ3MucmV2ZXJzZSgpLm1hcCgobG9nMikgPT4ge1xuICAgICAgICAgICAgbG9nMlswXSA9IGBcbiR7bG9nMlswXX1gO1xuICAgICAgICAgICAgcmV0dXJuIFsuLi5sb2cyLCBcIlxcblwiXTtcbiAgICAgICAgICB9KS5yZWR1Y2UoXG4gICAgICAgICAgICAocHJldiwgY3VycikgPT4ge1xuICAgICAgICAgICAgICByZXR1cm4gWy4uLmN1cnIsIC4uLnByZXZdO1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIFtgXG4ke3NlcGFyYXRvcn1gXVxuICAgICAgICAgICk7XG4gICAgICAgICAgY29uc29sZS5sb2coLi4ubG9nKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0gOiB7fVxuICB9O1xufTtcbmZ1bmN0aW9uIGZvcm1hdFRyYW5zYWN0aW9uSWQodHJhbnNhY3Rpb25JZDIpIHtcbiAgcmV0dXJuIGAke2NvbG9ycy5mZy5tYWdlbnRhfSMke3RyYW5zYWN0aW9uSWQyfSR7Y29sb3JzLnJlc2V0fWA7XG59XG5mdW5jdGlvbiBmb3JtYXRTdGVwKHN0ZXAsIHRvdGFsKSB7XG4gIHJldHVybiBgJHtjb2xvcnMuYmcuYmxhY2t9JHtjb2xvcnMuZmcueWVsbG93fVske3N0ZXB9LyR7dG90YWx9XSR7Y29sb3JzLnJlc2V0fWA7XG59XG5mdW5jdGlvbiBmb3JtYXRNZXRob2QobWV0aG9kKSB7XG4gIHJldHVybiBgJHtjb2xvcnMuYnJpZ2h0fSR7bWV0aG9kfSR7Y29sb3JzLnJlc2V0fWA7XG59XG5mdW5jdGlvbiBmb3JtYXRBY3Rpb24oYWN0aW9uKSB7XG4gIHJldHVybiBgJHtjb2xvcnMuZGltfSgke2FjdGlvbn0pJHtjb2xvcnMucmVzZXR9YDtcbn1cblxuZXhwb3J0IHsgY3JlYXRlQWRhcHRlciBhcyBjIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.DOXaXTC6.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.DV0Lly8-.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.DV0Lly8-.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ getAdapter),\n/* harmony export */   b: () => (/* binding */ convertToDB),\n/* harmony export */   c: () => (/* binding */ createInternalAdapter),\n/* harmony export */   d: () => (/* binding */ convertFromDB),\n/* harmony export */   e: () => (/* binding */ getMigrations),\n/* harmony export */   f: () => (/* binding */ getSchema),\n/* harmony export */   g: () => (/* binding */ getWithHooks),\n/* harmony export */   m: () => (/* binding */ matchType)\n/* harmony export */ });\n/* harmony import */ var _better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./better-auth.CW6D9eSx.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\");\n/* harmony import */ var _better_auth_Dcv8PS7T_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./better-auth.Dcv8PS7T.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.Dcv8PS7T.mjs\");\n/* harmony import */ var _better_auth_O2VtDkDK_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./better-auth.O2VtDkDK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.O2VtDkDK.mjs\");\n/* harmony import */ var _better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./better-auth.BZZKN1g7.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BZZKN1g7.mjs\");\n/* harmony import */ var _better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./better-auth.BUPPRXfK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BUPPRXfK.mjs\");\n/* harmony import */ var zod_v4__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! zod/v4 */ \"(rsc)/./node_modules/zod/v4/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_utils_hash__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @better-auth/utils/hash */ \"(rsc)/./node_modules/@better-auth/utils/dist/hash.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! @better-auth/utils */ \"(rsc)/./node_modules/@better-auth/utils/dist/index.mjs\");\n/* harmony import */ var _better_auth_utils_hex__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! @better-auth/utils/hex */ \"(rsc)/./node_modules/@better-auth/utils/dist/hex.mjs\");\n/* harmony import */ var _better_auth_B4Qoxdgc_mjs__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./better-auth.B4Qoxdgc.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B4Qoxdgc.mjs\");\n/* harmony import */ var _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./better-auth.BjBlybv-.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BjBlybv-.mjs\");\n/* harmony import */ var _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./better-auth.CMQ3rA-I.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CMQ3rA-I.mjs\");\n/* harmony import */ var _better_auth_utils_random__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! @better-auth/utils/random */ \"(rsc)/./node_modules/@better-auth/utils/dist/random.mjs\");\n/* harmony import */ var _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ./better-auth.DdzSJf-n.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DdzSJf-n.mjs\");\n/* harmony import */ var _better_auth_B_PTVODM_mjs__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ./better-auth.B_PTVODM.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.B_PTVODM.mjs\");\n/* harmony import */ var _better_auth_BduPtJy8_mjs__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ./better-auth.BduPtJy8.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BduPtJy8.mjs\");\n/* harmony import */ var _better_auth_7ZeACU2v_mjs__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ./better-auth.7ZeACU2v.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.7ZeACU2v.mjs\");\n/* harmony import */ var kysely__WEBPACK_IMPORTED_MODULE_19__ = __webpack_require__(/*! kysely */ \"(rsc)/./node_modules/kysely/dist/esm/raw-builder/sql.js\");\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nfunction getWithHooks(adapter, ctx) {\n  const hooks = ctx.hooks;\n  async function createWithHooks(data, model, customCreateFn, context) {\n    let actualData = data;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.create?.before;\n      if (toRun) {\n        const result = await toRun(actualData, context);\n        if (result === false) {\n          return null;\n        }\n        const isObject = typeof result === \"object\" && \"data\" in result;\n        if (isObject) {\n          actualData = {\n            ...actualData,\n            ...result.data\n          };\n        }\n      }\n    }\n    const customCreated = customCreateFn ? await customCreateFn.fn(actualData) : null;\n    const created = !customCreateFn || customCreateFn.executeMainFn ? await adapter.create({\n      model,\n      data: actualData,\n      forceAllowId: true\n    }) : customCreated;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.create?.after;\n      if (toRun) {\n        await toRun(created, context);\n      }\n    }\n    return created;\n  }\n  async function updateWithHooks(data, where, model, customUpdateFn, context) {\n    let actualData = data;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.before;\n      if (toRun) {\n        const result = await toRun(data, context);\n        if (result === false) {\n          return null;\n        }\n        const isObject = typeof result === \"object\";\n        actualData = isObject ? result.data : result;\n      }\n    }\n    const customUpdated = customUpdateFn ? await customUpdateFn.fn(actualData) : null;\n    const updated = !customUpdateFn || customUpdateFn.executeMainFn ? await adapter.update({\n      model,\n      update: actualData,\n      where\n    }) : customUpdated;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.after;\n      if (toRun) {\n        await toRun(updated, context);\n      }\n    }\n    return updated;\n  }\n  async function updateManyWithHooks(data, where, model, customUpdateFn, context) {\n    let actualData = data;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.before;\n      if (toRun) {\n        const result = await toRun(data, context);\n        if (result === false) {\n          return null;\n        }\n        const isObject = typeof result === \"object\";\n        actualData = isObject ? result.data : result;\n      }\n    }\n    const customUpdated = customUpdateFn ? await customUpdateFn.fn(actualData) : null;\n    const updated = !customUpdateFn || customUpdateFn.executeMainFn ? await adapter.updateMany({\n      model,\n      update: actualData,\n      where\n    }) : customUpdated;\n    for (const hook of hooks || []) {\n      const toRun = hook[model]?.update?.after;\n      if (toRun) {\n        await toRun(updated, context);\n      }\n    }\n    return updated;\n  }\n  return {\n    createWithHooks,\n    updateWithHooks,\n    updateManyWithHooks\n  };\n}\n\nconst createInternalAdapter = (adapter, ctx) => {\n  const logger = ctx.logger;\n  const options = ctx.options;\n  const secondaryStorage = options.secondaryStorage;\n  const sessionExpiration = options.session?.expiresIn || 60 * 60 * 24 * 7;\n  const { createWithHooks, updateWithHooks, updateManyWithHooks } = getWithHooks(adapter, ctx);\n  return {\n    createOAuthUser: async (user, account, context) => {\n      const createdUser = await createWithHooks(\n        {\n          // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...user\n        },\n        \"user\",\n        void 0,\n        context\n      );\n      const createdAccount = await createWithHooks(\n        {\n          ...account,\n          userId: createdUser.id,\n          // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date()\n        },\n        \"account\",\n        void 0,\n        context\n      );\n      return {\n        user: createdUser,\n        account: createdAccount\n      };\n    },\n    createUser: async (user, context) => {\n      const createdUser = await createWithHooks(\n        {\n          // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...user,\n          email: user.email?.toLowerCase()\n        },\n        \"user\",\n        void 0,\n        context\n      );\n      return createdUser;\n    },\n    createAccount: async (account, context) => {\n      const createdAccount = await createWithHooks(\n        {\n          // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...account\n        },\n        \"account\",\n        void 0,\n        context\n      );\n      return createdAccount;\n    },\n    listSessions: async (userId) => {\n      if (secondaryStorage) {\n        const currentList = await secondaryStorage.get(\n          `active-sessions-${userId}`\n        );\n        if (!currentList) return [];\n        const list = (0,_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(currentList) || [];\n        const now = Date.now();\n        const validSessions = list.filter((s) => s.expiresAt > now);\n        const sessions2 = [];\n        for (const session of validSessions) {\n          const sessionStringified = await secondaryStorage.get(session.token);\n          if (sessionStringified) {\n            const s = (0,_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(sessionStringified);\n            if (!s) return [];\n            const parsedSession = (0,_better_auth_Dcv8PS7T_mjs__WEBPACK_IMPORTED_MODULE_1__.e)(ctx.options, {\n              ...s.session,\n              expiresAt: new Date(s.session.expiresAt)\n            });\n            sessions2.push(parsedSession);\n          }\n        }\n        return sessions2;\n      }\n      const sessions = await adapter.findMany({\n        model: \"session\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      return sessions;\n    },\n    listUsers: async (limit, offset, sortBy, where) => {\n      const users = await adapter.findMany({\n        model: \"user\",\n        limit,\n        offset,\n        sortBy,\n        where\n      });\n      return users;\n    },\n    countTotalUsers: async (where) => {\n      const total = await adapter.count({\n        model: \"user\",\n        where\n      });\n      if (typeof total === \"string\") {\n        return parseInt(total);\n      }\n      return total;\n    },\n    deleteUser: async (userId) => {\n      if (secondaryStorage) {\n        await secondaryStorage.delete(`active-sessions-${userId}`);\n      }\n      if (!secondaryStorage || options.session?.storeSessionInDatabase) {\n        await adapter.deleteMany({\n          model: \"session\",\n          where: [\n            {\n              field: \"userId\",\n              value: userId\n            }\n          ]\n        });\n      }\n      await adapter.deleteMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      await adapter.delete({\n        model: \"user\",\n        where: [\n          {\n            field: \"id\",\n            value: userId\n          }\n        ]\n      });\n    },\n    createSession: async (userId, ctx2, dontRememberMe, override, overrideAll) => {\n      const headers = ctx2.headers || ctx2.request?.headers;\n      const { id: _, ...rest } = override || {};\n      const data = {\n        ipAddress: ctx2.request || ctx2.headers ? (0,_better_auth_O2VtDkDK_mjs__WEBPACK_IMPORTED_MODULE_2__.g)(ctx2.request || ctx2.headers, ctx2.context.options) || \"\" : \"\",\n        userAgent: headers?.get(\"user-agent\") || \"\",\n        ...rest,\n        /**\n         * If the user doesn't want to be remembered\n         * set the session to expire in 1 day.\n         * The cookie will be set to expire at the end of the session\n         */\n        expiresAt: dontRememberMe ? (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_0__.g)(60 * 60 * 24, \"sec\") : (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_0__.g)(sessionExpiration, \"sec\"),\n        userId,\n        token: (0,_better_auth_BUPPRXfK_mjs__WEBPACK_IMPORTED_MODULE_4__.g)(32),\n        // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n        createdAt: /* @__PURE__ */ new Date(),\n        updatedAt: /* @__PURE__ */ new Date(),\n        ...overrideAll ? rest : {}\n      };\n      const res = await createWithHooks(\n        data,\n        \"session\",\n        secondaryStorage ? {\n          fn: async (sessionData) => {\n            const currentList = await secondaryStorage.get(\n              `active-sessions-${userId}`\n            );\n            let list = [];\n            const now = Date.now();\n            if (currentList) {\n              list = (0,_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(currentList) || [];\n              list = list.filter((session) => session.expiresAt > now);\n            }\n            list.push({\n              token: data.token,\n              expiresAt: now + sessionExpiration * 1e3\n            });\n            await secondaryStorage.set(\n              `active-sessions-${userId}`,\n              JSON.stringify(list),\n              sessionExpiration\n            );\n            return sessionData;\n          },\n          executeMainFn: options.session?.storeSessionInDatabase\n        } : void 0,\n        ctx2\n      );\n      return res;\n    },\n    findSession: async (token) => {\n      if (secondaryStorage) {\n        const sessionStringified = await secondaryStorage.get(token);\n        if (!sessionStringified && !options.session?.storeSessionInDatabase) {\n          return null;\n        }\n        if (sessionStringified) {\n          const s = (0,_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(sessionStringified);\n          if (!s) return null;\n          const parsedSession2 = (0,_better_auth_Dcv8PS7T_mjs__WEBPACK_IMPORTED_MODULE_1__.e)(ctx.options, {\n            ...s.session,\n            expiresAt: new Date(s.session.expiresAt),\n            createdAt: new Date(s.session.createdAt),\n            updatedAt: new Date(s.session.updatedAt)\n          });\n          const parsedUser2 = (0,_better_auth_Dcv8PS7T_mjs__WEBPACK_IMPORTED_MODULE_1__.b)(ctx.options, {\n            ...s.user,\n            createdAt: new Date(s.user.createdAt),\n            updatedAt: new Date(s.user.updatedAt)\n          });\n          return {\n            session: parsedSession2,\n            user: parsedUser2\n          };\n        }\n      }\n      const session = await adapter.findOne({\n        model: \"session\",\n        where: [\n          {\n            value: token,\n            field: \"token\"\n          }\n        ]\n      });\n      if (!session) {\n        return null;\n      }\n      const user = await adapter.findOne({\n        model: \"user\",\n        where: [\n          {\n            value: session.userId,\n            field: \"id\"\n          }\n        ]\n      });\n      if (!user) {\n        return null;\n      }\n      const parsedSession = (0,_better_auth_Dcv8PS7T_mjs__WEBPACK_IMPORTED_MODULE_1__.e)(ctx.options, session);\n      const parsedUser = (0,_better_auth_Dcv8PS7T_mjs__WEBPACK_IMPORTED_MODULE_1__.b)(ctx.options, user);\n      return {\n        session: parsedSession,\n        user: parsedUser\n      };\n    },\n    findSessions: async (sessionTokens) => {\n      if (secondaryStorage) {\n        const sessions2 = [];\n        for (const sessionToken of sessionTokens) {\n          const sessionStringified = await secondaryStorage.get(sessionToken);\n          if (sessionStringified) {\n            const s = (0,_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(sessionStringified);\n            if (!s) return [];\n            const session = {\n              session: {\n                ...s.session,\n                expiresAt: new Date(s.session.expiresAt)\n              },\n              user: {\n                ...s.user,\n                createdAt: new Date(s.user.createdAt),\n                updatedAt: new Date(s.user.updatedAt)\n              }\n            };\n            sessions2.push(session);\n          }\n        }\n        return sessions2;\n      }\n      const sessions = await adapter.findMany({\n        model: \"session\",\n        where: [\n          {\n            field: \"token\",\n            value: sessionTokens,\n            operator: \"in\"\n          }\n        ]\n      });\n      const userIds = sessions.map((session) => {\n        return session.userId;\n      });\n      if (!userIds.length) return [];\n      const users = await adapter.findMany({\n        model: \"user\",\n        where: [\n          {\n            field: \"id\",\n            value: userIds,\n            operator: \"in\"\n          }\n        ]\n      });\n      return sessions.map((session) => {\n        const user = users.find((u) => u.id === session.userId);\n        if (!user) return null;\n        return {\n          session,\n          user\n        };\n      });\n    },\n    updateSession: async (sessionToken, session, context) => {\n      const updatedSession = await updateWithHooks(\n        session,\n        [{ field: \"token\", value: sessionToken }],\n        \"session\",\n        secondaryStorage ? {\n          async fn(data) {\n            const currentSession = await secondaryStorage.get(sessionToken);\n            let updatedSession2 = null;\n            if (currentSession) {\n              const parsedSession = (0,_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(currentSession);\n              if (!parsedSession) return null;\n              updatedSession2 = {\n                ...parsedSession.session,\n                ...data\n              };\n              return updatedSession2;\n            } else {\n              return null;\n            }\n          },\n          executeMainFn: options.session?.storeSessionInDatabase\n        } : void 0,\n        context\n      );\n      return updatedSession;\n    },\n    deleteSession: async (token) => {\n      if (secondaryStorage) {\n        const data = await secondaryStorage.get(token);\n        if (data) {\n          const { session } = (0,_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(data) ?? {};\n          if (!session) {\n            logger.error(\"Session not found in secondary storage\");\n            return;\n          }\n          const userId = session.userId;\n          const currentList = await secondaryStorage.get(\n            `active-sessions-${userId}`\n          );\n          if (currentList) {\n            let list = (0,_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(currentList) || [];\n            list = list.filter((s) => s.token !== token);\n            if (list.length > 0) {\n              await secondaryStorage.set(\n                `active-sessions-${userId}`,\n                JSON.stringify(list),\n                sessionExpiration\n              );\n            } else {\n              await secondaryStorage.delete(`active-sessions-${userId}`);\n            }\n          } else {\n            logger.error(\"Active sessions list not found in secondary storage\");\n          }\n        }\n        await secondaryStorage.delete(token);\n        if (!options.session?.storeSessionInDatabase || ctx.options.session?.preserveSessionInDatabase) {\n          return;\n        }\n      }\n      await adapter.delete({\n        model: \"session\",\n        where: [\n          {\n            field: \"token\",\n            value: token\n          }\n        ]\n      });\n    },\n    deleteAccounts: async (userId) => {\n      await adapter.deleteMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n    },\n    deleteAccount: async (accountId) => {\n      await adapter.delete({\n        model: \"account\",\n        where: [\n          {\n            field: \"id\",\n            value: accountId\n          }\n        ]\n      });\n    },\n    deleteSessions: async (userIdOrSessionTokens) => {\n      if (secondaryStorage) {\n        if (typeof userIdOrSessionTokens === \"string\") {\n          const activeSession = await secondaryStorage.get(\n            `active-sessions-${userIdOrSessionTokens}`\n          );\n          const sessions = activeSession ? (0,_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(activeSession) : [];\n          if (!sessions) return;\n          for (const session of sessions) {\n            await secondaryStorage.delete(session.token);\n          }\n        } else {\n          for (const sessionToken of userIdOrSessionTokens) {\n            const session = await secondaryStorage.get(sessionToken);\n            if (session) {\n              await secondaryStorage.delete(sessionToken);\n            }\n          }\n        }\n        if (!options.session?.storeSessionInDatabase || ctx.options.session?.preserveSessionInDatabase) {\n          return;\n        }\n      }\n      await adapter.deleteMany({\n        model: \"session\",\n        where: [\n          {\n            field: Array.isArray(userIdOrSessionTokens) ? \"token\" : \"userId\",\n            value: userIdOrSessionTokens,\n            operator: Array.isArray(userIdOrSessionTokens) ? \"in\" : void 0\n          }\n        ]\n      });\n    },\n    findOAuthUser: async (email, accountId, providerId) => {\n      const account = await adapter.findMany({\n        model: \"account\",\n        where: [\n          {\n            value: accountId,\n            field: \"accountId\"\n          }\n        ]\n      }).then((accounts) => {\n        return accounts.find((a) => a.providerId === providerId);\n      });\n      if (account) {\n        const user = await adapter.findOne({\n          model: \"user\",\n          where: [\n            {\n              value: account.userId,\n              field: \"id\"\n            }\n          ]\n        });\n        if (user) {\n          return {\n            user,\n            accounts: [account]\n          };\n        } else {\n          const user2 = await adapter.findOne({\n            model: \"user\",\n            where: [\n              {\n                value: email.toLowerCase(),\n                field: \"email\"\n              }\n            ]\n          });\n          if (user2) {\n            return {\n              user: user2,\n              accounts: [account]\n            };\n          }\n          return null;\n        }\n      } else {\n        const user = await adapter.findOne({\n          model: \"user\",\n          where: [\n            {\n              value: email.toLowerCase(),\n              field: \"email\"\n            }\n          ]\n        });\n        if (user) {\n          const accounts = await adapter.findMany({\n            model: \"account\",\n            where: [\n              {\n                value: user.id,\n                field: \"userId\"\n              }\n            ]\n          });\n          return {\n            user,\n            accounts: accounts || []\n          };\n        } else {\n          return null;\n        }\n      }\n    },\n    findUserByEmail: async (email, options2) => {\n      const user = await adapter.findOne({\n        model: \"user\",\n        where: [\n          {\n            value: email.toLowerCase(),\n            field: \"email\"\n          }\n        ]\n      });\n      if (!user) return null;\n      if (options2?.includeAccounts) {\n        const accounts = await adapter.findMany({\n          model: \"account\",\n          where: [\n            {\n              value: user.id,\n              field: \"userId\"\n            }\n          ]\n        });\n        return {\n          user,\n          accounts\n        };\n      }\n      return {\n        user,\n        accounts: []\n      };\n    },\n    findUserById: async (userId) => {\n      const user = await adapter.findOne({\n        model: \"user\",\n        where: [\n          {\n            field: \"id\",\n            value: userId\n          }\n        ]\n      });\n      return user;\n    },\n    linkAccount: async (account, context) => {\n      const _account = await createWithHooks(\n        {\n          // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...account\n        },\n        \"account\",\n        void 0,\n        context\n      );\n      return _account;\n    },\n    updateUser: async (userId, data, context) => {\n      const user = await updateWithHooks(\n        data,\n        [\n          {\n            field: \"id\",\n            value: userId\n          }\n        ],\n        \"user\",\n        void 0,\n        context\n      );\n      if (secondaryStorage && user) {\n        const listRaw = await secondaryStorage.get(`active-sessions-${userId}`);\n        if (listRaw) {\n          const now = Date.now();\n          const list = (0,_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(listRaw) || [];\n          const validSessions = list.filter((s) => s.expiresAt > now);\n          await Promise.all(\n            validSessions.map(async ({ token }) => {\n              const cached = await secondaryStorage.get(token);\n              if (!cached) return;\n              const parsed = (0,_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_3__.s)(cached);\n              if (!parsed) return;\n              const sessionTTL = Math.max(\n                Math.floor(\n                  (new Date(parsed.session.expiresAt).getTime() - now) / 1e3\n                ),\n                0\n              );\n              await secondaryStorage.set(\n                token,\n                JSON.stringify({\n                  session: parsed.session,\n                  user\n                }),\n                sessionTTL\n              );\n            })\n          );\n        }\n      }\n      return user;\n    },\n    updateUserByEmail: async (email, data, context) => {\n      const user = await updateWithHooks(\n        data,\n        [\n          {\n            field: \"email\",\n            value: email.toLowerCase()\n          }\n        ],\n        \"user\",\n        void 0,\n        context\n      );\n      return user;\n    },\n    updatePassword: async (userId, password, context) => {\n      await updateManyWithHooks(\n        {\n          password\n        },\n        [\n          {\n            field: \"userId\",\n            value: userId\n          },\n          {\n            field: \"providerId\",\n            value: \"credential\"\n          }\n        ],\n        \"account\",\n        void 0,\n        context\n      );\n    },\n    findAccounts: async (userId) => {\n      const accounts = await adapter.findMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      return accounts;\n    },\n    findAccount: async (accountId) => {\n      const account = await adapter.findOne({\n        model: \"account\",\n        where: [\n          {\n            field: \"accountId\",\n            value: accountId\n          }\n        ]\n      });\n      return account;\n    },\n    findAccountByProviderId: async (accountId, providerId) => {\n      const account = await adapter.findOne({\n        model: \"account\",\n        where: [\n          {\n            field: \"accountId\",\n            value: accountId\n          },\n          {\n            field: \"providerId\",\n            value: providerId\n          }\n        ]\n      });\n      return account;\n    },\n    findAccountByUserId: async (userId) => {\n      const account = await adapter.findMany({\n        model: \"account\",\n        where: [\n          {\n            field: \"userId\",\n            value: userId\n          }\n        ]\n      });\n      return account;\n    },\n    updateAccount: async (id, data, context) => {\n      const account = await updateWithHooks(\n        data,\n        [{ field: \"id\", value: id }],\n        \"account\",\n        void 0,\n        context\n      );\n      return account;\n    },\n    createVerificationValue: async (data, context) => {\n      const verification = await createWithHooks(\n        {\n          // todo: we should remove auto setting createdAt and updatedAt in the next major release, since the db generators already handle that\n          createdAt: /* @__PURE__ */ new Date(),\n          updatedAt: /* @__PURE__ */ new Date(),\n          ...data\n        },\n        \"verification\",\n        void 0,\n        context\n      );\n      return verification;\n    },\n    findVerificationValue: async (identifier) => {\n      const verification = await adapter.findMany({\n        model: \"verification\",\n        where: [\n          {\n            field: \"identifier\",\n            value: identifier\n          }\n        ],\n        sortBy: {\n          field: \"createdAt\",\n          direction: \"desc\"\n        },\n        limit: 1\n      });\n      if (!options.verification?.disableCleanup) {\n        await adapter.deleteMany({\n          model: \"verification\",\n          where: [\n            {\n              field: \"expiresAt\",\n              value: /* @__PURE__ */ new Date(),\n              operator: \"lt\"\n            }\n          ]\n        });\n      }\n      const lastVerification = verification[0];\n      return lastVerification;\n    },\n    deleteVerificationValue: async (id) => {\n      await adapter.delete({\n        model: \"verification\",\n        where: [\n          {\n            field: \"id\",\n            value: id\n          }\n        ]\n      });\n    },\n    deleteVerificationByIdentifier: async (identifier) => {\n      await adapter.delete({\n        model: \"verification\",\n        where: [\n          {\n            field: \"identifier\",\n            value: identifier\n          }\n        ]\n      });\n    },\n    updateVerificationValue: async (id, data, context) => {\n      const verification = await updateWithHooks(\n        data,\n        [{ field: \"id\", value: id }],\n        \"verification\",\n        void 0,\n        context\n      );\n      return verification;\n    }\n  };\n};\n\nasync function getAdapter(options) {\n  if (!options.database) {\n    const tables = (0,_better_auth_B_PTVODM_mjs__WEBPACK_IMPORTED_MODULE_16__.g)(options);\n    const memoryDB = Object.keys(tables).reduce((acc, key) => {\n      acc[key] = [];\n      return acc;\n    }, {});\n    _better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_12__.a.warn(\n      \"No database configuration provided. Using memory adapter in development\"\n    );\n    return (0,_better_auth_7ZeACU2v_mjs__WEBPACK_IMPORTED_MODULE_18__.m)(memoryDB)(options);\n  }\n  if (typeof options.database === \"function\") {\n    return options.database(options);\n  }\n  const { kysely, databaseType } = await (0,_better_auth_BduPtJy8_mjs__WEBPACK_IMPORTED_MODULE_17__.c)(options);\n  if (!kysely) {\n    throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_15__.B(\"Failed to initialize database adapter\");\n  }\n  return (0,_better_auth_BduPtJy8_mjs__WEBPACK_IMPORTED_MODULE_17__.k)(kysely, {\n    type: databaseType || \"sqlite\",\n    debugLogs: \"debugLogs\" in options.database ? options.database.debugLogs : false\n  })(options);\n}\nfunction convertToDB(fields, values) {\n  let result = values.id ? {\n    id: values.id\n  } : {};\n  for (const key in fields) {\n    const field = fields[key];\n    const value = values[key];\n    if (value === void 0) {\n      continue;\n    }\n    result[field.fieldName || key] = value;\n  }\n  return result;\n}\nfunction convertFromDB(fields, values) {\n  if (!values) {\n    return null;\n  }\n  let result = {\n    id: values.id\n  };\n  for (const [key, value] of Object.entries(fields)) {\n    result[key] = values[value.fieldName || key];\n  }\n  return result;\n}\n\nfunction getSchema(config) {\n  const tables = (0,_better_auth_B_PTVODM_mjs__WEBPACK_IMPORTED_MODULE_16__.g)(config);\n  let schema = {};\n  for (const key in tables) {\n    const table = tables[key];\n    const fields = table.fields;\n    let actualFields = {};\n    Object.entries(fields).forEach(([key2, field]) => {\n      actualFields[field.fieldName || key2] = field;\n      if (field.references) {\n        const refTable = tables[field.references.model];\n        if (refTable) {\n          actualFields[field.fieldName || key2].references = {\n            model: refTable.modelName,\n            field: field.references.field\n          };\n        }\n      }\n    });\n    if (schema[table.modelName]) {\n      schema[table.modelName].fields = {\n        ...schema[table.modelName].fields,\n        ...actualFields\n      };\n      continue;\n    }\n    schema[table.modelName] = {\n      fields: actualFields,\n      order: table.order || Infinity\n    };\n  }\n  return schema;\n}\n\nconst postgresMap = {\n  string: [\"character varying\", \"varchar\", \"text\"],\n  number: [\n    \"int4\",\n    \"integer\",\n    \"bigint\",\n    \"smallint\",\n    \"numeric\",\n    \"real\",\n    \"double precision\"\n  ],\n  boolean: [\"bool\", \"boolean\"],\n  date: [\"timestamp\", \"date\"],\n  json: [\"json\", \"jsonb\"]\n};\nconst mysqlMap = {\n  string: [\"varchar\", \"text\"],\n  number: [\n    \"integer\",\n    \"int\",\n    \"bigint\",\n    \"smallint\",\n    \"decimal\",\n    \"float\",\n    \"double\"\n  ],\n  boolean: [\"boolean\", \"tinyint\"],\n  date: [\"timestamp\", \"datetime\", \"date\"],\n  json: [\"json\"]\n};\nconst sqliteMap = {\n  string: [\"TEXT\"],\n  number: [\"INTEGER\", \"REAL\"],\n  boolean: [\"INTEGER\", \"BOOLEAN\"],\n  // 0 or 1\n  date: [\"DATE\", \"INTEGER\"],\n  json: [\"TEXT\"]\n};\nconst mssqlMap = {\n  string: [\"varchar\", \"nvarchar\"],\n  number: [\"int\", \"bigint\", \"smallint\", \"decimal\", \"float\", \"double\"],\n  boolean: [\"bit\", \"smallint\"],\n  date: [\"datetime\", \"date\"],\n  json: [\"varchar\", \"nvarchar\"]\n};\nconst map = {\n  postgres: postgresMap,\n  mysql: mysqlMap,\n  sqlite: sqliteMap,\n  mssql: mssqlMap\n};\nfunction matchType(columnDataType, fieldType, dbType) {\n  function normalize(type) {\n    return type.toLowerCase().split(\"(\")[0].trim();\n  }\n  if (fieldType === \"string[]\" || fieldType === \"number[]\") {\n    return columnDataType.toLowerCase().includes(\"json\");\n  }\n  const types = map[dbType];\n  const expected = Array.isArray(fieldType) ? types[\"string\"].map((t) => t.toLowerCase()) : types[fieldType].map((t) => t.toLowerCase());\n  return expected.includes(normalize(columnDataType));\n}\nasync function getMigrations(config) {\n  const betterAuthSchema = getSchema(config);\n  const logger = (0,_better_auth_BjBlybv_mjs__WEBPACK_IMPORTED_MODULE_12__.c)(config.logger);\n  let { kysely: db, databaseType: dbType } = await (0,_better_auth_BduPtJy8_mjs__WEBPACK_IMPORTED_MODULE_17__.c)(config);\n  if (!dbType) {\n    logger.warn(\n      \"Could not determine database type, defaulting to sqlite. Please provide a type in the database options to avoid this.\"\n    );\n    dbType = \"sqlite\";\n  }\n  if (!db) {\n    logger.error(\n      \"Only kysely adapter is supported for migrations. You can use `generate` command to generate the schema, if you're using a different adapter.\"\n    );\n    process.exit(1);\n  }\n  const tableMetadata = await db.introspection.getTables();\n  const toBeCreated = [];\n  const toBeAdded = [];\n  for (const [key, value] of Object.entries(betterAuthSchema)) {\n    const table = tableMetadata.find((t) => t.name === key);\n    if (!table) {\n      const tIndex = toBeCreated.findIndex((t) => t.table === key);\n      const tableData = {\n        table: key,\n        fields: value.fields,\n        order: value.order || Infinity\n      };\n      const insertIndex = toBeCreated.findIndex(\n        (t) => (t.order || Infinity) > tableData.order\n      );\n      if (insertIndex === -1) {\n        if (tIndex === -1) {\n          toBeCreated.push(tableData);\n        } else {\n          toBeCreated[tIndex].fields = {\n            ...toBeCreated[tIndex].fields,\n            ...value.fields\n          };\n        }\n      } else {\n        toBeCreated.splice(insertIndex, 0, tableData);\n      }\n      continue;\n    }\n    let toBeAddedFields = {};\n    for (const [fieldName, field] of Object.entries(value.fields)) {\n      const column = table.columns.find((c) => c.name === fieldName);\n      if (!column) {\n        toBeAddedFields[fieldName] = field;\n        continue;\n      }\n      if (matchType(column.dataType, field.type, dbType)) {\n        continue;\n      } else {\n        logger.warn(\n          `Field ${fieldName} in table ${key} has a different type in the database. Expected ${field.type} but got ${column.dataType}.`\n        );\n      }\n    }\n    if (Object.keys(toBeAddedFields).length > 0) {\n      toBeAdded.push({\n        table: key,\n        fields: toBeAddedFields,\n        order: value.order || Infinity\n      });\n    }\n  }\n  const migrations = [];\n  function getType(field, fieldName) {\n    const type = field.type;\n    const typeMap = {\n      string: {\n        sqlite: \"text\",\n        postgres: \"text\",\n        mysql: field.unique ? \"varchar(255)\" : field.references ? \"varchar(36)\" : \"text\",\n        mssql: field.unique || field.sortable ? \"varchar(255)\" : field.references ? \"varchar(36)\" : (\n          // mssql deprecated `text`, and the alternative is `varchar(max)`.\n          // Kysely type interface doesn't support `text`, so we set this to `varchar(8000)` as\n          // that's the max length for `varchar`\n          \"varchar(8000)\"\n        )\n      },\n      boolean: {\n        sqlite: \"integer\",\n        postgres: \"boolean\",\n        mysql: \"boolean\",\n        mssql: \"smallint\"\n      },\n      number: {\n        sqlite: field.bigint ? \"bigint\" : \"integer\",\n        postgres: field.bigint ? \"bigint\" : \"integer\",\n        mysql: field.bigint ? \"bigint\" : \"integer\",\n        mssql: field.bigint ? \"bigint\" : \"integer\"\n      },\n      date: {\n        sqlite: \"date\",\n        postgres: \"timestamp\",\n        mysql: \"datetime\",\n        mssql: \"datetime\"\n      },\n      json: {\n        sqlite: \"text\",\n        postgres: \"json\",\n        mysql: \"json\",\n        mssql: \"varchar(8000)\"\n      },\n      id: {\n        postgres: config.advanced?.database?.useNumberId ? \"serial\" : \"text\",\n        mysql: config.advanced?.database?.useNumberId ? \"integer\" : \"varchar(36)\",\n        mssql: config.advanced?.database?.useNumberId ? \"integer\" : \"varchar(36)\",\n        sqlite: config.advanced?.database?.useNumberId ? \"integer\" : \"text\"\n      }\n    };\n    if (fieldName === \"id\" || field.references?.field === \"id\") {\n      return typeMap.id[dbType];\n    }\n    if (dbType === \"sqlite\" && (type === \"string[]\" || type === \"number[]\")) {\n      return \"text\";\n    }\n    if (type === \"string[]\" || type === \"number[]\") {\n      return \"jsonb\";\n    }\n    if (Array.isArray(type)) {\n      return \"text\";\n    }\n    return typeMap[type][dbType || \"sqlite\"];\n  }\n  if (toBeAdded.length) {\n    for (const table of toBeAdded) {\n      for (const [fieldName, field] of Object.entries(table.fields)) {\n        const type = getType(field, fieldName);\n        const exec = db.schema.alterTable(table.table).addColumn(fieldName, type, (col) => {\n          col = field.required !== false ? col.notNull() : col;\n          if (field.references) {\n            col = col.references(\n              `${field.references.model}.${field.references.field}`\n            ).onDelete(field.references.onDelete || \"cascade\");\n          }\n          if (field.unique) {\n            col = col.unique();\n          }\n          if (field.type === \"date\" && typeof field.defaultValue === \"function\" && (dbType === \"postgres\" || dbType === \"mysql\" || dbType === \"mssql\")) {\n            col = col.defaultTo((0,kysely__WEBPACK_IMPORTED_MODULE_19__.sql)`CURRENT_TIMESTAMP`);\n          }\n          return col;\n        });\n        migrations.push(exec);\n      }\n    }\n  }\n  if (toBeCreated.length) {\n    for (const table of toBeCreated) {\n      let dbT = db.schema.createTable(table.table).addColumn(\n        \"id\",\n        config.advanced?.database?.useNumberId ? dbType === \"postgres\" ? \"serial\" : \"integer\" : dbType === \"mysql\" || dbType === \"mssql\" ? \"varchar(36)\" : \"text\",\n        (col) => {\n          if (config.advanced?.database?.useNumberId) {\n            if (dbType === \"postgres\") {\n              return col.primaryKey().notNull();\n            }\n            return col.autoIncrement().primaryKey().notNull();\n          }\n          return col.primaryKey().notNull();\n        }\n      );\n      for (const [fieldName, field] of Object.entries(table.fields)) {\n        const type = getType(field, fieldName);\n        dbT = dbT.addColumn(fieldName, type, (col) => {\n          col = field.required !== false ? col.notNull() : col;\n          if (field.references) {\n            col = col.references(`${field.references.model}.${field.references.field}`).onDelete(field.references.onDelete || \"cascade\");\n          }\n          if (field.unique) {\n            col = col.unique();\n          }\n          if (field.type === \"date\" && typeof field.defaultValue === \"function\" && (dbType === \"postgres\" || dbType === \"mysql\" || dbType === \"mssql\")) {\n            col = col.defaultTo((0,kysely__WEBPACK_IMPORTED_MODULE_19__.sql)`CURRENT_TIMESTAMP`);\n          }\n          return col;\n        });\n      }\n      migrations.push(dbT);\n    }\n  }\n  async function runMigrations() {\n    for (const migration of migrations) {\n      await migration.execute();\n    }\n  }\n  async function compileMigrations() {\n    const compiled = migrations.map((m) => m.compile().sql);\n    return compiled.join(\";\\n\\n\") + \";\";\n  }\n  return { toBeCreated, toBeAdded, runMigrations, compileMigrations };\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguRFYwTGx5OC0ubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBMEQ7QUFDaUM7QUFDbkM7QUFDUTtBQUNIO0FBQzdDO0FBQ0s7QUFDWTtBQUNDO0FBQ0Q7QUFDRTtBQUNyQjtBQUNtQjtBQUNMO0FBQ0k7QUFDQTtBQUNJO0FBQ3dDO0FBQ3hDO0FBQ0Q7QUFDK0I7QUFDRjtBQUMwQjtBQUMxQjtBQUNuQzs7QUFFN0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVUsd0RBQXdEO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FB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QTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFBVTtBQUNWO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVE7QUFDUjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFdBQVc7QUFDWDtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBQVU7QUFDVjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0VBQXNFLE9BQU87QUFDN0U7QUFDQTtBQUNBLHVCQUF1Qiw0REFBYTtBQUNwQztB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QUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUIsdUJBQXVCLEdBQUcsdUJBQXVCO0FBQ2xFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyw0Q0FBRztBQUNuQztBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyx1QkFBdUIsR0FBRyx1QkFBdUI7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdDQUFnQyw0Q0FBRztBQUNuQztBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsV0FBVztBQUN0QztBQUNBLFdBQVc7QUFDWDs7QUFFb0siLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXGRpc3RcXHNoYXJlZFxcYmV0dGVyLWF1dGguRFYwTGx5OC0ubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGcgYXMgZ2V0RGF0ZSB9IGZyb20gJy4vYmV0dGVyLWF1dGguQ1c2RDllU3gubWpzJztcbmltcG9ydCB7IGUgYXMgcGFyc2VTZXNzaW9uT3V0cHV0LCBiIGFzIHBhcnNlVXNlck91dHB1dCB9IGZyb20gJy4vYmV0dGVyLWF1dGguRGN2OFBTN1QubWpzJztcbmltcG9ydCB7IGcgYXMgZ2V0SXAgfSBmcm9tICcuL2JldHRlci1hdXRoLk8yVnREa0RLLm1qcyc7XG5pbXBvcnQgeyBzIGFzIHNhZmVKU09OUGFyc2UgfSBmcm9tICcuL2JldHRlci1hdXRoLkJaWktOMWc3Lm1qcyc7XG5pbXBvcnQgeyBnIGFzIGdlbmVyYXRlSWQgfSBmcm9tICcuL2JldHRlci1hdXRoLkJVUFBSWGZLLm1qcyc7XG5pbXBvcnQgJ3pvZC92NCc7XG5pbXBvcnQgJ2JldHRlci1jYWxsJztcbmltcG9ydCAnQGJldHRlci1hdXRoL3V0aWxzL2hhc2gnO1xuaW1wb3J0ICdAbm9ibGUvY2lwaGVycy9jaGFjaGEuanMnO1xuaW1wb3J0ICdAbm9ibGUvY2lwaGVycy91dGlscy5qcyc7XG5pbXBvcnQgJ0BiZXR0ZXItYXV0aC91dGlscy9iYXNlNjQnO1xuaW1wb3J0ICdqb3NlJztcbmltcG9ydCAnQG5vYmxlL2hhc2hlcy9zY3J5cHQuanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvaGV4JztcbmltcG9ydCAnQG5vYmxlL2hhc2hlcy91dGlscy5qcyc7XG5pbXBvcnQgJy4vYmV0dGVyLWF1dGguQjRRb3hkZ2MubWpzJztcbmltcG9ydCB7IGEgYXMgbG9nZ2VyLCBjIGFzIGNyZWF0ZUxvZ2dlciB9IGZyb20gJy4vYmV0dGVyLWF1dGguQmpCbHlidi0ubWpzJztcbmltcG9ydCAnLi9iZXR0ZXItYXV0aC5DTVEzckEtSS5tanMnO1xuaW1wb3J0ICdAYmV0dGVyLWF1dGgvdXRpbHMvcmFuZG9tJztcbmltcG9ydCB7IEIgYXMgQmV0dGVyQXV0aEVycm9yIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5EZHpTSmYtbi5tanMnO1xuaW1wb3J0IHsgZyBhcyBnZXRBdXRoVGFibGVzIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5CX1BUVk9ETS5tanMnO1xuaW1wb3J0IHsgYyBhcyBjcmVhdGVLeXNlbHlBZGFwdGVyLCBrIGFzIGt5c2VseUFkYXB0ZXIgfSBmcm9tICcuL2JldHRlci1hdXRoLkJkdVB0Snk4Lm1qcyc7XG5pbXBvcnQgeyBtIGFzIG1lbW9yeUFkYXB0ZXIgfSBmcm9tICcuL2JldHRlci1hdXRoLjdaZUFDVTJ2Lm1qcyc7XG5pbXBvcnQgeyBzcWwgfSBmcm9tICdreXNlbHknO1xuXG5mdW5jdGlvbiBnZXRXaXRoSG9va3MoYWRhcHRlciwgY3R4KSB7XG4gIGNvbnN0IGhvb2tzID0gY3R4Lmhvb2tzO1xuICBhc3luYyBmdW5jdGlvbiBjcmVhdGVXaXRoSG9va3MoZGF0YSwgbW9kZWwsIGN1c3RvbUNyZWF0ZUZuLCBjb250ZXh0KSB7XG4gICAgbGV0IGFjdHVhbERhdGEgPSBkYXRhO1xuICAgIGZvciAoY29uc3QgaG9vayBvZiBob29rcyB8fCBbXSkge1xuICAgICAgY29uc3QgdG9SdW4gPSBob29rW21vZGVsXT8uY3JlYXRlPy5iZWZvcmU7XG4gICAgICBpZiAodG9SdW4pIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdG9SdW4oYWN0dWFsRGF0YSwgY29udGV4dCk7XG4gICAgICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXNPYmplY3QgPSB0eXBlb2YgcmVzdWx0ID09PSBcIm9iamVjdFwiICYmIFwiZGF0YVwiIGluIHJlc3VsdDtcbiAgICAgICAgaWYgKGlzT2JqZWN0KSB7XG4gICAgICAgICAgYWN0dWFsRGF0YSA9IHtcbiAgICAgICAgICAgIC4uLmFjdHVhbERhdGEsXG4gICAgICAgICAgICAuLi5yZXN1bHQuZGF0YVxuICAgICAgICAgIH07XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgY3VzdG9tQ3JlYXRlZCA9IGN1c3RvbUNyZWF0ZUZuID8gYXdhaXQgY3VzdG9tQ3JlYXRlRm4uZm4oYWN0dWFsRGF0YSkgOiBudWxsO1xuICAgIGNvbnN0IGNyZWF0ZWQgPSAhY3VzdG9tQ3JlYXRlRm4gfHwgY3VzdG9tQ3JlYXRlRm4uZXhlY3V0ZU1haW5GbiA/IGF3YWl0IGFkYXB0ZXIuY3JlYXRlKHtcbiAgICAgIG1vZGVsLFxuICAgICAgZGF0YTogYWN0dWFsRGF0YSxcbiAgICAgIGZvcmNlQWxsb3dJZDogdHJ1ZVxuICAgIH0pIDogY3VzdG9tQ3JlYXRlZDtcbiAgICBmb3IgKGNvbnN0IGhvb2sgb2YgaG9va3MgfHwgW10pIHtcbiAgICAgIGNvbnN0IHRvUnVuID0gaG9va1ttb2RlbF0/LmNyZWF0ZT8uYWZ0ZXI7XG4gICAgICBpZiAodG9SdW4pIHtcbiAgICAgICAgYXdhaXQgdG9SdW4oY3JlYXRlZCwgY29udGV4dCk7XG4gICAgICB9XG4gICAgfVxuICAgIHJldHVybiBjcmVhdGVkO1xuICB9XG4gIGFzeW5jIGZ1bmN0aW9uIHVwZGF0ZVdpdGhIb29rcyhkYXRhLCB3aGVyZSwgbW9kZWwsIGN1c3RvbVVwZGF0ZUZuLCBjb250ZXh0KSB7XG4gICAgbGV0IGFjdHVhbERhdGEgPSBkYXRhO1xuICAgIGZvciAoY29uc3QgaG9vayBvZiBob29rcyB8fCBbXSkge1xuICAgICAgY29uc3QgdG9SdW4gPSBob29rW21vZGVsXT8udXBkYXRlPy5iZWZvcmU7XG4gICAgICBpZiAodG9SdW4pIHtcbiAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgdG9SdW4oZGF0YSwgY29udGV4dCk7XG4gICAgICAgIGlmIChyZXN1bHQgPT09IGZhbHNlKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgaXNPYmplY3QgPSB0eXBlb2YgcmVzdWx0ID09PSBcIm9iamVjdFwiO1xuICAgICAgICBhY3R1YWxEYXRhID0gaXNPYmplY3QgPyByZXN1bHQuZGF0YSA6IHJlc3VsdDtcbiAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgY3VzdG9tVXBkYXRlZCA9IGN1c3RvbVVwZGF0ZUZuID8gYXdhaXQgY3VzdG9tVXBkYXRlRm4uZm4oYWN0dWFsRGF0YSkgOiBudWxsO1xuICAgIGNvbnN0IHVwZGF0ZWQgPSAhY3VzdG9tVXBkYXRlRm4gfHwgY3VzdG9tVXBkYXRlRm4uZXhlY3V0ZU1haW5GbiA/IGF3YWl0IGFkYXB0ZXIudXBkYXRlKHtcbiAgICAgIG1vZGVsLFxuICAgICAgdXBkYXRlOiBhY3R1YWxEYXRhLFxuICAgICAgd2hlcmVcbiAgICB9KSA6IGN1c3RvbVVwZGF0ZWQ7XG4gICAgZm9yIChjb25zdCBob29rIG9mIGhvb2tzIHx8IFtdKSB7XG4gICAgICBjb25zdCB0b1J1biA9IGhvb2tbbW9kZWxdPy51cGRhdGU/LmFmdGVyO1xuICAgICAgaWYgKHRvUnVuKSB7XG4gICAgICAgIGF3YWl0IHRvUnVuKHVwZGF0ZWQsIGNvbnRleHQpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdXBkYXRlZDtcbiAgfVxuICBhc3luYyBmdW5jdGlvbiB1cGRhdGVNYW55V2l0aEhvb2tzKGRhdGEsIHdoZXJlLCBtb2RlbCwgY3VzdG9tVXBkYXRlRm4sIGNvbnRleHQpIHtcbiAgICBsZXQgYWN0dWFsRGF0YSA9IGRhdGE7XG4gICAgZm9yIChjb25zdCBob29rIG9mIGhvb2tzIHx8IFtdKSB7XG4gICAgICBjb25zdCB0b1J1biA9IGhvb2tbbW9kZWxdPy51cGRhdGU/LmJlZm9yZTtcbiAgICAgIGlmICh0b1J1bikge1xuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCB0b1J1bihkYXRhLCBjb250ZXh0KTtcbiAgICAgICAgaWYgKHJlc3VsdCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgICBjb25zdCBpc09iamVjdCA9IHR5cGVvZiByZXN1bHQgPT09IFwib2JqZWN0XCI7XG4gICAgICAgIGFjdHVhbERhdGEgPSBpc09iamVjdCA/IHJlc3VsdC5kYXRhIDogcmVzdWx0O1xuICAgICAgfVxuICAgIH1cbiAgICBjb25zdCBjdXN0b21VcGRhdGVkID0gY3VzdG9tVXBkYXRlRm4gPyBhd2FpdCBjdXN0b21VcGRhdGVGbi5mbihhY3R1YWxEYXRhKSA6IG51bGw7XG4gICAgY29uc3QgdXBkYXRlZCA9ICFjdXN0b21VcGRhdGVGbiB8fCBjdXN0b21VcGRhdGVGbi5leGVjdXRlTWFpbkZuID8gYXdhaXQgYWRhcHRlci51cGRhdGVNYW55KHtcbiAgICAgIG1vZGVsLFxuICAgICAgdXBkYXRlOiBhY3R1YWxEYXRhLFxuICAgICAgd2hlcmVcbiAgICB9KSA6IGN1c3RvbVVwZGF0ZWQ7XG4gICAgZm9yIChjb25zdCBob29rIG9mIGhvb2tzIHx8IFtdKSB7XG4gICAgICBjb25zdCB0b1J1biA9IGhvb2tbbW9kZWxdPy51cGRhdGU/LmFmdGVyO1xuICAgICAgaWYgKHRvUnVuKSB7XG4gICAgICAgIGF3YWl0IHRvUnVuKHVwZGF0ZWQsIGNvbnRleHQpO1xuICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdXBkYXRlZDtcbiAgfVxuICByZXR1cm4ge1xuICAgIGNyZWF0ZVdpdGhIb29rcyxcbiAgICB1cGRhdGVXaXRoSG9va3MsXG4gICAgdXBkYXRlTWFueVdpdGhIb29rc1xuICB9O1xufVxuXG5jb25zdCBjcmVhdGVJbnRlcm5hbEFkYXB0ZXIgPSAoYWRhcHRlciwgY3R4KSA9PiB7XG4gIGNvbnN0IGxvZ2dlciA9IGN0eC5sb2dnZXI7XG4gIGNvbnN0IG9wdGlvbnMgPSBjdHgub3B0aW9ucztcbiAgY29uc3Qgc2Vjb25kYXJ5U3RvcmFnZSA9IG9wdGlvbnMuc2Vjb25kYXJ5U3RvcmFnZTtcbiAgY29uc3Qgc2Vzc2lvbkV4cGlyYXRpb24gPSBvcHRpb25zLnNlc3Npb24/LmV4cGlyZXNJbiB8fCA2MCAqIDYwICogMjQgKiA3O1xuICBjb25zdCB7IGNyZWF0ZVdpdGhIb29rcywgdXBkYXRlV2l0aEhvb2tzLCB1cGRhdGVNYW55V2l0aEhvb2tzIH0gPSBnZXRXaXRoSG9va3MoYWRhcHRlciwgY3R4KTtcbiAgcmV0dXJuIHtcbiAgICBjcmVhdGVPQXV0aFVzZXI6IGFzeW5jICh1c2VyLCBhY2NvdW50LCBjb250ZXh0KSA9PiB7XG4gICAgICBjb25zdCBjcmVhdGVkVXNlciA9IGF3YWl0IGNyZWF0ZVdpdGhIb29rcyhcbiAgICAgICAge1xuICAgICAgICAgIC8vIHRvZG86IHdlIHNob3VsZCByZW1vdmUgYXV0byBzZXR0aW5nIGNyZWF0ZWRBdCBhbmQgdXBkYXRlZEF0IGluIHRoZSBuZXh0IG1ham9yIHJlbGVhc2UsIHNpbmNlIHRoZSBkYiBnZW5lcmF0b3JzIGFscmVhZHkgaGFuZGxlIHRoYXRcbiAgICAgICAgICBjcmVhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIHVwZGF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgLi4udXNlclxuICAgICAgICB9LFxuICAgICAgICBcInVzZXJcIixcbiAgICAgICAgdm9pZCAwLFxuICAgICAgICBjb250ZXh0XG4gICAgICApO1xuICAgICAgY29uc3QgY3JlYXRlZEFjY291bnQgPSBhd2FpdCBjcmVhdGVXaXRoSG9va3MoXG4gICAgICAgIHtcbiAgICAgICAgICAuLi5hY2NvdW50LFxuICAgICAgICAgIHVzZXJJZDogY3JlYXRlZFVzZXIuaWQsXG4gICAgICAgICAgLy8gdG9kbzogd2Ugc2hvdWxkIHJlbW92ZSBhdXRvIHNldHRpbmcgY3JlYXRlZEF0IGFuZCB1cGRhdGVkQXQgaW4gdGhlIG5leHQgbWFqb3IgcmVsZWFzZSwgc2luY2UgdGhlIGRiIGdlbmVyYXRvcnMgYWxyZWFkeSBoYW5kbGUgdGhhdFxuICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKVxuICAgICAgICB9LFxuICAgICAgICBcImFjY291bnRcIixcbiAgICAgICAgdm9pZCAwLFxuICAgICAgICBjb250ZXh0XG4gICAgICApO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgdXNlcjogY3JlYXRlZFVzZXIsXG4gICAgICAgIGFjY291bnQ6IGNyZWF0ZWRBY2NvdW50XG4gICAgICB9O1xuICAgIH0sXG4gICAgY3JlYXRlVXNlcjogYXN5bmMgKHVzZXIsIGNvbnRleHQpID0+IHtcbiAgICAgIGNvbnN0IGNyZWF0ZWRVc2VyID0gYXdhaXQgY3JlYXRlV2l0aEhvb2tzKFxuICAgICAgICB7XG4gICAgICAgICAgLy8gdG9kbzogd2Ugc2hvdWxkIHJlbW92ZSBhdXRvIHNldHRpbmcgY3JlYXRlZEF0IGFuZCB1cGRhdGVkQXQgaW4gdGhlIG5leHQgbWFqb3IgcmVsZWFzZSwgc2luY2UgdGhlIGRiIGdlbmVyYXRvcnMgYWxyZWFkeSBoYW5kbGUgdGhhdFxuICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICAuLi51c2VyLFxuICAgICAgICAgIGVtYWlsOiB1c2VyLmVtYWlsPy50b0xvd2VyQ2FzZSgpXG4gICAgICAgIH0sXG4gICAgICAgIFwidXNlclwiLFxuICAgICAgICB2b2lkIDAsXG4gICAgICAgIGNvbnRleHRcbiAgICAgICk7XG4gICAgICByZXR1cm4gY3JlYXRlZFVzZXI7XG4gICAgfSxcbiAgICBjcmVhdGVBY2NvdW50OiBhc3luYyAoYWNjb3VudCwgY29udGV4dCkgPT4ge1xuICAgICAgY29uc3QgY3JlYXRlZEFjY291bnQgPSBhd2FpdCBjcmVhdGVXaXRoSG9va3MoXG4gICAgICAgIHtcbiAgICAgICAgICAvLyB0b2RvOiB3ZSBzaG91bGQgcmVtb3ZlIGF1dG8gc2V0dGluZyBjcmVhdGVkQXQgYW5kIHVwZGF0ZWRBdCBpbiB0aGUgbmV4dCBtYWpvciByZWxlYXNlLCBzaW5jZSB0aGUgZGIgZ2VuZXJhdG9ycyBhbHJlYWR5IGhhbmRsZSB0aGF0XG4gICAgICAgICAgY3JlYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICB1cGRhdGVkQXQ6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgIC4uLmFjY291bnRcbiAgICAgICAgfSxcbiAgICAgICAgXCJhY2NvdW50XCIsXG4gICAgICAgIHZvaWQgMCxcbiAgICAgICAgY29udGV4dFxuICAgICAgKTtcbiAgICAgIHJldHVybiBjcmVhdGVkQWNjb3VudDtcbiAgICB9LFxuICAgIGxpc3RTZXNzaW9uczogYXN5bmMgKHVzZXJJZCkgPT4ge1xuICAgICAgaWYgKHNlY29uZGFyeVN0b3JhZ2UpIHtcbiAgICAgICAgY29uc3QgY3VycmVudExpc3QgPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldChcbiAgICAgICAgICBgYWN0aXZlLXNlc3Npb25zLSR7dXNlcklkfWBcbiAgICAgICAgKTtcbiAgICAgICAgaWYgKCFjdXJyZW50TGlzdCkgcmV0dXJuIFtdO1xuICAgICAgICBjb25zdCBsaXN0ID0gc2FmZUpTT05QYXJzZShjdXJyZW50TGlzdCkgfHwgW107XG4gICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICAgIGNvbnN0IHZhbGlkU2Vzc2lvbnMgPSBsaXN0LmZpbHRlcigocykgPT4gcy5leHBpcmVzQXQgPiBub3cpO1xuICAgICAgICBjb25zdCBzZXNzaW9uczIgPSBbXTtcbiAgICAgICAgZm9yIChjb25zdCBzZXNzaW9uIG9mIHZhbGlkU2Vzc2lvbnMpIHtcbiAgICAgICAgICBjb25zdCBzZXNzaW9uU3RyaW5naWZpZWQgPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldChzZXNzaW9uLnRva2VuKTtcbiAgICAgICAgICBpZiAoc2Vzc2lvblN0cmluZ2lmaWVkKSB7XG4gICAgICAgICAgICBjb25zdCBzID0gc2FmZUpTT05QYXJzZShzZXNzaW9uU3RyaW5naWZpZWQpO1xuICAgICAgICAgICAgaWYgKCFzKSByZXR1cm4gW107XG4gICAgICAgICAgICBjb25zdCBwYXJzZWRTZXNzaW9uID0gcGFyc2VTZXNzaW9uT3V0cHV0KGN0eC5vcHRpb25zLCB7XG4gICAgICAgICAgICAgIC4uLnMuc2Vzc2lvbixcbiAgICAgICAgICAgICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShzLnNlc3Npb24uZXhwaXJlc0F0KVxuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICBzZXNzaW9uczIucHVzaChwYXJzZWRTZXNzaW9uKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHNlc3Npb25zMjtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHNlc3Npb25zID0gYXdhaXQgYWRhcHRlci5maW5kTWFueSh7XG4gICAgICAgIG1vZGVsOiBcInNlc3Npb25cIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHNlc3Npb25zO1xuICAgIH0sXG4gICAgbGlzdFVzZXJzOiBhc3luYyAobGltaXQsIG9mZnNldCwgc29ydEJ5LCB3aGVyZSkgPT4ge1xuICAgICAgY29uc3QgdXNlcnMgPSBhd2FpdCBhZGFwdGVyLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICBsaW1pdCxcbiAgICAgICAgb2Zmc2V0LFxuICAgICAgICBzb3J0QnksXG4gICAgICAgIHdoZXJlXG4gICAgICB9KTtcbiAgICAgIHJldHVybiB1c2VycztcbiAgICB9LFxuICAgIGNvdW50VG90YWxVc2VyczogYXN5bmMgKHdoZXJlKSA9PiB7XG4gICAgICBjb25zdCB0b3RhbCA9IGF3YWl0IGFkYXB0ZXIuY291bnQoe1xuICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgIHdoZXJlXG4gICAgICB9KTtcbiAgICAgIGlmICh0eXBlb2YgdG90YWwgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgcmV0dXJuIHBhcnNlSW50KHRvdGFsKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiB0b3RhbDtcbiAgICB9LFxuICAgIGRlbGV0ZVVzZXI6IGFzeW5jICh1c2VySWQpID0+IHtcbiAgICAgIGlmIChzZWNvbmRhcnlTdG9yYWdlKSB7XG4gICAgICAgIGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZGVsZXRlKGBhY3RpdmUtc2Vzc2lvbnMtJHt1c2VySWR9YCk7XG4gICAgICB9XG4gICAgICBpZiAoIXNlY29uZGFyeVN0b3JhZ2UgfHwgb3B0aW9ucy5zZXNzaW9uPy5zdG9yZVNlc3Npb25JbkRhdGFiYXNlKSB7XG4gICAgICAgIGF3YWl0IGFkYXB0ZXIuZGVsZXRlTWFueSh7XG4gICAgICAgICAgbW9kZWw6IFwic2Vzc2lvblwiLFxuICAgICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgICB2YWx1ZTogdXNlcklkXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGF3YWl0IGFkYXB0ZXIuZGVsZXRlTWFueSh7XG4gICAgICAgIG1vZGVsOiBcImFjY291bnRcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgYXdhaXQgYWRhcHRlci5kZWxldGUoe1xuICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgY3JlYXRlU2Vzc2lvbjogYXN5bmMgKHVzZXJJZCwgY3R4MiwgZG9udFJlbWVtYmVyTWUsIG92ZXJyaWRlLCBvdmVycmlkZUFsbCkgPT4ge1xuICAgICAgY29uc3QgaGVhZGVycyA9IGN0eDIuaGVhZGVycyB8fCBjdHgyLnJlcXVlc3Q/LmhlYWRlcnM7XG4gICAgICBjb25zdCB7IGlkOiBfLCAuLi5yZXN0IH0gPSBvdmVycmlkZSB8fCB7fTtcbiAgICAgIGNvbnN0IGRhdGEgPSB7XG4gICAgICAgIGlwQWRkcmVzczogY3R4Mi5yZXF1ZXN0IHx8IGN0eDIuaGVhZGVycyA/IGdldElwKGN0eDIucmVxdWVzdCB8fCBjdHgyLmhlYWRlcnMsIGN0eDIuY29udGV4dC5vcHRpb25zKSB8fCBcIlwiIDogXCJcIixcbiAgICAgICAgdXNlckFnZW50OiBoZWFkZXJzPy5nZXQoXCJ1c2VyLWFnZW50XCIpIHx8IFwiXCIsXG4gICAgICAgIC4uLnJlc3QsXG4gICAgICAgIC8qKlxuICAgICAgICAgKiBJZiB0aGUgdXNlciBkb2Vzbid0IHdhbnQgdG8gYmUgcmVtZW1iZXJlZFxuICAgICAgICAgKiBzZXQgdGhlIHNlc3Npb24gdG8gZXhwaXJlIGluIDEgZGF5LlxuICAgICAgICAgKiBUaGUgY29va2llIHdpbGwgYmUgc2V0IHRvIGV4cGlyZSBhdCB0aGUgZW5kIG9mIHRoZSBzZXNzaW9uXG4gICAgICAgICAqL1xuICAgICAgICBleHBpcmVzQXQ6IGRvbnRSZW1lbWJlck1lID8gZ2V0RGF0ZSg2MCAqIDYwICogMjQsIFwic2VjXCIpIDogZ2V0RGF0ZShzZXNzaW9uRXhwaXJhdGlvbiwgXCJzZWNcIiksXG4gICAgICAgIHVzZXJJZCxcbiAgICAgICAgdG9rZW46IGdlbmVyYXRlSWQoMzIpLFxuICAgICAgICAvLyB0b2RvOiB3ZSBzaG91bGQgcmVtb3ZlIGF1dG8gc2V0dGluZyBjcmVhdGVkQXQgYW5kIHVwZGF0ZWRBdCBpbiB0aGUgbmV4dCBtYWpvciByZWxlYXNlLCBzaW5jZSB0aGUgZGIgZ2VuZXJhdG9ycyBhbHJlYWR5IGhhbmRsZSB0aGF0XG4gICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgIHVwZGF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgIC4uLm92ZXJyaWRlQWxsID8gcmVzdCA6IHt9XG4gICAgICB9O1xuICAgICAgY29uc3QgcmVzID0gYXdhaXQgY3JlYXRlV2l0aEhvb2tzKFxuICAgICAgICBkYXRhLFxuICAgICAgICBcInNlc3Npb25cIixcbiAgICAgICAgc2Vjb25kYXJ5U3RvcmFnZSA/IHtcbiAgICAgICAgICBmbjogYXN5bmMgKHNlc3Npb25EYXRhKSA9PiB7XG4gICAgICAgICAgICBjb25zdCBjdXJyZW50TGlzdCA9IGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZ2V0KFxuICAgICAgICAgICAgICBgYWN0aXZlLXNlc3Npb25zLSR7dXNlcklkfWBcbiAgICAgICAgICAgICk7XG4gICAgICAgICAgICBsZXQgbGlzdCA9IFtdO1xuICAgICAgICAgICAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICAgIGlmIChjdXJyZW50TGlzdCkge1xuICAgICAgICAgICAgICBsaXN0ID0gc2FmZUpTT05QYXJzZShjdXJyZW50TGlzdCkgfHwgW107XG4gICAgICAgICAgICAgIGxpc3QgPSBsaXN0LmZpbHRlcigoc2Vzc2lvbikgPT4gc2Vzc2lvbi5leHBpcmVzQXQgPiBub3cpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgbGlzdC5wdXNoKHtcbiAgICAgICAgICAgICAgdG9rZW46IGRhdGEudG9rZW4sXG4gICAgICAgICAgICAgIGV4cGlyZXNBdDogbm93ICsgc2Vzc2lvbkV4cGlyYXRpb24gKiAxZTNcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5zZXQoXG4gICAgICAgICAgICAgIGBhY3RpdmUtc2Vzc2lvbnMtJHt1c2VySWR9YCxcbiAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkobGlzdCksXG4gICAgICAgICAgICAgIHNlc3Npb25FeHBpcmF0aW9uXG4gICAgICAgICAgICApO1xuICAgICAgICAgICAgcmV0dXJuIHNlc3Npb25EYXRhO1xuICAgICAgICAgIH0sXG4gICAgICAgICAgZXhlY3V0ZU1haW5Gbjogb3B0aW9ucy5zZXNzaW9uPy5zdG9yZVNlc3Npb25JbkRhdGFiYXNlXG4gICAgICAgIH0gOiB2b2lkIDAsXG4gICAgICAgIGN0eDJcbiAgICAgICk7XG4gICAgICByZXR1cm4gcmVzO1xuICAgIH0sXG4gICAgZmluZFNlc3Npb246IGFzeW5jICh0b2tlbikgPT4ge1xuICAgICAgaWYgKHNlY29uZGFyeVN0b3JhZ2UpIHtcbiAgICAgICAgY29uc3Qgc2Vzc2lvblN0cmluZ2lmaWVkID0gYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5nZXQodG9rZW4pO1xuICAgICAgICBpZiAoIXNlc3Npb25TdHJpbmdpZmllZCAmJiAhb3B0aW9ucy5zZXNzaW9uPy5zdG9yZVNlc3Npb25JbkRhdGFiYXNlKSB7XG4gICAgICAgICAgcmV0dXJuIG51bGw7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHNlc3Npb25TdHJpbmdpZmllZCkge1xuICAgICAgICAgIGNvbnN0IHMgPSBzYWZlSlNPTlBhcnNlKHNlc3Npb25TdHJpbmdpZmllZCk7XG4gICAgICAgICAgaWYgKCFzKSByZXR1cm4gbnVsbDtcbiAgICAgICAgICBjb25zdCBwYXJzZWRTZXNzaW9uMiA9IHBhcnNlU2Vzc2lvbk91dHB1dChjdHgub3B0aW9ucywge1xuICAgICAgICAgICAgLi4ucy5zZXNzaW9uLFxuICAgICAgICAgICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShzLnNlc3Npb24uZXhwaXJlc0F0KSxcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUocy5zZXNzaW9uLmNyZWF0ZWRBdCksXG4gICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKHMuc2Vzc2lvbi51cGRhdGVkQXQpXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY29uc3QgcGFyc2VkVXNlcjIgPSBwYXJzZVVzZXJPdXRwdXQoY3R4Lm9wdGlvbnMsIHtcbiAgICAgICAgICAgIC4uLnMudXNlcixcbiAgICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUocy51c2VyLmNyZWF0ZWRBdCksXG4gICAgICAgICAgICB1cGRhdGVkQXQ6IG5ldyBEYXRlKHMudXNlci51cGRhdGVkQXQpXG4gICAgICAgICAgfSk7XG4gICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIHNlc3Npb246IHBhcnNlZFNlc3Npb24yLFxuICAgICAgICAgICAgdXNlcjogcGFyc2VkVXNlcjJcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBjb25zdCBzZXNzaW9uID0gYXdhaXQgYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgbW9kZWw6IFwic2Vzc2lvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHZhbHVlOiB0b2tlbixcbiAgICAgICAgICAgIGZpZWxkOiBcInRva2VuXCJcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgaWYgKCFzZXNzaW9uKSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgY29uc3QgdXNlciA9IGF3YWl0IGFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICB2YWx1ZTogc2Vzc2lvbi51c2VySWQsXG4gICAgICAgICAgICBmaWVsZDogXCJpZFwiXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIGlmICghdXNlcikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHBhcnNlZFNlc3Npb24gPSBwYXJzZVNlc3Npb25PdXRwdXQoY3R4Lm9wdGlvbnMsIHNlc3Npb24pO1xuICAgICAgY29uc3QgcGFyc2VkVXNlciA9IHBhcnNlVXNlck91dHB1dChjdHgub3B0aW9ucywgdXNlcik7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBzZXNzaW9uOiBwYXJzZWRTZXNzaW9uLFxuICAgICAgICB1c2VyOiBwYXJzZWRVc2VyXG4gICAgICB9O1xuICAgIH0sXG4gICAgZmluZFNlc3Npb25zOiBhc3luYyAoc2Vzc2lvblRva2VucykgPT4ge1xuICAgICAgaWYgKHNlY29uZGFyeVN0b3JhZ2UpIHtcbiAgICAgICAgY29uc3Qgc2Vzc2lvbnMyID0gW107XG4gICAgICAgIGZvciAoY29uc3Qgc2Vzc2lvblRva2VuIG9mIHNlc3Npb25Ub2tlbnMpIHtcbiAgICAgICAgICBjb25zdCBzZXNzaW9uU3RyaW5naWZpZWQgPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldChzZXNzaW9uVG9rZW4pO1xuICAgICAgICAgIGlmIChzZXNzaW9uU3RyaW5naWZpZWQpIHtcbiAgICAgICAgICAgIGNvbnN0IHMgPSBzYWZlSlNPTlBhcnNlKHNlc3Npb25TdHJpbmdpZmllZCk7XG4gICAgICAgICAgICBpZiAoIXMpIHJldHVybiBbXTtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSB7XG4gICAgICAgICAgICAgIHNlc3Npb246IHtcbiAgICAgICAgICAgICAgICAuLi5zLnNlc3Npb24sXG4gICAgICAgICAgICAgICAgZXhwaXJlc0F0OiBuZXcgRGF0ZShzLnNlc3Npb24uZXhwaXJlc0F0KVxuICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICB1c2VyOiB7XG4gICAgICAgICAgICAgICAgLi4ucy51c2VyLFxuICAgICAgICAgICAgICAgIGNyZWF0ZWRBdDogbmV3IERhdGUocy51c2VyLmNyZWF0ZWRBdCksXG4gICAgICAgICAgICAgICAgdXBkYXRlZEF0OiBuZXcgRGF0ZShzLnVzZXIudXBkYXRlZEF0KVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9O1xuICAgICAgICAgICAgc2Vzc2lvbnMyLnB1c2goc2Vzc2lvbik7XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzZXNzaW9uczI7XG4gICAgICB9XG4gICAgICBjb25zdCBzZXNzaW9ucyA9IGF3YWl0IGFkYXB0ZXIuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbDogXCJzZXNzaW9uXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidG9rZW5cIixcbiAgICAgICAgICAgIHZhbHVlOiBzZXNzaW9uVG9rZW5zLFxuICAgICAgICAgICAgb3BlcmF0b3I6IFwiaW5cIlxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBjb25zdCB1c2VySWRzID0gc2Vzc2lvbnMubWFwKChzZXNzaW9uKSA9PiB7XG4gICAgICAgIHJldHVybiBzZXNzaW9uLnVzZXJJZDtcbiAgICAgIH0pO1xuICAgICAgaWYgKCF1c2VySWRzLmxlbmd0aCkgcmV0dXJuIFtdO1xuICAgICAgY29uc3QgdXNlcnMgPSBhd2FpdCBhZGFwdGVyLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkcyxcbiAgICAgICAgICAgIG9wZXJhdG9yOiBcImluXCJcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHNlc3Npb25zLm1hcCgoc2Vzc2lvbikgPT4ge1xuICAgICAgICBjb25zdCB1c2VyID0gdXNlcnMuZmluZCgodSkgPT4gdS5pZCA9PT0gc2Vzc2lvbi51c2VySWQpO1xuICAgICAgICBpZiAoIXVzZXIpIHJldHVybiBudWxsO1xuICAgICAgICByZXR1cm4ge1xuICAgICAgICAgIHNlc3Npb24sXG4gICAgICAgICAgdXNlclxuICAgICAgICB9O1xuICAgICAgfSk7XG4gICAgfSxcbiAgICB1cGRhdGVTZXNzaW9uOiBhc3luYyAoc2Vzc2lvblRva2VuLCBzZXNzaW9uLCBjb250ZXh0KSA9PiB7XG4gICAgICBjb25zdCB1cGRhdGVkU2Vzc2lvbiA9IGF3YWl0IHVwZGF0ZVdpdGhIb29rcyhcbiAgICAgICAgc2Vzc2lvbixcbiAgICAgICAgW3sgZmllbGQ6IFwidG9rZW5cIiwgdmFsdWU6IHNlc3Npb25Ub2tlbiB9XSxcbiAgICAgICAgXCJzZXNzaW9uXCIsXG4gICAgICAgIHNlY29uZGFyeVN0b3JhZ2UgPyB7XG4gICAgICAgICAgYXN5bmMgZm4oZGF0YSkge1xuICAgICAgICAgICAgY29uc3QgY3VycmVudFNlc3Npb24gPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldChzZXNzaW9uVG9rZW4pO1xuICAgICAgICAgICAgbGV0IHVwZGF0ZWRTZXNzaW9uMiA9IG51bGw7XG4gICAgICAgICAgICBpZiAoY3VycmVudFNlc3Npb24pIHtcbiAgICAgICAgICAgICAgY29uc3QgcGFyc2VkU2Vzc2lvbiA9IHNhZmVKU09OUGFyc2UoY3VycmVudFNlc3Npb24pO1xuICAgICAgICAgICAgICBpZiAoIXBhcnNlZFNlc3Npb24pIHJldHVybiBudWxsO1xuICAgICAgICAgICAgICB1cGRhdGVkU2Vzc2lvbjIgPSB7XG4gICAgICAgICAgICAgICAgLi4ucGFyc2VkU2Vzc2lvbi5zZXNzaW9uLFxuICAgICAgICAgICAgICAgIC4uLmRhdGFcbiAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWRTZXNzaW9uMjtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH0sXG4gICAgICAgICAgZXhlY3V0ZU1haW5Gbjogb3B0aW9ucy5zZXNzaW9uPy5zdG9yZVNlc3Npb25JbkRhdGFiYXNlXG4gICAgICAgIH0gOiB2b2lkIDAsXG4gICAgICAgIGNvbnRleHRcbiAgICAgICk7XG4gICAgICByZXR1cm4gdXBkYXRlZFNlc3Npb247XG4gICAgfSxcbiAgICBkZWxldGVTZXNzaW9uOiBhc3luYyAodG9rZW4pID0+IHtcbiAgICAgIGlmIChzZWNvbmRhcnlTdG9yYWdlKSB7XG4gICAgICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldCh0b2tlbik7XG4gICAgICAgIGlmIChkYXRhKSB7XG4gICAgICAgICAgY29uc3QgeyBzZXNzaW9uIH0gPSBzYWZlSlNPTlBhcnNlKGRhdGEpID8/IHt9O1xuICAgICAgICAgIGlmICghc2Vzc2lvbikge1xuICAgICAgICAgICAgbG9nZ2VyLmVycm9yKFwiU2Vzc2lvbiBub3QgZm91bmQgaW4gc2Vjb25kYXJ5IHN0b3JhZ2VcIik7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnN0IHVzZXJJZCA9IHNlc3Npb24udXNlcklkO1xuICAgICAgICAgIGNvbnN0IGN1cnJlbnRMaXN0ID0gYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5nZXQoXG4gICAgICAgICAgICBgYWN0aXZlLXNlc3Npb25zLSR7dXNlcklkfWBcbiAgICAgICAgICApO1xuICAgICAgICAgIGlmIChjdXJyZW50TGlzdCkge1xuICAgICAgICAgICAgbGV0IGxpc3QgPSBzYWZlSlNPTlBhcnNlKGN1cnJlbnRMaXN0KSB8fCBbXTtcbiAgICAgICAgICAgIGxpc3QgPSBsaXN0LmZpbHRlcigocykgPT4gcy50b2tlbiAhPT0gdG9rZW4pO1xuICAgICAgICAgICAgaWYgKGxpc3QubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLnNldChcbiAgICAgICAgICAgICAgICBgYWN0aXZlLXNlc3Npb25zLSR7dXNlcklkfWAsXG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkobGlzdCksXG4gICAgICAgICAgICAgICAgc2Vzc2lvbkV4cGlyYXRpb25cbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZGVsZXRlKGBhY3RpdmUtc2Vzc2lvbnMtJHt1c2VySWR9YCk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihcIkFjdGl2ZSBzZXNzaW9ucyBsaXN0IG5vdCBmb3VuZCBpbiBzZWNvbmRhcnkgc3RvcmFnZVwiKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5kZWxldGUodG9rZW4pO1xuICAgICAgICBpZiAoIW9wdGlvbnMuc2Vzc2lvbj8uc3RvcmVTZXNzaW9uSW5EYXRhYmFzZSB8fCBjdHgub3B0aW9ucy5zZXNzaW9uPy5wcmVzZXJ2ZVNlc3Npb25JbkRhdGFiYXNlKSB7XG4gICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICBhd2FpdCBhZGFwdGVyLmRlbGV0ZSh7XG4gICAgICAgIG1vZGVsOiBcInNlc3Npb25cIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ0b2tlblwiLFxuICAgICAgICAgICAgdmFsdWU6IHRva2VuXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlbGV0ZUFjY291bnRzOiBhc3luYyAodXNlcklkKSA9PiB7XG4gICAgICBhd2FpdCBhZGFwdGVyLmRlbGV0ZU1hbnkoe1xuICAgICAgICBtb2RlbDogXCJhY2NvdW50XCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlbGV0ZUFjY291bnQ6IGFzeW5jIChhY2NvdW50SWQpID0+IHtcbiAgICAgIGF3YWl0IGFkYXB0ZXIuZGVsZXRlKHtcbiAgICAgICAgbW9kZWw6IFwiYWNjb3VudFwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkXCIsXG4gICAgICAgICAgICB2YWx1ZTogYWNjb3VudElkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlbGV0ZVNlc3Npb25zOiBhc3luYyAodXNlcklkT3JTZXNzaW9uVG9rZW5zKSA9PiB7XG4gICAgICBpZiAoc2Vjb25kYXJ5U3RvcmFnZSkge1xuICAgICAgICBpZiAodHlwZW9mIHVzZXJJZE9yU2Vzc2lvblRva2VucyA9PT0gXCJzdHJpbmdcIikge1xuICAgICAgICAgIGNvbnN0IGFjdGl2ZVNlc3Npb24gPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldChcbiAgICAgICAgICAgIGBhY3RpdmUtc2Vzc2lvbnMtJHt1c2VySWRPclNlc3Npb25Ub2tlbnN9YFxuICAgICAgICAgICk7XG4gICAgICAgICAgY29uc3Qgc2Vzc2lvbnMgPSBhY3RpdmVTZXNzaW9uID8gc2FmZUpTT05QYXJzZShhY3RpdmVTZXNzaW9uKSA6IFtdO1xuICAgICAgICAgIGlmICghc2Vzc2lvbnMpIHJldHVybjtcbiAgICAgICAgICBmb3IgKGNvbnN0IHNlc3Npb24gb2Ygc2Vzc2lvbnMpIHtcbiAgICAgICAgICAgIGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZGVsZXRlKHNlc3Npb24udG9rZW4pO1xuICAgICAgICAgIH1cbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICBmb3IgKGNvbnN0IHNlc3Npb25Ub2tlbiBvZiB1c2VySWRPclNlc3Npb25Ub2tlbnMpIHtcbiAgICAgICAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldChzZXNzaW9uVG9rZW4pO1xuICAgICAgICAgICAgaWYgKHNlc3Npb24pIHtcbiAgICAgICAgICAgICAgYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5kZWxldGUoc2Vzc2lvblRva2VuKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCFvcHRpb25zLnNlc3Npb24/LnN0b3JlU2Vzc2lvbkluRGF0YWJhc2UgfHwgY3R4Lm9wdGlvbnMuc2Vzc2lvbj8ucHJlc2VydmVTZXNzaW9uSW5EYXRhYmFzZSkge1xuICAgICAgICAgIHJldHVybjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgYXdhaXQgYWRhcHRlci5kZWxldGVNYW55KHtcbiAgICAgICAgbW9kZWw6IFwic2Vzc2lvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBBcnJheS5pc0FycmF5KHVzZXJJZE9yU2Vzc2lvblRva2VucykgPyBcInRva2VuXCIgOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXJJZE9yU2Vzc2lvblRva2VucyxcbiAgICAgICAgICAgIG9wZXJhdG9yOiBBcnJheS5pc0FycmF5KHVzZXJJZE9yU2Vzc2lvblRva2VucykgPyBcImluXCIgOiB2b2lkIDBcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgIH0sXG4gICAgZmluZE9BdXRoVXNlcjogYXN5bmMgKGVtYWlsLCBhY2NvdW50SWQsIHByb3ZpZGVySWQpID0+IHtcbiAgICAgIGNvbnN0IGFjY291bnQgPSBhd2FpdCBhZGFwdGVyLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwiYWNjb3VudFwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHZhbHVlOiBhY2NvdW50SWQsXG4gICAgICAgICAgICBmaWVsZDogXCJhY2NvdW50SWRcIlxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSkudGhlbigoYWNjb3VudHMpID0+IHtcbiAgICAgICAgcmV0dXJuIGFjY291bnRzLmZpbmQoKGEpID0+IGEucHJvdmlkZXJJZCA9PT0gcHJvdmlkZXJJZCk7XG4gICAgICB9KTtcbiAgICAgIGlmIChhY2NvdW50KSB7XG4gICAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBhZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICAgIG1vZGVsOiBcInVzZXJcIixcbiAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICB2YWx1ZTogYWNjb3VudC51c2VySWQsXG4gICAgICAgICAgICAgIGZpZWxkOiBcImlkXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodXNlcikge1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1c2VyLFxuICAgICAgICAgICAgYWNjb3VudHM6IFthY2NvdW50XVxuICAgICAgICAgIH07XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29uc3QgdXNlcjIgPSBhd2FpdCBhZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZhbHVlOiBlbWFpbC50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgICAgICAgIGZpZWxkOiBcImVtYWlsXCJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIGlmICh1c2VyMikge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgdXNlcjogdXNlcjIsXG4gICAgICAgICAgICAgIGFjY291bnRzOiBbYWNjb3VudF1cbiAgICAgICAgICAgIH07XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBudWxsO1xuICAgICAgICB9XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBjb25zdCB1c2VyID0gYXdhaXQgYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdmFsdWU6IGVtYWlsLnRvTG93ZXJDYXNlKCksXG4gICAgICAgICAgICAgIGZpZWxkOiBcImVtYWlsXCJcbiAgICAgICAgICAgIH1cbiAgICAgICAgICBdXG4gICAgICAgIH0pO1xuICAgICAgICBpZiAodXNlcikge1xuICAgICAgICAgIGNvbnN0IGFjY291bnRzID0gYXdhaXQgYWRhcHRlci5maW5kTWFueSh7XG4gICAgICAgICAgICBtb2RlbDogXCJhY2NvdW50XCIsXG4gICAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFsdWU6IHVzZXIuaWQsXG4gICAgICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCJcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgXVxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICB1c2VyLFxuICAgICAgICAgICAgYWNjb3VudHM6IGFjY291bnRzIHx8IFtdXG4gICAgICAgICAgfTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0sXG4gICAgZmluZFVzZXJCeUVtYWlsOiBhc3luYyAoZW1haWwsIG9wdGlvbnMyKSA9PiB7XG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgYWRhcHRlci5maW5kT25lKHtcbiAgICAgICAgbW9kZWw6IFwidXNlclwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIHZhbHVlOiBlbWFpbC50b0xvd2VyQ2FzZSgpLFxuICAgICAgICAgICAgZmllbGQ6IFwiZW1haWxcIlxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICBpZiAoIXVzZXIpIHJldHVybiBudWxsO1xuICAgICAgaWYgKG9wdGlvbnMyPy5pbmNsdWRlQWNjb3VudHMpIHtcbiAgICAgICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBhZGFwdGVyLmZpbmRNYW55KHtcbiAgICAgICAgICBtb2RlbDogXCJhY2NvdW50XCIsXG4gICAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgdmFsdWU6IHVzZXIuaWQsXG4gICAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICB9KTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICB1c2VyLFxuICAgICAgICAgIGFjY291bnRzXG4gICAgICAgIH07XG4gICAgICB9XG4gICAgICByZXR1cm4ge1xuICAgICAgICB1c2VyLFxuICAgICAgICBhY2NvdW50czogW11cbiAgICAgIH07XG4gICAgfSxcbiAgICBmaW5kVXNlckJ5SWQ6IGFzeW5jICh1c2VySWQpID0+IHtcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCBhZGFwdGVyLmZpbmRPbmUoe1xuICAgICAgICBtb2RlbDogXCJ1c2VyXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIHVzZXI7XG4gICAgfSxcbiAgICBsaW5rQWNjb3VudDogYXN5bmMgKGFjY291bnQsIGNvbnRleHQpID0+IHtcbiAgICAgIGNvbnN0IF9hY2NvdW50ID0gYXdhaXQgY3JlYXRlV2l0aEhvb2tzKFxuICAgICAgICB7XG4gICAgICAgICAgLy8gdG9kbzogd2Ugc2hvdWxkIHJlbW92ZSBhdXRvIHNldHRpbmcgY3JlYXRlZEF0IGFuZCB1cGRhdGVkQXQgaW4gdGhlIG5leHQgbWFqb3IgcmVsZWFzZSwgc2luY2UgdGhlIGRiIGdlbmVyYXRvcnMgYWxyZWFkeSBoYW5kbGUgdGhhdFxuICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICAuLi5hY2NvdW50XG4gICAgICAgIH0sXG4gICAgICAgIFwiYWNjb3VudFwiLFxuICAgICAgICB2b2lkIDAsXG4gICAgICAgIGNvbnRleHRcbiAgICAgICk7XG4gICAgICByZXR1cm4gX2FjY291bnQ7XG4gICAgfSxcbiAgICB1cGRhdGVVc2VyOiBhc3luYyAodXNlcklkLCBkYXRhLCBjb250ZXh0KSA9PiB7XG4gICAgICBjb25zdCB1c2VyID0gYXdhaXQgdXBkYXRlV2l0aEhvb2tzKFxuICAgICAgICBkYXRhLFxuICAgICAgICBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIFwidXNlclwiLFxuICAgICAgICB2b2lkIDAsXG4gICAgICAgIGNvbnRleHRcbiAgICAgICk7XG4gICAgICBpZiAoc2Vjb25kYXJ5U3RvcmFnZSAmJiB1c2VyKSB7XG4gICAgICAgIGNvbnN0IGxpc3RSYXcgPSBhd2FpdCBzZWNvbmRhcnlTdG9yYWdlLmdldChgYWN0aXZlLXNlc3Npb25zLSR7dXNlcklkfWApO1xuICAgICAgICBpZiAobGlzdFJhdykge1xuICAgICAgICAgIGNvbnN0IG5vdyA9IERhdGUubm93KCk7XG4gICAgICAgICAgY29uc3QgbGlzdCA9IHNhZmVKU09OUGFyc2UobGlzdFJhdykgfHwgW107XG4gICAgICAgICAgY29uc3QgdmFsaWRTZXNzaW9ucyA9IGxpc3QuZmlsdGVyKChzKSA9PiBzLmV4cGlyZXNBdCA+IG5vdyk7XG4gICAgICAgICAgYXdhaXQgUHJvbWlzZS5hbGwoXG4gICAgICAgICAgICB2YWxpZFNlc3Npb25zLm1hcChhc3luYyAoeyB0b2tlbiB9KSA9PiB7XG4gICAgICAgICAgICAgIGNvbnN0IGNhY2hlZCA9IGF3YWl0IHNlY29uZGFyeVN0b3JhZ2UuZ2V0KHRva2VuKTtcbiAgICAgICAgICAgICAgaWYgKCFjYWNoZWQpIHJldHVybjtcbiAgICAgICAgICAgICAgY29uc3QgcGFyc2VkID0gc2FmZUpTT05QYXJzZShjYWNoZWQpO1xuICAgICAgICAgICAgICBpZiAoIXBhcnNlZCkgcmV0dXJuO1xuICAgICAgICAgICAgICBjb25zdCBzZXNzaW9uVFRMID0gTWF0aC5tYXgoXG4gICAgICAgICAgICAgICAgTWF0aC5mbG9vcihcbiAgICAgICAgICAgICAgICAgIChuZXcgRGF0ZShwYXJzZWQuc2Vzc2lvbi5leHBpcmVzQXQpLmdldFRpbWUoKSAtIG5vdykgLyAxZTNcbiAgICAgICAgICAgICAgICApLFxuICAgICAgICAgICAgICAgIDBcbiAgICAgICAgICAgICAgKTtcbiAgICAgICAgICAgICAgYXdhaXQgc2Vjb25kYXJ5U3RvcmFnZS5zZXQoXG4gICAgICAgICAgICAgICAgdG9rZW4sXG4gICAgICAgICAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgICAgICAgc2Vzc2lvbjogcGFyc2VkLnNlc3Npb24sXG4gICAgICAgICAgICAgICAgICB1c2VyXG4gICAgICAgICAgICAgICAgfSksXG4gICAgICAgICAgICAgICAgc2Vzc2lvblRUTFxuICAgICAgICAgICAgICApO1xuICAgICAgICAgICAgfSlcbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gdXNlcjtcbiAgICB9LFxuICAgIHVwZGF0ZVVzZXJCeUVtYWlsOiBhc3luYyAoZW1haWwsIGRhdGEsIGNvbnRleHQpID0+IHtcbiAgICAgIGNvbnN0IHVzZXIgPSBhd2FpdCB1cGRhdGVXaXRoSG9va3MoXG4gICAgICAgIGRhdGEsXG4gICAgICAgIFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJlbWFpbFwiLFxuICAgICAgICAgICAgdmFsdWU6IGVtYWlsLnRvTG93ZXJDYXNlKClcbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIFwidXNlclwiLFxuICAgICAgICB2b2lkIDAsXG4gICAgICAgIGNvbnRleHRcbiAgICAgICk7XG4gICAgICByZXR1cm4gdXNlcjtcbiAgICB9LFxuICAgIHVwZGF0ZVBhc3N3b3JkOiBhc3luYyAodXNlcklkLCBwYXNzd29yZCwgY29udGV4dCkgPT4ge1xuICAgICAgYXdhaXQgdXBkYXRlTWFueVdpdGhIb29rcyhcbiAgICAgICAge1xuICAgICAgICAgIHBhc3N3b3JkXG4gICAgICAgIH0sXG4gICAgICAgIFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJ1c2VySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiB1c2VySWRcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInByb3ZpZGVySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBcImNyZWRlbnRpYWxcIlxuICAgICAgICAgIH1cbiAgICAgICAgXSxcbiAgICAgICAgXCJhY2NvdW50XCIsXG4gICAgICAgIHZvaWQgMCxcbiAgICAgICAgY29udGV4dFxuICAgICAgKTtcbiAgICB9LFxuICAgIGZpbmRBY2NvdW50czogYXN5bmMgKHVzZXJJZCkgPT4ge1xuICAgICAgY29uc3QgYWNjb3VudHMgPSBhd2FpdCBhZGFwdGVyLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwiYWNjb3VudFwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInVzZXJJZFwiLFxuICAgICAgICAgICAgdmFsdWU6IHVzZXJJZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgICByZXR1cm4gYWNjb3VudHM7XG4gICAgfSxcbiAgICBmaW5kQWNjb3VudDogYXN5bmMgKGFjY291bnRJZCkgPT4ge1xuICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiBcImFjY291bnRcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJhY2NvdW50SWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBhY2NvdW50SWRcbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGFjY291bnQ7XG4gICAgfSxcbiAgICBmaW5kQWNjb3VudEJ5UHJvdmlkZXJJZDogYXN5bmMgKGFjY291bnRJZCwgcHJvdmlkZXJJZCkgPT4ge1xuICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGFkYXB0ZXIuZmluZE9uZSh7XG4gICAgICAgIG1vZGVsOiBcImFjY291bnRcIixcbiAgICAgICAgd2hlcmU6IFtcbiAgICAgICAgICB7XG4gICAgICAgICAgICBmaWVsZDogXCJhY2NvdW50SWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBhY2NvdW50SWRcbiAgICAgICAgICB9LFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcInByb3ZpZGVySWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBwcm92aWRlcklkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBhY2NvdW50O1xuICAgIH0sXG4gICAgZmluZEFjY291bnRCeVVzZXJJZDogYXN5bmMgKHVzZXJJZCkgPT4ge1xuICAgICAgY29uc3QgYWNjb3VudCA9IGF3YWl0IGFkYXB0ZXIuZmluZE1hbnkoe1xuICAgICAgICBtb2RlbDogXCJhY2NvdW50XCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwidXNlcklkXCIsXG4gICAgICAgICAgICB2YWx1ZTogdXNlcklkXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICAgIHJldHVybiBhY2NvdW50O1xuICAgIH0sXG4gICAgdXBkYXRlQWNjb3VudDogYXN5bmMgKGlkLCBkYXRhLCBjb250ZXh0KSA9PiB7XG4gICAgICBjb25zdCBhY2NvdW50ID0gYXdhaXQgdXBkYXRlV2l0aEhvb2tzKFxuICAgICAgICBkYXRhLFxuICAgICAgICBbeyBmaWVsZDogXCJpZFwiLCB2YWx1ZTogaWQgfV0sXG4gICAgICAgIFwiYWNjb3VudFwiLFxuICAgICAgICB2b2lkIDAsXG4gICAgICAgIGNvbnRleHRcbiAgICAgICk7XG4gICAgICByZXR1cm4gYWNjb3VudDtcbiAgICB9LFxuICAgIGNyZWF0ZVZlcmlmaWNhdGlvblZhbHVlOiBhc3luYyAoZGF0YSwgY29udGV4dCkgPT4ge1xuICAgICAgY29uc3QgdmVyaWZpY2F0aW9uID0gYXdhaXQgY3JlYXRlV2l0aEhvb2tzKFxuICAgICAgICB7XG4gICAgICAgICAgLy8gdG9kbzogd2Ugc2hvdWxkIHJlbW92ZSBhdXRvIHNldHRpbmcgY3JlYXRlZEF0IGFuZCB1cGRhdGVkQXQgaW4gdGhlIG5leHQgbWFqb3IgcmVsZWFzZSwgc2luY2UgdGhlIGRiIGdlbmVyYXRvcnMgYWxyZWFkeSBoYW5kbGUgdGhhdFxuICAgICAgICAgIGNyZWF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCksXG4gICAgICAgICAgdXBkYXRlZEF0OiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSxcbiAgICAgICAgICAuLi5kYXRhXG4gICAgICAgIH0sXG4gICAgICAgIFwidmVyaWZpY2F0aW9uXCIsXG4gICAgICAgIHZvaWQgMCxcbiAgICAgICAgY29udGV4dFxuICAgICAgKTtcbiAgICAgIHJldHVybiB2ZXJpZmljYXRpb247XG4gICAgfSxcbiAgICBmaW5kVmVyaWZpY2F0aW9uVmFsdWU6IGFzeW5jIChpZGVudGlmaWVyKSA9PiB7XG4gICAgICBjb25zdCB2ZXJpZmljYXRpb24gPSBhd2FpdCBhZGFwdGVyLmZpbmRNYW55KHtcbiAgICAgICAgbW9kZWw6IFwidmVyaWZpY2F0aW9uXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRlbnRpZmllclwiLFxuICAgICAgICAgICAgdmFsdWU6IGlkZW50aWZpZXJcbiAgICAgICAgICB9XG4gICAgICAgIF0sXG4gICAgICAgIHNvcnRCeToge1xuICAgICAgICAgIGZpZWxkOiBcImNyZWF0ZWRBdFwiLFxuICAgICAgICAgIGRpcmVjdGlvbjogXCJkZXNjXCJcbiAgICAgICAgfSxcbiAgICAgICAgbGltaXQ6IDFcbiAgICAgIH0pO1xuICAgICAgaWYgKCFvcHRpb25zLnZlcmlmaWNhdGlvbj8uZGlzYWJsZUNsZWFudXApIHtcbiAgICAgICAgYXdhaXQgYWRhcHRlci5kZWxldGVNYW55KHtcbiAgICAgICAgICBtb2RlbDogXCJ2ZXJpZmljYXRpb25cIixcbiAgICAgICAgICB3aGVyZTogW1xuICAgICAgICAgICAge1xuICAgICAgICAgICAgICBmaWVsZDogXCJleHBpcmVzQXRcIixcbiAgICAgICAgICAgICAgdmFsdWU6IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpLFxuICAgICAgICAgICAgICBvcGVyYXRvcjogXCJsdFwiXG4gICAgICAgICAgICB9XG4gICAgICAgICAgXVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICAgIGNvbnN0IGxhc3RWZXJpZmljYXRpb24gPSB2ZXJpZmljYXRpb25bMF07XG4gICAgICByZXR1cm4gbGFzdFZlcmlmaWNhdGlvbjtcbiAgICB9LFxuICAgIGRlbGV0ZVZlcmlmaWNhdGlvblZhbHVlOiBhc3luYyAoaWQpID0+IHtcbiAgICAgIGF3YWl0IGFkYXB0ZXIuZGVsZXRlKHtcbiAgICAgICAgbW9kZWw6IFwidmVyaWZpY2F0aW9uXCIsXG4gICAgICAgIHdoZXJlOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgZmllbGQ6IFwiaWRcIixcbiAgICAgICAgICAgIHZhbHVlOiBpZFxuICAgICAgICAgIH1cbiAgICAgICAgXVxuICAgICAgfSk7XG4gICAgfSxcbiAgICBkZWxldGVWZXJpZmljYXRpb25CeUlkZW50aWZpZXI6IGFzeW5jIChpZGVudGlmaWVyKSA9PiB7XG4gICAgICBhd2FpdCBhZGFwdGVyLmRlbGV0ZSh7XG4gICAgICAgIG1vZGVsOiBcInZlcmlmaWNhdGlvblwiLFxuICAgICAgICB3aGVyZTogW1xuICAgICAgICAgIHtcbiAgICAgICAgICAgIGZpZWxkOiBcImlkZW50aWZpZXJcIixcbiAgICAgICAgICAgIHZhbHVlOiBpZGVudGlmaWVyXG4gICAgICAgICAgfVxuICAgICAgICBdXG4gICAgICB9KTtcbiAgICB9LFxuICAgIHVwZGF0ZVZlcmlmaWNhdGlvblZhbHVlOiBhc3luYyAoaWQsIGRhdGEsIGNvbnRleHQpID0+IHtcbiAgICAgIGNvbnN0IHZlcmlmaWNhdGlvbiA9IGF3YWl0IHVwZGF0ZVdpdGhIb29rcyhcbiAgICAgICAgZGF0YSxcbiAgICAgICAgW3sgZmllbGQ6IFwiaWRcIiwgdmFsdWU6IGlkIH1dLFxuICAgICAgICBcInZlcmlmaWNhdGlvblwiLFxuICAgICAgICB2b2lkIDAsXG4gICAgICAgIGNvbnRleHRcbiAgICAgICk7XG4gICAgICByZXR1cm4gdmVyaWZpY2F0aW9uO1xuICAgIH1cbiAgfTtcbn07XG5cbmFzeW5jIGZ1bmN0aW9uIGdldEFkYXB0ZXIob3B0aW9ucykge1xuICBpZiAoIW9wdGlvbnMuZGF0YWJhc2UpIHtcbiAgICBjb25zdCB0YWJsZXMgPSBnZXRBdXRoVGFibGVzKG9wdGlvbnMpO1xuICAgIGNvbnN0IG1lbW9yeURCID0gT2JqZWN0LmtleXModGFibGVzKS5yZWR1Y2UoKGFjYywga2V5KSA9PiB7XG4gICAgICBhY2Nba2V5XSA9IFtdO1xuICAgICAgcmV0dXJuIGFjYztcbiAgICB9LCB7fSk7XG4gICAgbG9nZ2VyLndhcm4oXG4gICAgICBcIk5vIGRhdGFiYXNlIGNvbmZpZ3VyYXRpb24gcHJvdmlkZWQuIFVzaW5nIG1lbW9yeSBhZGFwdGVyIGluIGRldmVsb3BtZW50XCJcbiAgICApO1xuICAgIHJldHVybiBtZW1vcnlBZGFwdGVyKG1lbW9yeURCKShvcHRpb25zKTtcbiAgfVxuICBpZiAodHlwZW9mIG9wdGlvbnMuZGF0YWJhc2UgPT09IFwiZnVuY3Rpb25cIikge1xuICAgIHJldHVybiBvcHRpb25zLmRhdGFiYXNlKG9wdGlvbnMpO1xuICB9XG4gIGNvbnN0IHsga3lzZWx5LCBkYXRhYmFzZVR5cGUgfSA9IGF3YWl0IGNyZWF0ZUt5c2VseUFkYXB0ZXIob3B0aW9ucyk7XG4gIGlmICgha3lzZWx5KSB7XG4gICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcIkZhaWxlZCB0byBpbml0aWFsaXplIGRhdGFiYXNlIGFkYXB0ZXJcIik7XG4gIH1cbiAgcmV0dXJuIGt5c2VseUFkYXB0ZXIoa3lzZWx5LCB7XG4gICAgdHlwZTogZGF0YWJhc2VUeXBlIHx8IFwic3FsaXRlXCIsXG4gICAgZGVidWdMb2dzOiBcImRlYnVnTG9nc1wiIGluIG9wdGlvbnMuZGF0YWJhc2UgPyBvcHRpb25zLmRhdGFiYXNlLmRlYnVnTG9ncyA6IGZhbHNlXG4gIH0pKG9wdGlvbnMpO1xufVxuZnVuY3Rpb24gY29udmVydFRvREIoZmllbGRzLCB2YWx1ZXMpIHtcbiAgbGV0IHJlc3VsdCA9IHZhbHVlcy5pZCA/IHtcbiAgICBpZDogdmFsdWVzLmlkXG4gIH0gOiB7fTtcbiAgZm9yIChjb25zdCBrZXkgaW4gZmllbGRzKSB7XG4gICAgY29uc3QgZmllbGQgPSBmaWVsZHNba2V5XTtcbiAgICBjb25zdCB2YWx1ZSA9IHZhbHVlc1trZXldO1xuICAgIGlmICh2YWx1ZSA9PT0gdm9pZCAwKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgcmVzdWx0W2ZpZWxkLmZpZWxkTmFtZSB8fCBrZXldID0gdmFsdWU7XG4gIH1cbiAgcmV0dXJuIHJlc3VsdDtcbn1cbmZ1bmN0aW9uIGNvbnZlcnRGcm9tREIoZmllbGRzLCB2YWx1ZXMpIHtcbiAgaWYgKCF2YWx1ZXMpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBsZXQgcmVzdWx0ID0ge1xuICAgIGlkOiB2YWx1ZXMuaWRcbiAgfTtcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoZmllbGRzKSkge1xuICAgIHJlc3VsdFtrZXldID0gdmFsdWVzW3ZhbHVlLmZpZWxkTmFtZSB8fCBrZXldO1xuICB9XG4gIHJldHVybiByZXN1bHQ7XG59XG5cbmZ1bmN0aW9uIGdldFNjaGVtYShjb25maWcpIHtcbiAgY29uc3QgdGFibGVzID0gZ2V0QXV0aFRhYmxlcyhjb25maWcpO1xuICBsZXQgc2NoZW1hID0ge307XG4gIGZvciAoY29uc3Qga2V5IGluIHRhYmxlcykge1xuICAgIGNvbnN0IHRhYmxlID0gdGFibGVzW2tleV07XG4gICAgY29uc3QgZmllbGRzID0gdGFibGUuZmllbGRzO1xuICAgIGxldCBhY3R1YWxGaWVsZHMgPSB7fTtcbiAgICBPYmplY3QuZW50cmllcyhmaWVsZHMpLmZvckVhY2goKFtrZXkyLCBmaWVsZF0pID0+IHtcbiAgICAgIGFjdHVhbEZpZWxkc1tmaWVsZC5maWVsZE5hbWUgfHwga2V5Ml0gPSBmaWVsZDtcbiAgICAgIGlmIChmaWVsZC5yZWZlcmVuY2VzKSB7XG4gICAgICAgIGNvbnN0IHJlZlRhYmxlID0gdGFibGVzW2ZpZWxkLnJlZmVyZW5jZXMubW9kZWxdO1xuICAgICAgICBpZiAocmVmVGFibGUpIHtcbiAgICAgICAgICBhY3R1YWxGaWVsZHNbZmllbGQuZmllbGROYW1lIHx8IGtleTJdLnJlZmVyZW5jZXMgPSB7XG4gICAgICAgICAgICBtb2RlbDogcmVmVGFibGUubW9kZWxOYW1lLFxuICAgICAgICAgICAgZmllbGQ6IGZpZWxkLnJlZmVyZW5jZXMuZmllbGRcbiAgICAgICAgICB9O1xuICAgICAgICB9XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKHNjaGVtYVt0YWJsZS5tb2RlbE5hbWVdKSB7XG4gICAgICBzY2hlbWFbdGFibGUubW9kZWxOYW1lXS5maWVsZHMgPSB7XG4gICAgICAgIC4uLnNjaGVtYVt0YWJsZS5tb2RlbE5hbWVdLmZpZWxkcyxcbiAgICAgICAgLi4uYWN0dWFsRmllbGRzXG4gICAgICB9O1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIHNjaGVtYVt0YWJsZS5tb2RlbE5hbWVdID0ge1xuICAgICAgZmllbGRzOiBhY3R1YWxGaWVsZHMsXG4gICAgICBvcmRlcjogdGFibGUub3JkZXIgfHwgSW5maW5pdHlcbiAgICB9O1xuICB9XG4gIHJldHVybiBzY2hlbWE7XG59XG5cbmNvbnN0IHBvc3RncmVzTWFwID0ge1xuICBzdHJpbmc6IFtcImNoYXJhY3RlciB2YXJ5aW5nXCIsIFwidmFyY2hhclwiLCBcInRleHRcIl0sXG4gIG51bWJlcjogW1xuICAgIFwiaW50NFwiLFxuICAgIFwiaW50ZWdlclwiLFxuICAgIFwiYmlnaW50XCIsXG4gICAgXCJzbWFsbGludFwiLFxuICAgIFwibnVtZXJpY1wiLFxuICAgIFwicmVhbFwiLFxuICAgIFwiZG91YmxlIHByZWNpc2lvblwiXG4gIF0sXG4gIGJvb2xlYW46IFtcImJvb2xcIiwgXCJib29sZWFuXCJdLFxuICBkYXRlOiBbXCJ0aW1lc3RhbXBcIiwgXCJkYXRlXCJdLFxuICBqc29uOiBbXCJqc29uXCIsIFwianNvbmJcIl1cbn07XG5jb25zdCBteXNxbE1hcCA9IHtcbiAgc3RyaW5nOiBbXCJ2YXJjaGFyXCIsIFwidGV4dFwiXSxcbiAgbnVtYmVyOiBbXG4gICAgXCJpbnRlZ2VyXCIsXG4gICAgXCJpbnRcIixcbiAgICBcImJpZ2ludFwiLFxuICAgIFwic21hbGxpbnRcIixcbiAgICBcImRlY2ltYWxcIixcbiAgICBcImZsb2F0XCIsXG4gICAgXCJkb3VibGVcIlxuICBdLFxuICBib29sZWFuOiBbXCJib29sZWFuXCIsIFwidGlueWludFwiXSxcbiAgZGF0ZTogW1widGltZXN0YW1wXCIsIFwiZGF0ZXRpbWVcIiwgXCJkYXRlXCJdLFxuICBqc29uOiBbXCJqc29uXCJdXG59O1xuY29uc3Qgc3FsaXRlTWFwID0ge1xuICBzdHJpbmc6IFtcIlRFWFRcIl0sXG4gIG51bWJlcjogW1wiSU5URUdFUlwiLCBcIlJFQUxcIl0sXG4gIGJvb2xlYW46IFtcIklOVEVHRVJcIiwgXCJCT09MRUFOXCJdLFxuICAvLyAwIG9yIDFcbiAgZGF0ZTogW1wiREFURVwiLCBcIklOVEVHRVJcIl0sXG4gIGpzb246IFtcIlRFWFRcIl1cbn07XG5jb25zdCBtc3NxbE1hcCA9IHtcbiAgc3RyaW5nOiBbXCJ2YXJjaGFyXCIsIFwibnZhcmNoYXJcIl0sXG4gIG51bWJlcjogW1wiaW50XCIsIFwiYmlnaW50XCIsIFwic21hbGxpbnRcIiwgXCJkZWNpbWFsXCIsIFwiZmxvYXRcIiwgXCJkb3VibGVcIl0sXG4gIGJvb2xlYW46IFtcImJpdFwiLCBcInNtYWxsaW50XCJdLFxuICBkYXRlOiBbXCJkYXRldGltZVwiLCBcImRhdGVcIl0sXG4gIGpzb246IFtcInZhcmNoYXJcIiwgXCJudmFyY2hhclwiXVxufTtcbmNvbnN0IG1hcCA9IHtcbiAgcG9zdGdyZXM6IHBvc3RncmVzTWFwLFxuICBteXNxbDogbXlzcWxNYXAsXG4gIHNxbGl0ZTogc3FsaXRlTWFwLFxuICBtc3NxbDogbXNzcWxNYXBcbn07XG5mdW5jdGlvbiBtYXRjaFR5cGUoY29sdW1uRGF0YVR5cGUsIGZpZWxkVHlwZSwgZGJUeXBlKSB7XG4gIGZ1bmN0aW9uIG5vcm1hbGl6ZSh0eXBlKSB7XG4gICAgcmV0dXJuIHR5cGUudG9Mb3dlckNhc2UoKS5zcGxpdChcIihcIilbMF0udHJpbSgpO1xuICB9XG4gIGlmIChmaWVsZFR5cGUgPT09IFwic3RyaW5nW11cIiB8fCBmaWVsZFR5cGUgPT09IFwibnVtYmVyW11cIikge1xuICAgIHJldHVybiBjb2x1bW5EYXRhVHlwZS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKFwianNvblwiKTtcbiAgfVxuICBjb25zdCB0eXBlcyA9IG1hcFtkYlR5cGVdO1xuICBjb25zdCBleHBlY3RlZCA9IEFycmF5LmlzQXJyYXkoZmllbGRUeXBlKSA/IHR5cGVzW1wic3RyaW5nXCJdLm1hcCgodCkgPT4gdC50b0xvd2VyQ2FzZSgpKSA6IHR5cGVzW2ZpZWxkVHlwZV0ubWFwKCh0KSA9PiB0LnRvTG93ZXJDYXNlKCkpO1xuICByZXR1cm4gZXhwZWN0ZWQuaW5jbHVkZXMobm9ybWFsaXplKGNvbHVtbkRhdGFUeXBlKSk7XG59XG5hc3luYyBmdW5jdGlvbiBnZXRNaWdyYXRpb25zKGNvbmZpZykge1xuICBjb25zdCBiZXR0ZXJBdXRoU2NoZW1hID0gZ2V0U2NoZW1hKGNvbmZpZyk7XG4gIGNvbnN0IGxvZ2dlciA9IGNyZWF0ZUxvZ2dlcihjb25maWcubG9nZ2VyKTtcbiAgbGV0IHsga3lzZWx5OiBkYiwgZGF0YWJhc2VUeXBlOiBkYlR5cGUgfSA9IGF3YWl0IGNyZWF0ZUt5c2VseUFkYXB0ZXIoY29uZmlnKTtcbiAgaWYgKCFkYlR5cGUpIHtcbiAgICBsb2dnZXIud2FybihcbiAgICAgIFwiQ291bGQgbm90IGRldGVybWluZSBkYXRhYmFzZSB0eXBlLCBkZWZhdWx0aW5nIHRvIHNxbGl0ZS4gUGxlYXNlIHByb3ZpZGUgYSB0eXBlIGluIHRoZSBkYXRhYmFzZSBvcHRpb25zIHRvIGF2b2lkIHRoaXMuXCJcbiAgICApO1xuICAgIGRiVHlwZSA9IFwic3FsaXRlXCI7XG4gIH1cbiAgaWYgKCFkYikge1xuICAgIGxvZ2dlci5lcnJvcihcbiAgICAgIFwiT25seSBreXNlbHkgYWRhcHRlciBpcyBzdXBwb3J0ZWQgZm9yIG1pZ3JhdGlvbnMuIFlvdSBjYW4gdXNlIGBnZW5lcmF0ZWAgY29tbWFuZCB0byBnZW5lcmF0ZSB0aGUgc2NoZW1hLCBpZiB5b3UncmUgdXNpbmcgYSBkaWZmZXJlbnQgYWRhcHRlci5cIlxuICAgICk7XG4gICAgcHJvY2Vzcy5leGl0KDEpO1xuICB9XG4gIGNvbnN0IHRhYmxlTWV0YWRhdGEgPSBhd2FpdCBkYi5pbnRyb3NwZWN0aW9uLmdldFRhYmxlcygpO1xuICBjb25zdCB0b0JlQ3JlYXRlZCA9IFtdO1xuICBjb25zdCB0b0JlQWRkZWQgPSBbXTtcbiAgZm9yIChjb25zdCBba2V5LCB2YWx1ZV0gb2YgT2JqZWN0LmVudHJpZXMoYmV0dGVyQXV0aFNjaGVtYSkpIHtcbiAgICBjb25zdCB0YWJsZSA9IHRhYmxlTWV0YWRhdGEuZmluZCgodCkgPT4gdC5uYW1lID09PSBrZXkpO1xuICAgIGlmICghdGFibGUpIHtcbiAgICAgIGNvbnN0IHRJbmRleCA9IHRvQmVDcmVhdGVkLmZpbmRJbmRleCgodCkgPT4gdC50YWJsZSA9PT0ga2V5KTtcbiAgICAgIGNvbnN0IHRhYmxlRGF0YSA9IHtcbiAgICAgICAgdGFibGU6IGtleSxcbiAgICAgICAgZmllbGRzOiB2YWx1ZS5maWVsZHMsXG4gICAgICAgIG9yZGVyOiB2YWx1ZS5vcmRlciB8fCBJbmZpbml0eVxuICAgICAgfTtcbiAgICAgIGNvbnN0IGluc2VydEluZGV4ID0gdG9CZUNyZWF0ZWQuZmluZEluZGV4KFxuICAgICAgICAodCkgPT4gKHQub3JkZXIgfHwgSW5maW5pdHkpID4gdGFibGVEYXRhLm9yZGVyXG4gICAgICApO1xuICAgICAgaWYgKGluc2VydEluZGV4ID09PSAtMSkge1xuICAgICAgICBpZiAodEluZGV4ID09PSAtMSkge1xuICAgICAgICAgIHRvQmVDcmVhdGVkLnB1c2godGFibGVEYXRhKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICB0b0JlQ3JlYXRlZFt0SW5kZXhdLmZpZWxkcyA9IHtcbiAgICAgICAgICAgIC4uLnRvQmVDcmVhdGVkW3RJbmRleF0uZmllbGRzLFxuICAgICAgICAgICAgLi4udmFsdWUuZmllbGRzXG4gICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdG9CZUNyZWF0ZWQuc3BsaWNlKGluc2VydEluZGV4LCAwLCB0YWJsZURhdGEpO1xuICAgICAgfVxuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGxldCB0b0JlQWRkZWRGaWVsZHMgPSB7fTtcbiAgICBmb3IgKGNvbnN0IFtmaWVsZE5hbWUsIGZpZWxkXSBvZiBPYmplY3QuZW50cmllcyh2YWx1ZS5maWVsZHMpKSB7XG4gICAgICBjb25zdCBjb2x1bW4gPSB0YWJsZS5jb2x1bW5zLmZpbmQoKGMpID0+IGMubmFtZSA9PT0gZmllbGROYW1lKTtcbiAgICAgIGlmICghY29sdW1uKSB7XG4gICAgICAgIHRvQmVBZGRlZEZpZWxkc1tmaWVsZE5hbWVdID0gZmllbGQ7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKG1hdGNoVHlwZShjb2x1bW4uZGF0YVR5cGUsIGZpZWxkLnR5cGUsIGRiVHlwZSkpIHtcbiAgICAgICAgY29udGludWU7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICBsb2dnZXIud2FybihcbiAgICAgICAgICBgRmllbGQgJHtmaWVsZE5hbWV9IGluIHRhYmxlICR7a2V5fSBoYXMgYSBkaWZmZXJlbnQgdHlwZSBpbiB0aGUgZGF0YWJhc2UuIEV4cGVjdGVkICR7ZmllbGQudHlwZX0gYnV0IGdvdCAke2NvbHVtbi5kYXRhVHlwZX0uYFxuICAgICAgICApO1xuICAgICAgfVxuICAgIH1cbiAgICBpZiAoT2JqZWN0LmtleXModG9CZUFkZGVkRmllbGRzKS5sZW5ndGggPiAwKSB7XG4gICAgICB0b0JlQWRkZWQucHVzaCh7XG4gICAgICAgIHRhYmxlOiBrZXksXG4gICAgICAgIGZpZWxkczogdG9CZUFkZGVkRmllbGRzLFxuICAgICAgICBvcmRlcjogdmFsdWUub3JkZXIgfHwgSW5maW5pdHlcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICBjb25zdCBtaWdyYXRpb25zID0gW107XG4gIGZ1bmN0aW9uIGdldFR5cGUoZmllbGQsIGZpZWxkTmFtZSkge1xuICAgIGNvbnN0IHR5cGUgPSBmaWVsZC50eXBlO1xuICAgIGNvbnN0IHR5cGVNYXAgPSB7XG4gICAgICBzdHJpbmc6IHtcbiAgICAgICAgc3FsaXRlOiBcInRleHRcIixcbiAgICAgICAgcG9zdGdyZXM6IFwidGV4dFwiLFxuICAgICAgICBteXNxbDogZmllbGQudW5pcXVlID8gXCJ2YXJjaGFyKDI1NSlcIiA6IGZpZWxkLnJlZmVyZW5jZXMgPyBcInZhcmNoYXIoMzYpXCIgOiBcInRleHRcIixcbiAgICAgICAgbXNzcWw6IGZpZWxkLnVuaXF1ZSB8fCBmaWVsZC5zb3J0YWJsZSA/IFwidmFyY2hhcigyNTUpXCIgOiBmaWVsZC5yZWZlcmVuY2VzID8gXCJ2YXJjaGFyKDM2KVwiIDogKFxuICAgICAgICAgIC8vIG1zc3FsIGRlcHJlY2F0ZWQgYHRleHRgLCBhbmQgdGhlIGFsdGVybmF0aXZlIGlzIGB2YXJjaGFyKG1heClgLlxuICAgICAgICAgIC8vIEt5c2VseSB0eXBlIGludGVyZmFjZSBkb2Vzbid0IHN1cHBvcnQgYHRleHRgLCBzbyB3ZSBzZXQgdGhpcyB0byBgdmFyY2hhcig4MDAwKWAgYXNcbiAgICAgICAgICAvLyB0aGF0J3MgdGhlIG1heCBsZW5ndGggZm9yIGB2YXJjaGFyYFxuICAgICAgICAgIFwidmFyY2hhcig4MDAwKVwiXG4gICAgICAgIClcbiAgICAgIH0sXG4gICAgICBib29sZWFuOiB7XG4gICAgICAgIHNxbGl0ZTogXCJpbnRlZ2VyXCIsXG4gICAgICAgIHBvc3RncmVzOiBcImJvb2xlYW5cIixcbiAgICAgICAgbXlzcWw6IFwiYm9vbGVhblwiLFxuICAgICAgICBtc3NxbDogXCJzbWFsbGludFwiXG4gICAgICB9LFxuICAgICAgbnVtYmVyOiB7XG4gICAgICAgIHNxbGl0ZTogZmllbGQuYmlnaW50ID8gXCJiaWdpbnRcIiA6IFwiaW50ZWdlclwiLFxuICAgICAgICBwb3N0Z3JlczogZmllbGQuYmlnaW50ID8gXCJiaWdpbnRcIiA6IFwiaW50ZWdlclwiLFxuICAgICAgICBteXNxbDogZmllbGQuYmlnaW50ID8gXCJiaWdpbnRcIiA6IFwiaW50ZWdlclwiLFxuICAgICAgICBtc3NxbDogZmllbGQuYmlnaW50ID8gXCJiaWdpbnRcIiA6IFwiaW50ZWdlclwiXG4gICAgICB9LFxuICAgICAgZGF0ZToge1xuICAgICAgICBzcWxpdGU6IFwiZGF0ZVwiLFxuICAgICAgICBwb3N0Z3JlczogXCJ0aW1lc3RhbXBcIixcbiAgICAgICAgbXlzcWw6IFwiZGF0ZXRpbWVcIixcbiAgICAgICAgbXNzcWw6IFwiZGF0ZXRpbWVcIlxuICAgICAgfSxcbiAgICAgIGpzb246IHtcbiAgICAgICAgc3FsaXRlOiBcInRleHRcIixcbiAgICAgICAgcG9zdGdyZXM6IFwianNvblwiLFxuICAgICAgICBteXNxbDogXCJqc29uXCIsXG4gICAgICAgIG1zc3FsOiBcInZhcmNoYXIoODAwMClcIlxuICAgICAgfSxcbiAgICAgIGlkOiB7XG4gICAgICAgIHBvc3RncmVzOiBjb25maWcuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCA/IFwic2VyaWFsXCIgOiBcInRleHRcIixcbiAgICAgICAgbXlzcWw6IGNvbmZpZy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkID8gXCJpbnRlZ2VyXCIgOiBcInZhcmNoYXIoMzYpXCIsXG4gICAgICAgIG1zc3FsOiBjb25maWcuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCA/IFwiaW50ZWdlclwiIDogXCJ2YXJjaGFyKDM2KVwiLFxuICAgICAgICBzcWxpdGU6IGNvbmZpZy5hZHZhbmNlZD8uZGF0YWJhc2U/LnVzZU51bWJlcklkID8gXCJpbnRlZ2VyXCIgOiBcInRleHRcIlxuICAgICAgfVxuICAgIH07XG4gICAgaWYgKGZpZWxkTmFtZSA9PT0gXCJpZFwiIHx8IGZpZWxkLnJlZmVyZW5jZXM/LmZpZWxkID09PSBcImlkXCIpIHtcbiAgICAgIHJldHVybiB0eXBlTWFwLmlkW2RiVHlwZV07XG4gICAgfVxuICAgIGlmIChkYlR5cGUgPT09IFwic3FsaXRlXCIgJiYgKHR5cGUgPT09IFwic3RyaW5nW11cIiB8fCB0eXBlID09PSBcIm51bWJlcltdXCIpKSB7XG4gICAgICByZXR1cm4gXCJ0ZXh0XCI7XG4gICAgfVxuICAgIGlmICh0eXBlID09PSBcInN0cmluZ1tdXCIgfHwgdHlwZSA9PT0gXCJudW1iZXJbXVwiKSB7XG4gICAgICByZXR1cm4gXCJqc29uYlwiO1xuICAgIH1cbiAgICBpZiAoQXJyYXkuaXNBcnJheSh0eXBlKSkge1xuICAgICAgcmV0dXJuIFwidGV4dFwiO1xuICAgIH1cbiAgICByZXR1cm4gdHlwZU1hcFt0eXBlXVtkYlR5cGUgfHwgXCJzcWxpdGVcIl07XG4gIH1cbiAgaWYgKHRvQmVBZGRlZC5sZW5ndGgpIHtcbiAgICBmb3IgKGNvbnN0IHRhYmxlIG9mIHRvQmVBZGRlZCkge1xuICAgICAgZm9yIChjb25zdCBbZmllbGROYW1lLCBmaWVsZF0gb2YgT2JqZWN0LmVudHJpZXModGFibGUuZmllbGRzKSkge1xuICAgICAgICBjb25zdCB0eXBlID0gZ2V0VHlwZShmaWVsZCwgZmllbGROYW1lKTtcbiAgICAgICAgY29uc3QgZXhlYyA9IGRiLnNjaGVtYS5hbHRlclRhYmxlKHRhYmxlLnRhYmxlKS5hZGRDb2x1bW4oZmllbGROYW1lLCB0eXBlLCAoY29sKSA9PiB7XG4gICAgICAgICAgY29sID0gZmllbGQucmVxdWlyZWQgIT09IGZhbHNlID8gY29sLm5vdE51bGwoKSA6IGNvbDtcbiAgICAgICAgICBpZiAoZmllbGQucmVmZXJlbmNlcykge1xuICAgICAgICAgICAgY29sID0gY29sLnJlZmVyZW5jZXMoXG4gICAgICAgICAgICAgIGAke2ZpZWxkLnJlZmVyZW5jZXMubW9kZWx9LiR7ZmllbGQucmVmZXJlbmNlcy5maWVsZH1gXG4gICAgICAgICAgICApLm9uRGVsZXRlKGZpZWxkLnJlZmVyZW5jZXMub25EZWxldGUgfHwgXCJjYXNjYWRlXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZmllbGQudW5pcXVlKSB7XG4gICAgICAgICAgICBjb2wgPSBjb2wudW5pcXVlKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChmaWVsZC50eXBlID09PSBcImRhdGVcIiAmJiB0eXBlb2YgZmllbGQuZGVmYXVsdFZhbHVlID09PSBcImZ1bmN0aW9uXCIgJiYgKGRiVHlwZSA9PT0gXCJwb3N0Z3Jlc1wiIHx8IGRiVHlwZSA9PT0gXCJteXNxbFwiIHx8IGRiVHlwZSA9PT0gXCJtc3NxbFwiKSkge1xuICAgICAgICAgICAgY29sID0gY29sLmRlZmF1bHRUbyhzcWxgQ1VSUkVOVF9USU1FU1RBTVBgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGNvbDtcbiAgICAgICAgfSk7XG4gICAgICAgIG1pZ3JhdGlvbnMucHVzaChleGVjKTtcbiAgICAgIH1cbiAgICB9XG4gIH1cbiAgaWYgKHRvQmVDcmVhdGVkLmxlbmd0aCkge1xuICAgIGZvciAoY29uc3QgdGFibGUgb2YgdG9CZUNyZWF0ZWQpIHtcbiAgICAgIGxldCBkYlQgPSBkYi5zY2hlbWEuY3JlYXRlVGFibGUodGFibGUudGFibGUpLmFkZENvbHVtbihcbiAgICAgICAgXCJpZFwiLFxuICAgICAgICBjb25maWcuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCA/IGRiVHlwZSA9PT0gXCJwb3N0Z3Jlc1wiID8gXCJzZXJpYWxcIiA6IFwiaW50ZWdlclwiIDogZGJUeXBlID09PSBcIm15c3FsXCIgfHwgZGJUeXBlID09PSBcIm1zc3FsXCIgPyBcInZhcmNoYXIoMzYpXCIgOiBcInRleHRcIixcbiAgICAgICAgKGNvbCkgPT4ge1xuICAgICAgICAgIGlmIChjb25maWcuYWR2YW5jZWQ/LmRhdGFiYXNlPy51c2VOdW1iZXJJZCkge1xuICAgICAgICAgICAgaWYgKGRiVHlwZSA9PT0gXCJwb3N0Z3Jlc1wiKSB7XG4gICAgICAgICAgICAgIHJldHVybiBjb2wucHJpbWFyeUtleSgpLm5vdE51bGwoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjb2wuYXV0b0luY3JlbWVudCgpLnByaW1hcnlLZXkoKS5ub3ROdWxsKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIHJldHVybiBjb2wucHJpbWFyeUtleSgpLm5vdE51bGwoKTtcbiAgICAgICAgfVxuICAgICAgKTtcbiAgICAgIGZvciAoY29uc3QgW2ZpZWxkTmFtZSwgZmllbGRdIG9mIE9iamVjdC5lbnRyaWVzKHRhYmxlLmZpZWxkcykpIHtcbiAgICAgICAgY29uc3QgdHlwZSA9IGdldFR5cGUoZmllbGQsIGZpZWxkTmFtZSk7XG4gICAgICAgIGRiVCA9IGRiVC5hZGRDb2x1bW4oZmllbGROYW1lLCB0eXBlLCAoY29sKSA9PiB7XG4gICAgICAgICAgY29sID0gZmllbGQucmVxdWlyZWQgIT09IGZhbHNlID8gY29sLm5vdE51bGwoKSA6IGNvbDtcbiAgICAgICAgICBpZiAoZmllbGQucmVmZXJlbmNlcykge1xuICAgICAgICAgICAgY29sID0gY29sLnJlZmVyZW5jZXMoYCR7ZmllbGQucmVmZXJlbmNlcy5tb2RlbH0uJHtmaWVsZC5yZWZlcmVuY2VzLmZpZWxkfWApLm9uRGVsZXRlKGZpZWxkLnJlZmVyZW5jZXMub25EZWxldGUgfHwgXCJjYXNjYWRlXCIpO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpZiAoZmllbGQudW5pcXVlKSB7XG4gICAgICAgICAgICBjb2wgPSBjb2wudW5pcXVlKCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGlmIChmaWVsZC50eXBlID09PSBcImRhdGVcIiAmJiB0eXBlb2YgZmllbGQuZGVmYXVsdFZhbHVlID09PSBcImZ1bmN0aW9uXCIgJiYgKGRiVHlwZSA9PT0gXCJwb3N0Z3Jlc1wiIHx8IGRiVHlwZSA9PT0gXCJteXNxbFwiIHx8IGRiVHlwZSA9PT0gXCJtc3NxbFwiKSkge1xuICAgICAgICAgICAgY29sID0gY29sLmRlZmF1bHRUbyhzcWxgQ1VSUkVOVF9USU1FU1RBTVBgKTtcbiAgICAgICAgICB9XG4gICAgICAgICAgcmV0dXJuIGNvbDtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBtaWdyYXRpb25zLnB1c2goZGJUKTtcbiAgICB9XG4gIH1cbiAgYXN5bmMgZnVuY3Rpb24gcnVuTWlncmF0aW9ucygpIHtcbiAgICBmb3IgKGNvbnN0IG1pZ3JhdGlvbiBvZiBtaWdyYXRpb25zKSB7XG4gICAgICBhd2FpdCBtaWdyYXRpb24uZXhlY3V0ZSgpO1xuICAgIH1cbiAgfVxuICBhc3luYyBmdW5jdGlvbiBjb21waWxlTWlncmF0aW9ucygpIHtcbiAgICBjb25zdCBjb21waWxlZCA9IG1pZ3JhdGlvbnMubWFwKChtKSA9PiBtLmNvbXBpbGUoKS5zcWwpO1xuICAgIHJldHVybiBjb21waWxlZC5qb2luKFwiO1xcblxcblwiKSArIFwiO1wiO1xuICB9XG4gIHJldHVybiB7IHRvQmVDcmVhdGVkLCB0b0JlQWRkZWQsIHJ1bk1pZ3JhdGlvbnMsIGNvbXBpbGVNaWdyYXRpb25zIH07XG59XG5cbmV4cG9ydCB7IGdldEFkYXB0ZXIgYXMgYSwgY29udmVydFRvREIgYXMgYiwgY3JlYXRlSW50ZXJuYWxBZGFwdGVyIGFzIGMsIGNvbnZlcnRGcm9tREIgYXMgZCwgZ2V0TWlncmF0aW9ucyBhcyBlLCBnZXRTY2hlbWEgYXMgZiwgZ2V0V2l0aEhvb2tzIGFzIGcsIG1hdGNoVHlwZSBhcyBtIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.DV0Lly8-.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.DV5EHeYG.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.DV5EHeYG.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   B: () => (/* binding */ BASE_ERROR_CODES),\n/* harmony export */   a: () => (/* binding */ createAuthEndpoint),\n/* harmony export */   b: () => (/* binding */ getSession),\n/* harmony export */   c: () => (/* binding */ createAuthMiddleware),\n/* harmony export */   d: () => (/* binding */ revokeSessions),\n/* harmony export */   e: () => (/* binding */ revokeSession),\n/* harmony export */   f: () => (/* binding */ freshSessionMiddleware),\n/* harmony export */   g: () => (/* binding */ getSessionFromCtx),\n/* harmony export */   h: () => (/* binding */ getSessionQuerySchema),\n/* harmony export */   i: () => (/* binding */ requestOnlySessionMiddleware),\n/* harmony export */   l: () => (/* binding */ listSessions),\n/* harmony export */   o: () => (/* binding */ optionsMiddleware),\n/* harmony export */   r: () => (/* binding */ revokeOtherSessions),\n/* harmony export */   s: () => (/* binding */ sessionMiddleware)\n/* harmony export */ });\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n/* harmony import */ var _better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./better-auth.CW6D9eSx.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\");\n/* harmony import */ var _better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./better-auth.UfVWArIB.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.UfVWArIB.mjs\");\n/* harmony import */ var zod_v4__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! zod/v4 */ \"(rsc)/./node_modules/zod/v4/index.js\");\n/* harmony import */ var _better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./better-auth.BZZKN1g7.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BZZKN1g7.mjs\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @better-auth/utils/binary */ \"(rsc)/./node_modules/@better-auth/utils/dist/binary.mjs\");\n\n\n\n\n\n\n\n\n\nconst optionsMiddleware = (0,better_call__WEBPACK_IMPORTED_MODULE_0__.createMiddleware)(async () => {\n  return {};\n});\nconst createAuthMiddleware = better_call__WEBPACK_IMPORTED_MODULE_0__.createMiddleware.create({\n  use: [\n    optionsMiddleware,\n    /**\n     * Only use for post hooks\n     */\n    (0,better_call__WEBPACK_IMPORTED_MODULE_0__.createMiddleware)(async () => {\n      return {};\n    })\n  ]\n});\nconst createAuthEndpoint = better_call__WEBPACK_IMPORTED_MODULE_0__.createEndpoint.create({\n  use: [optionsMiddleware]\n});\n\nconst BASE_ERROR_CODES = {\n  USER_NOT_FOUND: \"User not found\",\n  FAILED_TO_CREATE_USER: \"Failed to create user\",\n  FAILED_TO_CREATE_SESSION: \"Failed to create session\",\n  FAILED_TO_UPDATE_USER: \"Failed to update user\",\n  FAILED_TO_GET_SESSION: \"Failed to get session\",\n  INVALID_PASSWORD: \"Invalid password\",\n  INVALID_EMAIL: \"Invalid email\",\n  INVALID_EMAIL_OR_PASSWORD: \"Invalid email or password\",\n  SOCIAL_ACCOUNT_ALREADY_LINKED: \"Social account already linked\",\n  PROVIDER_NOT_FOUND: \"Provider not found\",\n  INVALID_TOKEN: \"Invalid token\",\n  ID_TOKEN_NOT_SUPPORTED: \"id_token not supported\",\n  FAILED_TO_GET_USER_INFO: \"Failed to get user info\",\n  USER_EMAIL_NOT_FOUND: \"User email not found\",\n  EMAIL_NOT_VERIFIED: \"Email not verified\",\n  PASSWORD_TOO_SHORT: \"Password too short\",\n  PASSWORD_TOO_LONG: \"Password too long\",\n  USER_ALREADY_EXISTS: \"User already exists. Use another email.\",\n  EMAIL_CAN_NOT_BE_UPDATED: \"Email can not be updated\",\n  CREDENTIAL_ACCOUNT_NOT_FOUND: \"Credential account not found\",\n  SESSION_EXPIRED: \"Session expired. Re-authenticate to perform this action.\",\n  FAILED_TO_UNLINK_LAST_ACCOUNT: \"You can't unlink your last account\",\n  ACCOUNT_NOT_FOUND: \"Account not found\",\n  USER_ALREADY_HAS_PASSWORD: \"User already has a password. Provide that to delete the account.\"\n};\n\nconst getSessionQuerySchema = zod_v4__WEBPACK_IMPORTED_MODULE_3__.optional(\n  zod_v4__WEBPACK_IMPORTED_MODULE_3__.object({\n    /**\n     * If cookie cache is enabled, it will disable the cache\n     * and fetch the session from the database\n     */\n    disableCookieCache: zod_v4__WEBPACK_IMPORTED_MODULE_3__.coerce.boolean().meta({\n      description: \"Disable cookie cache and fetch session from database\"\n    }).optional(),\n    disableRefresh: zod_v4__WEBPACK_IMPORTED_MODULE_3__.coerce.boolean().meta({\n      description: \"Disable session refresh. Useful for checking session status, without updating the session\"\n    }).optional()\n  })\n);\nconst getSession = () => createAuthEndpoint(\n  \"/get-session\",\n  {\n    method: \"GET\",\n    query: getSessionQuerySchema,\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Get the current session\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    session: {\n                      $ref: \"#/components/schemas/Session\"\n                    },\n                    user: {\n                      $ref: \"#/components/schemas/User\"\n                    }\n                  },\n                  required: [\"session\", \"user\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    try {\n      const sessionCookieToken = await ctx.getSignedCookie(\n        ctx.context.authCookies.sessionToken.name,\n        ctx.context.secret\n      );\n      if (!sessionCookieToken) {\n        return null;\n      }\n      const sessionDataCookie = ctx.getCookie(\n        ctx.context.authCookies.sessionData.name\n      );\n      const sessionDataPayload = sessionDataCookie ? (0,_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_4__.s)(_better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_7__.binary.decode(_better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_6__.base64Url.decode(sessionDataCookie))) : null;\n      if (sessionDataPayload) {\n        const isValid = await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_5__.createHMAC)(\"SHA-256\", \"base64urlnopad\").verify(\n          ctx.context.secret,\n          JSON.stringify({\n            ...sessionDataPayload.session,\n            expiresAt: sessionDataPayload.expiresAt\n          }),\n          sessionDataPayload.signature\n        );\n        if (!isValid) {\n          const dataCookie = ctx.context.authCookies.sessionData.name;\n          ctx.setCookie(dataCookie, \"\", {\n            maxAge: 0\n          });\n          return ctx.json(null);\n        }\n      }\n      const dontRememberMe = await ctx.getSignedCookie(\n        ctx.context.authCookies.dontRememberToken.name,\n        ctx.context.secret\n      );\n      if (sessionDataPayload?.session && ctx.context.options.session?.cookieCache?.enabled && !ctx.query?.disableCookieCache) {\n        const session2 = sessionDataPayload.session;\n        const hasExpired = sessionDataPayload.expiresAt < Date.now() || session2.session.expiresAt < /* @__PURE__ */ new Date();\n        if (!hasExpired) {\n          ctx.context.session = session2;\n          return ctx.json(\n            session2\n          );\n        } else {\n          const dataCookie = ctx.context.authCookies.sessionData.name;\n          ctx.setCookie(dataCookie, \"\", {\n            maxAge: 0\n          });\n        }\n      }\n      const session = await ctx.context.internalAdapter.findSession(sessionCookieToken);\n      ctx.context.session = session;\n      if (!session || session.session.expiresAt < /* @__PURE__ */ new Date()) {\n        (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_2__.d)(ctx);\n        if (session) {\n          await ctx.context.internalAdapter.deleteSession(\n            session.session.token\n          );\n        }\n        return ctx.json(null);\n      }\n      if (dontRememberMe || ctx.query?.disableRefresh) {\n        return ctx.json(\n          session\n        );\n      }\n      const expiresIn = ctx.context.sessionConfig.expiresIn;\n      const updateAge = ctx.context.sessionConfig.updateAge;\n      const sessionIsDueToBeUpdatedDate = session.session.expiresAt.valueOf() - expiresIn * 1e3 + updateAge * 1e3;\n      const shouldBeUpdated = sessionIsDueToBeUpdatedDate <= Date.now();\n      if (shouldBeUpdated && (!ctx.query?.disableRefresh || !ctx.context.options.session?.disableSessionRefresh)) {\n        const updatedSession = await ctx.context.internalAdapter.updateSession(\n          session.session.token,\n          {\n            expiresAt: (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_1__.g)(ctx.context.sessionConfig.expiresIn, \"sec\"),\n            updatedAt: /* @__PURE__ */ new Date()\n          }\n        );\n        if (!updatedSession) {\n          (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_2__.d)(ctx);\n          return ctx.json(null, { status: 401 });\n        }\n        const maxAge = (updatedSession.expiresAt.valueOf() - Date.now()) / 1e3;\n        await (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_2__.s)(\n          ctx,\n          {\n            session: updatedSession,\n            user: session.user\n          },\n          false,\n          {\n            maxAge\n          }\n        );\n        return ctx.json({\n          session: updatedSession,\n          user: session.user\n        });\n      }\n      await (0,_better_auth_UfVWArIB_mjs__WEBPACK_IMPORTED_MODULE_2__.b)(ctx, session);\n      return ctx.json(\n        session\n      );\n    } catch (error) {\n      ctx.context.logger.error(\"INTERNAL_SERVER_ERROR\", error);\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\", {\n        message: BASE_ERROR_CODES.FAILED_TO_GET_SESSION\n      });\n    }\n  }\n);\nconst getSessionFromCtx = async (ctx, config) => {\n  if (ctx.context.session) {\n    return ctx.context.session;\n  }\n  const session = await getSession()({\n    ...ctx,\n    asResponse: false,\n    headers: ctx.headers,\n    returnHeaders: false,\n    query: {\n      ...config,\n      ...ctx.query\n    }\n  }).catch((e) => {\n    return null;\n  });\n  ctx.context.session = session;\n  return session;\n};\nconst sessionMiddleware = createAuthMiddleware(async (ctx) => {\n  const session = await getSessionFromCtx(ctx);\n  if (!session?.session) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n  }\n  return {\n    session\n  };\n});\nconst requestOnlySessionMiddleware = createAuthMiddleware(\n  async (ctx) => {\n    const session = await getSessionFromCtx(ctx);\n    if (!session?.session && (ctx.request || ctx.headers)) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n    }\n    return { session };\n  }\n);\nconst freshSessionMiddleware = createAuthMiddleware(async (ctx) => {\n  const session = await getSessionFromCtx(ctx);\n  if (!session?.session) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n  }\n  if (ctx.context.sessionConfig.freshAge === 0) {\n    return {\n      session\n    };\n  }\n  const freshAge = ctx.context.sessionConfig.freshAge;\n  const lastUpdated = session.session.updatedAt?.valueOf() || session.session.createdAt.valueOf();\n  const now = Date.now();\n  const isFresh = now - lastUpdated < freshAge * 1e3;\n  if (!isFresh) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"FORBIDDEN\", {\n      message: \"Session is not fresh\"\n    });\n  }\n  return {\n    session\n  };\n});\nconst listSessions = () => createAuthEndpoint(\n  \"/list-sessions\",\n  {\n    method: \"GET\",\n    use: [sessionMiddleware],\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"List all active sessions for the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"array\",\n                  items: {\n                    $ref: \"#/components/schemas/Session\"\n                  }\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    try {\n      const sessions = await ctx.context.internalAdapter.listSessions(\n        ctx.context.session.user.id\n      );\n      const activeSessions = sessions.filter((session) => {\n        return session.expiresAt > /* @__PURE__ */ new Date();\n      });\n      return ctx.json(\n        activeSessions\n      );\n    } catch (e) {\n      ctx.context.logger.error(e);\n      throw ctx.error(\"INTERNAL_SERVER_ERROR\");\n    }\n  }\n);\nconst revokeSession = createAuthEndpoint(\n  \"/revoke-session\",\n  {\n    method: \"POST\",\n    body: zod_v4__WEBPACK_IMPORTED_MODULE_3__.object({\n      token: zod_v4__WEBPACK_IMPORTED_MODULE_3__.string().meta({\n        description: \"The token to revoke\"\n      })\n    }),\n    use: [sessionMiddleware],\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Revoke a single session\",\n        requestBody: {\n          content: {\n            \"application/json\": {\n              schema: {\n                type: \"object\",\n                properties: {\n                  token: {\n                    type: \"string\",\n                    description: \"The token to revoke\"\n                  }\n                },\n                required: [\"token\"]\n              }\n            }\n          }\n        },\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if the session was revoked successfully\"\n                    }\n                  },\n                  required: [\"status\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const token = ctx.body.token;\n    const findSession = await ctx.context.internalAdapter.findSession(token);\n    if (!findSession) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n        message: \"Session not found\"\n      });\n    }\n    if (findSession.session.userId !== ctx.context.session.user.id) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n    }\n    try {\n      await ctx.context.internalAdapter.deleteSession(token);\n    } catch (error) {\n      ctx.context.logger.error(\n        error && typeof error === \"object\" && \"name\" in error ? error.name : \"\",\n        error\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\");\n    }\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst revokeSessions = createAuthEndpoint(\n  \"/revoke-sessions\",\n  {\n    method: \"POST\",\n    use: [sessionMiddleware],\n    requireHeaders: true,\n    metadata: {\n      openapi: {\n        description: \"Revoke all sessions for the user\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if all sessions were revoked successfully\"\n                    }\n                  },\n                  required: [\"status\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    try {\n      await ctx.context.internalAdapter.deleteSessions(\n        ctx.context.session.user.id\n      );\n    } catch (error) {\n      ctx.context.logger.error(\n        error && typeof error === \"object\" && \"name\" in error ? error.name : \"\",\n        error\n      );\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"INTERNAL_SERVER_ERROR\");\n    }\n    return ctx.json({\n      status: true\n    });\n  }\n);\nconst revokeOtherSessions = createAuthEndpoint(\n  \"/revoke-other-sessions\",\n  {\n    method: \"POST\",\n    requireHeaders: true,\n    use: [sessionMiddleware],\n    metadata: {\n      openapi: {\n        description: \"Revoke all other sessions for the user except the current one\",\n        responses: {\n          \"200\": {\n            description: \"Success\",\n            content: {\n              \"application/json\": {\n                schema: {\n                  type: \"object\",\n                  properties: {\n                    status: {\n                      type: \"boolean\",\n                      description: \"Indicates if all other sessions were revoked successfully\"\n                    }\n                  },\n                  required: [\"status\"]\n                }\n              }\n            }\n          }\n        }\n      }\n    }\n  },\n  async (ctx) => {\n    const session = ctx.context.session;\n    if (!session.user) {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"UNAUTHORIZED\");\n    }\n    const sessions = await ctx.context.internalAdapter.listSessions(\n      session.user.id\n    );\n    const activeSessions = sessions.filter((session2) => {\n      return session2.expiresAt > /* @__PURE__ */ new Date();\n    });\n    const otherSessions = activeSessions.filter(\n      (session2) => session2.token !== ctx.context.session.session.token\n    );\n    await Promise.all(\n      otherSessions.map(\n        (session2) => ctx.context.internalAdapter.deleteSession(session2.token)\n      )\n    );\n    return ctx.json({\n      status: true\n    });\n  }\n);\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguRFY1RUhlWUcubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBeUU7QUFDZjtBQUN3RDtBQUN0RjtBQUNvQztBQUNYO0FBQ0M7QUFDSDs7QUFFbkQsMEJBQTBCLDZEQUFnQjtBQUMxQztBQUNBLENBQUM7QUFDRCw2QkFBNkIseURBQWdCO0FBQzdDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLDZEQUFnQjtBQUNwQjtBQUNBLEtBQUs7QUFDTDtBQUNBLENBQUM7QUFDRCwyQkFBMkIsdURBQWM7QUFDekM7QUFDQSxDQUFDOztBQUVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUEsOEJBQThCLDRDQUFVO0FBQ3hDLEVBQUUsMENBQVE7QUFDVjtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixrREFBZ0I7QUFDeEM7QUFDQSxLQUFLO0FBQ0wsb0JBQW9CLGtEQUFnQjtBQUNwQztBQUNBLEtBQUs7QUFDTCxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxtQkFBbUI7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxREFBcUQsNERBQWEsQ0FBQyw2REFBTSxRQUFRLGdFQUFTO0FBQzFG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QUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CO0FBQ25CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU07QUFDTjtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpREFBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1CQUFtQjtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixpREFBUTtBQUN4QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTs7QUFFZ1ciLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXGRpc3RcXHNoYXJlZFxcYmV0dGVyLWF1dGguRFY1RUhlWUcubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZU1pZGRsZXdhcmUsIGNyZWF0ZUVuZHBvaW50LCBBUElFcnJvciB9IGZyb20gJ2JldHRlci1jYWxsJztcbmltcG9ydCB7IGcgYXMgZ2V0RGF0ZSB9IGZyb20gJy4vYmV0dGVyLWF1dGguQ1c2RDllU3gubWpzJztcbmltcG9ydCB7IGQgYXMgZGVsZXRlU2Vzc2lvbkNvb2tpZSwgcyBhcyBzZXRTZXNzaW9uQ29va2llLCBiIGFzIHNldENvb2tpZUNhY2hlIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5VZlZXQXJJQi5tanMnO1xuaW1wb3J0ICogYXMgeiBmcm9tICd6b2QvdjQnO1xuaW1wb3J0IHsgcyBhcyBzYWZlSlNPTlBhcnNlIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5CWlpLTjFnNy5tanMnO1xuaW1wb3J0IHsgY3JlYXRlSE1BQyB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9obWFjJztcbmltcG9ydCB7IGJhc2U2NFVybCB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9iYXNlNjQnO1xuaW1wb3J0IHsgYmluYXJ5IH0gZnJvbSAnQGJldHRlci1hdXRoL3V0aWxzL2JpbmFyeSc7XG5cbmNvbnN0IG9wdGlvbnNNaWRkbGV3YXJlID0gY3JlYXRlTWlkZGxld2FyZShhc3luYyAoKSA9PiB7XG4gIHJldHVybiB7fTtcbn0pO1xuY29uc3QgY3JlYXRlQXV0aE1pZGRsZXdhcmUgPSBjcmVhdGVNaWRkbGV3YXJlLmNyZWF0ZSh7XG4gIHVzZTogW1xuICAgIG9wdGlvbnNNaWRkbGV3YXJlLFxuICAgIC8qKlxuICAgICAqIE9ubHkgdXNlIGZvciBwb3N0IGhvb2tzXG4gICAgICovXG4gICAgY3JlYXRlTWlkZGxld2FyZShhc3luYyAoKSA9PiB7XG4gICAgICByZXR1cm4ge307XG4gICAgfSlcbiAgXVxufSk7XG5jb25zdCBjcmVhdGVBdXRoRW5kcG9pbnQgPSBjcmVhdGVFbmRwb2ludC5jcmVhdGUoe1xuICB1c2U6IFtvcHRpb25zTWlkZGxld2FyZV1cbn0pO1xuXG5jb25zdCBCQVNFX0VSUk9SX0NPREVTID0ge1xuICBVU0VSX05PVF9GT1VORDogXCJVc2VyIG5vdCBmb3VuZFwiLFxuICBGQUlMRURfVE9fQ1JFQVRFX1VTRVI6IFwiRmFpbGVkIHRvIGNyZWF0ZSB1c2VyXCIsXG4gIEZBSUxFRF9UT19DUkVBVEVfU0VTU0lPTjogXCJGYWlsZWQgdG8gY3JlYXRlIHNlc3Npb25cIixcbiAgRkFJTEVEX1RPX1VQREFURV9VU0VSOiBcIkZhaWxlZCB0byB1cGRhdGUgdXNlclwiLFxuICBGQUlMRURfVE9fR0VUX1NFU1NJT046IFwiRmFpbGVkIHRvIGdldCBzZXNzaW9uXCIsXG4gIElOVkFMSURfUEFTU1dPUkQ6IFwiSW52YWxpZCBwYXNzd29yZFwiLFxuICBJTlZBTElEX0VNQUlMOiBcIkludmFsaWQgZW1haWxcIixcbiAgSU5WQUxJRF9FTUFJTF9PUl9QQVNTV09SRDogXCJJbnZhbGlkIGVtYWlsIG9yIHBhc3N3b3JkXCIsXG4gIFNPQ0lBTF9BQ0NPVU5UX0FMUkVBRFlfTElOS0VEOiBcIlNvY2lhbCBhY2NvdW50IGFscmVhZHkgbGlua2VkXCIsXG4gIFBST1ZJREVSX05PVF9GT1VORDogXCJQcm92aWRlciBub3QgZm91bmRcIixcbiAgSU5WQUxJRF9UT0tFTjogXCJJbnZhbGlkIHRva2VuXCIsXG4gIElEX1RPS0VOX05PVF9TVVBQT1JURUQ6IFwiaWRfdG9rZW4gbm90IHN1cHBvcnRlZFwiLFxuICBGQUlMRURfVE9fR0VUX1VTRVJfSU5GTzogXCJGYWlsZWQgdG8gZ2V0IHVzZXIgaW5mb1wiLFxuICBVU0VSX0VNQUlMX05PVF9GT1VORDogXCJVc2VyIGVtYWlsIG5vdCBmb3VuZFwiLFxuICBFTUFJTF9OT1RfVkVSSUZJRUQ6IFwiRW1haWwgbm90IHZlcmlmaWVkXCIsXG4gIFBBU1NXT1JEX1RPT19TSE9SVDogXCJQYXNzd29yZCB0b28gc2hvcnRcIixcbiAgUEFTU1dPUkRfVE9PX0xPTkc6IFwiUGFzc3dvcmQgdG9vIGxvbmdcIixcbiAgVVNFUl9BTFJFQURZX0VYSVNUUzogXCJVc2VyIGFscmVhZHkgZXhpc3RzLiBVc2UgYW5vdGhlciBlbWFpbC5cIixcbiAgRU1BSUxfQ0FOX05PVF9CRV9VUERBVEVEOiBcIkVtYWlsIGNhbiBub3QgYmUgdXBkYXRlZFwiLFxuICBDUkVERU5USUFMX0FDQ09VTlRfTk9UX0ZPVU5EOiBcIkNyZWRlbnRpYWwgYWNjb3VudCBub3QgZm91bmRcIixcbiAgU0VTU0lPTl9FWFBJUkVEOiBcIlNlc3Npb24gZXhwaXJlZC4gUmUtYXV0aGVudGljYXRlIHRvIHBlcmZvcm0gdGhpcyBhY3Rpb24uXCIsXG4gIEZBSUxFRF9UT19VTkxJTktfTEFTVF9BQ0NPVU5UOiBcIllvdSBjYW4ndCB1bmxpbmsgeW91ciBsYXN0IGFjY291bnRcIixcbiAgQUNDT1VOVF9OT1RfRk9VTkQ6IFwiQWNjb3VudCBub3QgZm91bmRcIixcbiAgVVNFUl9BTFJFQURZX0hBU19QQVNTV09SRDogXCJVc2VyIGFscmVhZHkgaGFzIGEgcGFzc3dvcmQuIFByb3ZpZGUgdGhhdCB0byBkZWxldGUgdGhlIGFjY291bnQuXCJcbn07XG5cbmNvbnN0IGdldFNlc3Npb25RdWVyeVNjaGVtYSA9IHoub3B0aW9uYWwoXG4gIHoub2JqZWN0KHtcbiAgICAvKipcbiAgICAgKiBJZiBjb29raWUgY2FjaGUgaXMgZW5hYmxlZCwgaXQgd2lsbCBkaXNhYmxlIHRoZSBjYWNoZVxuICAgICAqIGFuZCBmZXRjaCB0aGUgc2Vzc2lvbiBmcm9tIHRoZSBkYXRhYmFzZVxuICAgICAqL1xuICAgIGRpc2FibGVDb29raWVDYWNoZTogei5jb2VyY2UuYm9vbGVhbigpLm1ldGEoe1xuICAgICAgZGVzY3JpcHRpb246IFwiRGlzYWJsZSBjb29raWUgY2FjaGUgYW5kIGZldGNoIHNlc3Npb24gZnJvbSBkYXRhYmFzZVwiXG4gICAgfSkub3B0aW9uYWwoKSxcbiAgICBkaXNhYmxlUmVmcmVzaDogei5jb2VyY2UuYm9vbGVhbigpLm1ldGEoe1xuICAgICAgZGVzY3JpcHRpb246IFwiRGlzYWJsZSBzZXNzaW9uIHJlZnJlc2guIFVzZWZ1bCBmb3IgY2hlY2tpbmcgc2Vzc2lvbiBzdGF0dXMsIHdpdGhvdXQgdXBkYXRpbmcgdGhlIHNlc3Npb25cIlxuICAgIH0pLm9wdGlvbmFsKClcbiAgfSlcbik7XG5jb25zdCBnZXRTZXNzaW9uID0gKCkgPT4gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9nZXQtc2Vzc2lvblwiLFxuICB7XG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIHF1ZXJ5OiBnZXRTZXNzaW9uUXVlcnlTY2hlbWEsXG4gICAgcmVxdWlyZUhlYWRlcnM6IHRydWUsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiR2V0IHRoZSBjdXJyZW50IHNlc3Npb25cIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJvYmplY3RcIixcbiAgICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgICAgc2Vzc2lvbjoge1xuICAgICAgICAgICAgICAgICAgICAgICRyZWY6IFwiIy9jb21wb25lbnRzL3NjaGVtYXMvU2Vzc2lvblwiXG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgICAgICAgICAkcmVmOiBcIiMvY29tcG9uZW50cy9zY2hlbWFzL1VzZXJcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInNlc3Npb25cIiwgXCJ1c2VyXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IHNlc3Npb25Db29raWVUb2tlbiA9IGF3YWl0IGN0eC5nZXRTaWduZWRDb29raWUoXG4gICAgICAgIGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25Ub2tlbi5uYW1lLFxuICAgICAgICBjdHguY29udGV4dC5zZWNyZXRcbiAgICAgICk7XG4gICAgICBpZiAoIXNlc3Npb25Db29raWVUb2tlbikge1xuICAgICAgICByZXR1cm4gbnVsbDtcbiAgICAgIH1cbiAgICAgIGNvbnN0IHNlc3Npb25EYXRhQ29va2llID0gY3R4LmdldENvb2tpZShcbiAgICAgICAgY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvbkRhdGEubmFtZVxuICAgICAgKTtcbiAgICAgIGNvbnN0IHNlc3Npb25EYXRhUGF5bG9hZCA9IHNlc3Npb25EYXRhQ29va2llID8gc2FmZUpTT05QYXJzZShiaW5hcnkuZGVjb2RlKGJhc2U2NFVybC5kZWNvZGUoc2Vzc2lvbkRhdGFDb29raWUpKSkgOiBudWxsO1xuICAgICAgaWYgKHNlc3Npb25EYXRhUGF5bG9hZCkge1xuICAgICAgICBjb25zdCBpc1ZhbGlkID0gYXdhaXQgY3JlYXRlSE1BQyhcIlNIQS0yNTZcIiwgXCJiYXNlNjR1cmxub3BhZFwiKS52ZXJpZnkoXG4gICAgICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgICAgIC4uLnNlc3Npb25EYXRhUGF5bG9hZC5zZXNzaW9uLFxuICAgICAgICAgICAgZXhwaXJlc0F0OiBzZXNzaW9uRGF0YVBheWxvYWQuZXhwaXJlc0F0XG4gICAgICAgICAgfSksXG4gICAgICAgICAgc2Vzc2lvbkRhdGFQYXlsb2FkLnNpZ25hdHVyZVxuICAgICAgICApO1xuICAgICAgICBpZiAoIWlzVmFsaWQpIHtcbiAgICAgICAgICBjb25zdCBkYXRhQ29va2llID0gY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvbkRhdGEubmFtZTtcbiAgICAgICAgICBjdHguc2V0Q29va2llKGRhdGFDb29raWUsIFwiXCIsIHtcbiAgICAgICAgICAgIG1heEFnZTogMFxuICAgICAgICAgIH0pO1xuICAgICAgICAgIHJldHVybiBjdHguanNvbihudWxsKTtcbiAgICAgICAgfVxuICAgICAgfVxuICAgICAgY29uc3QgZG9udFJlbWVtYmVyTWUgPSBhd2FpdCBjdHguZ2V0U2lnbmVkQ29va2llKFxuICAgICAgICBjdHguY29udGV4dC5hdXRoQ29va2llcy5kb250UmVtZW1iZXJUb2tlbi5uYW1lLFxuICAgICAgICBjdHguY29udGV4dC5zZWNyZXRcbiAgICAgICk7XG4gICAgICBpZiAoc2Vzc2lvbkRhdGFQYXlsb2FkPy5zZXNzaW9uICYmIGN0eC5jb250ZXh0Lm9wdGlvbnMuc2Vzc2lvbj8uY29va2llQ2FjaGU/LmVuYWJsZWQgJiYgIWN0eC5xdWVyeT8uZGlzYWJsZUNvb2tpZUNhY2hlKSB7XG4gICAgICAgIGNvbnN0IHNlc3Npb24yID0gc2Vzc2lvbkRhdGFQYXlsb2FkLnNlc3Npb247XG4gICAgICAgIGNvbnN0IGhhc0V4cGlyZWQgPSBzZXNzaW9uRGF0YVBheWxvYWQuZXhwaXJlc0F0IDwgRGF0ZS5ub3coKSB8fCBzZXNzaW9uMi5zZXNzaW9uLmV4cGlyZXNBdCA8IC8qIEBfX1BVUkVfXyAqLyBuZXcgRGF0ZSgpO1xuICAgICAgICBpZiAoIWhhc0V4cGlyZWQpIHtcbiAgICAgICAgICBjdHguY29udGV4dC5zZXNzaW9uID0gc2Vzc2lvbjI7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKFxuICAgICAgICAgICAgc2Vzc2lvbjJcbiAgICAgICAgICApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGNvbnN0IGRhdGFDb29raWUgPSBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uRGF0YS5uYW1lO1xuICAgICAgICAgIGN0eC5zZXRDb29raWUoZGF0YUNvb2tpZSwgXCJcIiwge1xuICAgICAgICAgICAgbWF4QWdlOiAwXG4gICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFNlc3Npb24oc2Vzc2lvbkNvb2tpZVRva2VuKTtcbiAgICAgIGN0eC5jb250ZXh0LnNlc3Npb24gPSBzZXNzaW9uO1xuICAgICAgaWYgKCFzZXNzaW9uIHx8IHNlc3Npb24uc2Vzc2lvbi5leHBpcmVzQXQgPCAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKSkge1xuICAgICAgICBkZWxldGVTZXNzaW9uQ29va2llKGN0eCk7XG4gICAgICAgIGlmIChzZXNzaW9uKSB7XG4gICAgICAgICAgYXdhaXQgY3R4LmNvbnRleHQuaW50ZXJuYWxBZGFwdGVyLmRlbGV0ZVNlc3Npb24oXG4gICAgICAgICAgICBzZXNzaW9uLnNlc3Npb24udG9rZW5cbiAgICAgICAgICApO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjdHguanNvbihudWxsKTtcbiAgICAgIH1cbiAgICAgIGlmIChkb250UmVtZW1iZXJNZSB8fCBjdHgucXVlcnk/LmRpc2FibGVSZWZyZXNoKSB7XG4gICAgICAgIHJldHVybiBjdHguanNvbihcbiAgICAgICAgICBzZXNzaW9uXG4gICAgICAgICk7XG4gICAgICB9XG4gICAgICBjb25zdCBleHBpcmVzSW4gPSBjdHguY29udGV4dC5zZXNzaW9uQ29uZmlnLmV4cGlyZXNJbjtcbiAgICAgIGNvbnN0IHVwZGF0ZUFnZSA9IGN0eC5jb250ZXh0LnNlc3Npb25Db25maWcudXBkYXRlQWdlO1xuICAgICAgY29uc3Qgc2Vzc2lvbklzRHVlVG9CZVVwZGF0ZWREYXRlID0gc2Vzc2lvbi5zZXNzaW9uLmV4cGlyZXNBdC52YWx1ZU9mKCkgLSBleHBpcmVzSW4gKiAxZTMgKyB1cGRhdGVBZ2UgKiAxZTM7XG4gICAgICBjb25zdCBzaG91bGRCZVVwZGF0ZWQgPSBzZXNzaW9uSXNEdWVUb0JlVXBkYXRlZERhdGUgPD0gRGF0ZS5ub3coKTtcbiAgICAgIGlmIChzaG91bGRCZVVwZGF0ZWQgJiYgKCFjdHgucXVlcnk/LmRpc2FibGVSZWZyZXNoIHx8ICFjdHguY29udGV4dC5vcHRpb25zLnNlc3Npb24/LmRpc2FibGVTZXNzaW9uUmVmcmVzaCkpIHtcbiAgICAgICAgY29uc3QgdXBkYXRlZFNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIudXBkYXRlU2Vzc2lvbihcbiAgICAgICAgICBzZXNzaW9uLnNlc3Npb24udG9rZW4sXG4gICAgICAgICAge1xuICAgICAgICAgICAgZXhwaXJlc0F0OiBnZXREYXRlKGN0eC5jb250ZXh0LnNlc3Npb25Db25maWcuZXhwaXJlc0luLCBcInNlY1wiKSxcbiAgICAgICAgICAgIHVwZGF0ZWRBdDogLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKClcbiAgICAgICAgICB9XG4gICAgICAgICk7XG4gICAgICAgIGlmICghdXBkYXRlZFNlc3Npb24pIHtcbiAgICAgICAgICBkZWxldGVTZXNzaW9uQ29va2llKGN0eCk7XG4gICAgICAgICAgcmV0dXJuIGN0eC5qc29uKG51bGwsIHsgc3RhdHVzOiA0MDEgfSk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgbWF4QWdlID0gKHVwZGF0ZWRTZXNzaW9uLmV4cGlyZXNBdC52YWx1ZU9mKCkgLSBEYXRlLm5vdygpKSAvIDFlMztcbiAgICAgICAgYXdhaXQgc2V0U2Vzc2lvbkNvb2tpZShcbiAgICAgICAgICBjdHgsXG4gICAgICAgICAge1xuICAgICAgICAgICAgc2Vzc2lvbjogdXBkYXRlZFNlc3Npb24sXG4gICAgICAgICAgICB1c2VyOiBzZXNzaW9uLnVzZXJcbiAgICAgICAgICB9LFxuICAgICAgICAgIGZhbHNlLFxuICAgICAgICAgIHtcbiAgICAgICAgICAgIG1heEFnZVxuICAgICAgICAgIH1cbiAgICAgICAgKTtcbiAgICAgICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgICAgICBzZXNzaW9uOiB1cGRhdGVkU2Vzc2lvbixcbiAgICAgICAgICB1c2VyOiBzZXNzaW9uLnVzZXJcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgICBhd2FpdCBzZXRDb29raWVDYWNoZShjdHgsIHNlc3Npb24pO1xuICAgICAgcmV0dXJuIGN0eC5qc29uKFxuICAgICAgICBzZXNzaW9uXG4gICAgICApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIiwgZXJyb3IpO1xuICAgICAgdGhyb3cgbmV3IEFQSUVycm9yKFwiSU5URVJOQUxfU0VSVkVSX0VSUk9SXCIsIHtcbiAgICAgICAgbWVzc2FnZTogQkFTRV9FUlJPUl9DT0RFUy5GQUlMRURfVE9fR0VUX1NFU1NJT05cbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuKTtcbmNvbnN0IGdldFNlc3Npb25Gcm9tQ3R4ID0gYXN5bmMgKGN0eCwgY29uZmlnKSA9PiB7XG4gIGlmIChjdHguY29udGV4dC5zZXNzaW9uKSB7XG4gICAgcmV0dXJuIGN0eC5jb250ZXh0LnNlc3Npb247XG4gIH1cbiAgY29uc3Qgc2Vzc2lvbiA9IGF3YWl0IGdldFNlc3Npb24oKSh7XG4gICAgLi4uY3R4LFxuICAgIGFzUmVzcG9uc2U6IGZhbHNlLFxuICAgIGhlYWRlcnM6IGN0eC5oZWFkZXJzLFxuICAgIHJldHVybkhlYWRlcnM6IGZhbHNlLFxuICAgIHF1ZXJ5OiB7XG4gICAgICAuLi5jb25maWcsXG4gICAgICAuLi5jdHgucXVlcnlcbiAgICB9XG4gIH0pLmNhdGNoKChlKSA9PiB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH0pO1xuICBjdHguY29udGV4dC5zZXNzaW9uID0gc2Vzc2lvbjtcbiAgcmV0dXJuIHNlc3Npb247XG59O1xuY29uc3Qgc2Vzc2lvbk1pZGRsZXdhcmUgPSBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICBpZiAoIXNlc3Npb24/LnNlc3Npb24pIHtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIik7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBzZXNzaW9uXG4gIH07XG59KTtcbmNvbnN0IHJlcXVlc3RPbmx5U2Vzc2lvbk1pZGRsZXdhcmUgPSBjcmVhdGVBdXRoTWlkZGxld2FyZShcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICAgIGlmICghc2Vzc2lvbj8uc2Vzc2lvbiAmJiAoY3R4LnJlcXVlc3QgfHwgY3R4LmhlYWRlcnMpKSB7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIik7XG4gICAgfVxuICAgIHJldHVybiB7IHNlc3Npb24gfTtcbiAgfVxuKTtcbmNvbnN0IGZyZXNoU2Vzc2lvbk1pZGRsZXdhcmUgPSBjcmVhdGVBdXRoTWlkZGxld2FyZShhc3luYyAoY3R4KSA9PiB7XG4gIGNvbnN0IHNlc3Npb24gPSBhd2FpdCBnZXRTZXNzaW9uRnJvbUN0eChjdHgpO1xuICBpZiAoIXNlc3Npb24/LnNlc3Npb24pIHtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJVTkFVVEhPUklaRURcIik7XG4gIH1cbiAgaWYgKGN0eC5jb250ZXh0LnNlc3Npb25Db25maWcuZnJlc2hBZ2UgPT09IDApIHtcbiAgICByZXR1cm4ge1xuICAgICAgc2Vzc2lvblxuICAgIH07XG4gIH1cbiAgY29uc3QgZnJlc2hBZ2UgPSBjdHguY29udGV4dC5zZXNzaW9uQ29uZmlnLmZyZXNoQWdlO1xuICBjb25zdCBsYXN0VXBkYXRlZCA9IHNlc3Npb24uc2Vzc2lvbi51cGRhdGVkQXQ/LnZhbHVlT2YoKSB8fCBzZXNzaW9uLnNlc3Npb24uY3JlYXRlZEF0LnZhbHVlT2YoKTtcbiAgY29uc3Qgbm93ID0gRGF0ZS5ub3coKTtcbiAgY29uc3QgaXNGcmVzaCA9IG5vdyAtIGxhc3RVcGRhdGVkIDwgZnJlc2hBZ2UgKiAxZTM7XG4gIGlmICghaXNGcmVzaCkge1xuICAgIHRocm93IG5ldyBBUElFcnJvcihcIkZPUkJJRERFTlwiLCB7XG4gICAgICBtZXNzYWdlOiBcIlNlc3Npb24gaXMgbm90IGZyZXNoXCJcbiAgICB9KTtcbiAgfVxuICByZXR1cm4ge1xuICAgIHNlc3Npb25cbiAgfTtcbn0pO1xuY29uc3QgbGlzdFNlc3Npb25zID0gKCkgPT4gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9saXN0LXNlc3Npb25zXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiR0VUXCIsXG4gICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIkxpc3QgYWxsIGFjdGl2ZSBzZXNzaW9ucyBmb3IgdGhlIHVzZXJcIixcbiAgICAgICAgcmVzcG9uc2VzOiB7XG4gICAgICAgICAgXCIyMDBcIjoge1xuICAgICAgICAgICAgZGVzY3JpcHRpb246IFwiU3VjY2Vzc1wiLFxuICAgICAgICAgICAgY29udGVudDoge1xuICAgICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICAgIHNjaGVtYToge1xuICAgICAgICAgICAgICAgICAgdHlwZTogXCJhcnJheVwiLFxuICAgICAgICAgICAgICAgICAgaXRlbXM6IHtcbiAgICAgICAgICAgICAgICAgICAgJHJlZjogXCIjL2NvbXBvbmVudHMvc2NoZW1hcy9TZXNzaW9uXCJcbiAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9XG4gIH0sXG4gIGFzeW5jIChjdHgpID0+IHtcbiAgICB0cnkge1xuICAgICAgY29uc3Qgc2Vzc2lvbnMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIubGlzdFNlc3Npb25zKFxuICAgICAgICBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuaWRcbiAgICAgICk7XG4gICAgICBjb25zdCBhY3RpdmVTZXNzaW9ucyA9IHNlc3Npb25zLmZpbHRlcigoc2Vzc2lvbikgPT4ge1xuICAgICAgICByZXR1cm4gc2Vzc2lvbi5leHBpcmVzQXQgPiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKTtcbiAgICAgIH0pO1xuICAgICAgcmV0dXJuIGN0eC5qc29uKFxuICAgICAgICBhY3RpdmVTZXNzaW9uc1xuICAgICAgKTtcbiAgICB9IGNhdGNoIChlKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoZSk7XG4gICAgICB0aHJvdyBjdHguZXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIik7XG4gICAgfVxuICB9XG4pO1xuY29uc3QgcmV2b2tlU2Vzc2lvbiA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvcmV2b2tlLXNlc3Npb25cIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgYm9keTogei5vYmplY3Qoe1xuICAgICAgdG9rZW46IHouc3RyaW5nKCkubWV0YSh7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB0b2tlbiB0byByZXZva2VcIlxuICAgICAgfSlcbiAgICB9KSxcbiAgICB1c2U6IFtzZXNzaW9uTWlkZGxld2FyZV0sXG4gICAgcmVxdWlyZUhlYWRlcnM6IHRydWUsXG4gICAgbWV0YWRhdGE6IHtcbiAgICAgIG9wZW5hcGk6IHtcbiAgICAgICAgZGVzY3JpcHRpb246IFwiUmV2b2tlIGEgc2luZ2xlIHNlc3Npb25cIixcbiAgICAgICAgcmVxdWVzdEJvZHk6IHtcbiAgICAgICAgICBjb250ZW50OiB7XG4gICAgICAgICAgICBcImFwcGxpY2F0aW9uL2pzb25cIjoge1xuICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICB0eXBlOiBcIm9iamVjdFwiLFxuICAgICAgICAgICAgICAgIHByb3BlcnRpZXM6IHtcbiAgICAgICAgICAgICAgICAgIHRva2VuOiB7XG4gICAgICAgICAgICAgICAgICAgIHR5cGU6IFwic3RyaW5nXCIsXG4gICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlRoZSB0b2tlbiB0byByZXZva2VcIlxuICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInRva2VuXCJdXG4gICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0sXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluZGljYXRlcyBpZiB0aGUgc2Vzc2lvbiB3YXMgcmV2b2tlZCBzdWNjZXNzZnVsbHlcIlxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgcmVxdWlyZWQ6IFtcInN0YXR1c1wiXVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfSxcbiAgYXN5bmMgKGN0eCkgPT4ge1xuICAgIGNvbnN0IHRva2VuID0gY3R4LmJvZHkudG9rZW47XG4gICAgY29uc3QgZmluZFNlc3Npb24gPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZFNlc3Npb24odG9rZW4pO1xuICAgIGlmICghZmluZFNlc3Npb24pIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogXCJTZXNzaW9uIG5vdCBmb3VuZFwiXG4gICAgICB9KTtcbiAgICB9XG4gICAgaWYgKGZpbmRTZXNzaW9uLnNlc3Npb24udXNlcklkICE9PSBjdHguY29udGV4dC5zZXNzaW9uLnVzZXIuaWQpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiKTtcbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9uKHRva2VuKTtcbiAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgY3R4LmNvbnRleHQubG9nZ2VyLmVycm9yKFxuICAgICAgICBlcnJvciAmJiB0eXBlb2YgZXJyb3IgPT09IFwib2JqZWN0XCIgJiYgXCJuYW1lXCIgaW4gZXJyb3IgPyBlcnJvci5uYW1lIDogXCJcIixcbiAgICAgICAgZXJyb3JcbiAgICAgICk7XG4gICAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJJTlRFUk5BTF9TRVJWRVJfRVJST1JcIik7XG4gICAgfVxuICAgIHJldHVybiBjdHguanNvbih7XG4gICAgICBzdGF0dXM6IHRydWVcbiAgICB9KTtcbiAgfVxuKTtcbmNvbnN0IHJldm9rZVNlc3Npb25zID0gY3JlYXRlQXV0aEVuZHBvaW50KFxuICBcIi9yZXZva2Utc2Vzc2lvbnNcIixcbiAge1xuICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgdXNlOiBbc2Vzc2lvbk1pZGRsZXdhcmVdLFxuICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlLFxuICAgIG1ldGFkYXRhOiB7XG4gICAgICBvcGVuYXBpOiB7XG4gICAgICAgIGRlc2NyaXB0aW9uOiBcIlJldm9rZSBhbGwgc2Vzc2lvbnMgZm9yIHRoZSB1c2VyXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluZGljYXRlcyBpZiBhbGwgc2Vzc2lvbnMgd2VyZSByZXZva2VkIHN1Y2Nlc3NmdWxseVwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wic3RhdHVzXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgdHJ5IHtcbiAgICAgIGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9ucyhcbiAgICAgICAgY3R4LmNvbnRleHQuc2Vzc2lvbi51c2VyLmlkXG4gICAgICApO1xuICAgIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgICBjdHguY29udGV4dC5sb2dnZXIuZXJyb3IoXG4gICAgICAgIGVycm9yICYmIHR5cGVvZiBlcnJvciA9PT0gXCJvYmplY3RcIiAmJiBcIm5hbWVcIiBpbiBlcnJvciA/IGVycm9yLm5hbWUgOiBcIlwiLFxuICAgICAgICBlcnJvclxuICAgICAgKTtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIklOVEVSTkFMX1NFUlZFUl9FUlJPUlwiKTtcbiAgICB9XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN0YXR1czogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xuY29uc3QgcmV2b2tlT3RoZXJTZXNzaW9ucyA9IGNyZWF0ZUF1dGhFbmRwb2ludChcbiAgXCIvcmV2b2tlLW90aGVyLXNlc3Npb25zXCIsXG4gIHtcbiAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgIHJlcXVpcmVIZWFkZXJzOiB0cnVlLFxuICAgIHVzZTogW3Nlc3Npb25NaWRkbGV3YXJlXSxcbiAgICBtZXRhZGF0YToge1xuICAgICAgb3BlbmFwaToge1xuICAgICAgICBkZXNjcmlwdGlvbjogXCJSZXZva2UgYWxsIG90aGVyIHNlc3Npb25zIGZvciB0aGUgdXNlciBleGNlcHQgdGhlIGN1cnJlbnQgb25lXCIsXG4gICAgICAgIHJlc3BvbnNlczoge1xuICAgICAgICAgIFwiMjAwXCI6IHtcbiAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIlN1Y2Nlc3NcIixcbiAgICAgICAgICAgIGNvbnRlbnQ6IHtcbiAgICAgICAgICAgICAgXCJhcHBsaWNhdGlvbi9qc29uXCI6IHtcbiAgICAgICAgICAgICAgICBzY2hlbWE6IHtcbiAgICAgICAgICAgICAgICAgIHR5cGU6IFwib2JqZWN0XCIsXG4gICAgICAgICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgICAgICAgIHN0YXR1czoge1xuICAgICAgICAgICAgICAgICAgICAgIHR5cGU6IFwiYm9vbGVhblwiLFxuICAgICAgICAgICAgICAgICAgICAgIGRlc2NyaXB0aW9uOiBcIkluZGljYXRlcyBpZiBhbGwgb3RoZXIgc2Vzc2lvbnMgd2VyZSByZXZva2VkIHN1Y2Nlc3NmdWxseVwiXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICByZXF1aXJlZDogW1wic3RhdHVzXCJdXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9LFxuICBhc3luYyAoY3R4KSA9PiB7XG4gICAgY29uc3Qgc2Vzc2lvbiA9IGN0eC5jb250ZXh0LnNlc3Npb247XG4gICAgaWYgKCFzZXNzaW9uLnVzZXIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIlVOQVVUSE9SSVpFRFwiKTtcbiAgICB9XG4gICAgY29uc3Qgc2Vzc2lvbnMgPSBhd2FpdCBjdHguY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIubGlzdFNlc3Npb25zKFxuICAgICAgc2Vzc2lvbi51c2VyLmlkXG4gICAgKTtcbiAgICBjb25zdCBhY3RpdmVTZXNzaW9ucyA9IHNlc3Npb25zLmZpbHRlcigoc2Vzc2lvbjIpID0+IHtcbiAgICAgIHJldHVybiBzZXNzaW9uMi5leHBpcmVzQXQgPiAvKiBAX19QVVJFX18gKi8gbmV3IERhdGUoKTtcbiAgICB9KTtcbiAgICBjb25zdCBvdGhlclNlc3Npb25zID0gYWN0aXZlU2Vzc2lvbnMuZmlsdGVyKFxuICAgICAgKHNlc3Npb24yKSA9PiBzZXNzaW9uMi50b2tlbiAhPT0gY3R4LmNvbnRleHQuc2Vzc2lvbi5zZXNzaW9uLnRva2VuXG4gICAgKTtcbiAgICBhd2FpdCBQcm9taXNlLmFsbChcbiAgICAgIG90aGVyU2Vzc2lvbnMubWFwKFxuICAgICAgICAoc2Vzc2lvbjIpID0+IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5kZWxldGVTZXNzaW9uKHNlc3Npb24yLnRva2VuKVxuICAgICAgKVxuICAgICk7XG4gICAgcmV0dXJuIGN0eC5qc29uKHtcbiAgICAgIHN0YXR1czogdHJ1ZVxuICAgIH0pO1xuICB9XG4pO1xuXG5leHBvcnQgeyBCQVNFX0VSUk9SX0NPREVTIGFzIEIsIGNyZWF0ZUF1dGhFbmRwb2ludCBhcyBhLCBnZXRTZXNzaW9uIGFzIGIsIGNyZWF0ZUF1dGhNaWRkbGV3YXJlIGFzIGMsIHJldm9rZVNlc3Npb25zIGFzIGQsIHJldm9rZVNlc3Npb24gYXMgZSwgZnJlc2hTZXNzaW9uTWlkZGxld2FyZSBhcyBmLCBnZXRTZXNzaW9uRnJvbUN0eCBhcyBnLCBnZXRTZXNzaW9uUXVlcnlTY2hlbWEgYXMgaCwgcmVxdWVzdE9ubHlTZXNzaW9uTWlkZGxld2FyZSBhcyBpLCBsaXN0U2Vzc2lvbnMgYXMgbCwgb3B0aW9uc01pZGRsZXdhcmUgYXMgbywgcmV2b2tlT3RoZXJTZXNzaW9ucyBhcyByLCBzZXNzaW9uTWlkZGxld2FyZSBhcyBzIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.DV5EHeYG.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.Dcv8PS7T.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.Dcv8PS7T.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ accountSchema),\n/* harmony export */   b: () => (/* binding */ parseUserOutput),\n/* harmony export */   c: () => (/* binding */ coreSchema),\n/* harmony export */   d: () => (/* binding */ parseAccountOutput),\n/* harmony export */   e: () => (/* binding */ parseSessionOutput),\n/* harmony export */   f: () => (/* binding */ parseInputData),\n/* harmony export */   g: () => (/* binding */ getAllFields),\n/* harmony export */   h: () => (/* binding */ parseUserInput),\n/* harmony export */   i: () => (/* binding */ parseAdditionalUserInput),\n/* harmony export */   j: () => (/* binding */ parseAccountInput),\n/* harmony export */   k: () => (/* binding */ parseSessionInput),\n/* harmony export */   m: () => (/* binding */ mergeSchema),\n/* harmony export */   p: () => (/* binding */ parseOutputData),\n/* harmony export */   s: () => (/* binding */ sessionSchema),\n/* harmony export */   u: () => (/* binding */ userSchema),\n/* harmony export */   v: () => (/* binding */ verificationSchema)\n/* harmony export */ });\n/* harmony import */ var zod_v4__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! zod/v4 */ \"(rsc)/./node_modules/zod/v4/index.js\");\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n\n\n\nconst coreSchema = zod_v4__WEBPACK_IMPORTED_MODULE_0__.object({\n  id: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(),\n  createdAt: zod_v4__WEBPACK_IMPORTED_MODULE_0__.date().default(() => /* @__PURE__ */ new Date()),\n  updatedAt: zod_v4__WEBPACK_IMPORTED_MODULE_0__.date().default(() => /* @__PURE__ */ new Date())\n});\nconst accountSchema = coreSchema.extend({\n  providerId: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(),\n  accountId: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(),\n  userId: zod_v4__WEBPACK_IMPORTED_MODULE_0__.coerce.string(),\n  accessToken: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().nullish(),\n  refreshToken: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().nullish(),\n  idToken: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().nullish(),\n  /**\n   * Access token expires at\n   */\n  accessTokenExpiresAt: zod_v4__WEBPACK_IMPORTED_MODULE_0__.date().nullish(),\n  /**\n   * Refresh token expires at\n   */\n  refreshTokenExpiresAt: zod_v4__WEBPACK_IMPORTED_MODULE_0__.date().nullish(),\n  /**\n   * The scopes that the user has authorized\n   */\n  scope: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().nullish(),\n  /**\n   * Password is only stored in the credential provider\n   */\n  password: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().nullish()\n});\nconst userSchema = coreSchema.extend({\n  email: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().transform((val) => val.toLowerCase()),\n  emailVerified: zod_v4__WEBPACK_IMPORTED_MODULE_0__.boolean().default(false),\n  name: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(),\n  image: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().nullish()\n});\nconst sessionSchema = coreSchema.extend({\n  userId: zod_v4__WEBPACK_IMPORTED_MODULE_0__.coerce.string(),\n  expiresAt: zod_v4__WEBPACK_IMPORTED_MODULE_0__.date(),\n  token: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(),\n  ipAddress: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().nullish(),\n  userAgent: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string().nullish()\n});\nconst verificationSchema = coreSchema.extend({\n  value: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string(),\n  expiresAt: zod_v4__WEBPACK_IMPORTED_MODULE_0__.date(),\n  identifier: zod_v4__WEBPACK_IMPORTED_MODULE_0__.string()\n});\nfunction parseOutputData(data, schema) {\n  const fields = schema.fields;\n  const parsedData = {};\n  for (const key in data) {\n    const field = fields[key];\n    if (!field) {\n      parsedData[key] = data[key];\n      continue;\n    }\n    if (field.returned === false) {\n      continue;\n    }\n    parsedData[key] = data[key];\n  }\n  return parsedData;\n}\nfunction getAllFields(options, table) {\n  let schema = {\n    ...table === \"user\" ? options.user?.additionalFields : {},\n    ...table === \"session\" ? options.session?.additionalFields : {}\n  };\n  for (const plugin of options.plugins || []) {\n    if (plugin.schema && plugin.schema[table]) {\n      schema = {\n        ...schema,\n        ...plugin.schema[table].fields\n      };\n    }\n  }\n  return schema;\n}\nfunction parseUserOutput(options, user) {\n  const schema = getAllFields(options, \"user\");\n  return parseOutputData(user, { fields: schema });\n}\nfunction parseAccountOutput(options, account) {\n  const schema = getAllFields(options, \"account\");\n  return parseOutputData(account, { fields: schema });\n}\nfunction parseSessionOutput(options, session) {\n  const schema = getAllFields(options, \"session\");\n  return parseOutputData(session, { fields: schema });\n}\nfunction parseInputData(data, schema) {\n  const action = schema.action || \"create\";\n  const fields = schema.fields;\n  const parsedData = {};\n  for (const key in fields) {\n    if (key in data) {\n      if (fields[key].input === false) {\n        if (fields[key].defaultValue) {\n          parsedData[key] = fields[key].defaultValue;\n          continue;\n        }\n        continue;\n      }\n      if (fields[key].validator?.input && data[key] !== void 0) {\n        parsedData[key] = fields[key].validator.input.parse(data[key]);\n        continue;\n      }\n      if (fields[key].transform?.input && data[key] !== void 0) {\n        parsedData[key] = fields[key].transform?.input(data[key]);\n        continue;\n      }\n      parsedData[key] = data[key];\n      continue;\n    }\n    if (fields[key].defaultValue && action === \"create\") {\n      parsedData[key] = fields[key].defaultValue;\n      continue;\n    }\n    if (fields[key].required && action === \"create\") {\n      throw new better_call__WEBPACK_IMPORTED_MODULE_1__.APIError(\"BAD_REQUEST\", {\n        message: `${key} is required`\n      });\n    }\n  }\n  return parsedData;\n}\nfunction parseUserInput(options, user, action) {\n  const schema = getAllFields(options, \"user\");\n  return parseInputData(user || {}, { fields: schema, action });\n}\nfunction parseAdditionalUserInput(options, user) {\n  const schema = getAllFields(options, \"user\");\n  return parseInputData(user || {}, { fields: schema });\n}\nfunction parseAccountInput(options, account) {\n  const schema = getAllFields(options, \"account\");\n  return parseInputData(account, { fields: schema });\n}\nfunction parseSessionInput(options, session) {\n  const schema = getAllFields(options, \"session\");\n  return parseInputData(session, { fields: schema });\n}\nfunction mergeSchema(schema, newSchema) {\n  if (!newSchema) {\n    return schema;\n  }\n  for (const table in newSchema) {\n    const newModelName = newSchema[table]?.modelName;\n    if (newModelName) {\n      schema[table].modelName = newModelName;\n    }\n    for (const field in schema[table].fields) {\n      const newField = newSchema[table]?.fields?.[field];\n      if (!newField) {\n        continue;\n      }\n      schema[table].fields[field].fieldName = newField;\n    }\n  }\n  return schema;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguRGN2OFBTN1QubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUE0QjtBQUNXOztBQUV2QyxtQkFBbUIsMENBQVE7QUFDM0IsTUFBTSwwQ0FBUTtBQUNkLGFBQWEsd0NBQU07QUFDbkIsYUFBYSx3Q0FBTTtBQUNuQixDQUFDO0FBQ0Q7QUFDQSxjQUFjLDBDQUFRO0FBQ3RCLGFBQWEsMENBQVE7QUFDckIsVUFBVSxpREFBZTtBQUN6QixlQUFlLDBDQUFRO0FBQ3ZCLGdCQUFnQiwwQ0FBUTtBQUN4QixXQUFXLDBDQUFRO0FBQ25CO0FBQ0E7QUFDQTtBQUNBLHdCQUF3Qix3Q0FBTTtBQUM5QjtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsd0NBQU07QUFDL0I7QUFDQTtBQUNBO0FBQ0EsU0FBUywwQ0FBUTtBQUNqQjtBQUNBO0FBQ0E7QUFDQSxZQUFZLDBDQUFRO0FBQ3BCLENBQUM7QUFDRDtBQUNBLFNBQVMsMENBQVE7QUFDakIsaUJBQWlCLDJDQUFTO0FBQzFCLFFBQVEsMENBQVE7QUFDaEIsU0FBUywwQ0FBUTtBQUNqQixDQUFDO0FBQ0Q7QUFDQSxVQUFVLGlEQUFlO0FBQ3pCLGFBQWEsd0NBQU07QUFDbkIsU0FBUywwQ0FBUTtBQUNqQixhQUFhLDBDQUFRO0FBQ3JCLGFBQWEsMENBQVE7QUFDckIsQ0FBQztBQUNEO0FBQ0EsU0FBUywwQ0FBUTtBQUNqQixhQUFhLHdDQUFNO0FBQ25CLGNBQWMsMENBQVE7QUFDdEIsQ0FBQztBQUNEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDZEQUE2RDtBQUM3RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUNBQWlDLGdCQUFnQjtBQUNqRDtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsZ0JBQWdCO0FBQ3BEO0FBQ0E7QUFDQTtBQUNBLG9DQUFvQyxnQkFBZ0I7QUFDcEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLGlEQUFRO0FBQ3hCLG9CQUFvQixLQUFLO0FBQ3pCLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MsSUFBSSx3QkFBd0I7QUFDOUQ7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDLElBQUksZ0JBQWdCO0FBQ3REO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxnQkFBZ0I7QUFDbkQ7QUFDQTtBQUNBO0FBQ0EsbUNBQW1DLGdCQUFnQjtBQUNuRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUV5VyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcZGlzdFxcc2hhcmVkXFxiZXR0ZXItYXV0aC5EY3Y4UFM3VC5tanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgeiBmcm9tICd6b2QvdjQnO1xuaW1wb3J0IHsgQVBJRXJyb3IgfSBmcm9tICdiZXR0ZXItY2FsbCc7XG5cbmNvbnN0IGNvcmVTY2hlbWEgPSB6Lm9iamVjdCh7XG4gIGlkOiB6LnN0cmluZygpLFxuICBjcmVhdGVkQXQ6IHouZGF0ZSgpLmRlZmF1bHQoKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpLFxuICB1cGRhdGVkQXQ6IHouZGF0ZSgpLmRlZmF1bHQoKCkgPT4gLyogQF9fUFVSRV9fICovIG5ldyBEYXRlKCkpXG59KTtcbmNvbnN0IGFjY291bnRTY2hlbWEgPSBjb3JlU2NoZW1hLmV4dGVuZCh7XG4gIHByb3ZpZGVySWQ6IHouc3RyaW5nKCksXG4gIGFjY291bnRJZDogei5zdHJpbmcoKSxcbiAgdXNlcklkOiB6LmNvZXJjZS5zdHJpbmcoKSxcbiAgYWNjZXNzVG9rZW46IHouc3RyaW5nKCkubnVsbGlzaCgpLFxuICByZWZyZXNoVG9rZW46IHouc3RyaW5nKCkubnVsbGlzaCgpLFxuICBpZFRva2VuOiB6LnN0cmluZygpLm51bGxpc2goKSxcbiAgLyoqXG4gICAqIEFjY2VzcyB0b2tlbiBleHBpcmVzIGF0XG4gICAqL1xuICBhY2Nlc3NUb2tlbkV4cGlyZXNBdDogei5kYXRlKCkubnVsbGlzaCgpLFxuICAvKipcbiAgICogUmVmcmVzaCB0b2tlbiBleHBpcmVzIGF0XG4gICAqL1xuICByZWZyZXNoVG9rZW5FeHBpcmVzQXQ6IHouZGF0ZSgpLm51bGxpc2goKSxcbiAgLyoqXG4gICAqIFRoZSBzY29wZXMgdGhhdCB0aGUgdXNlciBoYXMgYXV0aG9yaXplZFxuICAgKi9cbiAgc2NvcGU6IHouc3RyaW5nKCkubnVsbGlzaCgpLFxuICAvKipcbiAgICogUGFzc3dvcmQgaXMgb25seSBzdG9yZWQgaW4gdGhlIGNyZWRlbnRpYWwgcHJvdmlkZXJcbiAgICovXG4gIHBhc3N3b3JkOiB6LnN0cmluZygpLm51bGxpc2goKVxufSk7XG5jb25zdCB1c2VyU2NoZW1hID0gY29yZVNjaGVtYS5leHRlbmQoe1xuICBlbWFpbDogei5zdHJpbmcoKS50cmFuc2Zvcm0oKHZhbCkgPT4gdmFsLnRvTG93ZXJDYXNlKCkpLFxuICBlbWFpbFZlcmlmaWVkOiB6LmJvb2xlYW4oKS5kZWZhdWx0KGZhbHNlKSxcbiAgbmFtZTogei5zdHJpbmcoKSxcbiAgaW1hZ2U6IHouc3RyaW5nKCkubnVsbGlzaCgpXG59KTtcbmNvbnN0IHNlc3Npb25TY2hlbWEgPSBjb3JlU2NoZW1hLmV4dGVuZCh7XG4gIHVzZXJJZDogei5jb2VyY2Uuc3RyaW5nKCksXG4gIGV4cGlyZXNBdDogei5kYXRlKCksXG4gIHRva2VuOiB6LnN0cmluZygpLFxuICBpcEFkZHJlc3M6IHouc3RyaW5nKCkubnVsbGlzaCgpLFxuICB1c2VyQWdlbnQ6IHouc3RyaW5nKCkubnVsbGlzaCgpXG59KTtcbmNvbnN0IHZlcmlmaWNhdGlvblNjaGVtYSA9IGNvcmVTY2hlbWEuZXh0ZW5kKHtcbiAgdmFsdWU6IHouc3RyaW5nKCksXG4gIGV4cGlyZXNBdDogei5kYXRlKCksXG4gIGlkZW50aWZpZXI6IHouc3RyaW5nKClcbn0pO1xuZnVuY3Rpb24gcGFyc2VPdXRwdXREYXRhKGRhdGEsIHNjaGVtYSkge1xuICBjb25zdCBmaWVsZHMgPSBzY2hlbWEuZmllbGRzO1xuICBjb25zdCBwYXJzZWREYXRhID0ge307XG4gIGZvciAoY29uc3Qga2V5IGluIGRhdGEpIHtcbiAgICBjb25zdCBmaWVsZCA9IGZpZWxkc1trZXldO1xuICAgIGlmICghZmllbGQpIHtcbiAgICAgIHBhcnNlZERhdGFba2V5XSA9IGRhdGFba2V5XTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoZmllbGQucmV0dXJuZWQgPT09IGZhbHNlKSB7XG4gICAgICBjb250aW51ZTtcbiAgICB9XG4gICAgcGFyc2VkRGF0YVtrZXldID0gZGF0YVtrZXldO1xuICB9XG4gIHJldHVybiBwYXJzZWREYXRhO1xufVxuZnVuY3Rpb24gZ2V0QWxsRmllbGRzKG9wdGlvbnMsIHRhYmxlKSB7XG4gIGxldCBzY2hlbWEgPSB7XG4gICAgLi4udGFibGUgPT09IFwidXNlclwiID8gb3B0aW9ucy51c2VyPy5hZGRpdGlvbmFsRmllbGRzIDoge30sXG4gICAgLi4udGFibGUgPT09IFwic2Vzc2lvblwiID8gb3B0aW9ucy5zZXNzaW9uPy5hZGRpdGlvbmFsRmllbGRzIDoge31cbiAgfTtcbiAgZm9yIChjb25zdCBwbHVnaW4gb2Ygb3B0aW9ucy5wbHVnaW5zIHx8IFtdKSB7XG4gICAgaWYgKHBsdWdpbi5zY2hlbWEgJiYgcGx1Z2luLnNjaGVtYVt0YWJsZV0pIHtcbiAgICAgIHNjaGVtYSA9IHtcbiAgICAgICAgLi4uc2NoZW1hLFxuICAgICAgICAuLi5wbHVnaW4uc2NoZW1hW3RhYmxlXS5maWVsZHNcbiAgICAgIH07XG4gICAgfVxuICB9XG4gIHJldHVybiBzY2hlbWE7XG59XG5mdW5jdGlvbiBwYXJzZVVzZXJPdXRwdXQob3B0aW9ucywgdXNlcikge1xuICBjb25zdCBzY2hlbWEgPSBnZXRBbGxGaWVsZHMob3B0aW9ucywgXCJ1c2VyXCIpO1xuICByZXR1cm4gcGFyc2VPdXRwdXREYXRhKHVzZXIsIHsgZmllbGRzOiBzY2hlbWEgfSk7XG59XG5mdW5jdGlvbiBwYXJzZUFjY291bnRPdXRwdXQob3B0aW9ucywgYWNjb3VudCkge1xuICBjb25zdCBzY2hlbWEgPSBnZXRBbGxGaWVsZHMob3B0aW9ucywgXCJhY2NvdW50XCIpO1xuICByZXR1cm4gcGFyc2VPdXRwdXREYXRhKGFjY291bnQsIHsgZmllbGRzOiBzY2hlbWEgfSk7XG59XG5mdW5jdGlvbiBwYXJzZVNlc3Npb25PdXRwdXQob3B0aW9ucywgc2Vzc2lvbikge1xuICBjb25zdCBzY2hlbWEgPSBnZXRBbGxGaWVsZHMob3B0aW9ucywgXCJzZXNzaW9uXCIpO1xuICByZXR1cm4gcGFyc2VPdXRwdXREYXRhKHNlc3Npb24sIHsgZmllbGRzOiBzY2hlbWEgfSk7XG59XG5mdW5jdGlvbiBwYXJzZUlucHV0RGF0YShkYXRhLCBzY2hlbWEpIHtcbiAgY29uc3QgYWN0aW9uID0gc2NoZW1hLmFjdGlvbiB8fCBcImNyZWF0ZVwiO1xuICBjb25zdCBmaWVsZHMgPSBzY2hlbWEuZmllbGRzO1xuICBjb25zdCBwYXJzZWREYXRhID0ge307XG4gIGZvciAoY29uc3Qga2V5IGluIGZpZWxkcykge1xuICAgIGlmIChrZXkgaW4gZGF0YSkge1xuICAgICAgaWYgKGZpZWxkc1trZXldLmlucHV0ID09PSBmYWxzZSkge1xuICAgICAgICBpZiAoZmllbGRzW2tleV0uZGVmYXVsdFZhbHVlKSB7XG4gICAgICAgICAgcGFyc2VkRGF0YVtrZXldID0gZmllbGRzW2tleV0uZGVmYXVsdFZhbHVlO1xuICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICB9XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKGZpZWxkc1trZXldLnZhbGlkYXRvcj8uaW5wdXQgJiYgZGF0YVtrZXldICE9PSB2b2lkIDApIHtcbiAgICAgICAgcGFyc2VkRGF0YVtrZXldID0gZmllbGRzW2tleV0udmFsaWRhdG9yLmlucHV0LnBhcnNlKGRhdGFba2V5XSk7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgaWYgKGZpZWxkc1trZXldLnRyYW5zZm9ybT8uaW5wdXQgJiYgZGF0YVtrZXldICE9PSB2b2lkIDApIHtcbiAgICAgICAgcGFyc2VkRGF0YVtrZXldID0gZmllbGRzW2tleV0udHJhbnNmb3JtPy5pbnB1dChkYXRhW2tleV0pO1xuICAgICAgICBjb250aW51ZTtcbiAgICAgIH1cbiAgICAgIHBhcnNlZERhdGFba2V5XSA9IGRhdGFba2V5XTtcbiAgICAgIGNvbnRpbnVlO1xuICAgIH1cbiAgICBpZiAoZmllbGRzW2tleV0uZGVmYXVsdFZhbHVlICYmIGFjdGlvbiA9PT0gXCJjcmVhdGVcIikge1xuICAgICAgcGFyc2VkRGF0YVtrZXldID0gZmllbGRzW2tleV0uZGVmYXVsdFZhbHVlO1xuICAgICAgY29udGludWU7XG4gICAgfVxuICAgIGlmIChmaWVsZHNba2V5XS5yZXF1aXJlZCAmJiBhY3Rpb24gPT09IFwiY3JlYXRlXCIpIHtcbiAgICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgICAgbWVzc2FnZTogYCR7a2V5fSBpcyByZXF1aXJlZGBcbiAgICAgIH0pO1xuICAgIH1cbiAgfVxuICByZXR1cm4gcGFyc2VkRGF0YTtcbn1cbmZ1bmN0aW9uIHBhcnNlVXNlcklucHV0KG9wdGlvbnMsIHVzZXIsIGFjdGlvbikge1xuICBjb25zdCBzY2hlbWEgPSBnZXRBbGxGaWVsZHMob3B0aW9ucywgXCJ1c2VyXCIpO1xuICByZXR1cm4gcGFyc2VJbnB1dERhdGEodXNlciB8fCB7fSwgeyBmaWVsZHM6IHNjaGVtYSwgYWN0aW9uIH0pO1xufVxuZnVuY3Rpb24gcGFyc2VBZGRpdGlvbmFsVXNlcklucHV0KG9wdGlvbnMsIHVzZXIpIHtcbiAgY29uc3Qgc2NoZW1hID0gZ2V0QWxsRmllbGRzKG9wdGlvbnMsIFwidXNlclwiKTtcbiAgcmV0dXJuIHBhcnNlSW5wdXREYXRhKHVzZXIgfHwge30sIHsgZmllbGRzOiBzY2hlbWEgfSk7XG59XG5mdW5jdGlvbiBwYXJzZUFjY291bnRJbnB1dChvcHRpb25zLCBhY2NvdW50KSB7XG4gIGNvbnN0IHNjaGVtYSA9IGdldEFsbEZpZWxkcyhvcHRpb25zLCBcImFjY291bnRcIik7XG4gIHJldHVybiBwYXJzZUlucHV0RGF0YShhY2NvdW50LCB7IGZpZWxkczogc2NoZW1hIH0pO1xufVxuZnVuY3Rpb24gcGFyc2VTZXNzaW9uSW5wdXQob3B0aW9ucywgc2Vzc2lvbikge1xuICBjb25zdCBzY2hlbWEgPSBnZXRBbGxGaWVsZHMob3B0aW9ucywgXCJzZXNzaW9uXCIpO1xuICByZXR1cm4gcGFyc2VJbnB1dERhdGEoc2Vzc2lvbiwgeyBmaWVsZHM6IHNjaGVtYSB9KTtcbn1cbmZ1bmN0aW9uIG1lcmdlU2NoZW1hKHNjaGVtYSwgbmV3U2NoZW1hKSB7XG4gIGlmICghbmV3U2NoZW1hKSB7XG4gICAgcmV0dXJuIHNjaGVtYTtcbiAgfVxuICBmb3IgKGNvbnN0IHRhYmxlIGluIG5ld1NjaGVtYSkge1xuICAgIGNvbnN0IG5ld01vZGVsTmFtZSA9IG5ld1NjaGVtYVt0YWJsZV0/Lm1vZGVsTmFtZTtcbiAgICBpZiAobmV3TW9kZWxOYW1lKSB7XG4gICAgICBzY2hlbWFbdGFibGVdLm1vZGVsTmFtZSA9IG5ld01vZGVsTmFtZTtcbiAgICB9XG4gICAgZm9yIChjb25zdCBmaWVsZCBpbiBzY2hlbWFbdGFibGVdLmZpZWxkcykge1xuICAgICAgY29uc3QgbmV3RmllbGQgPSBuZXdTY2hlbWFbdGFibGVdPy5maWVsZHM/LltmaWVsZF07XG4gICAgICBpZiAoIW5ld0ZpZWxkKSB7XG4gICAgICAgIGNvbnRpbnVlO1xuICAgICAgfVxuICAgICAgc2NoZW1hW3RhYmxlXS5maWVsZHNbZmllbGRdLmZpZWxkTmFtZSA9IG5ld0ZpZWxkO1xuICAgIH1cbiAgfVxuICByZXR1cm4gc2NoZW1hO1xufVxuXG5leHBvcnQgeyBhY2NvdW50U2NoZW1hIGFzIGEsIHBhcnNlVXNlck91dHB1dCBhcyBiLCBjb3JlU2NoZW1hIGFzIGMsIHBhcnNlQWNjb3VudE91dHB1dCBhcyBkLCBwYXJzZVNlc3Npb25PdXRwdXQgYXMgZSwgcGFyc2VJbnB1dERhdGEgYXMgZiwgZ2V0QWxsRmllbGRzIGFzIGcsIHBhcnNlVXNlcklucHV0IGFzIGgsIHBhcnNlQWRkaXRpb25hbFVzZXJJbnB1dCBhcyBpLCBwYXJzZUFjY291bnRJbnB1dCBhcyBqLCBwYXJzZVNlc3Npb25JbnB1dCBhcyBrLCBtZXJnZVNjaGVtYSBhcyBtLCBwYXJzZU91dHB1dERhdGEgYXMgcCwgc2Vzc2lvblNjaGVtYSBhcyBzLCB1c2VyU2NoZW1hIGFzIHUsIHZlcmlmaWNhdGlvblNjaGVtYSBhcyB2IH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.Dcv8PS7T.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.DdzSJf-n.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.DdzSJf-n.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   B: () => (/* binding */ BetterAuthError),\n/* harmony export */   M: () => (/* binding */ MissingDependencyError)\n/* harmony export */ });\nclass BetterAuthError extends Error {\n  constructor(message, cause) {\n    super(message);\n    this.name = \"BetterAuthError\";\n    this.message = message;\n    this.cause = cause;\n    this.stack = \"\";\n  }\n}\nclass MissingDependencyError extends BetterAuthError {\n  constructor(pkgName) {\n    super(\n      `The package \"${pkgName}\" is required. Make sure it is installed.`,\n      pkgName\n    );\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguRGR6U0pmLW4ubWpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLFFBQVE7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7O0FBRTZEIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxzaGFyZWRcXGJldHRlci1hdXRoLkRkelNKZi1uLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBCZXR0ZXJBdXRoRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UsIGNhdXNlKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5uYW1lID0gXCJCZXR0ZXJBdXRoRXJyb3JcIjtcbiAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIHRoaXMuY2F1c2UgPSBjYXVzZTtcbiAgICB0aGlzLnN0YWNrID0gXCJcIjtcbiAgfVxufVxuY2xhc3MgTWlzc2luZ0RlcGVuZGVuY3lFcnJvciBleHRlbmRzIEJldHRlckF1dGhFcnJvciB7XG4gIGNvbnN0cnVjdG9yKHBrZ05hbWUpIHtcbiAgICBzdXBlcihcbiAgICAgIGBUaGUgcGFja2FnZSBcIiR7cGtnTmFtZX1cIiBpcyByZXF1aXJlZC4gTWFrZSBzdXJlIGl0IGlzIGluc3RhbGxlZC5gLFxuICAgICAgcGtnTmFtZVxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IHsgQmV0dGVyQXV0aEVycm9yIGFzIEIsIE1pc3NpbmdEZXBlbmRlbmN5RXJyb3IgYXMgTSB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.DdzSJf-n.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.O2VtDkDK.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.O2VtDkDK.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   g: () => (/* binding */ getIp)\n/* harmony export */ });\n/* harmony import */ var _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./better-auth.CMQ3rA-I.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CMQ3rA-I.mjs\");\n\n\nfunction getIp(req, options) {\n  if (options.advanced?.ipAddress?.disableIpTracking) {\n    return null;\n  }\n  if ((0,_better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_0__.i)()) {\n    return \"127.0.0.1\";\n  }\n  const headers = \"headers\" in req ? req.headers : req;\n  const defaultHeaders = [\"x-forwarded-for\"];\n  const ipHeaders = options.advanced?.ipAddress?.ipAddressHeaders || defaultHeaders;\n  for (const key of ipHeaders) {\n    const value = \"get\" in headers ? headers.get(key) : headers[key];\n    if (typeof value === \"string\") {\n      const ip = value.split(\",\")[0].trim();\n      if (isValidIP(ip)) {\n        return ip;\n      }\n    }\n  }\n  return null;\n}\nfunction isValidIP(ip) {\n  const ipv4Regex = /^(\\d{1,3}\\.){3}\\d{1,3}$/;\n  if (ipv4Regex.test(ip)) {\n    const parts = ip.split(\".\").map(Number);\n    return parts.every((part) => part >= 0 && part <= 255);\n  }\n  const ipv6Regex = /^([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}$/;\n  return ipv6Regex.test(ip);\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguTzJWdERrREsubWpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQXlEOztBQUV6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLE1BQU0sNERBQU07QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLElBQUksSUFBSSxFQUFFLEdBQUcsSUFBSTtBQUMzQztBQUNBO0FBQ0E7QUFDQTtBQUNBLG1DQUFtQyxJQUFJLEdBQUcsRUFBRSxZQUFZLElBQUk7QUFDNUQ7QUFDQTs7QUFFc0IiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXGRpc3RcXHNoYXJlZFxcYmV0dGVyLWF1dGguTzJWdERrREsubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGkgYXMgaXNUZXN0IH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5DTVEzckEtSS5tanMnO1xuXG5mdW5jdGlvbiBnZXRJcChyZXEsIG9wdGlvbnMpIHtcbiAgaWYgKG9wdGlvbnMuYWR2YW5jZWQ/LmlwQWRkcmVzcz8uZGlzYWJsZUlwVHJhY2tpbmcpIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBpZiAoaXNUZXN0KCkpIHtcbiAgICByZXR1cm4gXCIxMjcuMC4wLjFcIjtcbiAgfVxuICBjb25zdCBoZWFkZXJzID0gXCJoZWFkZXJzXCIgaW4gcmVxID8gcmVxLmhlYWRlcnMgOiByZXE7XG4gIGNvbnN0IGRlZmF1bHRIZWFkZXJzID0gW1wieC1mb3J3YXJkZWQtZm9yXCJdO1xuICBjb25zdCBpcEhlYWRlcnMgPSBvcHRpb25zLmFkdmFuY2VkPy5pcEFkZHJlc3M/LmlwQWRkcmVzc0hlYWRlcnMgfHwgZGVmYXVsdEhlYWRlcnM7XG4gIGZvciAoY29uc3Qga2V5IG9mIGlwSGVhZGVycykge1xuICAgIGNvbnN0IHZhbHVlID0gXCJnZXRcIiBpbiBoZWFkZXJzID8gaGVhZGVycy5nZXQoa2V5KSA6IGhlYWRlcnNba2V5XTtcbiAgICBpZiAodHlwZW9mIHZhbHVlID09PSBcInN0cmluZ1wiKSB7XG4gICAgICBjb25zdCBpcCA9IHZhbHVlLnNwbGl0KFwiLFwiKVswXS50cmltKCk7XG4gICAgICBpZiAoaXNWYWxpZElQKGlwKSkge1xuICAgICAgICByZXR1cm4gaXA7XG4gICAgICB9XG4gICAgfVxuICB9XG4gIHJldHVybiBudWxsO1xufVxuZnVuY3Rpb24gaXNWYWxpZElQKGlwKSB7XG4gIGNvbnN0IGlwdjRSZWdleCA9IC9eKFxcZHsxLDN9XFwuKXszfVxcZHsxLDN9JC87XG4gIGlmIChpcHY0UmVnZXgudGVzdChpcCkpIHtcbiAgICBjb25zdCBwYXJ0cyA9IGlwLnNwbGl0KFwiLlwiKS5tYXAoTnVtYmVyKTtcbiAgICByZXR1cm4gcGFydHMuZXZlcnkoKHBhcnQpID0+IHBhcnQgPj0gMCAmJiBwYXJ0IDw9IDI1NSk7XG4gIH1cbiAgY29uc3QgaXB2NlJlZ2V4ID0gL14oWzAtOWEtZkEtRl17MSw0fTopezd9WzAtOWEtZkEtRl17MSw0fSQvO1xuICByZXR1cm4gaXB2NlJlZ2V4LnRlc3QoaXApO1xufVxuXG5leHBvcnQgeyBnZXRJcCBhcyBnIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.O2VtDkDK.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.UfVWArIB.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.UfVWArIB.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ parseCookies),\n/* harmony export */   b: () => (/* binding */ setCookieCache),\n/* harmony export */   c: () => (/* binding */ createCookieGetter),\n/* harmony export */   d: () => (/* binding */ deleteSessionCookie),\n/* harmony export */   e: () => (/* binding */ setCookieToHeader),\n/* harmony export */   f: () => (/* binding */ getSessionCookie),\n/* harmony export */   g: () => (/* binding */ getCookies),\n/* harmony export */   h: () => (/* binding */ getCookieCache),\n/* harmony export */   m: () => (/* binding */ ms),\n/* harmony export */   p: () => (/* binding */ parseSetCookieHeader),\n/* harmony export */   s: () => (/* binding */ setSessionCookie)\n/* harmony export */ });\n/* harmony import */ var _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./better-auth.DdzSJf-n.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.DdzSJf-n.mjs\");\n/* harmony import */ var _better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./better-auth.CW6D9eSx.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CW6D9eSx.mjs\");\n/* harmony import */ var _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./better-auth.CMQ3rA-I.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CMQ3rA-I.mjs\");\n/* harmony import */ var _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @better-auth/utils/base64 */ \"(rsc)/./node_modules/@better-auth/utils/dist/base64.mjs\");\n/* harmony import */ var _better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! @better-auth/utils/hmac */ \"(rsc)/./node_modules/@better-auth/utils/dist/hmac.mjs\");\n/* harmony import */ var _better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ./better-auth.BZZKN1g7.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.BZZKN1g7.mjs\");\n/* harmony import */ var _better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ./better-auth.CuS_eDdK.mjs */ \"(rsc)/./node_modules/better-auth/dist/shared/better-auth.CuS_eDdK.mjs\");\n/* harmony import */ var _better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! @better-auth/utils/binary */ \"(rsc)/./node_modules/@better-auth/utils/dist/binary.mjs\");\n\n\n\n\n\n\n\n\n\n//#region src/index.ts\nconst s = 1e3;\nconst m = s * 60;\nconst h = m * 60;\nconst d = h * 24;\nconst w = d * 7;\nconst y = d * 365.25;\nconst mo = y / 12;\nfunction ms(value, options) {\n\tif (typeof value === \"string\") return parse(value);\n\telse if (typeof value === \"number\") return format(value);\n\tthrow new Error(`Value provided to ms() must be a string or number. value=${JSON.stringify(value)}`);\n}\n/**\n* Parse the given string and return milliseconds.\n*\n* @param str - A string to parse to milliseconds\n* @returns The parsed value in milliseconds, or `NaN` if the string can't be\n* parsed\n*/\nfunction parse(str) {\n\tif (typeof str !== \"string\" || str.length === 0 || str.length > 100) throw new Error(`Value provided to ms.parse() must be a string with length between 1 and 99. value=${JSON.stringify(str)}`);\n\tconst match = /^(?<value>-?\\d*\\.?\\d+) *(?<unit>milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|months?|mo|years?|yrs?|y)?$/i.exec(str);\n\tif (!match?.groups) return NaN;\n\tconst { value, unit = \"ms\" } = match.groups;\n\tconst n = parseFloat(value);\n\tconst matchUnit = unit.toLowerCase();\n\t/* istanbul ignore next - istanbul doesn't understand, but thankfully the TypeScript the exhaustiveness check in the default case keeps us type safe here */\n\tswitch (matchUnit) {\n\t\tcase \"years\":\n\t\tcase \"year\":\n\t\tcase \"yrs\":\n\t\tcase \"yr\":\n\t\tcase \"y\": return n * y;\n\t\tcase \"months\":\n\t\tcase \"month\":\n\t\tcase \"mo\": return n * mo;\n\t\tcase \"weeks\":\n\t\tcase \"week\":\n\t\tcase \"w\": return n * w;\n\t\tcase \"days\":\n\t\tcase \"day\":\n\t\tcase \"d\": return n * d;\n\t\tcase \"hours\":\n\t\tcase \"hour\":\n\t\tcase \"hrs\":\n\t\tcase \"hr\":\n\t\tcase \"h\": return n * h;\n\t\tcase \"minutes\":\n\t\tcase \"minute\":\n\t\tcase \"mins\":\n\t\tcase \"min\":\n\t\tcase \"m\": return n * m;\n\t\tcase \"seconds\":\n\t\tcase \"second\":\n\t\tcase \"secs\":\n\t\tcase \"sec\":\n\t\tcase \"s\": return n * s;\n\t\tcase \"milliseconds\":\n\t\tcase \"millisecond\":\n\t\tcase \"msecs\":\n\t\tcase \"msec\":\n\t\tcase \"ms\": return n;\n\t\tdefault: throw new Error(`Unknown unit \"${matchUnit}\" provided to ms.parse(). value=${JSON.stringify(str)}`);\n\t}\n}\n/**\n* Short format for `ms`.\n*/\nfunction fmtShort(ms$1) {\n\tconst msAbs = Math.abs(ms$1);\n\tif (msAbs >= y) return `${Math.round(ms$1 / y)}y`;\n\tif (msAbs >= mo) return `${Math.round(ms$1 / mo)}mo`;\n\tif (msAbs >= w) return `${Math.round(ms$1 / w)}w`;\n\tif (msAbs >= d) return `${Math.round(ms$1 / d)}d`;\n\tif (msAbs >= h) return `${Math.round(ms$1 / h)}h`;\n\tif (msAbs >= m) return `${Math.round(ms$1 / m)}m`;\n\tif (msAbs >= s) return `${Math.round(ms$1 / s)}s`;\n\treturn `${ms$1}ms`;\n}\n/**\n* Format the given integer as a string.\n*\n* @param ms - milliseconds\n* @param options - Options for the conversion\n* @returns The formatted string\n*/\nfunction format(ms$1, options) {\n\tif (typeof ms$1 !== \"number\" || !Number.isFinite(ms$1)) throw new Error(\"Value provided to ms.format() must be of type number.\");\n\treturn fmtShort(ms$1);\n}\n\nfunction parseSetCookieHeader(setCookie) {\n  const cookies = /* @__PURE__ */ new Map();\n  const cookieArray = setCookie.split(\", \");\n  cookieArray.forEach((cookieString) => {\n    const parts = cookieString.split(\";\").map((part) => part.trim());\n    const [nameValue, ...attributes] = parts;\n    const [name, ...valueParts] = nameValue.split(\"=\");\n    const value = valueParts.join(\"=\");\n    if (!name || value === void 0) {\n      return;\n    }\n    const attrObj = { value };\n    attributes.forEach((attribute) => {\n      const [attrName, ...attrValueParts] = attribute.split(\"=\");\n      const attrValue = attrValueParts.join(\"=\");\n      const normalizedAttrName = attrName.trim().toLowerCase();\n      switch (normalizedAttrName) {\n        case \"max-age\":\n          attrObj[\"max-age\"] = attrValue ? parseInt(attrValue.trim(), 10) : void 0;\n          break;\n        case \"expires\":\n          attrObj.expires = attrValue ? new Date(attrValue.trim()) : void 0;\n          break;\n        case \"domain\":\n          attrObj.domain = attrValue ? attrValue.trim() : void 0;\n          break;\n        case \"path\":\n          attrObj.path = attrValue ? attrValue.trim() : void 0;\n          break;\n        case \"secure\":\n          attrObj.secure = true;\n          break;\n        case \"httponly\":\n          attrObj.httponly = true;\n          break;\n        case \"samesite\":\n          attrObj.samesite = attrValue ? attrValue.trim().toLowerCase() : void 0;\n          break;\n        default:\n          attrObj[normalizedAttrName] = attrValue ? attrValue.trim() : true;\n          break;\n      }\n    });\n    cookies.set(name, attrObj);\n  });\n  return cookies;\n}\nfunction setCookieToHeader(headers) {\n  return (context) => {\n    const setCookieHeader = context.response.headers.get(\"set-cookie\");\n    if (!setCookieHeader) {\n      return;\n    }\n    const cookieMap = /* @__PURE__ */ new Map();\n    const existingCookiesHeader = headers.get(\"cookie\") || \"\";\n    existingCookiesHeader.split(\";\").forEach((cookie) => {\n      const [name, ...rest] = cookie.trim().split(\"=\");\n      if (name && rest.length > 0) {\n        cookieMap.set(name, rest.join(\"=\"));\n      }\n    });\n    const setCookieHeaders = setCookieHeader.split(\",\");\n    setCookieHeaders.forEach((header) => {\n      const cookies = parseSetCookieHeader(header);\n      cookies.forEach((value, name) => {\n        cookieMap.set(name, value.value);\n      });\n    });\n    const updatedCookies = Array.from(cookieMap.entries()).map(([name, value]) => `${name}=${value}`).join(\"; \");\n    headers.set(\"cookie\", updatedCookies);\n  };\n}\n\nfunction createCookieGetter(options) {\n  const secure = options.advanced?.useSecureCookies !== void 0 ? options.advanced?.useSecureCookies : options.baseURL !== void 0 ? options.baseURL.startsWith(\"https://\") ? true : false : _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_2__.a;\n  const secureCookiePrefix = secure ? \"__Secure-\" : \"\";\n  const crossSubdomainEnabled = !!options.advanced?.crossSubDomainCookies?.enabled;\n  const domain = crossSubdomainEnabled ? options.advanced?.crossSubDomainCookies?.domain || (options.baseURL ? new URL(options.baseURL).hostname : void 0) : void 0;\n  if (crossSubdomainEnabled && !domain) {\n    throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_0__.B(\n      \"baseURL is required when crossSubdomainCookies are enabled\"\n    );\n  }\n  function createCookie(cookieName, overrideAttributes = {}) {\n    const prefix = options.advanced?.cookiePrefix || \"better-auth\";\n    const name = options.advanced?.cookies?.[cookieName]?.name || `${prefix}.${cookieName}`;\n    const attributes = options.advanced?.cookies?.[cookieName]?.attributes;\n    return {\n      name: `${secureCookiePrefix}${name}`,\n      attributes: {\n        secure: !!secureCookiePrefix,\n        sameSite: \"lax\",\n        path: \"/\",\n        httpOnly: true,\n        ...crossSubdomainEnabled ? { domain } : {},\n        ...options.advanced?.defaultCookieAttributes,\n        ...overrideAttributes,\n        ...attributes\n      }\n    };\n  }\n  return createCookie;\n}\nfunction getCookies(options) {\n  const createCookie = createCookieGetter(options);\n  const sessionMaxAge = options.session?.expiresIn || ms(\"7d\") / 1e3;\n  const sessionToken = createCookie(\"session_token\", {\n    maxAge: sessionMaxAge\n  });\n  const sessionData = createCookie(\"session_data\", {\n    maxAge: options.session?.cookieCache?.maxAge || 60 * 5\n  });\n  const dontRememberToken = createCookie(\"dont_remember\");\n  return {\n    sessionToken: {\n      name: sessionToken.name,\n      options: sessionToken.attributes\n    },\n    /**\n     * This cookie is used to store the session data in the cookie\n     * This is useful for when you want to cache the session in the cookie\n     */\n    sessionData: {\n      name: sessionData.name,\n      options: sessionData.attributes\n    },\n    dontRememberToken: {\n      name: dontRememberToken.name,\n      options: dontRememberToken.attributes\n    }\n  };\n}\nasync function setCookieCache(ctx, session) {\n  const shouldStoreSessionDataInCookie = ctx.context.options.session?.cookieCache?.enabled;\n  if (shouldStoreSessionDataInCookie) {\n    const filteredSession = Object.entries(session.session).reduce(\n      (acc, [key, value]) => {\n        const fieldConfig = ctx.context.options.session?.additionalFields?.[key];\n        if (!fieldConfig || fieldConfig.returned !== false) {\n          acc[key] = value;\n        }\n        return acc;\n      },\n      {}\n    );\n    const sessionData = { session: filteredSession, user: session.user };\n    const expiresAtDate = (0,_better_auth_CW6D9eSx_mjs__WEBPACK_IMPORTED_MODULE_1__.g)(\n      ctx.context.authCookies.sessionData.options.maxAge || 60,\n      \"sec\"\n    ).getTime();\n    const data = _better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_3__.base64Url.encode(\n      JSON.stringify({\n        session: sessionData,\n        expiresAt: expiresAtDate,\n        signature: await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_4__.createHMAC)(\"SHA-256\", \"base64urlnopad\").sign(\n          ctx.context.secret,\n          JSON.stringify({\n            ...sessionData,\n            expiresAt: expiresAtDate\n          })\n        )\n      }),\n      {\n        padding: false\n      }\n    );\n    if (data.length > 4093) {\n      throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_0__.B(\n        \"Session data is too large to store in the cookie. Please disable session cookie caching or reduce the size of the session data\"\n      );\n    }\n    ctx.setCookie(\n      ctx.context.authCookies.sessionData.name,\n      data,\n      ctx.context.authCookies.sessionData.options\n    );\n  }\n}\nasync function setSessionCookie(ctx, session, dontRememberMe, overrides) {\n  const dontRememberMeCookie = await ctx.getSignedCookie(\n    ctx.context.authCookies.dontRememberToken.name,\n    ctx.context.secret\n  );\n  dontRememberMe = dontRememberMe !== void 0 ? dontRememberMe : !!dontRememberMeCookie;\n  const options = ctx.context.authCookies.sessionToken.options;\n  const maxAge = dontRememberMe ? void 0 : ctx.context.sessionConfig.expiresIn;\n  await ctx.setSignedCookie(\n    ctx.context.authCookies.sessionToken.name,\n    session.session.token,\n    ctx.context.secret,\n    {\n      ...options,\n      maxAge,\n      ...overrides\n    }\n  );\n  if (dontRememberMe) {\n    await ctx.setSignedCookie(\n      ctx.context.authCookies.dontRememberToken.name,\n      \"true\",\n      ctx.context.secret,\n      ctx.context.authCookies.dontRememberToken.options\n    );\n  }\n  await setCookieCache(ctx, session);\n  ctx.context.setNewSession(session);\n  if (ctx.context.options.secondaryStorage) {\n    await ctx.context.secondaryStorage?.set(\n      session.session.token,\n      JSON.stringify({\n        user: session.user,\n        session: session.session\n      }),\n      Math.floor(\n        (new Date(session.session.expiresAt).getTime() - Date.now()) / 1e3\n      )\n    );\n  }\n}\nfunction deleteSessionCookie(ctx, skipDontRememberMe) {\n  ctx.setCookie(ctx.context.authCookies.sessionToken.name, \"\", {\n    ...ctx.context.authCookies.sessionToken.options,\n    maxAge: 0\n  });\n  ctx.setCookie(ctx.context.authCookies.sessionData.name, \"\", {\n    ...ctx.context.authCookies.sessionData.options,\n    maxAge: 0\n  });\n  if (!skipDontRememberMe) {\n    ctx.setCookie(ctx.context.authCookies.dontRememberToken.name, \"\", {\n      ...ctx.context.authCookies.dontRememberToken.options,\n      maxAge: 0\n    });\n  }\n}\nfunction parseCookies(cookieHeader) {\n  const cookies = cookieHeader.split(\"; \");\n  const cookieMap = /* @__PURE__ */ new Map();\n  cookies.forEach((cookie) => {\n    const [name, value] = cookie.split(\"=\");\n    cookieMap.set(name, value);\n  });\n  return cookieMap;\n}\nconst getSessionCookie = (request, config) => {\n  if (config?.cookiePrefix) {\n    if (config.cookieName) {\n      config.cookiePrefix = `${config.cookiePrefix}-`;\n    } else {\n      config.cookiePrefix = `${config.cookiePrefix}.`;\n    }\n  }\n  const headers = \"headers\" in request ? request.headers : request;\n  const req = request instanceof Request ? request : void 0;\n  (0,_better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_6__.a)(req?.url, config?.path, req);\n  const cookies = headers.get(\"cookie\");\n  if (!cookies) {\n    return null;\n  }\n  const { cookieName = \"session_token\", cookiePrefix = \"better-auth.\" } = config || {};\n  const name = `${cookiePrefix}${cookieName}`;\n  const secureCookieName = `__Secure-${name}`;\n  const parsedCookie = parseCookies(cookies);\n  const sessionToken = parsedCookie.get(name) || parsedCookie.get(secureCookieName);\n  if (sessionToken) {\n    return sessionToken;\n  }\n  return null;\n};\nconst getCookieCache = async (request, config) => {\n  const headers = request instanceof Headers ? request : request.headers;\n  const cookies = headers.get(\"cookie\");\n  if (!cookies) {\n    return null;\n  }\n  const { cookieName = \"session_data\", cookiePrefix = \"better-auth\" } = config || {};\n  const name = config?.isSecure !== void 0 ? config.isSecure ? `__Secure-${cookiePrefix}.${cookieName}` : `${cookiePrefix}.${cookieName}` : _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_2__.a ? `__Secure-${cookiePrefix}.${cookieName}` : `${cookiePrefix}.${cookieName}`;\n  const parsedCookie = parseCookies(cookies);\n  const sessionData = parsedCookie.get(name);\n  if (sessionData) {\n    const sessionDataPayload = (0,_better_auth_BZZKN1g7_mjs__WEBPACK_IMPORTED_MODULE_5__.s)(_better_auth_utils_binary__WEBPACK_IMPORTED_MODULE_7__.binary.decode(_better_auth_utils_base64__WEBPACK_IMPORTED_MODULE_3__.base64Url.decode(sessionData)));\n    if (!sessionDataPayload) {\n      return null;\n    }\n    const secret = config?.secret || _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_2__.e.BETTER_AUTH_SECRET;\n    if (!secret) {\n      throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_0__.B(\n        \"getCookieCache requires a secret to be provided. Either pass it as an option or set the BETTER_AUTH_SECRET environment variable\"\n      );\n    }\n    const isValid = await (0,_better_auth_utils_hmac__WEBPACK_IMPORTED_MODULE_4__.createHMAC)(\"SHA-256\", \"base64urlnopad\").verify(\n      secret,\n      JSON.stringify({\n        ...sessionDataPayload.session,\n        expiresAt: sessionDataPayload.expiresAt\n      }),\n      sessionDataPayload.signature\n    );\n    if (!isValid) {\n      return null;\n    }\n    return sessionDataPayload.session;\n  }\n  return null;\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguVWZWV0FySUIubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBa0U7QUFDUjtBQUNlO0FBQ25CO0FBQ0Q7QUFDVztBQUNIO0FBQ1Y7O0FBRW5EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2RUFBNkUsc0JBQXNCO0FBQ25HO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDJLQUEySyxvQkFBb0I7QUFDL0w7QUFDQTtBQUNBLFNBQVMscUJBQXFCO0FBQzlCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsVUFBVSxrQ0FBa0Msb0JBQW9CO0FBQzVHO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMkJBQTJCLHFCQUFxQjtBQUNoRCw0QkFBNEIsc0JBQXNCO0FBQ2xELDJCQUEyQixxQkFBcUI7QUFDaEQsMkJBQTJCLHFCQUFxQjtBQUNoRCwyQkFBMkIscUJBQXFCO0FBQ2hELDJCQUEyQixxQkFBcUI7QUFDaEQsMkJBQTJCLHFCQUFxQjtBQUNoRCxXQUFXLEtBQUs7QUFDaEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQjtBQUN0QjtBQUNBO0FB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O0FBQ3BPO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw0REFBYSxDQUFDLDZEQUFNLFFBQVEsZ0VBQVM7QUFDcEU7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLHdEQUFHO0FBQ3hDO0FBQ0EsZ0JBQWdCLHdEQUFlO0FBQy9CO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQixtRUFBVTtBQUNwQztBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXFQIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxzaGFyZWRcXGJldHRlci1hdXRoLlVmVldBcklCLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBCIGFzIEJldHRlckF1dGhFcnJvciB9IGZyb20gJy4vYmV0dGVyLWF1dGguRGR6U0pmLW4ubWpzJztcbmltcG9ydCB7IGcgYXMgZ2V0RGF0ZSB9IGZyb20gJy4vYmV0dGVyLWF1dGguQ1c2RDllU3gubWpzJztcbmltcG9ydCB7IGEgYXMgaXNQcm9kdWN0aW9uLCBlIGFzIGVudiB9IGZyb20gJy4vYmV0dGVyLWF1dGguQ01RM3JBLUkubWpzJztcbmltcG9ydCB7IGJhc2U2NFVybCB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9iYXNlNjQnO1xuaW1wb3J0IHsgY3JlYXRlSE1BQyB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9obWFjJztcbmltcG9ydCB7IHMgYXMgc2FmZUpTT05QYXJzZSB9IGZyb20gJy4vYmV0dGVyLWF1dGguQlpaS04xZzcubWpzJztcbmltcG9ydCB7IGEgYXMgZ2V0QmFzZVVSTCB9IGZyb20gJy4vYmV0dGVyLWF1dGguQ3VTX2VEZEsubWpzJztcbmltcG9ydCB7IGJpbmFyeSB9IGZyb20gJ0BiZXR0ZXItYXV0aC91dGlscy9iaW5hcnknO1xuXG4vLyNyZWdpb24gc3JjL2luZGV4LnRzXG5jb25zdCBzID0gMWUzO1xuY29uc3QgbSA9IHMgKiA2MDtcbmNvbnN0IGggPSBtICogNjA7XG5jb25zdCBkID0gaCAqIDI0O1xuY29uc3QgdyA9IGQgKiA3O1xuY29uc3QgeSA9IGQgKiAzNjUuMjU7XG5jb25zdCBtbyA9IHkgLyAxMjtcbmZ1bmN0aW9uIG1zKHZhbHVlLCBvcHRpb25zKSB7XG5cdGlmICh0eXBlb2YgdmFsdWUgPT09IFwic3RyaW5nXCIpIHJldHVybiBwYXJzZSh2YWx1ZSk7XG5cdGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gXCJudW1iZXJcIikgcmV0dXJuIGZvcm1hdCh2YWx1ZSk7XG5cdHRocm93IG5ldyBFcnJvcihgVmFsdWUgcHJvdmlkZWQgdG8gbXMoKSBtdXN0IGJlIGEgc3RyaW5nIG9yIG51bWJlci4gdmFsdWU9JHtKU09OLnN0cmluZ2lmeSh2YWx1ZSl9YCk7XG59XG4vKipcbiogUGFyc2UgdGhlIGdpdmVuIHN0cmluZyBhbmQgcmV0dXJuIG1pbGxpc2Vjb25kcy5cbipcbiogQHBhcmFtIHN0ciAtIEEgc3RyaW5nIHRvIHBhcnNlIHRvIG1pbGxpc2Vjb25kc1xuKiBAcmV0dXJucyBUaGUgcGFyc2VkIHZhbHVlIGluIG1pbGxpc2Vjb25kcywgb3IgYE5hTmAgaWYgdGhlIHN0cmluZyBjYW4ndCBiZVxuKiBwYXJzZWRcbiovXG5mdW5jdGlvbiBwYXJzZShzdHIpIHtcblx0aWYgKHR5cGVvZiBzdHIgIT09IFwic3RyaW5nXCIgfHwgc3RyLmxlbmd0aCA9PT0gMCB8fCBzdHIubGVuZ3RoID4gMTAwKSB0aHJvdyBuZXcgRXJyb3IoYFZhbHVlIHByb3ZpZGVkIHRvIG1zLnBhcnNlKCkgbXVzdCBiZSBhIHN0cmluZyB3aXRoIGxlbmd0aCBiZXR3ZWVuIDEgYW5kIDk5LiB2YWx1ZT0ke0pTT04uc3RyaW5naWZ5KHN0cil9YCk7XG5cdGNvbnN0IG1hdGNoID0gL14oPzx2YWx1ZT4tP1xcZCpcXC4/XFxkKykgKig/PHVuaXQ+bWlsbGlzZWNvbmRzP3xtc2Vjcz98bXN8c2Vjb25kcz98c2Vjcz98c3xtaW51dGVzP3xtaW5zP3xtfGhvdXJzP3xocnM/fGh8ZGF5cz98ZHx3ZWVrcz98d3xtb250aHM/fG1vfHllYXJzP3x5cnM/fHkpPyQvaS5leGVjKHN0cik7XG5cdGlmICghbWF0Y2g/Lmdyb3VwcykgcmV0dXJuIE5hTjtcblx0Y29uc3QgeyB2YWx1ZSwgdW5pdCA9IFwibXNcIiB9ID0gbWF0Y2guZ3JvdXBzO1xuXHRjb25zdCBuID0gcGFyc2VGbG9hdCh2YWx1ZSk7XG5cdGNvbnN0IG1hdGNoVW5pdCA9IHVuaXQudG9Mb3dlckNhc2UoKTtcblx0LyogaXN0YW5idWwgaWdub3JlIG5leHQgLSBpc3RhbmJ1bCBkb2Vzbid0IHVuZGVyc3RhbmQsIGJ1dCB0aGFua2Z1bGx5IHRoZSBUeXBlU2NyaXB0IHRoZSBleGhhdXN0aXZlbmVzcyBjaGVjayBpbiB0aGUgZGVmYXVsdCBjYXNlIGtlZXBzIHVzIHR5cGUgc2FmZSBoZXJlICovXG5cdHN3aXRjaCAobWF0Y2hVbml0KSB7XG5cdFx0Y2FzZSBcInllYXJzXCI6XG5cdFx0Y2FzZSBcInllYXJcIjpcblx0XHRjYXNlIFwieXJzXCI6XG5cdFx0Y2FzZSBcInlyXCI6XG5cdFx0Y2FzZSBcInlcIjogcmV0dXJuIG4gKiB5O1xuXHRcdGNhc2UgXCJtb250aHNcIjpcblx0XHRjYXNlIFwibW9udGhcIjpcblx0XHRjYXNlIFwibW9cIjogcmV0dXJuIG4gKiBtbztcblx0XHRjYXNlIFwid2Vla3NcIjpcblx0XHRjYXNlIFwid2Vla1wiOlxuXHRcdGNhc2UgXCJ3XCI6IHJldHVybiBuICogdztcblx0XHRjYXNlIFwiZGF5c1wiOlxuXHRcdGNhc2UgXCJkYXlcIjpcblx0XHRjYXNlIFwiZFwiOiByZXR1cm4gbiAqIGQ7XG5cdFx0Y2FzZSBcImhvdXJzXCI6XG5cdFx0Y2FzZSBcImhvdXJcIjpcblx0XHRjYXNlIFwiaHJzXCI6XG5cdFx0Y2FzZSBcImhyXCI6XG5cdFx0Y2FzZSBcImhcIjogcmV0dXJuIG4gKiBoO1xuXHRcdGNhc2UgXCJtaW51dGVzXCI6XG5cdFx0Y2FzZSBcIm1pbnV0ZVwiOlxuXHRcdGNhc2UgXCJtaW5zXCI6XG5cdFx0Y2FzZSBcIm1pblwiOlxuXHRcdGNhc2UgXCJtXCI6IHJldHVybiBuICogbTtcblx0XHRjYXNlIFwic2Vjb25kc1wiOlxuXHRcdGNhc2UgXCJzZWNvbmRcIjpcblx0XHRjYXNlIFwic2Vjc1wiOlxuXHRcdGNhc2UgXCJzZWNcIjpcblx0XHRjYXNlIFwic1wiOiByZXR1cm4gbiAqIHM7XG5cdFx0Y2FzZSBcIm1pbGxpc2Vjb25kc1wiOlxuXHRcdGNhc2UgXCJtaWxsaXNlY29uZFwiOlxuXHRcdGNhc2UgXCJtc2Vjc1wiOlxuXHRcdGNhc2UgXCJtc2VjXCI6XG5cdFx0Y2FzZSBcIm1zXCI6IHJldHVybiBuO1xuXHRcdGRlZmF1bHQ6IHRocm93IG5ldyBFcnJvcihgVW5rbm93biB1bml0IFwiJHttYXRjaFVuaXR9XCIgcHJvdmlkZWQgdG8gbXMucGFyc2UoKS4gdmFsdWU9JHtKU09OLnN0cmluZ2lmeShzdHIpfWApO1xuXHR9XG59XG4vKipcbiogU2hvcnQgZm9ybWF0IGZvciBgbXNgLlxuKi9cbmZ1bmN0aW9uIGZtdFNob3J0KG1zJDEpIHtcblx0Y29uc3QgbXNBYnMgPSBNYXRoLmFicyhtcyQxKTtcblx0aWYgKG1zQWJzID49IHkpIHJldHVybiBgJHtNYXRoLnJvdW5kKG1zJDEgLyB5KX15YDtcblx0aWYgKG1zQWJzID49IG1vKSByZXR1cm4gYCR7TWF0aC5yb3VuZChtcyQxIC8gbW8pfW1vYDtcblx0aWYgKG1zQWJzID49IHcpIHJldHVybiBgJHtNYXRoLnJvdW5kKG1zJDEgLyB3KX13YDtcblx0aWYgKG1zQWJzID49IGQpIHJldHVybiBgJHtNYXRoLnJvdW5kKG1zJDEgLyBkKX1kYDtcblx0aWYgKG1zQWJzID49IGgpIHJldHVybiBgJHtNYXRoLnJvdW5kKG1zJDEgLyBoKX1oYDtcblx0aWYgKG1zQWJzID49IG0pIHJldHVybiBgJHtNYXRoLnJvdW5kKG1zJDEgLyBtKX1tYDtcblx0aWYgKG1zQWJzID49IHMpIHJldHVybiBgJHtNYXRoLnJvdW5kKG1zJDEgLyBzKX1zYDtcblx0cmV0dXJuIGAke21zJDF9bXNgO1xufVxuLyoqXG4qIEZvcm1hdCB0aGUgZ2l2ZW4gaW50ZWdlciBhcyBhIHN0cmluZy5cbipcbiogQHBhcmFtIG1zIC0gbWlsbGlzZWNvbmRzXG4qIEBwYXJhbSBvcHRpb25zIC0gT3B0aW9ucyBmb3IgdGhlIGNvbnZlcnNpb25cbiogQHJldHVybnMgVGhlIGZvcm1hdHRlZCBzdHJpbmdcbiovXG5mdW5jdGlvbiBmb3JtYXQobXMkMSwgb3B0aW9ucykge1xuXHRpZiAodHlwZW9mIG1zJDEgIT09IFwibnVtYmVyXCIgfHwgIU51bWJlci5pc0Zpbml0ZShtcyQxKSkgdGhyb3cgbmV3IEVycm9yKFwiVmFsdWUgcHJvdmlkZWQgdG8gbXMuZm9ybWF0KCkgbXVzdCBiZSBvZiB0eXBlIG51bWJlci5cIik7XG5cdHJldHVybiBmbXRTaG9ydChtcyQxKTtcbn1cblxuZnVuY3Rpb24gcGFyc2VTZXRDb29raWVIZWFkZXIoc2V0Q29va2llKSB7XG4gIGNvbnN0IGNvb2tpZXMgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuICBjb25zdCBjb29raWVBcnJheSA9IHNldENvb2tpZS5zcGxpdChcIiwgXCIpO1xuICBjb29raWVBcnJheS5mb3JFYWNoKChjb29raWVTdHJpbmcpID0+IHtcbiAgICBjb25zdCBwYXJ0cyA9IGNvb2tpZVN0cmluZy5zcGxpdChcIjtcIikubWFwKChwYXJ0KSA9PiBwYXJ0LnRyaW0oKSk7XG4gICAgY29uc3QgW25hbWVWYWx1ZSwgLi4uYXR0cmlidXRlc10gPSBwYXJ0cztcbiAgICBjb25zdCBbbmFtZSwgLi4udmFsdWVQYXJ0c10gPSBuYW1lVmFsdWUuc3BsaXQoXCI9XCIpO1xuICAgIGNvbnN0IHZhbHVlID0gdmFsdWVQYXJ0cy5qb2luKFwiPVwiKTtcbiAgICBpZiAoIW5hbWUgfHwgdmFsdWUgPT09IHZvaWQgMCkge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBhdHRyT2JqID0geyB2YWx1ZSB9O1xuICAgIGF0dHJpYnV0ZXMuZm9yRWFjaCgoYXR0cmlidXRlKSA9PiB7XG4gICAgICBjb25zdCBbYXR0ck5hbWUsIC4uLmF0dHJWYWx1ZVBhcnRzXSA9IGF0dHJpYnV0ZS5zcGxpdChcIj1cIik7XG4gICAgICBjb25zdCBhdHRyVmFsdWUgPSBhdHRyVmFsdWVQYXJ0cy5qb2luKFwiPVwiKTtcbiAgICAgIGNvbnN0IG5vcm1hbGl6ZWRBdHRyTmFtZSA9IGF0dHJOYW1lLnRyaW0oKS50b0xvd2VyQ2FzZSgpO1xuICAgICAgc3dpdGNoIChub3JtYWxpemVkQXR0ck5hbWUpIHtcbiAgICAgICAgY2FzZSBcIm1heC1hZ2VcIjpcbiAgICAgICAgICBhdHRyT2JqW1wibWF4LWFnZVwiXSA9IGF0dHJWYWx1ZSA/IHBhcnNlSW50KGF0dHJWYWx1ZS50cmltKCksIDEwKSA6IHZvaWQgMDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImV4cGlyZXNcIjpcbiAgICAgICAgICBhdHRyT2JqLmV4cGlyZXMgPSBhdHRyVmFsdWUgPyBuZXcgRGF0ZShhdHRyVmFsdWUudHJpbSgpKSA6IHZvaWQgMDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcImRvbWFpblwiOlxuICAgICAgICAgIGF0dHJPYmouZG9tYWluID0gYXR0clZhbHVlID8gYXR0clZhbHVlLnRyaW0oKSA6IHZvaWQgMDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcInBhdGhcIjpcbiAgICAgICAgICBhdHRyT2JqLnBhdGggPSBhdHRyVmFsdWUgPyBhdHRyVmFsdWUudHJpbSgpIDogdm9pZCAwO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwic2VjdXJlXCI6XG4gICAgICAgICAgYXR0ck9iai5zZWN1cmUgPSB0cnVlO1xuICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlIFwiaHR0cG9ubHlcIjpcbiAgICAgICAgICBhdHRyT2JqLmh0dHBvbmx5ID0gdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSBcInNhbWVzaXRlXCI6XG4gICAgICAgICAgYXR0ck9iai5zYW1lc2l0ZSA9IGF0dHJWYWx1ZSA/IGF0dHJWYWx1ZS50cmltKCkudG9Mb3dlckNhc2UoKSA6IHZvaWQgMDtcbiAgICAgICAgICBicmVhaztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICBhdHRyT2JqW25vcm1hbGl6ZWRBdHRyTmFtZV0gPSBhdHRyVmFsdWUgPyBhdHRyVmFsdWUudHJpbSgpIDogdHJ1ZTtcbiAgICAgICAgICBicmVhaztcbiAgICAgIH1cbiAgICB9KTtcbiAgICBjb29raWVzLnNldChuYW1lLCBhdHRyT2JqKTtcbiAgfSk7XG4gIHJldHVybiBjb29raWVzO1xufVxuZnVuY3Rpb24gc2V0Q29va2llVG9IZWFkZXIoaGVhZGVycykge1xuICByZXR1cm4gKGNvbnRleHQpID0+IHtcbiAgICBjb25zdCBzZXRDb29raWVIZWFkZXIgPSBjb250ZXh0LnJlc3BvbnNlLmhlYWRlcnMuZ2V0KFwic2V0LWNvb2tpZVwiKTtcbiAgICBpZiAoIXNldENvb2tpZUhlYWRlcikge1xuICAgICAgcmV0dXJuO1xuICAgIH1cbiAgICBjb25zdCBjb29raWVNYXAgPSAvKiBAX19QVVJFX18gKi8gbmV3IE1hcCgpO1xuICAgIGNvbnN0IGV4aXN0aW5nQ29va2llc0hlYWRlciA9IGhlYWRlcnMuZ2V0KFwiY29va2llXCIpIHx8IFwiXCI7XG4gICAgZXhpc3RpbmdDb29raWVzSGVhZGVyLnNwbGl0KFwiO1wiKS5mb3JFYWNoKChjb29raWUpID0+IHtcbiAgICAgIGNvbnN0IFtuYW1lLCAuLi5yZXN0XSA9IGNvb2tpZS50cmltKCkuc3BsaXQoXCI9XCIpO1xuICAgICAgaWYgKG5hbWUgJiYgcmVzdC5sZW5ndGggPiAwKSB7XG4gICAgICAgIGNvb2tpZU1hcC5zZXQobmFtZSwgcmVzdC5qb2luKFwiPVwiKSk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgY29uc3Qgc2V0Q29va2llSGVhZGVycyA9IHNldENvb2tpZUhlYWRlci5zcGxpdChcIixcIik7XG4gICAgc2V0Q29va2llSGVhZGVycy5mb3JFYWNoKChoZWFkZXIpID0+IHtcbiAgICAgIGNvbnN0IGNvb2tpZXMgPSBwYXJzZVNldENvb2tpZUhlYWRlcihoZWFkZXIpO1xuICAgICAgY29va2llcy5mb3JFYWNoKCh2YWx1ZSwgbmFtZSkgPT4ge1xuICAgICAgICBjb29raWVNYXAuc2V0KG5hbWUsIHZhbHVlLnZhbHVlKTtcbiAgICAgIH0pO1xuICAgIH0pO1xuICAgIGNvbnN0IHVwZGF0ZWRDb29raWVzID0gQXJyYXkuZnJvbShjb29raWVNYXAuZW50cmllcygpKS5tYXAoKFtuYW1lLCB2YWx1ZV0pID0+IGAke25hbWV9PSR7dmFsdWV9YCkuam9pbihcIjsgXCIpO1xuICAgIGhlYWRlcnMuc2V0KFwiY29va2llXCIsIHVwZGF0ZWRDb29raWVzKTtcbiAgfTtcbn1cblxuZnVuY3Rpb24gY3JlYXRlQ29va2llR2V0dGVyKG9wdGlvbnMpIHtcbiAgY29uc3Qgc2VjdXJlID0gb3B0aW9ucy5hZHZhbmNlZD8udXNlU2VjdXJlQ29va2llcyAhPT0gdm9pZCAwID8gb3B0aW9ucy5hZHZhbmNlZD8udXNlU2VjdXJlQ29va2llcyA6IG9wdGlvbnMuYmFzZVVSTCAhPT0gdm9pZCAwID8gb3B0aW9ucy5iYXNlVVJMLnN0YXJ0c1dpdGgoXCJodHRwczovL1wiKSA/IHRydWUgOiBmYWxzZSA6IGlzUHJvZHVjdGlvbjtcbiAgY29uc3Qgc2VjdXJlQ29va2llUHJlZml4ID0gc2VjdXJlID8gXCJfX1NlY3VyZS1cIiA6IFwiXCI7XG4gIGNvbnN0IGNyb3NzU3ViZG9tYWluRW5hYmxlZCA9ICEhb3B0aW9ucy5hZHZhbmNlZD8uY3Jvc3NTdWJEb21haW5Db29raWVzPy5lbmFibGVkO1xuICBjb25zdCBkb21haW4gPSBjcm9zc1N1YmRvbWFpbkVuYWJsZWQgPyBvcHRpb25zLmFkdmFuY2VkPy5jcm9zc1N1YkRvbWFpbkNvb2tpZXM/LmRvbWFpbiB8fCAob3B0aW9ucy5iYXNlVVJMID8gbmV3IFVSTChvcHRpb25zLmJhc2VVUkwpLmhvc3RuYW1lIDogdm9pZCAwKSA6IHZvaWQgMDtcbiAgaWYgKGNyb3NzU3ViZG9tYWluRW5hYmxlZCAmJiAhZG9tYWluKSB7XG4gICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgIFwiYmFzZVVSTCBpcyByZXF1aXJlZCB3aGVuIGNyb3NzU3ViZG9tYWluQ29va2llcyBhcmUgZW5hYmxlZFwiXG4gICAgKTtcbiAgfVxuICBmdW5jdGlvbiBjcmVhdGVDb29raWUoY29va2llTmFtZSwgb3ZlcnJpZGVBdHRyaWJ1dGVzID0ge30pIHtcbiAgICBjb25zdCBwcmVmaXggPSBvcHRpb25zLmFkdmFuY2VkPy5jb29raWVQcmVmaXggfHwgXCJiZXR0ZXItYXV0aFwiO1xuICAgIGNvbnN0IG5hbWUgPSBvcHRpb25zLmFkdmFuY2VkPy5jb29raWVzPy5bY29va2llTmFtZV0/Lm5hbWUgfHwgYCR7cHJlZml4fS4ke2Nvb2tpZU5hbWV9YDtcbiAgICBjb25zdCBhdHRyaWJ1dGVzID0gb3B0aW9ucy5hZHZhbmNlZD8uY29va2llcz8uW2Nvb2tpZU5hbWVdPy5hdHRyaWJ1dGVzO1xuICAgIHJldHVybiB7XG4gICAgICBuYW1lOiBgJHtzZWN1cmVDb29raWVQcmVmaXh9JHtuYW1lfWAsXG4gICAgICBhdHRyaWJ1dGVzOiB7XG4gICAgICAgIHNlY3VyZTogISFzZWN1cmVDb29raWVQcmVmaXgsXG4gICAgICAgIHNhbWVTaXRlOiBcImxheFwiLFxuICAgICAgICBwYXRoOiBcIi9cIixcbiAgICAgICAgaHR0cE9ubHk6IHRydWUsXG4gICAgICAgIC4uLmNyb3NzU3ViZG9tYWluRW5hYmxlZCA/IHsgZG9tYWluIH0gOiB7fSxcbiAgICAgICAgLi4ub3B0aW9ucy5hZHZhbmNlZD8uZGVmYXVsdENvb2tpZUF0dHJpYnV0ZXMsXG4gICAgICAgIC4uLm92ZXJyaWRlQXR0cmlidXRlcyxcbiAgICAgICAgLi4uYXR0cmlidXRlc1xuICAgICAgfVxuICAgIH07XG4gIH1cbiAgcmV0dXJuIGNyZWF0ZUNvb2tpZTtcbn1cbmZ1bmN0aW9uIGdldENvb2tpZXMob3B0aW9ucykge1xuICBjb25zdCBjcmVhdGVDb29raWUgPSBjcmVhdGVDb29raWVHZXR0ZXIob3B0aW9ucyk7XG4gIGNvbnN0IHNlc3Npb25NYXhBZ2UgPSBvcHRpb25zLnNlc3Npb24/LmV4cGlyZXNJbiB8fCBtcyhcIjdkXCIpIC8gMWUzO1xuICBjb25zdCBzZXNzaW9uVG9rZW4gPSBjcmVhdGVDb29raWUoXCJzZXNzaW9uX3Rva2VuXCIsIHtcbiAgICBtYXhBZ2U6IHNlc3Npb25NYXhBZ2VcbiAgfSk7XG4gIGNvbnN0IHNlc3Npb25EYXRhID0gY3JlYXRlQ29va2llKFwic2Vzc2lvbl9kYXRhXCIsIHtcbiAgICBtYXhBZ2U6IG9wdGlvbnMuc2Vzc2lvbj8uY29va2llQ2FjaGU/Lm1heEFnZSB8fCA2MCAqIDVcbiAgfSk7XG4gIGNvbnN0IGRvbnRSZW1lbWJlclRva2VuID0gY3JlYXRlQ29va2llKFwiZG9udF9yZW1lbWJlclwiKTtcbiAgcmV0dXJuIHtcbiAgICBzZXNzaW9uVG9rZW46IHtcbiAgICAgIG5hbWU6IHNlc3Npb25Ub2tlbi5uYW1lLFxuICAgICAgb3B0aW9uczogc2Vzc2lvblRva2VuLmF0dHJpYnV0ZXNcbiAgICB9LFxuICAgIC8qKlxuICAgICAqIFRoaXMgY29va2llIGlzIHVzZWQgdG8gc3RvcmUgdGhlIHNlc3Npb24gZGF0YSBpbiB0aGUgY29va2llXG4gICAgICogVGhpcyBpcyB1c2VmdWwgZm9yIHdoZW4geW91IHdhbnQgdG8gY2FjaGUgdGhlIHNlc3Npb24gaW4gdGhlIGNvb2tpZVxuICAgICAqL1xuICAgIHNlc3Npb25EYXRhOiB7XG4gICAgICBuYW1lOiBzZXNzaW9uRGF0YS5uYW1lLFxuICAgICAgb3B0aW9uczogc2Vzc2lvbkRhdGEuYXR0cmlidXRlc1xuICAgIH0sXG4gICAgZG9udFJlbWVtYmVyVG9rZW46IHtcbiAgICAgIG5hbWU6IGRvbnRSZW1lbWJlclRva2VuLm5hbWUsXG4gICAgICBvcHRpb25zOiBkb250UmVtZW1iZXJUb2tlbi5hdHRyaWJ1dGVzXG4gICAgfVxuICB9O1xufVxuYXN5bmMgZnVuY3Rpb24gc2V0Q29va2llQ2FjaGUoY3R4LCBzZXNzaW9uKSB7XG4gIGNvbnN0IHNob3VsZFN0b3JlU2Vzc2lvbkRhdGFJbkNvb2tpZSA9IGN0eC5jb250ZXh0Lm9wdGlvbnMuc2Vzc2lvbj8uY29va2llQ2FjaGU/LmVuYWJsZWQ7XG4gIGlmIChzaG91bGRTdG9yZVNlc3Npb25EYXRhSW5Db29raWUpIHtcbiAgICBjb25zdCBmaWx0ZXJlZFNlc3Npb24gPSBPYmplY3QuZW50cmllcyhzZXNzaW9uLnNlc3Npb24pLnJlZHVjZShcbiAgICAgIChhY2MsIFtrZXksIHZhbHVlXSkgPT4ge1xuICAgICAgICBjb25zdCBmaWVsZENvbmZpZyA9IGN0eC5jb250ZXh0Lm9wdGlvbnMuc2Vzc2lvbj8uYWRkaXRpb25hbEZpZWxkcz8uW2tleV07XG4gICAgICAgIGlmICghZmllbGRDb25maWcgfHwgZmllbGRDb25maWcucmV0dXJuZWQgIT09IGZhbHNlKSB7XG4gICAgICAgICAgYWNjW2tleV0gPSB2YWx1ZTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYWNjO1xuICAgICAgfSxcbiAgICAgIHt9XG4gICAgKTtcbiAgICBjb25zdCBzZXNzaW9uRGF0YSA9IHsgc2Vzc2lvbjogZmlsdGVyZWRTZXNzaW9uLCB1c2VyOiBzZXNzaW9uLnVzZXIgfTtcbiAgICBjb25zdCBleHBpcmVzQXREYXRlID0gZ2V0RGF0ZShcbiAgICAgIGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25EYXRhLm9wdGlvbnMubWF4QWdlIHx8IDYwLFxuICAgICAgXCJzZWNcIlxuICAgICkuZ2V0VGltZSgpO1xuICAgIGNvbnN0IGRhdGEgPSBiYXNlNjRVcmwuZW5jb2RlKFxuICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBzZXNzaW9uOiBzZXNzaW9uRGF0YSxcbiAgICAgICAgZXhwaXJlc0F0OiBleHBpcmVzQXREYXRlLFxuICAgICAgICBzaWduYXR1cmU6IGF3YWl0IGNyZWF0ZUhNQUMoXCJTSEEtMjU2XCIsIFwiYmFzZTY0dXJsbm9wYWRcIikuc2lnbihcbiAgICAgICAgICBjdHguY29udGV4dC5zZWNyZXQsXG4gICAgICAgICAgSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgICAgLi4uc2Vzc2lvbkRhdGEsXG4gICAgICAgICAgICBleHBpcmVzQXQ6IGV4cGlyZXNBdERhdGVcbiAgICAgICAgICB9KVxuICAgICAgICApXG4gICAgICB9KSxcbiAgICAgIHtcbiAgICAgICAgcGFkZGluZzogZmFsc2VcbiAgICAgIH1cbiAgICApO1xuICAgIGlmIChkYXRhLmxlbmd0aCA+IDQwOTMpIHtcbiAgICAgIHRocm93IG5ldyBCZXR0ZXJBdXRoRXJyb3IoXG4gICAgICAgIFwiU2Vzc2lvbiBkYXRhIGlzIHRvbyBsYXJnZSB0byBzdG9yZSBpbiB0aGUgY29va2llLiBQbGVhc2UgZGlzYWJsZSBzZXNzaW9uIGNvb2tpZSBjYWNoaW5nIG9yIHJlZHVjZSB0aGUgc2l6ZSBvZiB0aGUgc2Vzc2lvbiBkYXRhXCJcbiAgICAgICk7XG4gICAgfVxuICAgIGN0eC5zZXRDb29raWUoXG4gICAgICBjdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uRGF0YS5uYW1lLFxuICAgICAgZGF0YSxcbiAgICAgIGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25EYXRhLm9wdGlvbnNcbiAgICApO1xuICB9XG59XG5hc3luYyBmdW5jdGlvbiBzZXRTZXNzaW9uQ29va2llKGN0eCwgc2Vzc2lvbiwgZG9udFJlbWVtYmVyTWUsIG92ZXJyaWRlcykge1xuICBjb25zdCBkb250UmVtZW1iZXJNZUNvb2tpZSA9IGF3YWl0IGN0eC5nZXRTaWduZWRDb29raWUoXG4gICAgY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuZG9udFJlbWVtYmVyVG9rZW4ubmFtZSxcbiAgICBjdHguY29udGV4dC5zZWNyZXRcbiAgKTtcbiAgZG9udFJlbWVtYmVyTWUgPSBkb250UmVtZW1iZXJNZSAhPT0gdm9pZCAwID8gZG9udFJlbWVtYmVyTWUgOiAhIWRvbnRSZW1lbWJlck1lQ29va2llO1xuICBjb25zdCBvcHRpb25zID0gY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvblRva2VuLm9wdGlvbnM7XG4gIGNvbnN0IG1heEFnZSA9IGRvbnRSZW1lbWJlck1lID8gdm9pZCAwIDogY3R4LmNvbnRleHQuc2Vzc2lvbkNvbmZpZy5leHBpcmVzSW47XG4gIGF3YWl0IGN0eC5zZXRTaWduZWRDb29raWUoXG4gICAgY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvblRva2VuLm5hbWUsXG4gICAgc2Vzc2lvbi5zZXNzaW9uLnRva2VuLFxuICAgIGN0eC5jb250ZXh0LnNlY3JldCxcbiAgICB7XG4gICAgICAuLi5vcHRpb25zLFxuICAgICAgbWF4QWdlLFxuICAgICAgLi4ub3ZlcnJpZGVzXG4gICAgfVxuICApO1xuICBpZiAoZG9udFJlbWVtYmVyTWUpIHtcbiAgICBhd2FpdCBjdHguc2V0U2lnbmVkQ29va2llKFxuICAgICAgY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuZG9udFJlbWVtYmVyVG9rZW4ubmFtZSxcbiAgICAgIFwidHJ1ZVwiLFxuICAgICAgY3R4LmNvbnRleHQuc2VjcmV0LFxuICAgICAgY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuZG9udFJlbWVtYmVyVG9rZW4ub3B0aW9uc1xuICAgICk7XG4gIH1cbiAgYXdhaXQgc2V0Q29va2llQ2FjaGUoY3R4LCBzZXNzaW9uKTtcbiAgY3R4LmNvbnRleHQuc2V0TmV3U2Vzc2lvbihzZXNzaW9uKTtcbiAgaWYgKGN0eC5jb250ZXh0Lm9wdGlvbnMuc2Vjb25kYXJ5U3RvcmFnZSkge1xuICAgIGF3YWl0IGN0eC5jb250ZXh0LnNlY29uZGFyeVN0b3JhZ2U/LnNldChcbiAgICAgIHNlc3Npb24uc2Vzc2lvbi50b2tlbixcbiAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgdXNlcjogc2Vzc2lvbi51c2VyLFxuICAgICAgICBzZXNzaW9uOiBzZXNzaW9uLnNlc3Npb25cbiAgICAgIH0pLFxuICAgICAgTWF0aC5mbG9vcihcbiAgICAgICAgKG5ldyBEYXRlKHNlc3Npb24uc2Vzc2lvbi5leHBpcmVzQXQpLmdldFRpbWUoKSAtIERhdGUubm93KCkpIC8gMWUzXG4gICAgICApXG4gICAgKTtcbiAgfVxufVxuZnVuY3Rpb24gZGVsZXRlU2Vzc2lvbkNvb2tpZShjdHgsIHNraXBEb250UmVtZW1iZXJNZSkge1xuICBjdHguc2V0Q29va2llKGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25Ub2tlbi5uYW1lLCBcIlwiLCB7XG4gICAgLi4uY3R4LmNvbnRleHQuYXV0aENvb2tpZXMuc2Vzc2lvblRva2VuLm9wdGlvbnMsXG4gICAgbWF4QWdlOiAwXG4gIH0pO1xuICBjdHguc2V0Q29va2llKGN0eC5jb250ZXh0LmF1dGhDb29raWVzLnNlc3Npb25EYXRhLm5hbWUsIFwiXCIsIHtcbiAgICAuLi5jdHguY29udGV4dC5hdXRoQ29va2llcy5zZXNzaW9uRGF0YS5vcHRpb25zLFxuICAgIG1heEFnZTogMFxuICB9KTtcbiAgaWYgKCFza2lwRG9udFJlbWVtYmVyTWUpIHtcbiAgICBjdHguc2V0Q29va2llKGN0eC5jb250ZXh0LmF1dGhDb29raWVzLmRvbnRSZW1lbWJlclRva2VuLm5hbWUsIFwiXCIsIHtcbiAgICAgIC4uLmN0eC5jb250ZXh0LmF1dGhDb29raWVzLmRvbnRSZW1lbWJlclRva2VuLm9wdGlvbnMsXG4gICAgICBtYXhBZ2U6IDBcbiAgICB9KTtcbiAgfVxufVxuZnVuY3Rpb24gcGFyc2VDb29raWVzKGNvb2tpZUhlYWRlcikge1xuICBjb25zdCBjb29raWVzID0gY29va2llSGVhZGVyLnNwbGl0KFwiOyBcIik7XG4gIGNvbnN0IGNvb2tpZU1hcCA9IC8qIEBfX1BVUkVfXyAqLyBuZXcgTWFwKCk7XG4gIGNvb2tpZXMuZm9yRWFjaCgoY29va2llKSA9PiB7XG4gICAgY29uc3QgW25hbWUsIHZhbHVlXSA9IGNvb2tpZS5zcGxpdChcIj1cIik7XG4gICAgY29va2llTWFwLnNldChuYW1lLCB2YWx1ZSk7XG4gIH0pO1xuICByZXR1cm4gY29va2llTWFwO1xufVxuY29uc3QgZ2V0U2Vzc2lvbkNvb2tpZSA9IChyZXF1ZXN0LCBjb25maWcpID0+IHtcbiAgaWYgKGNvbmZpZz8uY29va2llUHJlZml4KSB7XG4gICAgaWYgKGNvbmZpZy5jb29raWVOYW1lKSB7XG4gICAgICBjb25maWcuY29va2llUHJlZml4ID0gYCR7Y29uZmlnLmNvb2tpZVByZWZpeH0tYDtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uZmlnLmNvb2tpZVByZWZpeCA9IGAke2NvbmZpZy5jb29raWVQcmVmaXh9LmA7XG4gICAgfVxuICB9XG4gIGNvbnN0IGhlYWRlcnMgPSBcImhlYWRlcnNcIiBpbiByZXF1ZXN0ID8gcmVxdWVzdC5oZWFkZXJzIDogcmVxdWVzdDtcbiAgY29uc3QgcmVxID0gcmVxdWVzdCBpbnN0YW5jZW9mIFJlcXVlc3QgPyByZXF1ZXN0IDogdm9pZCAwO1xuICBnZXRCYXNlVVJMKHJlcT8udXJsLCBjb25maWc/LnBhdGgsIHJlcSk7XG4gIGNvbnN0IGNvb2tpZXMgPSBoZWFkZXJzLmdldChcImNvb2tpZVwiKTtcbiAgaWYgKCFjb29raWVzKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgY29uc3QgeyBjb29raWVOYW1lID0gXCJzZXNzaW9uX3Rva2VuXCIsIGNvb2tpZVByZWZpeCA9IFwiYmV0dGVyLWF1dGguXCIgfSA9IGNvbmZpZyB8fCB7fTtcbiAgY29uc3QgbmFtZSA9IGAke2Nvb2tpZVByZWZpeH0ke2Nvb2tpZU5hbWV9YDtcbiAgY29uc3Qgc2VjdXJlQ29va2llTmFtZSA9IGBfX1NlY3VyZS0ke25hbWV9YDtcbiAgY29uc3QgcGFyc2VkQ29va2llID0gcGFyc2VDb29raWVzKGNvb2tpZXMpO1xuICBjb25zdCBzZXNzaW9uVG9rZW4gPSBwYXJzZWRDb29raWUuZ2V0KG5hbWUpIHx8IHBhcnNlZENvb2tpZS5nZXQoc2VjdXJlQ29va2llTmFtZSk7XG4gIGlmIChzZXNzaW9uVG9rZW4pIHtcbiAgICByZXR1cm4gc2Vzc2lvblRva2VuO1xuICB9XG4gIHJldHVybiBudWxsO1xufTtcbmNvbnN0IGdldENvb2tpZUNhY2hlID0gYXN5bmMgKHJlcXVlc3QsIGNvbmZpZykgPT4ge1xuICBjb25zdCBoZWFkZXJzID0gcmVxdWVzdCBpbnN0YW5jZW9mIEhlYWRlcnMgPyByZXF1ZXN0IDogcmVxdWVzdC5oZWFkZXJzO1xuICBjb25zdCBjb29raWVzID0gaGVhZGVycy5nZXQoXCJjb29raWVcIik7XG4gIGlmICghY29va2llcykge1xuICAgIHJldHVybiBudWxsO1xuICB9XG4gIGNvbnN0IHsgY29va2llTmFtZSA9IFwic2Vzc2lvbl9kYXRhXCIsIGNvb2tpZVByZWZpeCA9IFwiYmV0dGVyLWF1dGhcIiB9ID0gY29uZmlnIHx8IHt9O1xuICBjb25zdCBuYW1lID0gY29uZmlnPy5pc1NlY3VyZSAhPT0gdm9pZCAwID8gY29uZmlnLmlzU2VjdXJlID8gYF9fU2VjdXJlLSR7Y29va2llUHJlZml4fS4ke2Nvb2tpZU5hbWV9YCA6IGAke2Nvb2tpZVByZWZpeH0uJHtjb29raWVOYW1lfWAgOiBpc1Byb2R1Y3Rpb24gPyBgX19TZWN1cmUtJHtjb29raWVQcmVmaXh9LiR7Y29va2llTmFtZX1gIDogYCR7Y29va2llUHJlZml4fS4ke2Nvb2tpZU5hbWV9YDtcbiAgY29uc3QgcGFyc2VkQ29va2llID0gcGFyc2VDb29raWVzKGNvb2tpZXMpO1xuICBjb25zdCBzZXNzaW9uRGF0YSA9IHBhcnNlZENvb2tpZS5nZXQobmFtZSk7XG4gIGlmIChzZXNzaW9uRGF0YSkge1xuICAgIGNvbnN0IHNlc3Npb25EYXRhUGF5bG9hZCA9IHNhZmVKU09OUGFyc2UoYmluYXJ5LmRlY29kZShiYXNlNjRVcmwuZGVjb2RlKHNlc3Npb25EYXRhKSkpO1xuICAgIGlmICghc2Vzc2lvbkRhdGFQYXlsb2FkKSB7XG4gICAgICByZXR1cm4gbnVsbDtcbiAgICB9XG4gICAgY29uc3Qgc2VjcmV0ID0gY29uZmlnPy5zZWNyZXQgfHwgZW52LkJFVFRFUl9BVVRIX1NFQ1JFVDtcbiAgICBpZiAoIXNlY3JldCkge1xuICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgXCJnZXRDb29raWVDYWNoZSByZXF1aXJlcyBhIHNlY3JldCB0byBiZSBwcm92aWRlZC4gRWl0aGVyIHBhc3MgaXQgYXMgYW4gb3B0aW9uIG9yIHNldCB0aGUgQkVUVEVSX0FVVEhfU0VDUkVUIGVudmlyb25tZW50IHZhcmlhYmxlXCJcbiAgICAgICk7XG4gICAgfVxuICAgIGNvbnN0IGlzVmFsaWQgPSBhd2FpdCBjcmVhdGVITUFDKFwiU0hBLTI1NlwiLCBcImJhc2U2NHVybG5vcGFkXCIpLnZlcmlmeShcbiAgICAgIHNlY3JldCxcbiAgICAgIEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgLi4uc2Vzc2lvbkRhdGFQYXlsb2FkLnNlc3Npb24sXG4gICAgICAgIGV4cGlyZXNBdDogc2Vzc2lvbkRhdGFQYXlsb2FkLmV4cGlyZXNBdFxuICAgICAgfSksXG4gICAgICBzZXNzaW9uRGF0YVBheWxvYWQuc2lnbmF0dXJlXG4gICAgKTtcbiAgICBpZiAoIWlzVmFsaWQpIHtcbiAgICAgIHJldHVybiBudWxsO1xuICAgIH1cbiAgICByZXR1cm4gc2Vzc2lvbkRhdGFQYXlsb2FkLnNlc3Npb247XG4gIH1cbiAgcmV0dXJuIG51bGw7XG59O1xuXG5leHBvcnQgeyBwYXJzZUNvb2tpZXMgYXMgYSwgc2V0Q29va2llQ2FjaGUgYXMgYiwgY3JlYXRlQ29va2llR2V0dGVyIGFzIGMsIGRlbGV0ZVNlc3Npb25Db29raWUgYXMgZCwgc2V0Q29va2llVG9IZWFkZXIgYXMgZSwgZ2V0U2Vzc2lvbkNvb2tpZSBhcyBmLCBnZXRDb29raWVzIGFzIGcsIGdldENvb2tpZUNhY2hlIGFzIGgsIG1zIGFzIG0sIHBhcnNlU2V0Q29va2llSGVhZGVyIGFzIHAsIHNldFNlc3Npb25Db29raWUgYXMgcyB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.UfVWArIB.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/dist/shared/better-auth.YwDQhoPc.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.YwDQhoPc.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   c: () => (/* binding */ checkPassword),\n/* harmony export */   v: () => (/* binding */ validatePassword)\n/* harmony export */ });\n/* harmony import */ var better_call__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! better-call */ \"(rsc)/./node_modules/better-call/dist/index.js\");\n\n\nasync function validatePassword(ctx, data) {\n  const accounts = await ctx.context.internalAdapter.findAccounts(data.userId);\n  const credentialAccount = accounts?.find(\n    (account) => account.providerId === \"credential\"\n  );\n  const currentPassword = credentialAccount?.password;\n  if (!credentialAccount || !currentPassword) {\n    return false;\n  }\n  const compare = await ctx.context.password.verify({\n    hash: currentPassword,\n    password: data.password\n  });\n  return compare;\n}\nasync function checkPassword(userId, c) {\n  const accounts = await c.context.internalAdapter.findAccounts(userId);\n  const credentialAccount = accounts?.find(\n    (account) => account.providerId === \"credential\"\n  );\n  const currentPassword = credentialAccount?.password;\n  if (!credentialAccount || !currentPassword || !c.body.password) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n      message: \"No password credential found\"\n    });\n  }\n  const compare = await c.context.password.verify({\n    hash: currentPassword,\n    password: c.body.password\n  });\n  if (!compare) {\n    throw new better_call__WEBPACK_IMPORTED_MODULE_0__.APIError(\"BAD_REQUEST\", {\n      message: \"Invalid password\"\n    });\n  }\n  return true;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguWXdEUWhvUGMubWpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUF1Qzs7QUFFdkM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWMsaURBQVE7QUFDdEI7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0g7QUFDQSxjQUFjLGlEQUFRO0FBQ3RCO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTs7QUFFcUQiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXGRpc3RcXHNoYXJlZFxcYmV0dGVyLWF1dGguWXdEUWhvUGMubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEFQSUVycm9yIH0gZnJvbSAnYmV0dGVyLWNhbGwnO1xuXG5hc3luYyBmdW5jdGlvbiB2YWxpZGF0ZVBhc3N3b3JkKGN0eCwgZGF0YSkge1xuICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGN0eC5jb250ZXh0LmludGVybmFsQWRhcHRlci5maW5kQWNjb3VudHMoZGF0YS51c2VySWQpO1xuICBjb25zdCBjcmVkZW50aWFsQWNjb3VudCA9IGFjY291bnRzPy5maW5kKFxuICAgIChhY2NvdW50KSA9PiBhY2NvdW50LnByb3ZpZGVySWQgPT09IFwiY3JlZGVudGlhbFwiXG4gICk7XG4gIGNvbnN0IGN1cnJlbnRQYXNzd29yZCA9IGNyZWRlbnRpYWxBY2NvdW50Py5wYXNzd29yZDtcbiAgaWYgKCFjcmVkZW50aWFsQWNjb3VudCB8fCAhY3VycmVudFBhc3N3b3JkKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG4gIGNvbnN0IGNvbXBhcmUgPSBhd2FpdCBjdHguY29udGV4dC5wYXNzd29yZC52ZXJpZnkoe1xuICAgIGhhc2g6IGN1cnJlbnRQYXNzd29yZCxcbiAgICBwYXNzd29yZDogZGF0YS5wYXNzd29yZFxuICB9KTtcbiAgcmV0dXJuIGNvbXBhcmU7XG59XG5hc3luYyBmdW5jdGlvbiBjaGVja1Bhc3N3b3JkKHVzZXJJZCwgYykge1xuICBjb25zdCBhY2NvdW50cyA9IGF3YWl0IGMuY29udGV4dC5pbnRlcm5hbEFkYXB0ZXIuZmluZEFjY291bnRzKHVzZXJJZCk7XG4gIGNvbnN0IGNyZWRlbnRpYWxBY2NvdW50ID0gYWNjb3VudHM/LmZpbmQoXG4gICAgKGFjY291bnQpID0+IGFjY291bnQucHJvdmlkZXJJZCA9PT0gXCJjcmVkZW50aWFsXCJcbiAgKTtcbiAgY29uc3QgY3VycmVudFBhc3N3b3JkID0gY3JlZGVudGlhbEFjY291bnQ/LnBhc3N3b3JkO1xuICBpZiAoIWNyZWRlbnRpYWxBY2NvdW50IHx8ICFjdXJyZW50UGFzc3dvcmQgfHwgIWMuYm9keS5wYXNzd29yZCkge1xuICAgIHRocm93IG5ldyBBUElFcnJvcihcIkJBRF9SRVFVRVNUXCIsIHtcbiAgICAgIG1lc3NhZ2U6IFwiTm8gcGFzc3dvcmQgY3JlZGVudGlhbCBmb3VuZFwiXG4gICAgfSk7XG4gIH1cbiAgY29uc3QgY29tcGFyZSA9IGF3YWl0IGMuY29udGV4dC5wYXNzd29yZC52ZXJpZnkoe1xuICAgIGhhc2g6IGN1cnJlbnRQYXNzd29yZCxcbiAgICBwYXNzd29yZDogYy5ib2R5LnBhc3N3b3JkXG4gIH0pO1xuICBpZiAoIWNvbXBhcmUpIHtcbiAgICB0aHJvdyBuZXcgQVBJRXJyb3IoXCJCQURfUkVRVUVTVFwiLCB7XG4gICAgICBtZXNzYWdlOiBcIkludmFsaWQgcGFzc3dvcmRcIlxuICAgIH0pO1xuICB9XG4gIHJldHVybiB0cnVlO1xufVxuXG5leHBvcnQgeyBjaGVja1Bhc3N3b3JkIGFzIGMsIHZhbGlkYXRlUGFzc3dvcmQgYXMgdiB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/dist/shared/better-auth.YwDQhoPc.mjs\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jwks/local.js":
/*!******************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/jwks/local.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createLocalJWKSet: () => (/* binding */ createLocalJWKSet)\n/* harmony export */ });\n/* harmony import */ var _key_import_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../key/import.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/key/import.js\");\n/* harmony import */ var _util_errors_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../util/errors.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/errors.js\");\n/* harmony import */ var _lib_is_object_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../lib/is_object.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_object.js\");\n\n\n\nfunction getKtyFromAlg(alg) {\n    switch (typeof alg === 'string' && alg.slice(0, 2)) {\n        case 'RS':\n        case 'PS':\n            return 'RSA';\n        case 'ES':\n            return 'EC';\n        case 'Ed':\n            return 'OKP';\n        case 'ML':\n            return 'AKP';\n        default:\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JOSENotSupported('Unsupported \"alg\" value for a JSON Web Key Set');\n    }\n}\nfunction isJWKSLike(jwks) {\n    return (jwks &&\n        typeof jwks === 'object' &&\n        Array.isArray(jwks.keys) &&\n        jwks.keys.every(isJWKLike));\n}\nfunction isJWKLike(key) {\n    return (0,_lib_is_object_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(key);\n}\nclass LocalJWKSet {\n    #jwks;\n    #cached = new WeakMap();\n    constructor(jwks) {\n        if (!isJWKSLike(jwks)) {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JWKSInvalid('JSON Web Key Set malformed');\n        }\n        this.#jwks = structuredClone(jwks);\n    }\n    jwks() {\n        return this.#jwks;\n    }\n    async getKey(protectedHeader, token) {\n        const { alg, kid } = { ...protectedHeader, ...token?.header };\n        const kty = getKtyFromAlg(alg);\n        const candidates = this.#jwks.keys.filter((jwk) => {\n            let candidate = kty === jwk.kty;\n            if (candidate && typeof kid === 'string') {\n                candidate = kid === jwk.kid;\n            }\n            if (candidate && (typeof jwk.alg === 'string' || kty === 'AKP')) {\n                candidate = alg === jwk.alg;\n            }\n            if (candidate && typeof jwk.use === 'string') {\n                candidate = jwk.use === 'sig';\n            }\n            if (candidate && Array.isArray(jwk.key_ops)) {\n                candidate = jwk.key_ops.includes('verify');\n            }\n            if (candidate) {\n                switch (alg) {\n                    case 'ES256':\n                        candidate = jwk.crv === 'P-256';\n                        break;\n                    case 'ES384':\n                        candidate = jwk.crv === 'P-384';\n                        break;\n                    case 'ES512':\n                        candidate = jwk.crv === 'P-521';\n                        break;\n                    case 'Ed25519':\n                    case 'EdDSA':\n                        candidate = jwk.crv === 'Ed25519';\n                        break;\n                }\n            }\n            return candidate;\n        });\n        const { 0: jwk, length } = candidates;\n        if (length === 0) {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JWKSNoMatchingKey();\n        }\n        if (length !== 1) {\n            const error = new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JWKSMultipleMatchingKeys();\n            const _cached = this.#cached;\n            error[Symbol.asyncIterator] = async function* () {\n                for (const jwk of candidates) {\n                    try {\n                        yield await importWithAlgCache(_cached, jwk, alg);\n                    }\n                    catch { }\n                }\n            };\n            throw error;\n        }\n        return importWithAlgCache(this.#cached, jwk, alg);\n    }\n}\nasync function importWithAlgCache(cache, jwk, alg) {\n    const cached = cache.get(jwk) || cache.set(jwk, {}).get(jwk);\n    if (cached[alg] === undefined) {\n        const key = await (0,_key_import_js__WEBPACK_IMPORTED_MODULE_2__.importJWK)({ ...jwk, ext: true }, alg);\n        if (key instanceof Uint8Array || key.type !== 'public') {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JWKSInvalid('JSON Web Key Set members must be public keys');\n        }\n        cached[alg] = key;\n    }\n    return cached[alg];\n}\nfunction createLocalJWKSet(jwks) {\n    const set = new LocalJWKSet(jwks);\n    const localJWKSet = async (protectedHeader, token) => set.getKey(protectedHeader, token);\n    Object.defineProperties(localJWKSet, {\n        jwks: {\n            value: () => structuredClone(set.jwks()),\n            enumerable: false,\n            configurable: false,\n            writable: false,\n        },\n    });\n    return localJWKSet;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvandrcy9sb2NhbC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQTZDO0FBQ21FO0FBQ3JFO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQiw2REFBZ0I7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsV0FBVyw2REFBUTtBQUNuQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0Isd0RBQVc7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQkFBZ0IsV0FBVyxJQUFJO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxnQkFBZ0IsaUJBQWlCO0FBQ2pDO0FBQ0Esc0JBQXNCLDhEQUFpQjtBQUN2QztBQUNBO0FBQ0EsOEJBQThCLHFFQUF3QjtBQUN0RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzREFBc0Q7QUFDdEQ7QUFDQSwwQkFBMEIseURBQVMsR0FBRyxtQkFBbUI7QUFDekQ7QUFDQSxzQkFBc0Isd0RBQVc7QUFDakM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcbm9kZV9tb2R1bGVzXFxqb3NlXFxkaXN0XFx3ZWJhcGlcXGp3a3NcXGxvY2FsLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGltcG9ydEpXSyB9IGZyb20gJy4uL2tleS9pbXBvcnQuanMnO1xuaW1wb3J0IHsgSldLU0ludmFsaWQsIEpPU0VOb3RTdXBwb3J0ZWQsIEpXS1NOb01hdGNoaW5nS2V5LCBKV0tTTXVsdGlwbGVNYXRjaGluZ0tleXMsIH0gZnJvbSAnLi4vdXRpbC9lcnJvcnMuanMnO1xuaW1wb3J0IGlzT2JqZWN0IGZyb20gJy4uL2xpYi9pc19vYmplY3QuanMnO1xuZnVuY3Rpb24gZ2V0S3R5RnJvbUFsZyhhbGcpIHtcbiAgICBzd2l0Y2ggKHR5cGVvZiBhbGcgPT09ICdzdHJpbmcnICYmIGFsZy5zbGljZSgwLCAyKSkge1xuICAgICAgICBjYXNlICdSUyc6XG4gICAgICAgIGNhc2UgJ1BTJzpcbiAgICAgICAgICAgIHJldHVybiAnUlNBJztcbiAgICAgICAgY2FzZSAnRVMnOlxuICAgICAgICAgICAgcmV0dXJuICdFQyc7XG4gICAgICAgIGNhc2UgJ0VkJzpcbiAgICAgICAgICAgIHJldHVybiAnT0tQJztcbiAgICAgICAgY2FzZSAnTUwnOlxuICAgICAgICAgICAgcmV0dXJuICdBS1AnO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdGhyb3cgbmV3IEpPU0VOb3RTdXBwb3J0ZWQoJ1Vuc3VwcG9ydGVkIFwiYWxnXCIgdmFsdWUgZm9yIGEgSlNPTiBXZWIgS2V5IFNldCcpO1xuICAgIH1cbn1cbmZ1bmN0aW9uIGlzSldLU0xpa2Uoandrcykge1xuICAgIHJldHVybiAoandrcyAmJlxuICAgICAgICB0eXBlb2YgandrcyA9PT0gJ29iamVjdCcgJiZcbiAgICAgICAgQXJyYXkuaXNBcnJheShqd2tzLmtleXMpICYmXG4gICAgICAgIGp3a3Mua2V5cy5ldmVyeShpc0pXS0xpa2UpKTtcbn1cbmZ1bmN0aW9uIGlzSldLTGlrZShrZXkpIHtcbiAgICByZXR1cm4gaXNPYmplY3Qoa2V5KTtcbn1cbmNsYXNzIExvY2FsSldLU2V0IHtcbiAgICAjandrcztcbiAgICAjY2FjaGVkID0gbmV3IFdlYWtNYXAoKTtcbiAgICBjb25zdHJ1Y3Rvcihqd2tzKSB7XG4gICAgICAgIGlmICghaXNKV0tTTGlrZShqd2tzKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEpXS1NJbnZhbGlkKCdKU09OIFdlYiBLZXkgU2V0IG1hbGZvcm1lZCcpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuI2p3a3MgPSBzdHJ1Y3R1cmVkQ2xvbmUoandrcyk7XG4gICAgfVxuICAgIGp3a3MoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiNqd2tzO1xuICAgIH1cbiAgICBhc3luYyBnZXRLZXkocHJvdGVjdGVkSGVhZGVyLCB0b2tlbikge1xuICAgICAgICBjb25zdCB7IGFsZywga2lkIH0gPSB7IC4uLnByb3RlY3RlZEhlYWRlciwgLi4udG9rZW4/LmhlYWRlciB9O1xuICAgICAgICBjb25zdCBrdHkgPSBnZXRLdHlGcm9tQWxnKGFsZyk7XG4gICAgICAgIGNvbnN0IGNhbmRpZGF0ZXMgPSB0aGlzLiNqd2tzLmtleXMuZmlsdGVyKChqd2spID0+IHtcbiAgICAgICAgICAgIGxldCBjYW5kaWRhdGUgPSBrdHkgPT09IGp3ay5rdHk7XG4gICAgICAgICAgICBpZiAoY2FuZGlkYXRlICYmIHR5cGVvZiBraWQgPT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICAgICAgY2FuZGlkYXRlID0ga2lkID09PSBqd2sua2lkO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNhbmRpZGF0ZSAmJiAodHlwZW9mIGp3ay5hbGcgPT09ICdzdHJpbmcnIHx8IGt0eSA9PT0gJ0FLUCcpKSB7XG4gICAgICAgICAgICAgICAgY2FuZGlkYXRlID0gYWxnID09PSBqd2suYWxnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGNhbmRpZGF0ZSAmJiB0eXBlb2YgandrLnVzZSA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgICAgICAgICBjYW5kaWRhdGUgPSBqd2sudXNlID09PSAnc2lnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGlmIChjYW5kaWRhdGUgJiYgQXJyYXkuaXNBcnJheShqd2sua2V5X29wcykpIHtcbiAgICAgICAgICAgICAgICBjYW5kaWRhdGUgPSBqd2sua2V5X29wcy5pbmNsdWRlcygndmVyaWZ5Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBpZiAoY2FuZGlkYXRlKSB7XG4gICAgICAgICAgICAgICAgc3dpdGNoIChhbGcpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnRVMyNTYnOlxuICAgICAgICAgICAgICAgICAgICAgICAgY2FuZGlkYXRlID0gandrLmNydiA9PT0gJ1AtMjU2JztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgICAgICBjYXNlICdFUzM4NCc6XG4gICAgICAgICAgICAgICAgICAgICAgICBjYW5kaWRhdGUgPSBqd2suY3J2ID09PSAnUC0zODQnO1xuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ0VTNTEyJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbmRpZGF0ZSA9IGp3ay5jcnYgPT09ICdQLTUyMSc7XG4gICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICAgICAgY2FzZSAnRWQyNTUxOSc6XG4gICAgICAgICAgICAgICAgICAgIGNhc2UgJ0VkRFNBJzpcbiAgICAgICAgICAgICAgICAgICAgICAgIGNhbmRpZGF0ZSA9IGp3ay5jcnYgPT09ICdFZDI1NTE5JztcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiBjYW5kaWRhdGU7XG4gICAgICAgIH0pO1xuICAgICAgICBjb25zdCB7IDA6IGp3aywgbGVuZ3RoIH0gPSBjYW5kaWRhdGVzO1xuICAgICAgICBpZiAobGVuZ3RoID09PSAwKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSldLU05vTWF0Y2hpbmdLZXkoKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAobGVuZ3RoICE9PSAxKSB7XG4gICAgICAgICAgICBjb25zdCBlcnJvciA9IG5ldyBKV0tTTXVsdGlwbGVNYXRjaGluZ0tleXMoKTtcbiAgICAgICAgICAgIGNvbnN0IF9jYWNoZWQgPSB0aGlzLiNjYWNoZWQ7XG4gICAgICAgICAgICBlcnJvcltTeW1ib2wuYXN5bmNJdGVyYXRvcl0gPSBhc3luYyBmdW5jdGlvbiogKCkge1xuICAgICAgICAgICAgICAgIGZvciAoY29uc3QgandrIG9mIGNhbmRpZGF0ZXMpIHtcbiAgICAgICAgICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHlpZWxkIGF3YWl0IGltcG9ydFdpdGhBbGdDYWNoZShfY2FjaGVkLCBqd2ssIGFsZyk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgY2F0Y2ggeyB9XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIHRocm93IGVycm9yO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBpbXBvcnRXaXRoQWxnQ2FjaGUodGhpcy4jY2FjaGVkLCBqd2ssIGFsZyk7XG4gICAgfVxufVxuYXN5bmMgZnVuY3Rpb24gaW1wb3J0V2l0aEFsZ0NhY2hlKGNhY2hlLCBqd2ssIGFsZykge1xuICAgIGNvbnN0IGNhY2hlZCA9IGNhY2hlLmdldChqd2spIHx8IGNhY2hlLnNldChqd2ssIHt9KS5nZXQoandrKTtcbiAgICBpZiAoY2FjaGVkW2FsZ10gPT09IHVuZGVmaW5lZCkge1xuICAgICAgICBjb25zdCBrZXkgPSBhd2FpdCBpbXBvcnRKV0soeyAuLi5qd2ssIGV4dDogdHJ1ZSB9LCBhbGcpO1xuICAgICAgICBpZiAoa2V5IGluc3RhbmNlb2YgVWludDhBcnJheSB8fCBrZXkudHlwZSAhPT0gJ3B1YmxpYycpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBKV0tTSW52YWxpZCgnSlNPTiBXZWIgS2V5IFNldCBtZW1iZXJzIG11c3QgYmUgcHVibGljIGtleXMnKTtcbiAgICAgICAgfVxuICAgICAgICBjYWNoZWRbYWxnXSA9IGtleTtcbiAgICB9XG4gICAgcmV0dXJuIGNhY2hlZFthbGddO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZUxvY2FsSldLU2V0KGp3a3MpIHtcbiAgICBjb25zdCBzZXQgPSBuZXcgTG9jYWxKV0tTZXQoandrcyk7XG4gICAgY29uc3QgbG9jYWxKV0tTZXQgPSBhc3luYyAocHJvdGVjdGVkSGVhZGVyLCB0b2tlbikgPT4gc2V0LmdldEtleShwcm90ZWN0ZWRIZWFkZXIsIHRva2VuKTtcbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydGllcyhsb2NhbEpXS1NldCwge1xuICAgICAgICBqd2tzOiB7XG4gICAgICAgICAgICB2YWx1ZTogKCkgPT4gc3RydWN0dXJlZENsb25lKHNldC5qd2tzKCkpLFxuICAgICAgICAgICAgZW51bWVyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgd3JpdGFibGU6IGZhbHNlLFxuICAgICAgICB9LFxuICAgIH0pO1xuICAgIHJldHVybiBsb2NhbEpXS1NldDtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jwks/local.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jwks/remote.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/jwks/remote.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   createRemoteJWKSet: () => (/* binding */ createRemoteJWKSet),\n/* harmony export */   customFetch: () => (/* binding */ customFetch),\n/* harmony export */   jwksCache: () => (/* binding */ jwksCache)\n/* harmony export */ });\n/* harmony import */ var _util_errors_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../util/errors.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/errors.js\");\n/* harmony import */ var _local_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./local.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jwks/local.js\");\n/* harmony import */ var _lib_is_object_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../lib/is_object.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_object.js\");\n\n\n\nfunction isCloudflareWorkers() {\n    return (typeof WebSocketPair !== 'undefined' ||\n        (typeof navigator !== 'undefined' && navigator.userAgent === 'Cloudflare-Workers') ||\n        (typeof EdgeRuntime !== 'undefined' && EdgeRuntime === 'vercel'));\n}\nlet USER_AGENT;\nif (typeof navigator === 'undefined' || !navigator.userAgent?.startsWith?.('Mozilla/5.0 ')) {\n    const NAME = 'jose';\n    const VERSION = 'v6.1.0';\n    USER_AGENT = `${NAME}/${VERSION}`;\n}\nconst customFetch = Symbol();\nasync function fetchJwks(url, headers, signal, fetchImpl = fetch) {\n    const response = await fetchImpl(url, {\n        method: 'GET',\n        signal,\n        redirect: 'manual',\n        headers,\n    }).catch((err) => {\n        if (err.name === 'TimeoutError') {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JWKSTimeout();\n        }\n        throw err;\n    });\n    if (response.status !== 200) {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JOSEError('Expected 200 OK from the JSON Web Key Set HTTP response');\n    }\n    try {\n        return await response.json();\n    }\n    catch {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JOSEError('Failed to parse the JSON Web Key Set HTTP response as JSON');\n    }\n}\nconst jwksCache = Symbol();\nfunction isFreshJwksCache(input, cacheMaxAge) {\n    if (typeof input !== 'object' || input === null) {\n        return false;\n    }\n    if (!('uat' in input) || typeof input.uat !== 'number' || Date.now() - input.uat >= cacheMaxAge) {\n        return false;\n    }\n    if (!('jwks' in input) ||\n        !(0,_lib_is_object_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(input.jwks) ||\n        !Array.isArray(input.jwks.keys) ||\n        !Array.prototype.every.call(input.jwks.keys, _lib_is_object_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])) {\n        return false;\n    }\n    return true;\n}\nclass RemoteJWKSet {\n    #url;\n    #timeoutDuration;\n    #cooldownDuration;\n    #cacheMaxAge;\n    #jwksTimestamp;\n    #pendingFetch;\n    #headers;\n    #customFetch;\n    #local;\n    #cache;\n    constructor(url, options) {\n        if (!(url instanceof URL)) {\n            throw new TypeError('url must be an instance of URL');\n        }\n        this.#url = new URL(url.href);\n        this.#timeoutDuration =\n            typeof options?.timeoutDuration === 'number' ? options?.timeoutDuration : 5000;\n        this.#cooldownDuration =\n            typeof options?.cooldownDuration === 'number' ? options?.cooldownDuration : 30000;\n        this.#cacheMaxAge = typeof options?.cacheMaxAge === 'number' ? options?.cacheMaxAge : 600000;\n        this.#headers = new Headers(options?.headers);\n        if (USER_AGENT && !this.#headers.has('User-Agent')) {\n            this.#headers.set('User-Agent', USER_AGENT);\n        }\n        if (!this.#headers.has('accept')) {\n            this.#headers.set('accept', 'application/json');\n            this.#headers.append('accept', 'application/jwk-set+json');\n        }\n        this.#customFetch = options?.[customFetch];\n        if (options?.[jwksCache] !== undefined) {\n            this.#cache = options?.[jwksCache];\n            if (isFreshJwksCache(options?.[jwksCache], this.#cacheMaxAge)) {\n                this.#jwksTimestamp = this.#cache.uat;\n                this.#local = (0,_local_js__WEBPACK_IMPORTED_MODULE_2__.createLocalJWKSet)(this.#cache.jwks);\n            }\n        }\n    }\n    pendingFetch() {\n        return !!this.#pendingFetch;\n    }\n    coolingDown() {\n        return typeof this.#jwksTimestamp === 'number'\n            ? Date.now() < this.#jwksTimestamp + this.#cooldownDuration\n            : false;\n    }\n    fresh() {\n        return typeof this.#jwksTimestamp === 'number'\n            ? Date.now() < this.#jwksTimestamp + this.#cacheMaxAge\n            : false;\n    }\n    jwks() {\n        return this.#local?.jwks();\n    }\n    async getKey(protectedHeader, token) {\n        if (!this.#local || !this.fresh()) {\n            await this.reload();\n        }\n        try {\n            return await this.#local(protectedHeader, token);\n        }\n        catch (err) {\n            if (err instanceof _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JWKSNoMatchingKey) {\n                if (this.coolingDown() === false) {\n                    await this.reload();\n                    return this.#local(protectedHeader, token);\n                }\n            }\n            throw err;\n        }\n    }\n    async reload() {\n        if (this.#pendingFetch && isCloudflareWorkers()) {\n            this.#pendingFetch = undefined;\n        }\n        this.#pendingFetch ||= fetchJwks(this.#url.href, this.#headers, AbortSignal.timeout(this.#timeoutDuration), this.#customFetch)\n            .then((json) => {\n            this.#local = (0,_local_js__WEBPACK_IMPORTED_MODULE_2__.createLocalJWKSet)(json);\n            if (this.#cache) {\n                this.#cache.uat = Date.now();\n                this.#cache.jwks = json;\n            }\n            this.#jwksTimestamp = Date.now();\n            this.#pendingFetch = undefined;\n        })\n            .catch((err) => {\n            this.#pendingFetch = undefined;\n            throw err;\n        });\n        await this.#pendingFetch;\n    }\n}\nfunction createRemoteJWKSet(url, options) {\n    const set = new RemoteJWKSet(url, options);\n    const remoteJWKSet = async (protectedHeader, token) => set.getKey(protectedHeader, token);\n    Object.defineProperties(remoteJWKSet, {\n        coolingDown: {\n            get: () => set.coolingDown(),\n            enumerable: true,\n            configurable: false,\n        },\n        fresh: {\n            get: () => set.fresh(),\n            enumerable: true,\n            configurable: false,\n        },\n        reload: {\n            value: () => set.reload(),\n            enumerable: true,\n            configurable: false,\n            writable: false,\n        },\n        reloading: {\n            get: () => set.pendingFetch(),\n            enumerable: true,\n            configurable: false,\n        },\n        jwks: {\n            value: () => set.jwks(),\n            enumerable: true,\n            configurable: false,\n            writable: false,\n        },\n    });\n    return remoteJWKSet;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvandrcy9yZW1vdGUuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBQThFO0FBQy9CO0FBQ0o7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLEtBQUssR0FBRyxRQUFRO0FBQ3BDO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQSxzQkFBc0Isd0RBQVc7QUFDakM7QUFDQTtBQUNBLEtBQUs7QUFDTDtBQUNBLGtCQUFrQixzREFBUztBQUMzQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLHNEQUFTO0FBQzNCO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTLDZEQUFRO0FBQ2pCO0FBQ0EscURBQXFELHlEQUFRO0FBQzdEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsNERBQWlCO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQiw4REFBaUI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiw0REFBaUI7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUztBQUNUO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVCxLQUFLO0FBQ0w7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcbm9kZV9tb2R1bGVzXFxqb3NlXFxkaXN0XFx3ZWJhcGlcXGp3a3NcXHJlbW90ZS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBKT1NFRXJyb3IsIEpXS1NOb01hdGNoaW5nS2V5LCBKV0tTVGltZW91dCB9IGZyb20gJy4uL3V0aWwvZXJyb3JzLmpzJztcbmltcG9ydCB7IGNyZWF0ZUxvY2FsSldLU2V0IH0gZnJvbSAnLi9sb2NhbC5qcyc7XG5pbXBvcnQgaXNPYmplY3QgZnJvbSAnLi4vbGliL2lzX29iamVjdC5qcyc7XG5mdW5jdGlvbiBpc0Nsb3VkZmxhcmVXb3JrZXJzKCkge1xuICAgIHJldHVybiAodHlwZW9mIFdlYlNvY2tldFBhaXIgIT09ICd1bmRlZmluZWQnIHx8XG4gICAgICAgICh0eXBlb2YgbmF2aWdhdG9yICE9PSAndW5kZWZpbmVkJyAmJiBuYXZpZ2F0b3IudXNlckFnZW50ID09PSAnQ2xvdWRmbGFyZS1Xb3JrZXJzJykgfHxcbiAgICAgICAgKHR5cGVvZiBFZGdlUnVudGltZSAhPT0gJ3VuZGVmaW5lZCcgJiYgRWRnZVJ1bnRpbWUgPT09ICd2ZXJjZWwnKSk7XG59XG5sZXQgVVNFUl9BR0VOVDtcbmlmICh0eXBlb2YgbmF2aWdhdG9yID09PSAndW5kZWZpbmVkJyB8fCAhbmF2aWdhdG9yLnVzZXJBZ2VudD8uc3RhcnRzV2l0aD8uKCdNb3ppbGxhLzUuMCAnKSkge1xuICAgIGNvbnN0IE5BTUUgPSAnam9zZSc7XG4gICAgY29uc3QgVkVSU0lPTiA9ICd2Ni4xLjAnO1xuICAgIFVTRVJfQUdFTlQgPSBgJHtOQU1FfS8ke1ZFUlNJT059YDtcbn1cbmV4cG9ydCBjb25zdCBjdXN0b21GZXRjaCA9IFN5bWJvbCgpO1xuYXN5bmMgZnVuY3Rpb24gZmV0Y2hKd2tzKHVybCwgaGVhZGVycywgc2lnbmFsLCBmZXRjaEltcGwgPSBmZXRjaCkge1xuICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgZmV0Y2hJbXBsKHVybCwge1xuICAgICAgICBtZXRob2Q6ICdHRVQnLFxuICAgICAgICBzaWduYWwsXG4gICAgICAgIHJlZGlyZWN0OiAnbWFudWFsJyxcbiAgICAgICAgaGVhZGVycyxcbiAgICB9KS5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgIGlmIChlcnIubmFtZSA9PT0gJ1RpbWVvdXRFcnJvcicpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBKV0tTVGltZW91dCgpO1xuICAgICAgICB9XG4gICAgICAgIHRocm93IGVycjtcbiAgICB9KTtcbiAgICBpZiAocmVzcG9uc2Uuc3RhdHVzICE9PSAyMDApIHtcbiAgICAgICAgdGhyb3cgbmV3IEpPU0VFcnJvcignRXhwZWN0ZWQgMjAwIE9LIGZyb20gdGhlIEpTT04gV2ViIEtleSBTZXQgSFRUUCByZXNwb25zZScpO1xuICAgIH1cbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgIH1cbiAgICBjYXRjaCB7XG4gICAgICAgIHRocm93IG5ldyBKT1NFRXJyb3IoJ0ZhaWxlZCB0byBwYXJzZSB0aGUgSlNPTiBXZWIgS2V5IFNldCBIVFRQIHJlc3BvbnNlIGFzIEpTT04nKTtcbiAgICB9XG59XG5leHBvcnQgY29uc3Qgandrc0NhY2hlID0gU3ltYm9sKCk7XG5mdW5jdGlvbiBpc0ZyZXNoSndrc0NhY2hlKGlucHV0LCBjYWNoZU1heEFnZSkge1xuICAgIGlmICh0eXBlb2YgaW5wdXQgIT09ICdvYmplY3QnIHx8IGlucHV0ID09PSBudWxsKSB7XG4gICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgaWYgKCEoJ3VhdCcgaW4gaW5wdXQpIHx8IHR5cGVvZiBpbnB1dC51YXQgIT09ICdudW1iZXInIHx8IERhdGUubm93KCkgLSBpbnB1dC51YXQgPj0gY2FjaGVNYXhBZ2UpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoISgnandrcycgaW4gaW5wdXQpIHx8XG4gICAgICAgICFpc09iamVjdChpbnB1dC5qd2tzKSB8fFxuICAgICAgICAhQXJyYXkuaXNBcnJheShpbnB1dC5qd2tzLmtleXMpIHx8XG4gICAgICAgICFBcnJheS5wcm90b3R5cGUuZXZlcnkuY2FsbChpbnB1dC5qd2tzLmtleXMsIGlzT2JqZWN0KSkge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufVxuY2xhc3MgUmVtb3RlSldLU2V0IHtcbiAgICAjdXJsO1xuICAgICN0aW1lb3V0RHVyYXRpb247XG4gICAgI2Nvb2xkb3duRHVyYXRpb247XG4gICAgI2NhY2hlTWF4QWdlO1xuICAgICNqd2tzVGltZXN0YW1wO1xuICAgICNwZW5kaW5nRmV0Y2g7XG4gICAgI2hlYWRlcnM7XG4gICAgI2N1c3RvbUZldGNoO1xuICAgICNsb2NhbDtcbiAgICAjY2FjaGU7XG4gICAgY29uc3RydWN0b3IodXJsLCBvcHRpb25zKSB7XG4gICAgICAgIGlmICghKHVybCBpbnN0YW5jZW9mIFVSTCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3VybCBtdXN0IGJlIGFuIGluc3RhbmNlIG9mIFVSTCcpO1xuICAgICAgICB9XG4gICAgICAgIHRoaXMuI3VybCA9IG5ldyBVUkwodXJsLmhyZWYpO1xuICAgICAgICB0aGlzLiN0aW1lb3V0RHVyYXRpb24gPVxuICAgICAgICAgICAgdHlwZW9mIG9wdGlvbnM/LnRpbWVvdXREdXJhdGlvbiA9PT0gJ251bWJlcicgPyBvcHRpb25zPy50aW1lb3V0RHVyYXRpb24gOiA1MDAwO1xuICAgICAgICB0aGlzLiNjb29sZG93bkR1cmF0aW9uID1cbiAgICAgICAgICAgIHR5cGVvZiBvcHRpb25zPy5jb29sZG93bkR1cmF0aW9uID09PSAnbnVtYmVyJyA/IG9wdGlvbnM/LmNvb2xkb3duRHVyYXRpb24gOiAzMDAwMDtcbiAgICAgICAgdGhpcy4jY2FjaGVNYXhBZ2UgPSB0eXBlb2Ygb3B0aW9ucz8uY2FjaGVNYXhBZ2UgPT09ICdudW1iZXInID8gb3B0aW9ucz8uY2FjaGVNYXhBZ2UgOiA2MDAwMDA7XG4gICAgICAgIHRoaXMuI2hlYWRlcnMgPSBuZXcgSGVhZGVycyhvcHRpb25zPy5oZWFkZXJzKTtcbiAgICAgICAgaWYgKFVTRVJfQUdFTlQgJiYgIXRoaXMuI2hlYWRlcnMuaGFzKCdVc2VyLUFnZW50JykpIHtcbiAgICAgICAgICAgIHRoaXMuI2hlYWRlcnMuc2V0KCdVc2VyLUFnZW50JywgVVNFUl9BR0VOVCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCF0aGlzLiNoZWFkZXJzLmhhcygnYWNjZXB0JykpIHtcbiAgICAgICAgICAgIHRoaXMuI2hlYWRlcnMuc2V0KCdhY2NlcHQnLCAnYXBwbGljYXRpb24vanNvbicpO1xuICAgICAgICAgICAgdGhpcy4jaGVhZGVycy5hcHBlbmQoJ2FjY2VwdCcsICdhcHBsaWNhdGlvbi9qd2stc2V0K2pzb24nKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLiNjdXN0b21GZXRjaCA9IG9wdGlvbnM/LltjdXN0b21GZXRjaF07XG4gICAgICAgIGlmIChvcHRpb25zPy5bandrc0NhY2hlXSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aGlzLiNjYWNoZSA9IG9wdGlvbnM/Lltqd2tzQ2FjaGVdO1xuICAgICAgICAgICAgaWYgKGlzRnJlc2hKd2tzQ2FjaGUob3B0aW9ucz8uW2p3a3NDYWNoZV0sIHRoaXMuI2NhY2hlTWF4QWdlKSkge1xuICAgICAgICAgICAgICAgIHRoaXMuI2p3a3NUaW1lc3RhbXAgPSB0aGlzLiNjYWNoZS51YXQ7XG4gICAgICAgICAgICAgICAgdGhpcy4jbG9jYWwgPSBjcmVhdGVMb2NhbEpXS1NldCh0aGlzLiNjYWNoZS5qd2tzKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBwZW5kaW5nRmV0Y2goKSB7XG4gICAgICAgIHJldHVybiAhIXRoaXMuI3BlbmRpbmdGZXRjaDtcbiAgICB9XG4gICAgY29vbGluZ0Rvd24oKSB7XG4gICAgICAgIHJldHVybiB0eXBlb2YgdGhpcy4jandrc1RpbWVzdGFtcCA9PT0gJ251bWJlcidcbiAgICAgICAgICAgID8gRGF0ZS5ub3coKSA8IHRoaXMuI2p3a3NUaW1lc3RhbXAgKyB0aGlzLiNjb29sZG93bkR1cmF0aW9uXG4gICAgICAgICAgICA6IGZhbHNlO1xuICAgIH1cbiAgICBmcmVzaCgpIHtcbiAgICAgICAgcmV0dXJuIHR5cGVvZiB0aGlzLiNqd2tzVGltZXN0YW1wID09PSAnbnVtYmVyJ1xuICAgICAgICAgICAgPyBEYXRlLm5vdygpIDwgdGhpcy4jandrc1RpbWVzdGFtcCArIHRoaXMuI2NhY2hlTWF4QWdlXG4gICAgICAgICAgICA6IGZhbHNlO1xuICAgIH1cbiAgICBqd2tzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy4jbG9jYWw/Lmp3a3MoKTtcbiAgICB9XG4gICAgYXN5bmMgZ2V0S2V5KHByb3RlY3RlZEhlYWRlciwgdG9rZW4pIHtcbiAgICAgICAgaWYgKCF0aGlzLiNsb2NhbCB8fCAhdGhpcy5mcmVzaCgpKSB7XG4gICAgICAgICAgICBhd2FpdCB0aGlzLnJlbG9hZCgpO1xuICAgICAgICB9XG4gICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgdGhpcy4jbG9jYWwocHJvdGVjdGVkSGVhZGVyLCB0b2tlbik7XG4gICAgICAgIH1cbiAgICAgICAgY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIEpXS1NOb01hdGNoaW5nS2V5KSB7XG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuY29vbGluZ0Rvd24oKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5yZWxvYWQoKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuI2xvY2FsKHByb3RlY3RlZEhlYWRlciwgdG9rZW4pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRocm93IGVycjtcbiAgICAgICAgfVxuICAgIH1cbiAgICBhc3luYyByZWxvYWQoKSB7XG4gICAgICAgIGlmICh0aGlzLiNwZW5kaW5nRmV0Y2ggJiYgaXNDbG91ZGZsYXJlV29ya2VycygpKSB7XG4gICAgICAgICAgICB0aGlzLiNwZW5kaW5nRmV0Y2ggPSB1bmRlZmluZWQ7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy4jcGVuZGluZ0ZldGNoIHx8PSBmZXRjaEp3a3ModGhpcy4jdXJsLmhyZWYsIHRoaXMuI2hlYWRlcnMsIEFib3J0U2lnbmFsLnRpbWVvdXQodGhpcy4jdGltZW91dER1cmF0aW9uKSwgdGhpcy4jY3VzdG9tRmV0Y2gpXG4gICAgICAgICAgICAudGhlbigoanNvbikgPT4ge1xuICAgICAgICAgICAgdGhpcy4jbG9jYWwgPSBjcmVhdGVMb2NhbEpXS1NldChqc29uKTtcbiAgICAgICAgICAgIGlmICh0aGlzLiNjYWNoZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuI2NhY2hlLnVhdCA9IERhdGUubm93KCk7XG4gICAgICAgICAgICAgICAgdGhpcy4jY2FjaGUuandrcyA9IGpzb247XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICB0aGlzLiNqd2tzVGltZXN0YW1wID0gRGF0ZS5ub3coKTtcbiAgICAgICAgICAgIHRoaXMuI3BlbmRpbmdGZXRjaCA9IHVuZGVmaW5lZDtcbiAgICAgICAgfSlcbiAgICAgICAgICAgIC5jYXRjaCgoZXJyKSA9PiB7XG4gICAgICAgICAgICB0aGlzLiNwZW5kaW5nRmV0Y2ggPSB1bmRlZmluZWQ7XG4gICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgIH0pO1xuICAgICAgICBhd2FpdCB0aGlzLiNwZW5kaW5nRmV0Y2g7XG4gICAgfVxufVxuZXhwb3J0IGZ1bmN0aW9uIGNyZWF0ZVJlbW90ZUpXS1NldCh1cmwsIG9wdGlvbnMpIHtcbiAgICBjb25zdCBzZXQgPSBuZXcgUmVtb3RlSldLU2V0KHVybCwgb3B0aW9ucyk7XG4gICAgY29uc3QgcmVtb3RlSldLU2V0ID0gYXN5bmMgKHByb3RlY3RlZEhlYWRlciwgdG9rZW4pID0+IHNldC5nZXRLZXkocHJvdGVjdGVkSGVhZGVyLCB0b2tlbik7XG4gICAgT2JqZWN0LmRlZmluZVByb3BlcnRpZXMocmVtb3RlSldLU2V0LCB7XG4gICAgICAgIGNvb2xpbmdEb3duOiB7XG4gICAgICAgICAgICBnZXQ6ICgpID0+IHNldC5jb29saW5nRG93bigpLFxuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICAgIGZyZXNoOiB7XG4gICAgICAgICAgICBnZXQ6ICgpID0+IHNldC5mcmVzaCgpLFxuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICAgIHJlbG9hZDoge1xuICAgICAgICAgICAgdmFsdWU6ICgpID0+IHNldC5yZWxvYWQoKSxcbiAgICAgICAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICAgICAgICBjb25maWd1cmFibGU6IGZhbHNlLFxuICAgICAgICAgICAgd3JpdGFibGU6IGZhbHNlLFxuICAgICAgICB9LFxuICAgICAgICByZWxvYWRpbmc6IHtcbiAgICAgICAgICAgIGdldDogKCkgPT4gc2V0LnBlbmRpbmdGZXRjaCgpLFxuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgICAgIGp3a3M6IHtcbiAgICAgICAgICAgIHZhbHVlOiAoKSA9PiBzZXQuandrcygpLFxuICAgICAgICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgICAgICAgIGNvbmZpZ3VyYWJsZTogZmFsc2UsXG4gICAgICAgICAgICB3cml0YWJsZTogZmFsc2UsXG4gICAgICAgIH0sXG4gICAgfSk7XG4gICAgcmV0dXJuIHJlbW90ZUpXS1NldDtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jwks/remote.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jws/compact/sign.js":
/*!************************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/jws/compact/sign.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   CompactSign: () => (/* binding */ CompactSign)\n/* harmony export */ });\n/* harmony import */ var _flattened_sign_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../flattened/sign.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jws/flattened/sign.js\");\n\nclass CompactSign {\n    #flattened;\n    constructor(payload) {\n        this.#flattened = new _flattened_sign_js__WEBPACK_IMPORTED_MODULE_0__.FlattenedSign(payload);\n    }\n    setProtectedHeader(protectedHeader) {\n        this.#flattened.setProtectedHeader(protectedHeader);\n        return this;\n    }\n    async sign(key, options) {\n        const jws = await this.#flattened.sign(key, options);\n        if (jws.payload === undefined) {\n            throw new TypeError('use the flattened module for creating JWS with b64: false');\n        }\n        return `${jws.protected}.${jws.payload}.${jws.signature}`;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvandzL2NvbXBhY3Qvc2lnbi5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFxRDtBQUM5QztBQUNQO0FBQ0E7QUFDQSw4QkFBOEIsNkRBQWE7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQkFBa0IsY0FBYyxHQUFHLFlBQVksR0FBRyxjQUFjO0FBQ2hFO0FBQ0EiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXG5vZGVfbW9kdWxlc1xcam9zZVxcZGlzdFxcd2ViYXBpXFxqd3NcXGNvbXBhY3RcXHNpZ24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRmxhdHRlbmVkU2lnbiB9IGZyb20gJy4uL2ZsYXR0ZW5lZC9zaWduLmpzJztcbmV4cG9ydCBjbGFzcyBDb21wYWN0U2lnbiB7XG4gICAgI2ZsYXR0ZW5lZDtcbiAgICBjb25zdHJ1Y3RvcihwYXlsb2FkKSB7XG4gICAgICAgIHRoaXMuI2ZsYXR0ZW5lZCA9IG5ldyBGbGF0dGVuZWRTaWduKHBheWxvYWQpO1xuICAgIH1cbiAgICBzZXRQcm90ZWN0ZWRIZWFkZXIocHJvdGVjdGVkSGVhZGVyKSB7XG4gICAgICAgIHRoaXMuI2ZsYXR0ZW5lZC5zZXRQcm90ZWN0ZWRIZWFkZXIocHJvdGVjdGVkSGVhZGVyKTtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGFzeW5jIHNpZ24oa2V5LCBvcHRpb25zKSB7XG4gICAgICAgIGNvbnN0IGp3cyA9IGF3YWl0IHRoaXMuI2ZsYXR0ZW5lZC5zaWduKGtleSwgb3B0aW9ucyk7XG4gICAgICAgIGlmIChqd3MucGF5bG9hZCA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCd1c2UgdGhlIGZsYXR0ZW5lZCBtb2R1bGUgZm9yIGNyZWF0aW5nIEpXUyB3aXRoIGI2NDogZmFsc2UnKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gYCR7andzLnByb3RlY3RlZH0uJHtqd3MucGF5bG9hZH0uJHtqd3Muc2lnbmF0dXJlfWA7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jws/compact/sign.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jws/compact/verify.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/jws/compact/verify.js ***!
  \**************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   compactVerify: () => (/* binding */ compactVerify)\n/* harmony export */ });\n/* harmony import */ var _flattened_verify_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../flattened/verify.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jws/flattened/verify.js\");\n/* harmony import */ var _util_errors_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../util/errors.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/errors.js\");\n/* harmony import */ var _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/buffer_utils.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/buffer_utils.js\");\n\n\n\nasync function compactVerify(jws, key, options) {\n    if (jws instanceof Uint8Array) {\n        jws = _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_0__.decoder.decode(jws);\n    }\n    if (typeof jws !== 'string') {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWSInvalid('Compact JWS must be a string or Uint8Array');\n    }\n    const { 0: protectedHeader, 1: payload, 2: signature, length } = jws.split('.');\n    if (length !== 3) {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWSInvalid('Invalid Compact JWS');\n    }\n    const verified = await (0,_flattened_verify_js__WEBPACK_IMPORTED_MODULE_2__.flattenedVerify)({ payload, protected: protectedHeader, signature }, key, options);\n    const result = { payload: verified.payload, protectedHeader: verified.protectedHeader };\n    if (typeof key === 'function') {\n        return { ...result, key: verified.key };\n    }\n    return result;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvandzL2NvbXBhY3QvdmVyaWZ5LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBeUQ7QUFDUDtBQUNFO0FBQzdDO0FBQ1A7QUFDQSxjQUFjLHlEQUFPO0FBQ3JCO0FBQ0E7QUFDQSxrQkFBa0IsdURBQVU7QUFDNUI7QUFDQSxZQUFZLHVEQUF1RDtBQUNuRTtBQUNBLGtCQUFrQix1REFBVTtBQUM1QjtBQUNBLDJCQUEyQixxRUFBZSxHQUFHLGdEQUFnRDtBQUM3RixxQkFBcUI7QUFDckI7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxub2RlX21vZHVsZXNcXGpvc2VcXGRpc3RcXHdlYmFwaVxcandzXFxjb21wYWN0XFx2ZXJpZnkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZmxhdHRlbmVkVmVyaWZ5IH0gZnJvbSAnLi4vZmxhdHRlbmVkL3ZlcmlmeS5qcyc7XG5pbXBvcnQgeyBKV1NJbnZhbGlkIH0gZnJvbSAnLi4vLi4vdXRpbC9lcnJvcnMuanMnO1xuaW1wb3J0IHsgZGVjb2RlciB9IGZyb20gJy4uLy4uL2xpYi9idWZmZXJfdXRpbHMuanMnO1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGNvbXBhY3RWZXJpZnkoandzLCBrZXksIG9wdGlvbnMpIHtcbiAgICBpZiAoandzIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgICAgICBqd3MgPSBkZWNvZGVyLmRlY29kZShqd3MpO1xuICAgIH1cbiAgICBpZiAodHlwZW9mIGp3cyAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEpXU0ludmFsaWQoJ0NvbXBhY3QgSldTIG11c3QgYmUgYSBzdHJpbmcgb3IgVWludDhBcnJheScpO1xuICAgIH1cbiAgICBjb25zdCB7IDA6IHByb3RlY3RlZEhlYWRlciwgMTogcGF5bG9hZCwgMjogc2lnbmF0dXJlLCBsZW5ndGggfSA9IGp3cy5zcGxpdCgnLicpO1xuICAgIGlmIChsZW5ndGggIT09IDMpIHtcbiAgICAgICAgdGhyb3cgbmV3IEpXU0ludmFsaWQoJ0ludmFsaWQgQ29tcGFjdCBKV1MnKTtcbiAgICB9XG4gICAgY29uc3QgdmVyaWZpZWQgPSBhd2FpdCBmbGF0dGVuZWRWZXJpZnkoeyBwYXlsb2FkLCBwcm90ZWN0ZWQ6IHByb3RlY3RlZEhlYWRlciwgc2lnbmF0dXJlIH0sIGtleSwgb3B0aW9ucyk7XG4gICAgY29uc3QgcmVzdWx0ID0geyBwYXlsb2FkOiB2ZXJpZmllZC5wYXlsb2FkLCBwcm90ZWN0ZWRIZWFkZXI6IHZlcmlmaWVkLnByb3RlY3RlZEhlYWRlciB9O1xuICAgIGlmICh0eXBlb2Yga2V5ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHJldHVybiB7IC4uLnJlc3VsdCwga2V5OiB2ZXJpZmllZC5rZXkgfTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jws/compact/verify.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jws/flattened/sign.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/jws/flattened/sign.js ***!
  \**************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   FlattenedSign: () => (/* binding */ FlattenedSign)\n/* harmony export */ });\n/* harmony import */ var _util_base64url_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../util/base64url.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/base64url.js\");\n/* harmony import */ var _lib_sign_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../lib/sign.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/sign.js\");\n/* harmony import */ var _lib_is_disjoint_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../lib/is_disjoint.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_disjoint.js\");\n/* harmony import */ var _util_errors_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../util/errors.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/errors.js\");\n/* harmony import */ var _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../lib/buffer_utils.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/buffer_utils.js\");\n/* harmony import */ var _lib_check_key_type_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../lib/check_key_type.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/check_key_type.js\");\n/* harmony import */ var _lib_validate_crit_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../lib/validate_crit.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/validate_crit.js\");\n/* harmony import */ var _lib_normalize_key_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../lib/normalize_key.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/normalize_key.js\");\n\n\n\n\n\n\n\n\nclass FlattenedSign {\n    #payload;\n    #protectedHeader;\n    #unprotectedHeader;\n    constructor(payload) {\n        if (!(payload instanceof Uint8Array)) {\n            throw new TypeError('payload must be an instance of Uint8Array');\n        }\n        this.#payload = payload;\n    }\n    setProtectedHeader(protectedHeader) {\n        if (this.#protectedHeader) {\n            throw new TypeError('setProtectedHeader can only be called once');\n        }\n        this.#protectedHeader = protectedHeader;\n        return this;\n    }\n    setUnprotectedHeader(unprotectedHeader) {\n        if (this.#unprotectedHeader) {\n            throw new TypeError('setUnprotectedHeader can only be called once');\n        }\n        this.#unprotectedHeader = unprotectedHeader;\n        return this;\n    }\n    async sign(key, options) {\n        if (!this.#protectedHeader && !this.#unprotectedHeader) {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JWSInvalid('either setProtectedHeader or setUnprotectedHeader must be called before #sign()');\n        }\n        if (!(0,_lib_is_disjoint_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(this.#protectedHeader, this.#unprotectedHeader)) {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JWSInvalid('JWS Protected and JWS Unprotected Header Parameter names must be disjoint');\n        }\n        const joseHeader = {\n            ...this.#protectedHeader,\n            ...this.#unprotectedHeader,\n        };\n        const extensions = (0,_lib_validate_crit_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(_util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JWSInvalid, new Map([['b64', true]]), options?.crit, this.#protectedHeader, joseHeader);\n        let b64 = true;\n        if (extensions.has('b64')) {\n            b64 = this.#protectedHeader.b64;\n            if (typeof b64 !== 'boolean') {\n                throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JWSInvalid('The \"b64\" (base64url-encode payload) Header Parameter must be a boolean');\n            }\n        }\n        const { alg } = joseHeader;\n        if (typeof alg !== 'string' || !alg) {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JWSInvalid('JWS \"alg\" (Algorithm) Header Parameter missing or invalid');\n        }\n        (0,_lib_check_key_type_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(alg, key, 'sign');\n        let payload = this.#payload;\n        if (b64) {\n            payload = _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_4__.encoder.encode((0,_util_base64url_js__WEBPACK_IMPORTED_MODULE_5__.encode)(payload));\n        }\n        let protectedHeader;\n        if (this.#protectedHeader) {\n            protectedHeader = _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_4__.encoder.encode((0,_util_base64url_js__WEBPACK_IMPORTED_MODULE_5__.encode)(JSON.stringify(this.#protectedHeader)));\n        }\n        else {\n            protectedHeader = _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_4__.encoder.encode('');\n        }\n        const data = (0,_lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_4__.concat)(protectedHeader, _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_4__.encoder.encode('.'), payload);\n        const k = await (0,_lib_normalize_key_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(key, alg);\n        const signature = await (0,_lib_sign_js__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(alg, k, data);\n        const jws = {\n            signature: (0,_util_base64url_js__WEBPACK_IMPORTED_MODULE_5__.encode)(signature),\n            payload: '',\n        };\n        if (b64) {\n            jws.payload = _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_4__.decoder.decode(payload);\n        }\n        if (this.#unprotectedHeader) {\n            jws.header = this.#unprotectedHeader;\n        }\n        if (this.#protectedHeader) {\n            jws.protected = _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_4__.decoder.decode(protectedHeader);\n        }\n        return jws;\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvandzL2ZsYXR0ZW5lZC9zaWduLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7OztBQUF5RDtBQUNwQjtBQUNhO0FBQ0E7QUFDbUI7QUFDZDtBQUNEO0FBQ0E7QUFDL0M7QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix1REFBVTtBQUNoQztBQUNBLGFBQWEsK0RBQVU7QUFDdkIsc0JBQXNCLHVEQUFVO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQkFBMkIsaUVBQVksQ0FBQyx1REFBVTtBQUNsRDtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQix1REFBVTtBQUNwQztBQUNBO0FBQ0EsZ0JBQWdCLE1BQU07QUFDdEI7QUFDQSxzQkFBc0IsdURBQVU7QUFDaEM7QUFDQSxRQUFRLGtFQUFZO0FBQ3BCO0FBQ0E7QUFDQSxzQkFBc0IseURBQU8sUUFBUSwwREFBSTtBQUN6QztBQUNBO0FBQ0E7QUFDQSw4QkFBOEIseURBQU8sUUFBUSwwREFBSTtBQUNqRDtBQUNBO0FBQ0EsOEJBQThCLHlEQUFPO0FBQ3JDO0FBQ0EscUJBQXFCLDREQUFNLGtCQUFrQix5REFBTztBQUNwRCx3QkFBd0IsaUVBQVk7QUFDcEMsZ0NBQWdDLHdEQUFJO0FBQ3BDO0FBQ0EsdUJBQXVCLDBEQUFJO0FBQzNCO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQix5REFBTztBQUNqQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLHlEQUFPO0FBQ25DO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxub2RlX21vZHVsZXNcXGpvc2VcXGRpc3RcXHdlYmFwaVxcandzXFxmbGF0dGVuZWRcXHNpZ24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZW5jb2RlIGFzIGI2NHUgfSBmcm9tICcuLi8uLi91dGlsL2Jhc2U2NHVybC5qcyc7XG5pbXBvcnQgc2lnbiBmcm9tICcuLi8uLi9saWIvc2lnbi5qcyc7XG5pbXBvcnQgaXNEaXNqb2ludCBmcm9tICcuLi8uLi9saWIvaXNfZGlzam9pbnQuanMnO1xuaW1wb3J0IHsgSldTSW52YWxpZCB9IGZyb20gJy4uLy4uL3V0aWwvZXJyb3JzLmpzJztcbmltcG9ydCB7IGVuY29kZXIsIGRlY29kZXIsIGNvbmNhdCB9IGZyb20gJy4uLy4uL2xpYi9idWZmZXJfdXRpbHMuanMnO1xuaW1wb3J0IGNoZWNrS2V5VHlwZSBmcm9tICcuLi8uLi9saWIvY2hlY2tfa2V5X3R5cGUuanMnO1xuaW1wb3J0IHZhbGlkYXRlQ3JpdCBmcm9tICcuLi8uLi9saWIvdmFsaWRhdGVfY3JpdC5qcyc7XG5pbXBvcnQgbm9ybWFsaXplS2V5IGZyb20gJy4uLy4uL2xpYi9ub3JtYWxpemVfa2V5LmpzJztcbmV4cG9ydCBjbGFzcyBGbGF0dGVuZWRTaWduIHtcbiAgICAjcGF5bG9hZDtcbiAgICAjcHJvdGVjdGVkSGVhZGVyO1xuICAgICN1bnByb3RlY3RlZEhlYWRlcjtcbiAgICBjb25zdHJ1Y3RvcihwYXlsb2FkKSB7XG4gICAgICAgIGlmICghKHBheWxvYWQgaW5zdGFuY2VvZiBVaW50OEFycmF5KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcigncGF5bG9hZCBtdXN0IGJlIGFuIGluc3RhbmNlIG9mIFVpbnQ4QXJyYXknKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLiNwYXlsb2FkID0gcGF5bG9hZDtcbiAgICB9XG4gICAgc2V0UHJvdGVjdGVkSGVhZGVyKHByb3RlY3RlZEhlYWRlcikge1xuICAgICAgICBpZiAodGhpcy4jcHJvdGVjdGVkSGVhZGVyKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdzZXRQcm90ZWN0ZWRIZWFkZXIgY2FuIG9ubHkgYmUgY2FsbGVkIG9uY2UnKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLiNwcm90ZWN0ZWRIZWFkZXIgPSBwcm90ZWN0ZWRIZWFkZXI7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBzZXRVbnByb3RlY3RlZEhlYWRlcih1bnByb3RlY3RlZEhlYWRlcikge1xuICAgICAgICBpZiAodGhpcy4jdW5wcm90ZWN0ZWRIZWFkZXIpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ3NldFVucHJvdGVjdGVkSGVhZGVyIGNhbiBvbmx5IGJlIGNhbGxlZCBvbmNlJyk7XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy4jdW5wcm90ZWN0ZWRIZWFkZXIgPSB1bnByb3RlY3RlZEhlYWRlcjtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIGFzeW5jIHNpZ24oa2V5LCBvcHRpb25zKSB7XG4gICAgICAgIGlmICghdGhpcy4jcHJvdGVjdGVkSGVhZGVyICYmICF0aGlzLiN1bnByb3RlY3RlZEhlYWRlcikge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEpXU0ludmFsaWQoJ2VpdGhlciBzZXRQcm90ZWN0ZWRIZWFkZXIgb3Igc2V0VW5wcm90ZWN0ZWRIZWFkZXIgbXVzdCBiZSBjYWxsZWQgYmVmb3JlICNzaWduKCknKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoIWlzRGlzam9pbnQodGhpcy4jcHJvdGVjdGVkSGVhZGVyLCB0aGlzLiN1bnByb3RlY3RlZEhlYWRlcikpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBKV1NJbnZhbGlkKCdKV1MgUHJvdGVjdGVkIGFuZCBKV1MgVW5wcm90ZWN0ZWQgSGVhZGVyIFBhcmFtZXRlciBuYW1lcyBtdXN0IGJlIGRpc2pvaW50Jyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3Qgam9zZUhlYWRlciA9IHtcbiAgICAgICAgICAgIC4uLnRoaXMuI3Byb3RlY3RlZEhlYWRlcixcbiAgICAgICAgICAgIC4uLnRoaXMuI3VucHJvdGVjdGVkSGVhZGVyLFxuICAgICAgICB9O1xuICAgICAgICBjb25zdCBleHRlbnNpb25zID0gdmFsaWRhdGVDcml0KEpXU0ludmFsaWQsIG5ldyBNYXAoW1snYjY0JywgdHJ1ZV1dKSwgb3B0aW9ucz8uY3JpdCwgdGhpcy4jcHJvdGVjdGVkSGVhZGVyLCBqb3NlSGVhZGVyKTtcbiAgICAgICAgbGV0IGI2NCA9IHRydWU7XG4gICAgICAgIGlmIChleHRlbnNpb25zLmhhcygnYjY0JykpIHtcbiAgICAgICAgICAgIGI2NCA9IHRoaXMuI3Byb3RlY3RlZEhlYWRlci5iNjQ7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGI2NCAhPT0gJ2Jvb2xlYW4nKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEpXU0ludmFsaWQoJ1RoZSBcImI2NFwiIChiYXNlNjR1cmwtZW5jb2RlIHBheWxvYWQpIEhlYWRlciBQYXJhbWV0ZXIgbXVzdCBiZSBhIGJvb2xlYW4nKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBjb25zdCB7IGFsZyB9ID0gam9zZUhlYWRlcjtcbiAgICAgICAgaWYgKHR5cGVvZiBhbGcgIT09ICdzdHJpbmcnIHx8ICFhbGcpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBKV1NJbnZhbGlkKCdKV1MgXCJhbGdcIiAoQWxnb3JpdGhtKSBIZWFkZXIgUGFyYW1ldGVyIG1pc3Npbmcgb3IgaW52YWxpZCcpO1xuICAgICAgICB9XG4gICAgICAgIGNoZWNrS2V5VHlwZShhbGcsIGtleSwgJ3NpZ24nKTtcbiAgICAgICAgbGV0IHBheWxvYWQgPSB0aGlzLiNwYXlsb2FkO1xuICAgICAgICBpZiAoYjY0KSB7XG4gICAgICAgICAgICBwYXlsb2FkID0gZW5jb2Rlci5lbmNvZGUoYjY0dShwYXlsb2FkKSk7XG4gICAgICAgIH1cbiAgICAgICAgbGV0IHByb3RlY3RlZEhlYWRlcjtcbiAgICAgICAgaWYgKHRoaXMuI3Byb3RlY3RlZEhlYWRlcikge1xuICAgICAgICAgICAgcHJvdGVjdGVkSGVhZGVyID0gZW5jb2Rlci5lbmNvZGUoYjY0dShKU09OLnN0cmluZ2lmeSh0aGlzLiNwcm90ZWN0ZWRIZWFkZXIpKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSB7XG4gICAgICAgICAgICBwcm90ZWN0ZWRIZWFkZXIgPSBlbmNvZGVyLmVuY29kZSgnJyk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZGF0YSA9IGNvbmNhdChwcm90ZWN0ZWRIZWFkZXIsIGVuY29kZXIuZW5jb2RlKCcuJyksIHBheWxvYWQpO1xuICAgICAgICBjb25zdCBrID0gYXdhaXQgbm9ybWFsaXplS2V5KGtleSwgYWxnKTtcbiAgICAgICAgY29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgc2lnbihhbGcsIGssIGRhdGEpO1xuICAgICAgICBjb25zdCBqd3MgPSB7XG4gICAgICAgICAgICBzaWduYXR1cmU6IGI2NHUoc2lnbmF0dXJlKSxcbiAgICAgICAgICAgIHBheWxvYWQ6ICcnLFxuICAgICAgICB9O1xuICAgICAgICBpZiAoYjY0KSB7XG4gICAgICAgICAgICBqd3MucGF5bG9hZCA9IGRlY29kZXIuZGVjb2RlKHBheWxvYWQpO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLiN1bnByb3RlY3RlZEhlYWRlcikge1xuICAgICAgICAgICAgandzLmhlYWRlciA9IHRoaXMuI3VucHJvdGVjdGVkSGVhZGVyO1xuICAgICAgICB9XG4gICAgICAgIGlmICh0aGlzLiNwcm90ZWN0ZWRIZWFkZXIpIHtcbiAgICAgICAgICAgIGp3cy5wcm90ZWN0ZWQgPSBkZWNvZGVyLmRlY29kZShwcm90ZWN0ZWRIZWFkZXIpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBqd3M7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jws/flattened/sign.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jws/flattened/verify.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/jws/flattened/verify.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   flattenedVerify: () => (/* binding */ flattenedVerify)\n/* harmony export */ });\n/* harmony import */ var _util_base64url_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../util/base64url.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/base64url.js\");\n/* harmony import */ var _lib_verify_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../lib/verify.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/verify.js\");\n/* harmony import */ var _util_errors_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../util/errors.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/errors.js\");\n/* harmony import */ var _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../lib/buffer_utils.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/buffer_utils.js\");\n/* harmony import */ var _lib_is_disjoint_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../lib/is_disjoint.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_disjoint.js\");\n/* harmony import */ var _lib_is_object_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/is_object.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_object.js\");\n/* harmony import */ var _lib_check_key_type_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../lib/check_key_type.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/check_key_type.js\");\n/* harmony import */ var _lib_validate_crit_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../lib/validate_crit.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/validate_crit.js\");\n/* harmony import */ var _lib_validate_algorithms_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../lib/validate_algorithms.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/validate_algorithms.js\");\n/* harmony import */ var _lib_normalize_key_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../lib/normalize_key.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/normalize_key.js\");\n\n\n\n\n\n\n\n\n\n\nasync function flattenedVerify(jws, key, options) {\n    if (!(0,_lib_is_object_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(jws)) {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWSInvalid('Flattened JWS must be an object');\n    }\n    if (jws.protected === undefined && jws.header === undefined) {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWSInvalid('Flattened JWS must have either of the \"protected\" or \"header\" members');\n    }\n    if (jws.protected !== undefined && typeof jws.protected !== 'string') {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWSInvalid('JWS Protected Header incorrect type');\n    }\n    if (jws.payload === undefined) {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWSInvalid('JWS Payload missing');\n    }\n    if (typeof jws.signature !== 'string') {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWSInvalid('JWS Signature missing or incorrect type');\n    }\n    if (jws.header !== undefined && !(0,_lib_is_object_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(jws.header)) {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWSInvalid('JWS Unprotected Header incorrect type');\n    }\n    let parsedProt = {};\n    if (jws.protected) {\n        try {\n            const protectedHeader = (0,_util_base64url_js__WEBPACK_IMPORTED_MODULE_2__.decode)(jws.protected);\n            parsedProt = JSON.parse(_lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_3__.decoder.decode(protectedHeader));\n        }\n        catch {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWSInvalid('JWS Protected Header is invalid');\n        }\n    }\n    if (!(0,_lib_is_disjoint_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(parsedProt, jws.header)) {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWSInvalid('JWS Protected and JWS Unprotected Header Parameter names must be disjoint');\n    }\n    const joseHeader = {\n        ...parsedProt,\n        ...jws.header,\n    };\n    const extensions = (0,_lib_validate_crit_js__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(_util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWSInvalid, new Map([['b64', true]]), options?.crit, parsedProt, joseHeader);\n    let b64 = true;\n    if (extensions.has('b64')) {\n        b64 = parsedProt.b64;\n        if (typeof b64 !== 'boolean') {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWSInvalid('The \"b64\" (base64url-encode payload) Header Parameter must be a boolean');\n        }\n    }\n    const { alg } = joseHeader;\n    if (typeof alg !== 'string' || !alg) {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWSInvalid('JWS \"alg\" (Algorithm) Header Parameter missing or invalid');\n    }\n    const algorithms = options && (0,_lib_validate_algorithms_js__WEBPACK_IMPORTED_MODULE_6__[\"default\"])('algorithms', options.algorithms);\n    if (algorithms && !algorithms.has(alg)) {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JOSEAlgNotAllowed('\"alg\" (Algorithm) Header Parameter value not allowed');\n    }\n    if (b64) {\n        if (typeof jws.payload !== 'string') {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWSInvalid('JWS Payload must be a string');\n        }\n    }\n    else if (typeof jws.payload !== 'string' && !(jws.payload instanceof Uint8Array)) {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWSInvalid('JWS Payload must be a string or an Uint8Array instance');\n    }\n    let resolvedKey = false;\n    if (typeof key === 'function') {\n        key = await key(parsedProt, jws);\n        resolvedKey = true;\n    }\n    (0,_lib_check_key_type_js__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(alg, key, 'verify');\n    const data = (0,_lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_3__.concat)(_lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_3__.encoder.encode(jws.protected ?? ''), _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_3__.encoder.encode('.'), typeof jws.payload === 'string' ? _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_3__.encoder.encode(jws.payload) : jws.payload);\n    let signature;\n    try {\n        signature = (0,_util_base64url_js__WEBPACK_IMPORTED_MODULE_2__.decode)(jws.signature);\n    }\n    catch {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWSInvalid('Failed to base64url decode the signature');\n    }\n    const k = await (0,_lib_normalize_key_js__WEBPACK_IMPORTED_MODULE_8__[\"default\"])(key, alg);\n    const verified = await (0,_lib_verify_js__WEBPACK_IMPORTED_MODULE_9__[\"default\"])(alg, k, signature, data);\n    if (!verified) {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWSSignatureVerificationFailed();\n    }\n    let payload;\n    if (b64) {\n        try {\n            payload = (0,_util_base64url_js__WEBPACK_IMPORTED_MODULE_2__.decode)(jws.payload);\n        }\n        catch {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWSInvalid('Failed to base64url decode the payload');\n        }\n    }\n    else if (typeof jws.payload === 'string') {\n        payload = _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_3__.encoder.encode(jws.payload);\n    }\n    else {\n        payload = jws.payload;\n    }\n    const result = { payload };\n    if (jws.protected !== undefined) {\n        result.protectedHeader = parsedProt;\n    }\n    if (jws.header !== undefined) {\n        result.unprotectedHeader = jws.header;\n    }\n    if (resolvedKey) {\n        return { ...result, key: k };\n    }\n    return result;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvandzL2ZsYXR0ZW5lZC92ZXJpZnkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBeUQ7QUFDaEI7QUFDNEQ7QUFDaEM7QUFDbkI7QUFDSjtBQUNTO0FBQ0Q7QUFDWTtBQUNaO0FBQy9DO0FBQ1AsU0FBUyw2REFBUTtBQUNqQixrQkFBa0IsdURBQVU7QUFDNUI7QUFDQTtBQUNBLGtCQUFrQix1REFBVTtBQUM1QjtBQUNBO0FBQ0Esa0JBQWtCLHVEQUFVO0FBQzVCO0FBQ0E7QUFDQSxrQkFBa0IsdURBQVU7QUFDNUI7QUFDQTtBQUNBLGtCQUFrQix1REFBVTtBQUM1QjtBQUNBLHFDQUFxQyw2REFBUTtBQUM3QyxrQkFBa0IsdURBQVU7QUFDNUI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQ0FBb0MsMERBQUk7QUFDeEMsb0NBQW9DLHlEQUFPO0FBQzNDO0FBQ0E7QUFDQSxzQkFBc0IsdURBQVU7QUFDaEM7QUFDQTtBQUNBLFNBQVMsK0RBQVU7QUFDbkIsa0JBQWtCLHVEQUFVO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsaUVBQVksQ0FBQyx1REFBVTtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQix1REFBVTtBQUNoQztBQUNBO0FBQ0EsWUFBWSxNQUFNO0FBQ2xCO0FBQ0Esa0JBQWtCLHVEQUFVO0FBQzVCO0FBQ0Esa0NBQWtDLHVFQUFrQjtBQUNwRDtBQUNBLGtCQUFrQiw4REFBaUI7QUFDbkM7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHVEQUFVO0FBQ2hDO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQix1REFBVTtBQUM1QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJLGtFQUFZO0FBQ2hCLGlCQUFpQiw0REFBTSxDQUFDLHlEQUFPLDhCQUE4Qix5REFBTyxnREFBZ0QseURBQU87QUFDM0g7QUFDQTtBQUNBLG9CQUFvQiwwREFBSTtBQUN4QjtBQUNBO0FBQ0Esa0JBQWtCLHVEQUFVO0FBQzVCO0FBQ0Esb0JBQW9CLGlFQUFZO0FBQ2hDLDJCQUEyQiwwREFBTTtBQUNqQztBQUNBLGtCQUFrQiwyRUFBOEI7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsMERBQUk7QUFDMUI7QUFDQTtBQUNBLHNCQUFzQix1REFBVTtBQUNoQztBQUNBO0FBQ0E7QUFDQSxrQkFBa0IseURBQU87QUFDekI7QUFDQTtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpQkFBaUI7QUFDakI7QUFDQTtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxub2RlX21vZHVsZXNcXGpvc2VcXGRpc3RcXHdlYmFwaVxcandzXFxmbGF0dGVuZWRcXHZlcmlmeS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZWNvZGUgYXMgYjY0dSB9IGZyb20gJy4uLy4uL3V0aWwvYmFzZTY0dXJsLmpzJztcbmltcG9ydCB2ZXJpZnkgZnJvbSAnLi4vLi4vbGliL3ZlcmlmeS5qcyc7XG5pbXBvcnQgeyBKT1NFQWxnTm90QWxsb3dlZCwgSldTSW52YWxpZCwgSldTU2lnbmF0dXJlVmVyaWZpY2F0aW9uRmFpbGVkIH0gZnJvbSAnLi4vLi4vdXRpbC9lcnJvcnMuanMnO1xuaW1wb3J0IHsgY29uY2F0LCBlbmNvZGVyLCBkZWNvZGVyIH0gZnJvbSAnLi4vLi4vbGliL2J1ZmZlcl91dGlscy5qcyc7XG5pbXBvcnQgaXNEaXNqb2ludCBmcm9tICcuLi8uLi9saWIvaXNfZGlzam9pbnQuanMnO1xuaW1wb3J0IGlzT2JqZWN0IGZyb20gJy4uLy4uL2xpYi9pc19vYmplY3QuanMnO1xuaW1wb3J0IGNoZWNrS2V5VHlwZSBmcm9tICcuLi8uLi9saWIvY2hlY2tfa2V5X3R5cGUuanMnO1xuaW1wb3J0IHZhbGlkYXRlQ3JpdCBmcm9tICcuLi8uLi9saWIvdmFsaWRhdGVfY3JpdC5qcyc7XG5pbXBvcnQgdmFsaWRhdGVBbGdvcml0aG1zIGZyb20gJy4uLy4uL2xpYi92YWxpZGF0ZV9hbGdvcml0aG1zLmpzJztcbmltcG9ydCBub3JtYWxpemVLZXkgZnJvbSAnLi4vLi4vbGliL25vcm1hbGl6ZV9rZXkuanMnO1xuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGZsYXR0ZW5lZFZlcmlmeShqd3MsIGtleSwgb3B0aW9ucykge1xuICAgIGlmICghaXNPYmplY3QoandzKSkge1xuICAgICAgICB0aHJvdyBuZXcgSldTSW52YWxpZCgnRmxhdHRlbmVkIEpXUyBtdXN0IGJlIGFuIG9iamVjdCcpO1xuICAgIH1cbiAgICBpZiAoandzLnByb3RlY3RlZCA9PT0gdW5kZWZpbmVkICYmIGp3cy5oZWFkZXIgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyBuZXcgSldTSW52YWxpZCgnRmxhdHRlbmVkIEpXUyBtdXN0IGhhdmUgZWl0aGVyIG9mIHRoZSBcInByb3RlY3RlZFwiIG9yIFwiaGVhZGVyXCIgbWVtYmVycycpO1xuICAgIH1cbiAgICBpZiAoandzLnByb3RlY3RlZCAhPT0gdW5kZWZpbmVkICYmIHR5cGVvZiBqd3MucHJvdGVjdGVkICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgSldTSW52YWxpZCgnSldTIFByb3RlY3RlZCBIZWFkZXIgaW5jb3JyZWN0IHR5cGUnKTtcbiAgICB9XG4gICAgaWYgKGp3cy5wYXlsb2FkID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgdGhyb3cgbmV3IEpXU0ludmFsaWQoJ0pXUyBQYXlsb2FkIG1pc3NpbmcnKTtcbiAgICB9XG4gICAgaWYgKHR5cGVvZiBqd3Muc2lnbmF0dXJlICE9PSAnc3RyaW5nJykge1xuICAgICAgICB0aHJvdyBuZXcgSldTSW52YWxpZCgnSldTIFNpZ25hdHVyZSBtaXNzaW5nIG9yIGluY29ycmVjdCB0eXBlJyk7XG4gICAgfVxuICAgIGlmIChqd3MuaGVhZGVyICE9PSB1bmRlZmluZWQgJiYgIWlzT2JqZWN0KGp3cy5oZWFkZXIpKSB7XG4gICAgICAgIHRocm93IG5ldyBKV1NJbnZhbGlkKCdKV1MgVW5wcm90ZWN0ZWQgSGVhZGVyIGluY29ycmVjdCB0eXBlJyk7XG4gICAgfVxuICAgIGxldCBwYXJzZWRQcm90ID0ge307XG4gICAgaWYgKGp3cy5wcm90ZWN0ZWQpIHtcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgIGNvbnN0IHByb3RlY3RlZEhlYWRlciA9IGI2NHUoandzLnByb3RlY3RlZCk7XG4gICAgICAgICAgICBwYXJzZWRQcm90ID0gSlNPTi5wYXJzZShkZWNvZGVyLmRlY29kZShwcm90ZWN0ZWRIZWFkZXIpKTtcbiAgICAgICAgfVxuICAgICAgICBjYXRjaCB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSldTSW52YWxpZCgnSldTIFByb3RlY3RlZCBIZWFkZXIgaXMgaW52YWxpZCcpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmICghaXNEaXNqb2ludChwYXJzZWRQcm90LCBqd3MuaGVhZGVyKSkge1xuICAgICAgICB0aHJvdyBuZXcgSldTSW52YWxpZCgnSldTIFByb3RlY3RlZCBhbmQgSldTIFVucHJvdGVjdGVkIEhlYWRlciBQYXJhbWV0ZXIgbmFtZXMgbXVzdCBiZSBkaXNqb2ludCcpO1xuICAgIH1cbiAgICBjb25zdCBqb3NlSGVhZGVyID0ge1xuICAgICAgICAuLi5wYXJzZWRQcm90LFxuICAgICAgICAuLi5qd3MuaGVhZGVyLFxuICAgIH07XG4gICAgY29uc3QgZXh0ZW5zaW9ucyA9IHZhbGlkYXRlQ3JpdChKV1NJbnZhbGlkLCBuZXcgTWFwKFtbJ2I2NCcsIHRydWVdXSksIG9wdGlvbnM/LmNyaXQsIHBhcnNlZFByb3QsIGpvc2VIZWFkZXIpO1xuICAgIGxldCBiNjQgPSB0cnVlO1xuICAgIGlmIChleHRlbnNpb25zLmhhcygnYjY0JykpIHtcbiAgICAgICAgYjY0ID0gcGFyc2VkUHJvdC5iNjQ7XG4gICAgICAgIGlmICh0eXBlb2YgYjY0ICE9PSAnYm9vbGVhbicpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBKV1NJbnZhbGlkKCdUaGUgXCJiNjRcIiAoYmFzZTY0dXJsLWVuY29kZSBwYXlsb2FkKSBIZWFkZXIgUGFyYW1ldGVyIG11c3QgYmUgYSBib29sZWFuJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgY29uc3QgeyBhbGcgfSA9IGpvc2VIZWFkZXI7XG4gICAgaWYgKHR5cGVvZiBhbGcgIT09ICdzdHJpbmcnIHx8ICFhbGcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEpXU0ludmFsaWQoJ0pXUyBcImFsZ1wiIChBbGdvcml0aG0pIEhlYWRlciBQYXJhbWV0ZXIgbWlzc2luZyBvciBpbnZhbGlkJyk7XG4gICAgfVxuICAgIGNvbnN0IGFsZ29yaXRobXMgPSBvcHRpb25zICYmIHZhbGlkYXRlQWxnb3JpdGhtcygnYWxnb3JpdGhtcycsIG9wdGlvbnMuYWxnb3JpdGhtcyk7XG4gICAgaWYgKGFsZ29yaXRobXMgJiYgIWFsZ29yaXRobXMuaGFzKGFsZykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEpPU0VBbGdOb3RBbGxvd2VkKCdcImFsZ1wiIChBbGdvcml0aG0pIEhlYWRlciBQYXJhbWV0ZXIgdmFsdWUgbm90IGFsbG93ZWQnKTtcbiAgICB9XG4gICAgaWYgKGI2NCkge1xuICAgICAgICBpZiAodHlwZW9mIGp3cy5wYXlsb2FkICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEpXU0ludmFsaWQoJ0pXUyBQYXlsb2FkIG11c3QgYmUgYSBzdHJpbmcnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgandzLnBheWxvYWQgIT09ICdzdHJpbmcnICYmICEoandzLnBheWxvYWQgaW5zdGFuY2VvZiBVaW50OEFycmF5KSkge1xuICAgICAgICB0aHJvdyBuZXcgSldTSW52YWxpZCgnSldTIFBheWxvYWQgbXVzdCBiZSBhIHN0cmluZyBvciBhbiBVaW50OEFycmF5IGluc3RhbmNlJyk7XG4gICAgfVxuICAgIGxldCByZXNvbHZlZEtleSA9IGZhbHNlO1xuICAgIGlmICh0eXBlb2Yga2V5ID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIGtleSA9IGF3YWl0IGtleShwYXJzZWRQcm90LCBqd3MpO1xuICAgICAgICByZXNvbHZlZEtleSA9IHRydWU7XG4gICAgfVxuICAgIGNoZWNrS2V5VHlwZShhbGcsIGtleSwgJ3ZlcmlmeScpO1xuICAgIGNvbnN0IGRhdGEgPSBjb25jYXQoZW5jb2Rlci5lbmNvZGUoandzLnByb3RlY3RlZCA/PyAnJyksIGVuY29kZXIuZW5jb2RlKCcuJyksIHR5cGVvZiBqd3MucGF5bG9hZCA9PT0gJ3N0cmluZycgPyBlbmNvZGVyLmVuY29kZShqd3MucGF5bG9hZCkgOiBqd3MucGF5bG9hZCk7XG4gICAgbGV0IHNpZ25hdHVyZTtcbiAgICB0cnkge1xuICAgICAgICBzaWduYXR1cmUgPSBiNjR1KGp3cy5zaWduYXR1cmUpO1xuICAgIH1cbiAgICBjYXRjaCB7XG4gICAgICAgIHRocm93IG5ldyBKV1NJbnZhbGlkKCdGYWlsZWQgdG8gYmFzZTY0dXJsIGRlY29kZSB0aGUgc2lnbmF0dXJlJyk7XG4gICAgfVxuICAgIGNvbnN0IGsgPSBhd2FpdCBub3JtYWxpemVLZXkoa2V5LCBhbGcpO1xuICAgIGNvbnN0IHZlcmlmaWVkID0gYXdhaXQgdmVyaWZ5KGFsZywgaywgc2lnbmF0dXJlLCBkYXRhKTtcbiAgICBpZiAoIXZlcmlmaWVkKSB7XG4gICAgICAgIHRocm93IG5ldyBKV1NTaWduYXR1cmVWZXJpZmljYXRpb25GYWlsZWQoKTtcbiAgICB9XG4gICAgbGV0IHBheWxvYWQ7XG4gICAgaWYgKGI2NCkge1xuICAgICAgICB0cnkge1xuICAgICAgICAgICAgcGF5bG9hZCA9IGI2NHUoandzLnBheWxvYWQpO1xuICAgICAgICB9XG4gICAgICAgIGNhdGNoIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBKV1NJbnZhbGlkKCdGYWlsZWQgdG8gYmFzZTY0dXJsIGRlY29kZSB0aGUgcGF5bG9hZCcpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGVsc2UgaWYgKHR5cGVvZiBqd3MucGF5bG9hZCA9PT0gJ3N0cmluZycpIHtcbiAgICAgICAgcGF5bG9hZCA9IGVuY29kZXIuZW5jb2RlKGp3cy5wYXlsb2FkKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIHBheWxvYWQgPSBqd3MucGF5bG9hZDtcbiAgICB9XG4gICAgY29uc3QgcmVzdWx0ID0geyBwYXlsb2FkIH07XG4gICAgaWYgKGp3cy5wcm90ZWN0ZWQgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXN1bHQucHJvdGVjdGVkSGVhZGVyID0gcGFyc2VkUHJvdDtcbiAgICB9XG4gICAgaWYgKGp3cy5oZWFkZXIgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZXN1bHQudW5wcm90ZWN0ZWRIZWFkZXIgPSBqd3MuaGVhZGVyO1xuICAgIH1cbiAgICBpZiAocmVzb2x2ZWRLZXkpIHtcbiAgICAgICAgcmV0dXJuIHsgLi4ucmVzdWx0LCBrZXk6IGsgfTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jws/flattened/verify.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jwt/sign.js":
/*!****************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/jwt/sign.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   SignJWT: () => (/* binding */ SignJWT)\n/* harmony export */ });\n/* harmony import */ var _jws_compact_sign_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../jws/compact/sign.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jws/compact/sign.js\");\n/* harmony import */ var _util_errors_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/errors.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/errors.js\");\n/* harmony import */ var _lib_jwt_claims_set_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/jwt_claims_set.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/jwt_claims_set.js\");\n\n\n\nclass SignJWT {\n    #protectedHeader;\n    #jwt;\n    constructor(payload = {}) {\n        this.#jwt = new _lib_jwt_claims_set_js__WEBPACK_IMPORTED_MODULE_0__.JWTClaimsBuilder(payload);\n    }\n    setIssuer(issuer) {\n        this.#jwt.iss = issuer;\n        return this;\n    }\n    setSubject(subject) {\n        this.#jwt.sub = subject;\n        return this;\n    }\n    setAudience(audience) {\n        this.#jwt.aud = audience;\n        return this;\n    }\n    setJti(jwtId) {\n        this.#jwt.jti = jwtId;\n        return this;\n    }\n    setNotBefore(input) {\n        this.#jwt.nbf = input;\n        return this;\n    }\n    setExpirationTime(input) {\n        this.#jwt.exp = input;\n        return this;\n    }\n    setIssuedAt(input) {\n        this.#jwt.iat = input;\n        return this;\n    }\n    setProtectedHeader(protectedHeader) {\n        this.#protectedHeader = protectedHeader;\n        return this;\n    }\n    async sign(key, options) {\n        const sig = new _jws_compact_sign_js__WEBPACK_IMPORTED_MODULE_1__.CompactSign(this.#jwt.data());\n        sig.setProtectedHeader(this.#protectedHeader);\n        if (Array.isArray(this.#protectedHeader?.crit) &&\n            this.#protectedHeader.crit.includes('b64') &&\n            this.#protectedHeader.b64 === false) {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_2__.JWTInvalid('JWTs MUST NOT use unencoded payload');\n        }\n        return sig.sign(key, options);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvand0L3NpZ24uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFxRDtBQUNOO0FBQ2E7QUFDckQ7QUFDUDtBQUNBO0FBQ0EsNEJBQTRCO0FBQzVCLHdCQUF3QixvRUFBZ0I7QUFDeEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx3QkFBd0IsNkRBQVc7QUFDbkM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsdURBQVU7QUFDaEM7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXG5vZGVfbW9kdWxlc1xcam9zZVxcZGlzdFxcd2ViYXBpXFxqd3RcXHNpZ24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29tcGFjdFNpZ24gfSBmcm9tICcuLi9qd3MvY29tcGFjdC9zaWduLmpzJztcbmltcG9ydCB7IEpXVEludmFsaWQgfSBmcm9tICcuLi91dGlsL2Vycm9ycy5qcyc7XG5pbXBvcnQgeyBKV1RDbGFpbXNCdWlsZGVyIH0gZnJvbSAnLi4vbGliL2p3dF9jbGFpbXNfc2V0LmpzJztcbmV4cG9ydCBjbGFzcyBTaWduSldUIHtcbiAgICAjcHJvdGVjdGVkSGVhZGVyO1xuICAgICNqd3Q7XG4gICAgY29uc3RydWN0b3IocGF5bG9hZCA9IHt9KSB7XG4gICAgICAgIHRoaXMuI2p3dCA9IG5ldyBKV1RDbGFpbXNCdWlsZGVyKHBheWxvYWQpO1xuICAgIH1cbiAgICBzZXRJc3N1ZXIoaXNzdWVyKSB7XG4gICAgICAgIHRoaXMuI2p3dC5pc3MgPSBpc3N1ZXI7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBzZXRTdWJqZWN0KHN1YmplY3QpIHtcbiAgICAgICAgdGhpcy4jand0LnN1YiA9IHN1YmplY3Q7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBzZXRBdWRpZW5jZShhdWRpZW5jZSkge1xuICAgICAgICB0aGlzLiNqd3QuYXVkID0gYXVkaWVuY2U7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH1cbiAgICBzZXRKdGkoand0SWQpIHtcbiAgICAgICAgdGhpcy4jand0Lmp0aSA9IGp3dElkO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgc2V0Tm90QmVmb3JlKGlucHV0KSB7XG4gICAgICAgIHRoaXMuI2p3dC5uYmYgPSBpbnB1dDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHNldEV4cGlyYXRpb25UaW1lKGlucHV0KSB7XG4gICAgICAgIHRoaXMuI2p3dC5leHAgPSBpbnB1dDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHNldElzc3VlZEF0KGlucHV0KSB7XG4gICAgICAgIHRoaXMuI2p3dC5pYXQgPSBpbnB1dDtcbiAgICAgICAgcmV0dXJuIHRoaXM7XG4gICAgfVxuICAgIHNldFByb3RlY3RlZEhlYWRlcihwcm90ZWN0ZWRIZWFkZXIpIHtcbiAgICAgICAgdGhpcy4jcHJvdGVjdGVkSGVhZGVyID0gcHJvdGVjdGVkSGVhZGVyO1xuICAgICAgICByZXR1cm4gdGhpcztcbiAgICB9XG4gICAgYXN5bmMgc2lnbihrZXksIG9wdGlvbnMpIHtcbiAgICAgICAgY29uc3Qgc2lnID0gbmV3IENvbXBhY3RTaWduKHRoaXMuI2p3dC5kYXRhKCkpO1xuICAgICAgICBzaWcuc2V0UHJvdGVjdGVkSGVhZGVyKHRoaXMuI3Byb3RlY3RlZEhlYWRlcik7XG4gICAgICAgIGlmIChBcnJheS5pc0FycmF5KHRoaXMuI3Byb3RlY3RlZEhlYWRlcj8uY3JpdCkgJiZcbiAgICAgICAgICAgIHRoaXMuI3Byb3RlY3RlZEhlYWRlci5jcml0LmluY2x1ZGVzKCdiNjQnKSAmJlxuICAgICAgICAgICAgdGhpcy4jcHJvdGVjdGVkSGVhZGVyLmI2NCA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBKV1RJbnZhbGlkKCdKV1RzIE1VU1QgTk9UIHVzZSB1bmVuY29kZWQgcGF5bG9hZCcpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzaWcuc2lnbihrZXksIG9wdGlvbnMpO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jwt/sign.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jwt/verify.js":
/*!******************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/jwt/verify.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   jwtVerify: () => (/* binding */ jwtVerify)\n/* harmony export */ });\n/* harmony import */ var _jws_compact_verify_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../jws/compact/verify.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jws/compact/verify.js\");\n/* harmony import */ var _lib_jwt_claims_set_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../lib/jwt_claims_set.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/jwt_claims_set.js\");\n/* harmony import */ var _util_errors_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../util/errors.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/errors.js\");\n\n\n\nasync function jwtVerify(jwt, key, options) {\n    const verified = await (0,_jws_compact_verify_js__WEBPACK_IMPORTED_MODULE_0__.compactVerify)(jwt, key, options);\n    if (verified.protectedHeader.crit?.includes('b64') && verified.protectedHeader.b64 === false) {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_1__.JWTInvalid('JWTs MUST NOT use unencoded payload');\n    }\n    const payload = (0,_lib_jwt_claims_set_js__WEBPACK_IMPORTED_MODULE_2__.validateClaimsSet)(verified.protectedHeader, verified.payload, options);\n    const result = { payload, protectedHeader: verified.protectedHeader };\n    if (typeof key === 'function') {\n        return { ...result, key: verified.key };\n    }\n    return result;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvand0L3ZlcmlmeS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQXlEO0FBQ0k7QUFDZDtBQUN4QztBQUNQLDJCQUEyQixxRUFBYTtBQUN4QztBQUNBLGtCQUFrQix1REFBVTtBQUM1QjtBQUNBLG9CQUFvQix5RUFBaUI7QUFDckMscUJBQXFCO0FBQ3JCO0FBQ0EsaUJBQWlCO0FBQ2pCO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcbm9kZV9tb2R1bGVzXFxqb3NlXFxkaXN0XFx3ZWJhcGlcXGp3dFxcdmVyaWZ5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNvbXBhY3RWZXJpZnkgfSBmcm9tICcuLi9qd3MvY29tcGFjdC92ZXJpZnkuanMnO1xuaW1wb3J0IHsgdmFsaWRhdGVDbGFpbXNTZXQgfSBmcm9tICcuLi9saWIvand0X2NsYWltc19zZXQuanMnO1xuaW1wb3J0IHsgSldUSW52YWxpZCB9IGZyb20gJy4uL3V0aWwvZXJyb3JzLmpzJztcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBqd3RWZXJpZnkoand0LCBrZXksIG9wdGlvbnMpIHtcbiAgICBjb25zdCB2ZXJpZmllZCA9IGF3YWl0IGNvbXBhY3RWZXJpZnkoand0LCBrZXksIG9wdGlvbnMpO1xuICAgIGlmICh2ZXJpZmllZC5wcm90ZWN0ZWRIZWFkZXIuY3JpdD8uaW5jbHVkZXMoJ2I2NCcpICYmIHZlcmlmaWVkLnByb3RlY3RlZEhlYWRlci5iNjQgPT09IGZhbHNlKSB7XG4gICAgICAgIHRocm93IG5ldyBKV1RJbnZhbGlkKCdKV1RzIE1VU1QgTk9UIHVzZSB1bmVuY29kZWQgcGF5bG9hZCcpO1xuICAgIH1cbiAgICBjb25zdCBwYXlsb2FkID0gdmFsaWRhdGVDbGFpbXNTZXQodmVyaWZpZWQucHJvdGVjdGVkSGVhZGVyLCB2ZXJpZmllZC5wYXlsb2FkLCBvcHRpb25zKTtcbiAgICBjb25zdCByZXN1bHQgPSB7IHBheWxvYWQsIHByb3RlY3RlZEhlYWRlcjogdmVyaWZpZWQucHJvdGVjdGVkSGVhZGVyIH07XG4gICAgaWYgKHR5cGVvZiBrZXkgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgcmV0dXJuIHsgLi4ucmVzdWx0LCBrZXk6IHZlcmlmaWVkLmtleSB9O1xuICAgIH1cbiAgICByZXR1cm4gcmVzdWx0O1xufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/jwt/verify.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/key/import.js":
/*!******************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/key/import.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   importJWK: () => (/* binding */ importJWK),\n/* harmony export */   importPKCS8: () => (/* binding */ importPKCS8),\n/* harmony export */   importSPKI: () => (/* binding */ importSPKI),\n/* harmony export */   importX509: () => (/* binding */ importX509)\n/* harmony export */ });\n/* harmony import */ var _util_base64url_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/base64url.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/base64url.js\");\n/* harmony import */ var _lib_asn1_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/asn1.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/asn1.js\");\n/* harmony import */ var _lib_jwk_to_key_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../lib/jwk_to_key.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/jwk_to_key.js\");\n/* harmony import */ var _util_errors_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../util/errors.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/errors.js\");\n/* harmony import */ var _lib_is_object_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../lib/is_object.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_object.js\");\n\n\n\n\n\nasync function importSPKI(spki, alg, options) {\n    if (typeof spki !== 'string' || spki.indexOf('-----BEGIN PUBLIC KEY-----') !== 0) {\n        throw new TypeError('\"spki\" must be SPKI formatted string');\n    }\n    return (0,_lib_asn1_js__WEBPACK_IMPORTED_MODULE_0__.fromSPKI)(spki, alg, options);\n}\nasync function importX509(x509, alg, options) {\n    if (typeof x509 !== 'string' || x509.indexOf('-----BEGIN CERTIFICATE-----') !== 0) {\n        throw new TypeError('\"x509\" must be X.509 formatted string');\n    }\n    return (0,_lib_asn1_js__WEBPACK_IMPORTED_MODULE_0__.fromX509)(x509, alg, options);\n}\nasync function importPKCS8(pkcs8, alg, options) {\n    if (typeof pkcs8 !== 'string' || pkcs8.indexOf('-----BEGIN PRIVATE KEY-----') !== 0) {\n        throw new TypeError('\"pkcs8\" must be PKCS#8 formatted string');\n    }\n    return (0,_lib_asn1_js__WEBPACK_IMPORTED_MODULE_0__.fromPKCS8)(pkcs8, alg, options);\n}\nasync function importJWK(jwk, alg, options) {\n    if (!(0,_lib_is_object_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(jwk)) {\n        throw new TypeError('JWK must be an object');\n    }\n    let ext;\n    alg ??= jwk.alg;\n    ext ??= options?.extractable ?? jwk.ext;\n    switch (jwk.kty) {\n        case 'oct':\n            if (typeof jwk.k !== 'string' || !jwk.k) {\n                throw new TypeError('missing \"k\" (Key Value) Parameter value');\n            }\n            return (0,_util_base64url_js__WEBPACK_IMPORTED_MODULE_2__.decode)(jwk.k);\n        case 'RSA':\n            if ('oth' in jwk && jwk.oth !== undefined) {\n                throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_3__.JOSENotSupported('RSA JWK \"oth\" (Other Primes Info) Parameter value is not supported');\n            }\n            return (0,_lib_jwk_to_key_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"])({ ...jwk, alg, ext });\n        case 'AKP': {\n            if (typeof jwk.alg !== 'string' || !jwk.alg) {\n                throw new TypeError('missing \"alg\" (Algorithm) Parameter value');\n            }\n            if (alg !== undefined && alg !== jwk.alg) {\n                throw new TypeError('JWK alg and alg option value mismatch');\n            }\n            return (0,_lib_jwk_to_key_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"])({ ...jwk, ext });\n        }\n        case 'EC':\n        case 'OKP':\n            return (0,_lib_jwk_to_key_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"])({ ...jwk, alg, ext });\n        default:\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_3__.JOSENotSupported('Unsupported \"kty\" (Key Type) Parameter value');\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkva2V5L2ltcG9ydC5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7QUFBaUU7QUFDRjtBQUNoQjtBQUNNO0FBQ1Y7QUFDcEM7QUFDUDtBQUNBO0FBQ0E7QUFDQSxXQUFXLHNEQUFRO0FBQ25CO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQSxXQUFXLHNEQUFRO0FBQ25CO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQSxXQUFXLHVEQUFTO0FBQ3BCO0FBQ087QUFDUCxTQUFTLDZEQUFRO0FBQ2pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDBEQUFlO0FBQ2xDO0FBQ0E7QUFDQSwwQkFBMEIsNkRBQWdCO0FBQzFDO0FBQ0EsbUJBQW1CLDhEQUFXLEdBQUcsa0JBQWtCO0FBQ25EO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsbUJBQW1CLDhEQUFXLEdBQUcsYUFBYTtBQUM5QztBQUNBO0FBQ0E7QUFDQSxtQkFBbUIsOERBQVcsR0FBRyxrQkFBa0I7QUFDbkQ7QUFDQSxzQkFBc0IsNkRBQWdCO0FBQ3RDO0FBQ0EiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXG5vZGVfbW9kdWxlc1xcam9zZVxcZGlzdFxcd2ViYXBpXFxrZXlcXGltcG9ydC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZWNvZGUgYXMgZGVjb2RlQmFzZTY0VVJMIH0gZnJvbSAnLi4vdXRpbC9iYXNlNjR1cmwuanMnO1xuaW1wb3J0IHsgZnJvbVNQS0ksIGZyb21QS0NTOCwgZnJvbVg1MDkgfSBmcm9tICcuLi9saWIvYXNuMS5qcyc7XG5pbXBvcnQgdG9DcnlwdG9LZXkgZnJvbSAnLi4vbGliL2p3a190b19rZXkuanMnO1xuaW1wb3J0IHsgSk9TRU5vdFN1cHBvcnRlZCB9IGZyb20gJy4uL3V0aWwvZXJyb3JzLmpzJztcbmltcG9ydCBpc09iamVjdCBmcm9tICcuLi9saWIvaXNfb2JqZWN0LmpzJztcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbXBvcnRTUEtJKHNwa2ksIGFsZywgb3B0aW9ucykge1xuICAgIGlmICh0eXBlb2Ygc3BraSAhPT0gJ3N0cmluZycgfHwgc3BraS5pbmRleE9mKCctLS0tLUJFR0lOIFBVQkxJQyBLRVktLS0tLScpICE9PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wic3BraVwiIG11c3QgYmUgU1BLSSBmb3JtYXR0ZWQgc3RyaW5nJyk7XG4gICAgfVxuICAgIHJldHVybiBmcm9tU1BLSShzcGtpLCBhbGcsIG9wdGlvbnMpO1xufVxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIGltcG9ydFg1MDkoeDUwOSwgYWxnLCBvcHRpb25zKSB7XG4gICAgaWYgKHR5cGVvZiB4NTA5ICE9PSAnc3RyaW5nJyB8fCB4NTA5LmluZGV4T2YoJy0tLS0tQkVHSU4gQ0VSVElGSUNBVEUtLS0tLScpICE9PSAwKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1wieDUwOVwiIG11c3QgYmUgWC41MDkgZm9ybWF0dGVkIHN0cmluZycpO1xuICAgIH1cbiAgICByZXR1cm4gZnJvbVg1MDkoeDUwOSwgYWxnLCBvcHRpb25zKTtcbn1cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbXBvcnRQS0NTOChwa2NzOCwgYWxnLCBvcHRpb25zKSB7XG4gICAgaWYgKHR5cGVvZiBwa2NzOCAhPT0gJ3N0cmluZycgfHwgcGtjczguaW5kZXhPZignLS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tJykgIT09IDApIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJwa2NzOFwiIG11c3QgYmUgUEtDUyM4IGZvcm1hdHRlZCBzdHJpbmcnKTtcbiAgICB9XG4gICAgcmV0dXJuIGZyb21QS0NTOChwa2NzOCwgYWxnLCBvcHRpb25zKTtcbn1cbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBpbXBvcnRKV0soandrLCBhbGcsIG9wdGlvbnMpIHtcbiAgICBpZiAoIWlzT2JqZWN0KGp3aykpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSldLIG11c3QgYmUgYW4gb2JqZWN0Jyk7XG4gICAgfVxuICAgIGxldCBleHQ7XG4gICAgYWxnID8/PSBqd2suYWxnO1xuICAgIGV4dCA/Pz0gb3B0aW9ucz8uZXh0cmFjdGFibGUgPz8gandrLmV4dDtcbiAgICBzd2l0Y2ggKGp3ay5rdHkpIHtcbiAgICAgICAgY2FzZSAnb2N0JzpcbiAgICAgICAgICAgIGlmICh0eXBlb2YgandrLmsgIT09ICdzdHJpbmcnIHx8ICFqd2suaykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ21pc3NpbmcgXCJrXCIgKEtleSBWYWx1ZSkgUGFyYW1ldGVyIHZhbHVlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gZGVjb2RlQmFzZTY0VVJMKGp3ay5rKTtcbiAgICAgICAgY2FzZSAnUlNBJzpcbiAgICAgICAgICAgIGlmICgnb3RoJyBpbiBqd2sgJiYgandrLm90aCAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEpPU0VOb3RTdXBwb3J0ZWQoJ1JTQSBKV0sgXCJvdGhcIiAoT3RoZXIgUHJpbWVzIEluZm8pIFBhcmFtZXRlciB2YWx1ZSBpcyBub3Qgc3VwcG9ydGVkJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICByZXR1cm4gdG9DcnlwdG9LZXkoeyAuLi5qd2ssIGFsZywgZXh0IH0pO1xuICAgICAgICBjYXNlICdBS1AnOiB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIGp3ay5hbGcgIT09ICdzdHJpbmcnIHx8ICFqd2suYWxnKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignbWlzc2luZyBcImFsZ1wiIChBbGdvcml0aG0pIFBhcmFtZXRlciB2YWx1ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaWYgKGFsZyAhPT0gdW5kZWZpbmVkICYmIGFsZyAhPT0gandrLmFsZykge1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0pXSyBhbGcgYW5kIGFsZyBvcHRpb24gdmFsdWUgbWlzbWF0Y2gnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHJldHVybiB0b0NyeXB0b0tleSh7IC4uLmp3aywgZXh0IH0pO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ0VDJzpcbiAgICAgICAgY2FzZSAnT0tQJzpcbiAgICAgICAgICAgIHJldHVybiB0b0NyeXB0b0tleSh7IC4uLmp3aywgYWxnLCBleHQgfSk7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyBuZXcgSk9TRU5vdFN1cHBvcnRlZCgnVW5zdXBwb3J0ZWQgXCJrdHlcIiAoS2V5IFR5cGUpIFBhcmFtZXRlciB2YWx1ZScpO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/key/import.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/asn1.js":
/*!****************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/asn1.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   fromPKCS8: () => (/* binding */ fromPKCS8),\n/* harmony export */   fromSPKI: () => (/* binding */ fromSPKI),\n/* harmony export */   fromX509: () => (/* binding */ fromX509),\n/* harmony export */   toPKCS8: () => (/* binding */ toPKCS8),\n/* harmony export */   toSPKI: () => (/* binding */ toSPKI)\n/* harmony export */ });\n/* harmony import */ var _invalid_key_input_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./invalid_key_input.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/invalid_key_input.js\");\n/* harmony import */ var _lib_base64_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../lib/base64.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/base64.js\");\n/* harmony import */ var _util_errors_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../util/errors.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/errors.js\");\n/* harmony import */ var _is_key_like_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./is_key_like.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_key_like.js\");\n\n\n\n\nconst formatPEM = (b64, descriptor) => {\n    const newlined = (b64.match(/.{1,64}/g) || []).join('\\n');\n    return `-----BEGIN ${descriptor}-----\\n${newlined}\\n-----END ${descriptor}-----`;\n};\nconst genericExport = async (keyType, keyFormat, key) => {\n    if ((0,_is_key_like_js__WEBPACK_IMPORTED_MODULE_0__.isKeyObject)(key)) {\n        if (key.type !== keyType) {\n            throw new TypeError(`key is not a ${keyType} key`);\n        }\n        return key.export({ format: 'pem', type: keyFormat });\n    }\n    if (!(0,_is_key_like_js__WEBPACK_IMPORTED_MODULE_0__.isCryptoKey)(key)) {\n        throw new TypeError((0,_invalid_key_input_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(key, 'CryptoKey', 'KeyObject'));\n    }\n    if (!key.extractable) {\n        throw new TypeError('CryptoKey is not extractable');\n    }\n    if (key.type !== keyType) {\n        throw new TypeError(`key is not a ${keyType} key`);\n    }\n    return formatPEM((0,_lib_base64_js__WEBPACK_IMPORTED_MODULE_2__.encodeBase64)(new Uint8Array(await crypto.subtle.exportKey(keyFormat, key))), `${keyType.toUpperCase()} KEY`);\n};\nconst toSPKI = (key) => {\n    return genericExport('public', 'spki', key);\n};\nconst toPKCS8 = (key) => {\n    return genericExport('private', 'pkcs8', key);\n};\nconst bytesEqual = (a, b) => {\n    if (a.byteLength !== b.length)\n        return false;\n    for (let i = 0; i < a.byteLength; i++) {\n        if (a[i] !== b[i])\n            return false;\n    }\n    return true;\n};\nconst createASN1State = (data) => ({ data, pos: 0 });\nconst parseLength = (state) => {\n    const first = state.data[state.pos++];\n    if (first & 0x80) {\n        const lengthOfLen = first & 0x7f;\n        let length = 0;\n        for (let i = 0; i < lengthOfLen; i++) {\n            length = (length << 8) | state.data[state.pos++];\n        }\n        return length;\n    }\n    return first;\n};\nconst skipElement = (state, count = 1) => {\n    if (count <= 0)\n        return;\n    state.pos++;\n    const length = parseLength(state);\n    state.pos += length;\n    if (count > 1) {\n        skipElement(state, count - 1);\n    }\n};\nconst expectTag = (state, expectedTag, errorMessage) => {\n    if (state.data[state.pos++] !== expectedTag) {\n        throw new Error(errorMessage);\n    }\n};\nconst getSubarray = (state, length) => {\n    const result = state.data.subarray(state.pos, state.pos + length);\n    state.pos += length;\n    return result;\n};\nconst parseAlgorithmOID = (state) => {\n    expectTag(state, 0x06, 'Expected algorithm OID');\n    const oidLen = parseLength(state);\n    return getSubarray(state, oidLen);\n};\nfunction parsePKCS8Header(state) {\n    expectTag(state, 0x30, 'Invalid PKCS#8 structure');\n    parseLength(state);\n    expectTag(state, 0x02, 'Expected version field');\n    const verLen = parseLength(state);\n    state.pos += verLen;\n    expectTag(state, 0x30, 'Expected algorithm identifier');\n    const algIdLen = parseLength(state);\n    const algIdStart = state.pos;\n    return { algIdStart, algIdLength: algIdLen };\n}\nfunction parseSPKIHeader(state) {\n    expectTag(state, 0x30, 'Invalid SPKI structure');\n    parseLength(state);\n    expectTag(state, 0x30, 'Expected algorithm identifier');\n    const algIdLen = parseLength(state);\n    const algIdStart = state.pos;\n    return { algIdStart, algIdLength: algIdLen };\n}\nconst parseECAlgorithmIdentifier = (state) => {\n    const algOid = parseAlgorithmOID(state);\n    if (bytesEqual(algOid, [0x2b, 0x65, 0x6e])) {\n        return 'X25519';\n    }\n    if (!bytesEqual(algOid, [0x2a, 0x86, 0x48, 0xce, 0x3d, 0x02, 0x01])) {\n        throw new Error('Unsupported key algorithm');\n    }\n    expectTag(state, 0x06, 'Expected curve OID');\n    const curveOidLen = parseLength(state);\n    const curveOid = getSubarray(state, curveOidLen);\n    for (const { name, oid } of [\n        { name: 'P-256', oid: [0x2a, 0x86, 0x48, 0xce, 0x3d, 0x03, 0x01, 0x07] },\n        { name: 'P-384', oid: [0x2b, 0x81, 0x04, 0x00, 0x22] },\n        { name: 'P-521', oid: [0x2b, 0x81, 0x04, 0x00, 0x23] },\n    ]) {\n        if (bytesEqual(curveOid, oid)) {\n            return name;\n        }\n    }\n    throw new Error('Unsupported named curve');\n};\nconst genericImport = async (keyFormat, keyData, alg, options) => {\n    let algorithm;\n    let keyUsages;\n    const isPublic = keyFormat === 'spki';\n    const getSigUsages = () => (isPublic ? ['verify'] : ['sign']);\n    const getEncUsages = () => isPublic ? ['encrypt', 'wrapKey'] : ['decrypt', 'unwrapKey'];\n    switch (alg) {\n        case 'PS256':\n        case 'PS384':\n        case 'PS512':\n            algorithm = { name: 'RSA-PSS', hash: `SHA-${alg.slice(-3)}` };\n            keyUsages = getSigUsages();\n            break;\n        case 'RS256':\n        case 'RS384':\n        case 'RS512':\n            algorithm = { name: 'RSASSA-PKCS1-v1_5', hash: `SHA-${alg.slice(-3)}` };\n            keyUsages = getSigUsages();\n            break;\n        case 'RSA-OAEP':\n        case 'RSA-OAEP-256':\n        case 'RSA-OAEP-384':\n        case 'RSA-OAEP-512':\n            algorithm = {\n                name: 'RSA-OAEP',\n                hash: `SHA-${parseInt(alg.slice(-3), 10) || 1}`,\n            };\n            keyUsages = getEncUsages();\n            break;\n        case 'ES256':\n        case 'ES384':\n        case 'ES512': {\n            const curveMap = { ES256: 'P-256', ES384: 'P-384', ES512: 'P-521' };\n            algorithm = { name: 'ECDSA', namedCurve: curveMap[alg] };\n            keyUsages = getSigUsages();\n            break;\n        }\n        case 'ECDH-ES':\n        case 'ECDH-ES+A128KW':\n        case 'ECDH-ES+A192KW':\n        case 'ECDH-ES+A256KW': {\n            try {\n                const namedCurve = options.getNamedCurve(keyData);\n                algorithm = namedCurve === 'X25519' ? { name: 'X25519' } : { name: 'ECDH', namedCurve };\n            }\n            catch (cause) {\n                throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_3__.JOSENotSupported('Invalid or unsupported key format');\n            }\n            keyUsages = isPublic ? [] : ['deriveBits'];\n            break;\n        }\n        case 'Ed25519':\n        case 'EdDSA':\n            algorithm = { name: 'Ed25519' };\n            keyUsages = getSigUsages();\n            break;\n        case 'ML-DSA-44':\n        case 'ML-DSA-65':\n        case 'ML-DSA-87':\n            algorithm = { name: alg };\n            keyUsages = getSigUsages();\n            break;\n        default:\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_3__.JOSENotSupported('Invalid or unsupported \"alg\" (Algorithm) value');\n    }\n    return crypto.subtle.importKey(keyFormat, keyData, algorithm, options?.extractable ?? (isPublic ? true : false), keyUsages);\n};\nconst processPEMData = (pem, pattern) => {\n    return (0,_lib_base64_js__WEBPACK_IMPORTED_MODULE_2__.decodeBase64)(pem.replace(pattern, ''));\n};\nconst fromPKCS8 = (pem, alg, options) => {\n    const keyData = processPEMData(pem, /(?:-----(?:BEGIN|END) PRIVATE KEY-----|\\s)/g);\n    let opts = options;\n    if (alg?.startsWith?.('ECDH-ES')) {\n        opts ||= {};\n        opts.getNamedCurve = (keyData) => {\n            const state = createASN1State(keyData);\n            parsePKCS8Header(state);\n            return parseECAlgorithmIdentifier(state);\n        };\n    }\n    return genericImport('pkcs8', keyData, alg, opts);\n};\nconst fromSPKI = (pem, alg, options) => {\n    const keyData = processPEMData(pem, /(?:-----(?:BEGIN|END) PUBLIC KEY-----|\\s)/g);\n    let opts = options;\n    if (alg?.startsWith?.('ECDH-ES')) {\n        opts ||= {};\n        opts.getNamedCurve = (keyData) => {\n            const state = createASN1State(keyData);\n            parseSPKIHeader(state);\n            return parseECAlgorithmIdentifier(state);\n        };\n    }\n    return genericImport('spki', keyData, alg, opts);\n};\nfunction spkiFromX509(buf) {\n    const state = createASN1State(buf);\n    expectTag(state, 0x30, 'Invalid certificate structure');\n    parseLength(state);\n    expectTag(state, 0x30, 'Invalid tbsCertificate structure');\n    parseLength(state);\n    if (buf[state.pos] === 0xa0) {\n        skipElement(state, 6);\n    }\n    else {\n        skipElement(state, 5);\n    }\n    const spkiStart = state.pos;\n    expectTag(state, 0x30, 'Invalid SPKI structure');\n    const spkiContentLen = parseLength(state);\n    return buf.subarray(spkiStart, spkiStart + spkiContentLen + (state.pos - spkiStart));\n}\nfunction extractX509SPKI(x509) {\n    const derBytes = processPEMData(x509, /(?:-----(?:BEGIN|END) CERTIFICATE-----|\\s)/g);\n    return spkiFromX509(derBytes);\n}\nconst fromX509 = (pem, alg, options) => {\n    let spki;\n    try {\n        spki = extractX509SPKI(pem);\n    }\n    catch (cause) {\n        throw new TypeError('Failed to parse the X.509 certificate', { cause });\n    }\n    return fromSPKI(formatPEM((0,_lib_base64_js__WEBPACK_IMPORTED_MODULE_2__.encodeBase64)(spki), 'PUBLIC KEY'), alg, options);\n};\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL2FzbjEuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7O0FBQXFEO0FBQ1M7QUFDVDtBQUNPO0FBQzVEO0FBQ0EsbUNBQW1DLEtBQUs7QUFDeEMseUJBQXlCLFdBQVcsU0FBUyxTQUFTLGFBQWEsV0FBVztBQUM5RTtBQUNBO0FBQ0EsUUFBUSw0REFBVztBQUNuQjtBQUNBLGdEQUFnRCxTQUFTO0FBQ3pEO0FBQ0EsNEJBQTRCLGdDQUFnQztBQUM1RDtBQUNBLFNBQVMsNERBQVc7QUFDcEIsNEJBQTRCLGlFQUFlO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw0Q0FBNEMsU0FBUztBQUNyRDtBQUNBLHFCQUFxQiw0REFBWSxvRUFBb0UsdUJBQXVCO0FBQzVIO0FBQ087QUFDUDtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLGtCQUFrQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLGNBQWM7QUFDbkQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHdCQUF3QixpQkFBaUI7QUFDekM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsaUJBQWlCLFlBQVk7QUFDN0IsVUFBVSxzRUFBc0U7QUFDaEYsVUFBVSxvREFBb0Q7QUFDOUQsVUFBVSxvREFBb0Q7QUFDOUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQiw4QkFBOEIsY0FBYztBQUN0RTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCLHdDQUF3QyxjQUFjO0FBQ2hGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSw2QkFBNkIsaUNBQWlDO0FBQzlEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLCtCQUErQjtBQUMvQiwwQkFBMEI7QUFDMUI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0RBQXdELGlCQUFpQixJQUFJO0FBQzdFO0FBQ0E7QUFDQSwwQkFBMEIsNkRBQWdCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDBCQUEwQjtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsMEJBQTBCO0FBQzFCO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQiw2REFBZ0I7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXLDREQUFZO0FBQ3ZCO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVFQUF1RSxPQUFPO0FBQzlFO0FBQ0EsOEJBQThCLDREQUFZO0FBQzFDIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxub2RlX21vZHVsZXNcXGpvc2VcXGRpc3RcXHdlYmFwaVxcbGliXFxhc24xLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBpbnZhbGlkS2V5SW5wdXQgZnJvbSAnLi9pbnZhbGlkX2tleV9pbnB1dC5qcyc7XG5pbXBvcnQgeyBlbmNvZGVCYXNlNjQsIGRlY29kZUJhc2U2NCB9IGZyb20gJy4uL2xpYi9iYXNlNjQuanMnO1xuaW1wb3J0IHsgSk9TRU5vdFN1cHBvcnRlZCB9IGZyb20gJy4uL3V0aWwvZXJyb3JzLmpzJztcbmltcG9ydCB7IGlzQ3J5cHRvS2V5LCBpc0tleU9iamVjdCB9IGZyb20gJy4vaXNfa2V5X2xpa2UuanMnO1xuY29uc3QgZm9ybWF0UEVNID0gKGI2NCwgZGVzY3JpcHRvcikgPT4ge1xuICAgIGNvbnN0IG5ld2xpbmVkID0gKGI2NC5tYXRjaCgvLnsxLDY0fS9nKSB8fCBbXSkuam9pbignXFxuJyk7XG4gICAgcmV0dXJuIGAtLS0tLUJFR0lOICR7ZGVzY3JpcHRvcn0tLS0tLVxcbiR7bmV3bGluZWR9XFxuLS0tLS1FTkQgJHtkZXNjcmlwdG9yfS0tLS0tYDtcbn07XG5jb25zdCBnZW5lcmljRXhwb3J0ID0gYXN5bmMgKGtleVR5cGUsIGtleUZvcm1hdCwga2V5KSA9PiB7XG4gICAgaWYgKGlzS2V5T2JqZWN0KGtleSkpIHtcbiAgICAgICAgaWYgKGtleS50eXBlICE9PSBrZXlUeXBlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBrZXkgaXMgbm90IGEgJHtrZXlUeXBlfSBrZXlgKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4ga2V5LmV4cG9ydCh7IGZvcm1hdDogJ3BlbScsIHR5cGU6IGtleUZvcm1hdCB9KTtcbiAgICB9XG4gICAgaWYgKCFpc0NyeXB0b0tleShrZXkpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoaW52YWxpZEtleUlucHV0KGtleSwgJ0NyeXB0b0tleScsICdLZXlPYmplY3QnKSk7XG4gICAgfVxuICAgIGlmICgha2V5LmV4dHJhY3RhYmxlKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0NyeXB0b0tleSBpcyBub3QgZXh0cmFjdGFibGUnKTtcbiAgICB9XG4gICAgaWYgKGtleS50eXBlICE9PSBrZXlUeXBlKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYGtleSBpcyBub3QgYSAke2tleVR5cGV9IGtleWApO1xuICAgIH1cbiAgICByZXR1cm4gZm9ybWF0UEVNKGVuY29kZUJhc2U2NChuZXcgVWludDhBcnJheShhd2FpdCBjcnlwdG8uc3VidGxlLmV4cG9ydEtleShrZXlGb3JtYXQsIGtleSkpKSwgYCR7a2V5VHlwZS50b1VwcGVyQ2FzZSgpfSBLRVlgKTtcbn07XG5leHBvcnQgY29uc3QgdG9TUEtJID0gKGtleSkgPT4ge1xuICAgIHJldHVybiBnZW5lcmljRXhwb3J0KCdwdWJsaWMnLCAnc3BraScsIGtleSk7XG59O1xuZXhwb3J0IGNvbnN0IHRvUEtDUzggPSAoa2V5KSA9PiB7XG4gICAgcmV0dXJuIGdlbmVyaWNFeHBvcnQoJ3ByaXZhdGUnLCAncGtjczgnLCBrZXkpO1xufTtcbmNvbnN0IGJ5dGVzRXF1YWwgPSAoYSwgYikgPT4ge1xuICAgIGlmIChhLmJ5dGVMZW5ndGggIT09IGIubGVuZ3RoKVxuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBhLmJ5dGVMZW5ndGg7IGkrKykge1xuICAgICAgICBpZiAoYVtpXSAhPT0gYltpXSlcbiAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICB9XG4gICAgcmV0dXJuIHRydWU7XG59O1xuY29uc3QgY3JlYXRlQVNOMVN0YXRlID0gKGRhdGEpID0+ICh7IGRhdGEsIHBvczogMCB9KTtcbmNvbnN0IHBhcnNlTGVuZ3RoID0gKHN0YXRlKSA9PiB7XG4gICAgY29uc3QgZmlyc3QgPSBzdGF0ZS5kYXRhW3N0YXRlLnBvcysrXTtcbiAgICBpZiAoZmlyc3QgJiAweDgwKSB7XG4gICAgICAgIGNvbnN0IGxlbmd0aE9mTGVuID0gZmlyc3QgJiAweDdmO1xuICAgICAgICBsZXQgbGVuZ3RoID0gMDtcbiAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBsZW5ndGhPZkxlbjsgaSsrKSB7XG4gICAgICAgICAgICBsZW5ndGggPSAobGVuZ3RoIDw8IDgpIHwgc3RhdGUuZGF0YVtzdGF0ZS5wb3MrK107XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIGxlbmd0aDtcbiAgICB9XG4gICAgcmV0dXJuIGZpcnN0O1xufTtcbmNvbnN0IHNraXBFbGVtZW50ID0gKHN0YXRlLCBjb3VudCA9IDEpID0+IHtcbiAgICBpZiAoY291bnQgPD0gMClcbiAgICAgICAgcmV0dXJuO1xuICAgIHN0YXRlLnBvcysrO1xuICAgIGNvbnN0IGxlbmd0aCA9IHBhcnNlTGVuZ3RoKHN0YXRlKTtcbiAgICBzdGF0ZS5wb3MgKz0gbGVuZ3RoO1xuICAgIGlmIChjb3VudCA+IDEpIHtcbiAgICAgICAgc2tpcEVsZW1lbnQoc3RhdGUsIGNvdW50IC0gMSk7XG4gICAgfVxufTtcbmNvbnN0IGV4cGVjdFRhZyA9IChzdGF0ZSwgZXhwZWN0ZWRUYWcsIGVycm9yTWVzc2FnZSkgPT4ge1xuICAgIGlmIChzdGF0ZS5kYXRhW3N0YXRlLnBvcysrXSAhPT0gZXhwZWN0ZWRUYWcpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGVycm9yTWVzc2FnZSk7XG4gICAgfVxufTtcbmNvbnN0IGdldFN1YmFycmF5ID0gKHN0YXRlLCBsZW5ndGgpID0+IHtcbiAgICBjb25zdCByZXN1bHQgPSBzdGF0ZS5kYXRhLnN1YmFycmF5KHN0YXRlLnBvcywgc3RhdGUucG9zICsgbGVuZ3RoKTtcbiAgICBzdGF0ZS5wb3MgKz0gbGVuZ3RoO1xuICAgIHJldHVybiByZXN1bHQ7XG59O1xuY29uc3QgcGFyc2VBbGdvcml0aG1PSUQgPSAoc3RhdGUpID0+IHtcbiAgICBleHBlY3RUYWcoc3RhdGUsIDB4MDYsICdFeHBlY3RlZCBhbGdvcml0aG0gT0lEJyk7XG4gICAgY29uc3Qgb2lkTGVuID0gcGFyc2VMZW5ndGgoc3RhdGUpO1xuICAgIHJldHVybiBnZXRTdWJhcnJheShzdGF0ZSwgb2lkTGVuKTtcbn07XG5mdW5jdGlvbiBwYXJzZVBLQ1M4SGVhZGVyKHN0YXRlKSB7XG4gICAgZXhwZWN0VGFnKHN0YXRlLCAweDMwLCAnSW52YWxpZCBQS0NTIzggc3RydWN0dXJlJyk7XG4gICAgcGFyc2VMZW5ndGgoc3RhdGUpO1xuICAgIGV4cGVjdFRhZyhzdGF0ZSwgMHgwMiwgJ0V4cGVjdGVkIHZlcnNpb24gZmllbGQnKTtcbiAgICBjb25zdCB2ZXJMZW4gPSBwYXJzZUxlbmd0aChzdGF0ZSk7XG4gICAgc3RhdGUucG9zICs9IHZlckxlbjtcbiAgICBleHBlY3RUYWcoc3RhdGUsIDB4MzAsICdFeHBlY3RlZCBhbGdvcml0aG0gaWRlbnRpZmllcicpO1xuICAgIGNvbnN0IGFsZ0lkTGVuID0gcGFyc2VMZW5ndGgoc3RhdGUpO1xuICAgIGNvbnN0IGFsZ0lkU3RhcnQgPSBzdGF0ZS5wb3M7XG4gICAgcmV0dXJuIHsgYWxnSWRTdGFydCwgYWxnSWRMZW5ndGg6IGFsZ0lkTGVuIH07XG59XG5mdW5jdGlvbiBwYXJzZVNQS0lIZWFkZXIoc3RhdGUpIHtcbiAgICBleHBlY3RUYWcoc3RhdGUsIDB4MzAsICdJbnZhbGlkIFNQS0kgc3RydWN0dXJlJyk7XG4gICAgcGFyc2VMZW5ndGgoc3RhdGUpO1xuICAgIGV4cGVjdFRhZyhzdGF0ZSwgMHgzMCwgJ0V4cGVjdGVkIGFsZ29yaXRobSBpZGVudGlmaWVyJyk7XG4gICAgY29uc3QgYWxnSWRMZW4gPSBwYXJzZUxlbmd0aChzdGF0ZSk7XG4gICAgY29uc3QgYWxnSWRTdGFydCA9IHN0YXRlLnBvcztcbiAgICByZXR1cm4geyBhbGdJZFN0YXJ0LCBhbGdJZExlbmd0aDogYWxnSWRMZW4gfTtcbn1cbmNvbnN0IHBhcnNlRUNBbGdvcml0aG1JZGVudGlmaWVyID0gKHN0YXRlKSA9PiB7XG4gICAgY29uc3QgYWxnT2lkID0gcGFyc2VBbGdvcml0aG1PSUQoc3RhdGUpO1xuICAgIGlmIChieXRlc0VxdWFsKGFsZ09pZCwgWzB4MmIsIDB4NjUsIDB4NmVdKSkge1xuICAgICAgICByZXR1cm4gJ1gyNTUxOSc7XG4gICAgfVxuICAgIGlmICghYnl0ZXNFcXVhbChhbGdPaWQsIFsweDJhLCAweDg2LCAweDQ4LCAweGNlLCAweDNkLCAweDAyLCAweDAxXSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVbnN1cHBvcnRlZCBrZXkgYWxnb3JpdGhtJyk7XG4gICAgfVxuICAgIGV4cGVjdFRhZyhzdGF0ZSwgMHgwNiwgJ0V4cGVjdGVkIGN1cnZlIE9JRCcpO1xuICAgIGNvbnN0IGN1cnZlT2lkTGVuID0gcGFyc2VMZW5ndGgoc3RhdGUpO1xuICAgIGNvbnN0IGN1cnZlT2lkID0gZ2V0U3ViYXJyYXkoc3RhdGUsIGN1cnZlT2lkTGVuKTtcbiAgICBmb3IgKGNvbnN0IHsgbmFtZSwgb2lkIH0gb2YgW1xuICAgICAgICB7IG5hbWU6ICdQLTI1NicsIG9pZDogWzB4MmEsIDB4ODYsIDB4NDgsIDB4Y2UsIDB4M2QsIDB4MDMsIDB4MDEsIDB4MDddIH0sXG4gICAgICAgIHsgbmFtZTogJ1AtMzg0Jywgb2lkOiBbMHgyYiwgMHg4MSwgMHgwNCwgMHgwMCwgMHgyMl0gfSxcbiAgICAgICAgeyBuYW1lOiAnUC01MjEnLCBvaWQ6IFsweDJiLCAweDgxLCAweDA0LCAweDAwLCAweDIzXSB9LFxuICAgIF0pIHtcbiAgICAgICAgaWYgKGJ5dGVzRXF1YWwoY3VydmVPaWQsIG9pZCkpIHtcbiAgICAgICAgICAgIHJldHVybiBuYW1lO1xuICAgICAgICB9XG4gICAgfVxuICAgIHRocm93IG5ldyBFcnJvcignVW5zdXBwb3J0ZWQgbmFtZWQgY3VydmUnKTtcbn07XG5jb25zdCBnZW5lcmljSW1wb3J0ID0gYXN5bmMgKGtleUZvcm1hdCwga2V5RGF0YSwgYWxnLCBvcHRpb25zKSA9PiB7XG4gICAgbGV0IGFsZ29yaXRobTtcbiAgICBsZXQga2V5VXNhZ2VzO1xuICAgIGNvbnN0IGlzUHVibGljID0ga2V5Rm9ybWF0ID09PSAnc3BraSc7XG4gICAgY29uc3QgZ2V0U2lnVXNhZ2VzID0gKCkgPT4gKGlzUHVibGljID8gWyd2ZXJpZnknXSA6IFsnc2lnbiddKTtcbiAgICBjb25zdCBnZXRFbmNVc2FnZXMgPSAoKSA9PiBpc1B1YmxpYyA/IFsnZW5jcnlwdCcsICd3cmFwS2V5J10gOiBbJ2RlY3J5cHQnLCAndW53cmFwS2V5J107XG4gICAgc3dpdGNoIChhbGcpIHtcbiAgICAgICAgY2FzZSAnUFMyNTYnOlxuICAgICAgICBjYXNlICdQUzM4NCc6XG4gICAgICAgIGNhc2UgJ1BTNTEyJzpcbiAgICAgICAgICAgIGFsZ29yaXRobSA9IHsgbmFtZTogJ1JTQS1QU1MnLCBoYXNoOiBgU0hBLSR7YWxnLnNsaWNlKC0zKX1gIH07XG4gICAgICAgICAgICBrZXlVc2FnZXMgPSBnZXRTaWdVc2FnZXMoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdSUzI1Nic6XG4gICAgICAgIGNhc2UgJ1JTMzg0JzpcbiAgICAgICAgY2FzZSAnUlM1MTInOlxuICAgICAgICAgICAgYWxnb3JpdGhtID0geyBuYW1lOiAnUlNBU1NBLVBLQ1MxLXYxXzUnLCBoYXNoOiBgU0hBLSR7YWxnLnNsaWNlKC0zKX1gIH07XG4gICAgICAgICAgICBrZXlVc2FnZXMgPSBnZXRTaWdVc2FnZXMoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdSU0EtT0FFUCc6XG4gICAgICAgIGNhc2UgJ1JTQS1PQUVQLTI1Nic6XG4gICAgICAgIGNhc2UgJ1JTQS1PQUVQLTM4NCc6XG4gICAgICAgIGNhc2UgJ1JTQS1PQUVQLTUxMic6XG4gICAgICAgICAgICBhbGdvcml0aG0gPSB7XG4gICAgICAgICAgICAgICAgbmFtZTogJ1JTQS1PQUVQJyxcbiAgICAgICAgICAgICAgICBoYXNoOiBgU0hBLSR7cGFyc2VJbnQoYWxnLnNsaWNlKC0zKSwgMTApIHx8IDF9YCxcbiAgICAgICAgICAgIH07XG4gICAgICAgICAgICBrZXlVc2FnZXMgPSBnZXRFbmNVc2FnZXMoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdFUzI1Nic6XG4gICAgICAgIGNhc2UgJ0VTMzg0JzpcbiAgICAgICAgY2FzZSAnRVM1MTInOiB7XG4gICAgICAgICAgICBjb25zdCBjdXJ2ZU1hcCA9IHsgRVMyNTY6ICdQLTI1NicsIEVTMzg0OiAnUC0zODQnLCBFUzUxMjogJ1AtNTIxJyB9O1xuICAgICAgICAgICAgYWxnb3JpdGhtID0geyBuYW1lOiAnRUNEU0EnLCBuYW1lZEN1cnZlOiBjdXJ2ZU1hcFthbGddIH07XG4gICAgICAgICAgICBrZXlVc2FnZXMgPSBnZXRTaWdVc2FnZXMoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ0VDREgtRVMnOlxuICAgICAgICBjYXNlICdFQ0RILUVTK0ExMjhLVyc6XG4gICAgICAgIGNhc2UgJ0VDREgtRVMrQTE5MktXJzpcbiAgICAgICAgY2FzZSAnRUNESC1FUytBMjU2S1cnOiB7XG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGNvbnN0IG5hbWVkQ3VydmUgPSBvcHRpb25zLmdldE5hbWVkQ3VydmUoa2V5RGF0YSk7XG4gICAgICAgICAgICAgICAgYWxnb3JpdGhtID0gbmFtZWRDdXJ2ZSA9PT0gJ1gyNTUxOScgPyB7IG5hbWU6ICdYMjU1MTknIH0gOiB7IG5hbWU6ICdFQ0RIJywgbmFtZWRDdXJ2ZSB9O1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGNhdXNlKSB7XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IEpPU0VOb3RTdXBwb3J0ZWQoJ0ludmFsaWQgb3IgdW5zdXBwb3J0ZWQga2V5IGZvcm1hdCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAga2V5VXNhZ2VzID0gaXNQdWJsaWMgPyBbXSA6IFsnZGVyaXZlQml0cyddO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnRWQyNTUxOSc6XG4gICAgICAgIGNhc2UgJ0VkRFNBJzpcbiAgICAgICAgICAgIGFsZ29yaXRobSA9IHsgbmFtZTogJ0VkMjU1MTknIH07XG4gICAgICAgICAgICBrZXlVc2FnZXMgPSBnZXRTaWdVc2FnZXMoKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdNTC1EU0EtNDQnOlxuICAgICAgICBjYXNlICdNTC1EU0EtNjUnOlxuICAgICAgICBjYXNlICdNTC1EU0EtODcnOlxuICAgICAgICAgICAgYWxnb3JpdGhtID0geyBuYW1lOiBhbGcgfTtcbiAgICAgICAgICAgIGtleVVzYWdlcyA9IGdldFNpZ1VzYWdlcygpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyBuZXcgSk9TRU5vdFN1cHBvcnRlZCgnSW52YWxpZCBvciB1bnN1cHBvcnRlZCBcImFsZ1wiIChBbGdvcml0aG0pIHZhbHVlJyk7XG4gICAgfVxuICAgIHJldHVybiBjcnlwdG8uc3VidGxlLmltcG9ydEtleShrZXlGb3JtYXQsIGtleURhdGEsIGFsZ29yaXRobSwgb3B0aW9ucz8uZXh0cmFjdGFibGUgPz8gKGlzUHVibGljID8gdHJ1ZSA6IGZhbHNlKSwga2V5VXNhZ2VzKTtcbn07XG5jb25zdCBwcm9jZXNzUEVNRGF0YSA9IChwZW0sIHBhdHRlcm4pID0+IHtcbiAgICByZXR1cm4gZGVjb2RlQmFzZTY0KHBlbS5yZXBsYWNlKHBhdHRlcm4sICcnKSk7XG59O1xuZXhwb3J0IGNvbnN0IGZyb21QS0NTOCA9IChwZW0sIGFsZywgb3B0aW9ucykgPT4ge1xuICAgIGNvbnN0IGtleURhdGEgPSBwcm9jZXNzUEVNRGF0YShwZW0sIC8oPzotLS0tLSg/OkJFR0lOfEVORCkgUFJJVkFURSBLRVktLS0tLXxcXHMpL2cpO1xuICAgIGxldCBvcHRzID0gb3B0aW9ucztcbiAgICBpZiAoYWxnPy5zdGFydHNXaXRoPy4oJ0VDREgtRVMnKSkge1xuICAgICAgICBvcHRzIHx8PSB7fTtcbiAgICAgICAgb3B0cy5nZXROYW1lZEN1cnZlID0gKGtleURhdGEpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN0YXRlID0gY3JlYXRlQVNOMVN0YXRlKGtleURhdGEpO1xuICAgICAgICAgICAgcGFyc2VQS0NTOEhlYWRlcihzdGF0ZSk7XG4gICAgICAgICAgICByZXR1cm4gcGFyc2VFQ0FsZ29yaXRobUlkZW50aWZpZXIoc3RhdGUpO1xuICAgICAgICB9O1xuICAgIH1cbiAgICByZXR1cm4gZ2VuZXJpY0ltcG9ydCgncGtjczgnLCBrZXlEYXRhLCBhbGcsIG9wdHMpO1xufTtcbmV4cG9ydCBjb25zdCBmcm9tU1BLSSA9IChwZW0sIGFsZywgb3B0aW9ucykgPT4ge1xuICAgIGNvbnN0IGtleURhdGEgPSBwcm9jZXNzUEVNRGF0YShwZW0sIC8oPzotLS0tLSg/OkJFR0lOfEVORCkgUFVCTElDIEtFWS0tLS0tfFxccykvZyk7XG4gICAgbGV0IG9wdHMgPSBvcHRpb25zO1xuICAgIGlmIChhbGc/LnN0YXJ0c1dpdGg/LignRUNESC1FUycpKSB7XG4gICAgICAgIG9wdHMgfHw9IHt9O1xuICAgICAgICBvcHRzLmdldE5hbWVkQ3VydmUgPSAoa2V5RGF0YSkgPT4ge1xuICAgICAgICAgICAgY29uc3Qgc3RhdGUgPSBjcmVhdGVBU04xU3RhdGUoa2V5RGF0YSk7XG4gICAgICAgICAgICBwYXJzZVNQS0lIZWFkZXIoc3RhdGUpO1xuICAgICAgICAgICAgcmV0dXJuIHBhcnNlRUNBbGdvcml0aG1JZGVudGlmaWVyKHN0YXRlKTtcbiAgICAgICAgfTtcbiAgICB9XG4gICAgcmV0dXJuIGdlbmVyaWNJbXBvcnQoJ3Nwa2knLCBrZXlEYXRhLCBhbGcsIG9wdHMpO1xufTtcbmZ1bmN0aW9uIHNwa2lGcm9tWDUwOShidWYpIHtcbiAgICBjb25zdCBzdGF0ZSA9IGNyZWF0ZUFTTjFTdGF0ZShidWYpO1xuICAgIGV4cGVjdFRhZyhzdGF0ZSwgMHgzMCwgJ0ludmFsaWQgY2VydGlmaWNhdGUgc3RydWN0dXJlJyk7XG4gICAgcGFyc2VMZW5ndGgoc3RhdGUpO1xuICAgIGV4cGVjdFRhZyhzdGF0ZSwgMHgzMCwgJ0ludmFsaWQgdGJzQ2VydGlmaWNhdGUgc3RydWN0dXJlJyk7XG4gICAgcGFyc2VMZW5ndGgoc3RhdGUpO1xuICAgIGlmIChidWZbc3RhdGUucG9zXSA9PT0gMHhhMCkge1xuICAgICAgICBza2lwRWxlbWVudChzdGF0ZSwgNik7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgICBza2lwRWxlbWVudChzdGF0ZSwgNSk7XG4gICAgfVxuICAgIGNvbnN0IHNwa2lTdGFydCA9IHN0YXRlLnBvcztcbiAgICBleHBlY3RUYWcoc3RhdGUsIDB4MzAsICdJbnZhbGlkIFNQS0kgc3RydWN0dXJlJyk7XG4gICAgY29uc3Qgc3BraUNvbnRlbnRMZW4gPSBwYXJzZUxlbmd0aChzdGF0ZSk7XG4gICAgcmV0dXJuIGJ1Zi5zdWJhcnJheShzcGtpU3RhcnQsIHNwa2lTdGFydCArIHNwa2lDb250ZW50TGVuICsgKHN0YXRlLnBvcyAtIHNwa2lTdGFydCkpO1xufVxuZnVuY3Rpb24gZXh0cmFjdFg1MDlTUEtJKHg1MDkpIHtcbiAgICBjb25zdCBkZXJCeXRlcyA9IHByb2Nlc3NQRU1EYXRhKHg1MDksIC8oPzotLS0tLSg/OkJFR0lOfEVORCkgQ0VSVElGSUNBVEUtLS0tLXxcXHMpL2cpO1xuICAgIHJldHVybiBzcGtpRnJvbVg1MDkoZGVyQnl0ZXMpO1xufVxuZXhwb3J0IGNvbnN0IGZyb21YNTA5ID0gKHBlbSwgYWxnLCBvcHRpb25zKSA9PiB7XG4gICAgbGV0IHNwa2k7XG4gICAgdHJ5IHtcbiAgICAgICAgc3BraSA9IGV4dHJhY3RYNTA5U1BLSShwZW0pO1xuICAgIH1cbiAgICBjYXRjaCAoY2F1c2UpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignRmFpbGVkIHRvIHBhcnNlIHRoZSBYLjUwOSBjZXJ0aWZpY2F0ZScsIHsgY2F1c2UgfSk7XG4gICAgfVxuICAgIHJldHVybiBmcm9tU1BLSShmb3JtYXRQRU0oZW5jb2RlQmFzZTY0KHNwa2kpLCAnUFVCTElDIEtFWScpLCBhbGcsIG9wdGlvbnMpO1xufTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/asn1.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/base64.js":
/*!******************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/base64.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decodeBase64: () => (/* binding */ decodeBase64),\n/* harmony export */   encodeBase64: () => (/* binding */ encodeBase64)\n/* harmony export */ });\nfunction encodeBase64(input) {\n    if (Uint8Array.prototype.toBase64) {\n        return input.toBase64();\n    }\n    const CHUNK_SIZE = 0x8000;\n    const arr = [];\n    for (let i = 0; i < input.length; i += CHUNK_SIZE) {\n        arr.push(String.fromCharCode.apply(null, input.subarray(i, i + CHUNK_SIZE)));\n    }\n    return btoa(arr.join(''));\n}\nfunction decodeBase64(encoded) {\n    if (Uint8Array.fromBase64) {\n        return Uint8Array.fromBase64(encoded);\n    }\n    const binary = atob(encoded);\n    const bytes = new Uint8Array(binary.length);\n    for (let i = 0; i < binary.length; i++) {\n        bytes[i] = binary.charCodeAt(i);\n    }\n    return bytes;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL2Jhc2U2NC5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG9CQUFvQixrQkFBa0I7QUFDdEM7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxvQkFBb0IsbUJBQW1CO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxub2RlX21vZHVsZXNcXGpvc2VcXGRpc3RcXHdlYmFwaVxcbGliXFxiYXNlNjQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGVuY29kZUJhc2U2NChpbnB1dCkge1xuICAgIGlmIChVaW50OEFycmF5LnByb3RvdHlwZS50b0Jhc2U2NCkge1xuICAgICAgICByZXR1cm4gaW5wdXQudG9CYXNlNjQoKTtcbiAgICB9XG4gICAgY29uc3QgQ0hVTktfU0laRSA9IDB4ODAwMDtcbiAgICBjb25zdCBhcnIgPSBbXTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlucHV0Lmxlbmd0aDsgaSArPSBDSFVOS19TSVpFKSB7XG4gICAgICAgIGFyci5wdXNoKFN0cmluZy5mcm9tQ2hhckNvZGUuYXBwbHkobnVsbCwgaW5wdXQuc3ViYXJyYXkoaSwgaSArIENIVU5LX1NJWkUpKSk7XG4gICAgfVxuICAgIHJldHVybiBidG9hKGFyci5qb2luKCcnKSk7XG59XG5leHBvcnQgZnVuY3Rpb24gZGVjb2RlQmFzZTY0KGVuY29kZWQpIHtcbiAgICBpZiAoVWludDhBcnJheS5mcm9tQmFzZTY0KSB7XG4gICAgICAgIHJldHVybiBVaW50OEFycmF5LmZyb21CYXNlNjQoZW5jb2RlZCk7XG4gICAgfVxuICAgIGNvbnN0IGJpbmFyeSA9IGF0b2IoZW5jb2RlZCk7XG4gICAgY29uc3QgYnl0ZXMgPSBuZXcgVWludDhBcnJheShiaW5hcnkubGVuZ3RoKTtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGJpbmFyeS5sZW5ndGg7IGkrKykge1xuICAgICAgICBieXRlc1tpXSA9IGJpbmFyeS5jaGFyQ29kZUF0KGkpO1xuICAgIH1cbiAgICByZXR1cm4gYnl0ZXM7XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/base64.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/buffer_utils.js":
/*!************************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/buffer_utils.js ***!
  \************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   concat: () => (/* binding */ concat),\n/* harmony export */   decoder: () => (/* binding */ decoder),\n/* harmony export */   encoder: () => (/* binding */ encoder),\n/* harmony export */   uint32be: () => (/* binding */ uint32be),\n/* harmony export */   uint64be: () => (/* binding */ uint64be)\n/* harmony export */ });\nconst encoder = new TextEncoder();\nconst decoder = new TextDecoder();\nconst MAX_INT32 = 2 ** 32;\nfunction concat(...buffers) {\n    const size = buffers.reduce((acc, { length }) => acc + length, 0);\n    const buf = new Uint8Array(size);\n    let i = 0;\n    for (const buffer of buffers) {\n        buf.set(buffer, i);\n        i += buffer.length;\n    }\n    return buf;\n}\nfunction writeUInt32BE(buf, value, offset) {\n    if (value < 0 || value >= MAX_INT32) {\n        throw new RangeError(`value must be >= 0 and <= ${MAX_INT32 - 1}. Received ${value}`);\n    }\n    buf.set([value >>> 24, value >>> 16, value >>> 8, value & 0xff], offset);\n}\nfunction uint64be(value) {\n    const high = Math.floor(value / MAX_INT32);\n    const low = value % MAX_INT32;\n    const buf = new Uint8Array(8);\n    writeUInt32BE(buf, high, 0);\n    writeUInt32BE(buf, low, 4);\n    return buf;\n}\nfunction uint32be(value) {\n    const buf = new Uint8Array(4);\n    writeUInt32BE(buf, value);\n    return buf;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL2J1ZmZlcl91dGlscy5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFPO0FBQ0E7QUFDUDtBQUNPO0FBQ1Asd0NBQXdDLFFBQVE7QUFDaEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwREFBMEQsY0FBYyxhQUFhLE1BQU07QUFDM0Y7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXG5vZGVfbW9kdWxlc1xcam9zZVxcZGlzdFxcd2ViYXBpXFxsaWJcXGJ1ZmZlcl91dGlscy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xuZXhwb3J0IGNvbnN0IGRlY29kZXIgPSBuZXcgVGV4dERlY29kZXIoKTtcbmNvbnN0IE1BWF9JTlQzMiA9IDIgKiogMzI7XG5leHBvcnQgZnVuY3Rpb24gY29uY2F0KC4uLmJ1ZmZlcnMpIHtcbiAgICBjb25zdCBzaXplID0gYnVmZmVycy5yZWR1Y2UoKGFjYywgeyBsZW5ndGggfSkgPT4gYWNjICsgbGVuZ3RoLCAwKTtcbiAgICBjb25zdCBidWYgPSBuZXcgVWludDhBcnJheShzaXplKTtcbiAgICBsZXQgaSA9IDA7XG4gICAgZm9yIChjb25zdCBidWZmZXIgb2YgYnVmZmVycykge1xuICAgICAgICBidWYuc2V0KGJ1ZmZlciwgaSk7XG4gICAgICAgIGkgKz0gYnVmZmVyLmxlbmd0aDtcbiAgICB9XG4gICAgcmV0dXJuIGJ1Zjtcbn1cbmZ1bmN0aW9uIHdyaXRlVUludDMyQkUoYnVmLCB2YWx1ZSwgb2Zmc2V0KSB7XG4gICAgaWYgKHZhbHVlIDwgMCB8fCB2YWx1ZSA+PSBNQVhfSU5UMzIpIHtcbiAgICAgICAgdGhyb3cgbmV3IFJhbmdlRXJyb3IoYHZhbHVlIG11c3QgYmUgPj0gMCBhbmQgPD0gJHtNQVhfSU5UMzIgLSAxfS4gUmVjZWl2ZWQgJHt2YWx1ZX1gKTtcbiAgICB9XG4gICAgYnVmLnNldChbdmFsdWUgPj4+IDI0LCB2YWx1ZSA+Pj4gMTYsIHZhbHVlID4+PiA4LCB2YWx1ZSAmIDB4ZmZdLCBvZmZzZXQpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHVpbnQ2NGJlKHZhbHVlKSB7XG4gICAgY29uc3QgaGlnaCA9IE1hdGguZmxvb3IodmFsdWUgLyBNQVhfSU5UMzIpO1xuICAgIGNvbnN0IGxvdyA9IHZhbHVlICUgTUFYX0lOVDMyO1xuICAgIGNvbnN0IGJ1ZiA9IG5ldyBVaW50OEFycmF5KDgpO1xuICAgIHdyaXRlVUludDMyQkUoYnVmLCBoaWdoLCAwKTtcbiAgICB3cml0ZVVJbnQzMkJFKGJ1ZiwgbG93LCA0KTtcbiAgICByZXR1cm4gYnVmO1xufVxuZXhwb3J0IGZ1bmN0aW9uIHVpbnQzMmJlKHZhbHVlKSB7XG4gICAgY29uc3QgYnVmID0gbmV3IFVpbnQ4QXJyYXkoNCk7XG4gICAgd3JpdGVVSW50MzJCRShidWYsIHZhbHVlKTtcbiAgICByZXR1cm4gYnVmO1xufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/buffer_utils.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/check_key_length.js":
/*!****************************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/check_key_length.js ***!
  \****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((alg, key) => {\n    if (alg.startsWith('RS') || alg.startsWith('PS')) {\n        const { modulusLength } = key.algorithm;\n        if (typeof modulusLength !== 'number' || modulusLength < 2048) {\n            throw new TypeError(`${alg} requires key modulusLength to be 2048 bits or larger`);\n        }\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL2NoZWNrX2tleV9sZW5ndGguanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLGlFQUFlO0FBQ2Y7QUFDQSxnQkFBZ0IsZ0JBQWdCO0FBQ2hDO0FBQ0EsbUNBQW1DLEtBQUs7QUFDeEM7QUFDQTtBQUNBLENBQUMsRUFBQyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcbm9kZV9tb2R1bGVzXFxqb3NlXFxkaXN0XFx3ZWJhcGlcXGxpYlxcY2hlY2tfa2V5X2xlbmd0aC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCAoYWxnLCBrZXkpID0+IHtcbiAgICBpZiAoYWxnLnN0YXJ0c1dpdGgoJ1JTJykgfHwgYWxnLnN0YXJ0c1dpdGgoJ1BTJykpIHtcbiAgICAgICAgY29uc3QgeyBtb2R1bHVzTGVuZ3RoIH0gPSBrZXkuYWxnb3JpdGhtO1xuICAgICAgICBpZiAodHlwZW9mIG1vZHVsdXNMZW5ndGggIT09ICdudW1iZXInIHx8IG1vZHVsdXNMZW5ndGggPCAyMDQ4KSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGAke2FsZ30gcmVxdWlyZXMga2V5IG1vZHVsdXNMZW5ndGggdG8gYmUgMjA0OCBiaXRzIG9yIGxhcmdlcmApO1xuICAgICAgICB9XG4gICAgfVxufTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/check_key_length.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/check_key_type.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/check_key_type.js ***!
  \**************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _invalid_key_input_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./invalid_key_input.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/invalid_key_input.js\");\n/* harmony import */ var _is_key_like_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./is_key_like.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_key_like.js\");\n/* harmony import */ var _is_jwk_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./is_jwk.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_jwk.js\");\n\n\n\nconst tag = (key) => key?.[Symbol.toStringTag];\nconst jwkMatchesOp = (alg, key, usage) => {\n    if (key.use !== undefined) {\n        let expected;\n        switch (usage) {\n            case 'sign':\n            case 'verify':\n                expected = 'sig';\n                break;\n            case 'encrypt':\n            case 'decrypt':\n                expected = 'enc';\n                break;\n        }\n        if (key.use !== expected) {\n            throw new TypeError(`Invalid key for this operation, its \"use\" must be \"${expected}\" when present`);\n        }\n    }\n    if (key.alg !== undefined && key.alg !== alg) {\n        throw new TypeError(`Invalid key for this operation, its \"alg\" must be \"${alg}\" when present`);\n    }\n    if (Array.isArray(key.key_ops)) {\n        let expectedKeyOp;\n        switch (true) {\n            case usage === 'sign' || usage === 'verify':\n            case alg === 'dir':\n            case alg.includes('CBC-HS'):\n                expectedKeyOp = usage;\n                break;\n            case alg.startsWith('PBES2'):\n                expectedKeyOp = 'deriveBits';\n                break;\n            case /^A\\d{3}(?:GCM)?(?:KW)?$/.test(alg):\n                if (!alg.includes('GCM') && alg.endsWith('KW')) {\n                    expectedKeyOp = usage === 'encrypt' ? 'wrapKey' : 'unwrapKey';\n                }\n                else {\n                    expectedKeyOp = usage;\n                }\n                break;\n            case usage === 'encrypt' && alg.startsWith('RSA'):\n                expectedKeyOp = 'wrapKey';\n                break;\n            case usage === 'decrypt':\n                expectedKeyOp = alg.startsWith('RSA') ? 'unwrapKey' : 'deriveBits';\n                break;\n        }\n        if (expectedKeyOp && key.key_ops?.includes?.(expectedKeyOp) === false) {\n            throw new TypeError(`Invalid key for this operation, its \"key_ops\" must include \"${expectedKeyOp}\" when present`);\n        }\n    }\n    return true;\n};\nconst symmetricTypeCheck = (alg, key, usage) => {\n    if (key instanceof Uint8Array)\n        return;\n    if (_is_jwk_js__WEBPACK_IMPORTED_MODULE_0__.isJWK(key)) {\n        if (_is_jwk_js__WEBPACK_IMPORTED_MODULE_0__.isSecretJWK(key) && jwkMatchesOp(alg, key, usage))\n            return;\n        throw new TypeError(`JSON Web Key for symmetric algorithms must have JWK \"kty\" (Key Type) equal to \"oct\" and the JWK \"k\" (Key Value) present`);\n    }\n    if (!(0,_is_key_like_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(key)) {\n        throw new TypeError((0,_invalid_key_input_js__WEBPACK_IMPORTED_MODULE_2__.withAlg)(alg, key, 'CryptoKey', 'KeyObject', 'JSON Web Key', 'Uint8Array'));\n    }\n    if (key.type !== 'secret') {\n        throw new TypeError(`${tag(key)} instances for symmetric algorithms must be of type \"secret\"`);\n    }\n};\nconst asymmetricTypeCheck = (alg, key, usage) => {\n    if (_is_jwk_js__WEBPACK_IMPORTED_MODULE_0__.isJWK(key)) {\n        switch (usage) {\n            case 'decrypt':\n            case 'sign':\n                if (_is_jwk_js__WEBPACK_IMPORTED_MODULE_0__.isPrivateJWK(key) && jwkMatchesOp(alg, key, usage))\n                    return;\n                throw new TypeError(`JSON Web Key for this operation be a private JWK`);\n            case 'encrypt':\n            case 'verify':\n                if (_is_jwk_js__WEBPACK_IMPORTED_MODULE_0__.isPublicJWK(key) && jwkMatchesOp(alg, key, usage))\n                    return;\n                throw new TypeError(`JSON Web Key for this operation be a public JWK`);\n        }\n    }\n    if (!(0,_is_key_like_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(key)) {\n        throw new TypeError((0,_invalid_key_input_js__WEBPACK_IMPORTED_MODULE_2__.withAlg)(alg, key, 'CryptoKey', 'KeyObject', 'JSON Web Key'));\n    }\n    if (key.type === 'secret') {\n        throw new TypeError(`${tag(key)} instances for asymmetric algorithms must not be of type \"secret\"`);\n    }\n    if (key.type === 'public') {\n        switch (usage) {\n            case 'sign':\n                throw new TypeError(`${tag(key)} instances for asymmetric algorithm signing must be of type \"private\"`);\n            case 'decrypt':\n                throw new TypeError(`${tag(key)} instances for asymmetric algorithm decryption must be of type \"private\"`);\n            default:\n                break;\n        }\n    }\n    if (key.type === 'private') {\n        switch (usage) {\n            case 'verify':\n                throw new TypeError(`${tag(key)} instances for asymmetric algorithm verifying must be of type \"public\"`);\n            case 'encrypt':\n                throw new TypeError(`${tag(key)} instances for asymmetric algorithm encryption must be of type \"public\"`);\n            default:\n                break;\n        }\n    }\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((alg, key, usage) => {\n    const symmetric = alg.startsWith('HS') ||\n        alg === 'dir' ||\n        alg.startsWith('PBES2') ||\n        /^A(?:128|192|256)(?:GCM)?(?:KW)?$/.test(alg) ||\n        /^A(?:128|192|256)CBC-HS(?:256|384|512)$/.test(alg);\n    if (symmetric) {\n        symmetricTypeCheck(alg, key, usage);\n    }\n    else {\n        asymmetricTypeCheck(alg, key, usage);\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL2NoZWNrX2tleV90eXBlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBb0U7QUFDM0I7QUFDTjtBQUNuQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzRkFBc0YsU0FBUztBQUMvRjtBQUNBO0FBQ0E7QUFDQSxrRkFBa0YsSUFBSTtBQUN0RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsRUFBRTtBQUN6QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrRkFBK0YsY0FBYztBQUM3RztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFFBQVEsNkNBQVM7QUFDakIsWUFBWSxtREFBZTtBQUMzQjtBQUNBO0FBQ0E7QUFDQSxTQUFTLDJEQUFTO0FBQ2xCLDRCQUE0Qiw4REFBZTtBQUMzQztBQUNBO0FBQ0EsK0JBQStCLFVBQVU7QUFDekM7QUFDQTtBQUNBO0FBQ0EsUUFBUSw2Q0FBUztBQUNqQjtBQUNBO0FBQ0E7QUFDQSxvQkFBb0Isb0RBQWdCO0FBQ3BDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esb0JBQW9CLG1EQUFlO0FBQ25DO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsU0FBUywyREFBUztBQUNsQiw0QkFBNEIsOERBQWU7QUFDM0M7QUFDQTtBQUNBLCtCQUErQixVQUFVO0FBQ3pDO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLFVBQVU7QUFDakQ7QUFDQSx1Q0FBdUMsVUFBVTtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHVDQUF1QyxVQUFVO0FBQ2pEO0FBQ0EsdUNBQXVDLFVBQVU7QUFDakQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsRUFBQyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcbm9kZV9tb2R1bGVzXFxqb3NlXFxkaXN0XFx3ZWJhcGlcXGxpYlxcY2hlY2tfa2V5X3R5cGUuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgd2l0aEFsZyBhcyBpbnZhbGlkS2V5SW5wdXQgfSBmcm9tICcuL2ludmFsaWRfa2V5X2lucHV0LmpzJztcbmltcG9ydCBpc0tleUxpa2UgZnJvbSAnLi9pc19rZXlfbGlrZS5qcyc7XG5pbXBvcnQgKiBhcyBqd2sgZnJvbSAnLi9pc19qd2suanMnO1xuY29uc3QgdGFnID0gKGtleSkgPT4ga2V5Py5bU3ltYm9sLnRvU3RyaW5nVGFnXTtcbmNvbnN0IGp3a01hdGNoZXNPcCA9IChhbGcsIGtleSwgdXNhZ2UpID0+IHtcbiAgICBpZiAoa2V5LnVzZSAhPT0gdW5kZWZpbmVkKSB7XG4gICAgICAgIGxldCBleHBlY3RlZDtcbiAgICAgICAgc3dpdGNoICh1c2FnZSkge1xuICAgICAgICAgICAgY2FzZSAnc2lnbic6XG4gICAgICAgICAgICBjYXNlICd2ZXJpZnknOlxuICAgICAgICAgICAgICAgIGV4cGVjdGVkID0gJ3NpZyc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlICdlbmNyeXB0JzpcbiAgICAgICAgICAgIGNhc2UgJ2RlY3J5cHQnOlxuICAgICAgICAgICAgICAgIGV4cGVjdGVkID0gJ2VuYyc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGtleS51c2UgIT09IGV4cGVjdGVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBJbnZhbGlkIGtleSBmb3IgdGhpcyBvcGVyYXRpb24sIGl0cyBcInVzZVwiIG11c3QgYmUgXCIke2V4cGVjdGVkfVwiIHdoZW4gcHJlc2VudGApO1xuICAgICAgICB9XG4gICAgfVxuICAgIGlmIChrZXkuYWxnICE9PSB1bmRlZmluZWQgJiYga2V5LmFsZyAhPT0gYWxnKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYEludmFsaWQga2V5IGZvciB0aGlzIG9wZXJhdGlvbiwgaXRzIFwiYWxnXCIgbXVzdCBiZSBcIiR7YWxnfVwiIHdoZW4gcHJlc2VudGApO1xuICAgIH1cbiAgICBpZiAoQXJyYXkuaXNBcnJheShrZXkua2V5X29wcykpIHtcbiAgICAgICAgbGV0IGV4cGVjdGVkS2V5T3A7XG4gICAgICAgIHN3aXRjaCAodHJ1ZSkge1xuICAgICAgICAgICAgY2FzZSB1c2FnZSA9PT0gJ3NpZ24nIHx8IHVzYWdlID09PSAndmVyaWZ5JzpcbiAgICAgICAgICAgIGNhc2UgYWxnID09PSAnZGlyJzpcbiAgICAgICAgICAgIGNhc2UgYWxnLmluY2x1ZGVzKCdDQkMtSFMnKTpcbiAgICAgICAgICAgICAgICBleHBlY3RlZEtleU9wID0gdXNhZ2U7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIGFsZy5zdGFydHNXaXRoKCdQQkVTMicpOlxuICAgICAgICAgICAgICAgIGV4cGVjdGVkS2V5T3AgPSAnZGVyaXZlQml0cyc7XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICBjYXNlIC9eQVxcZHszfSg/OkdDTSk/KD86S1cpPyQvLnRlc3QoYWxnKTpcbiAgICAgICAgICAgICAgICBpZiAoIWFsZy5pbmNsdWRlcygnR0NNJykgJiYgYWxnLmVuZHNXaXRoKCdLVycpKSB7XG4gICAgICAgICAgICAgICAgICAgIGV4cGVjdGVkS2V5T3AgPSB1c2FnZSA9PT0gJ2VuY3J5cHQnID8gJ3dyYXBLZXknIDogJ3Vud3JhcEtleSc7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICBleHBlY3RlZEtleU9wID0gdXNhZ2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSB1c2FnZSA9PT0gJ2VuY3J5cHQnICYmIGFsZy5zdGFydHNXaXRoKCdSU0EnKTpcbiAgICAgICAgICAgICAgICBleHBlY3RlZEtleU9wID0gJ3dyYXBLZXknO1xuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgY2FzZSB1c2FnZSA9PT0gJ2RlY3J5cHQnOlxuICAgICAgICAgICAgICAgIGV4cGVjdGVkS2V5T3AgPSBhbGcuc3RhcnRzV2l0aCgnUlNBJykgPyAndW53cmFwS2V5JyA6ICdkZXJpdmVCaXRzJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBpZiAoZXhwZWN0ZWRLZXlPcCAmJiBrZXkua2V5X29wcz8uaW5jbHVkZXM/LihleHBlY3RlZEtleU9wKSA9PT0gZmFsc2UpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYEludmFsaWQga2V5IGZvciB0aGlzIG9wZXJhdGlvbiwgaXRzIFwia2V5X29wc1wiIG11c3QgaW5jbHVkZSBcIiR7ZXhwZWN0ZWRLZXlPcH1cIiB3aGVuIHByZXNlbnRgKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gdHJ1ZTtcbn07XG5jb25zdCBzeW1tZXRyaWNUeXBlQ2hlY2sgPSAoYWxnLCBrZXksIHVzYWdlKSA9PiB7XG4gICAgaWYgKGtleSBpbnN0YW5jZW9mIFVpbnQ4QXJyYXkpXG4gICAgICAgIHJldHVybjtcbiAgICBpZiAoandrLmlzSldLKGtleSkpIHtcbiAgICAgICAgaWYgKGp3ay5pc1NlY3JldEpXSyhrZXkpICYmIGp3a01hdGNoZXNPcChhbGcsIGtleSwgdXNhZ2UpKVxuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGBKU09OIFdlYiBLZXkgZm9yIHN5bW1ldHJpYyBhbGdvcml0aG1zIG11c3QgaGF2ZSBKV0sgXCJrdHlcIiAoS2V5IFR5cGUpIGVxdWFsIHRvIFwib2N0XCIgYW5kIHRoZSBKV0sgXCJrXCIgKEtleSBWYWx1ZSkgcHJlc2VudGApO1xuICAgIH1cbiAgICBpZiAoIWlzS2V5TGlrZShrZXkpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoaW52YWxpZEtleUlucHV0KGFsZywga2V5LCAnQ3J5cHRvS2V5JywgJ0tleU9iamVjdCcsICdKU09OIFdlYiBLZXknLCAnVWludDhBcnJheScpKTtcbiAgICB9XG4gICAgaWYgKGtleS50eXBlICE9PSAnc2VjcmV0Jykge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGAke3RhZyhrZXkpfSBpbnN0YW5jZXMgZm9yIHN5bW1ldHJpYyBhbGdvcml0aG1zIG11c3QgYmUgb2YgdHlwZSBcInNlY3JldFwiYCk7XG4gICAgfVxufTtcbmNvbnN0IGFzeW1tZXRyaWNUeXBlQ2hlY2sgPSAoYWxnLCBrZXksIHVzYWdlKSA9PiB7XG4gICAgaWYgKGp3ay5pc0pXSyhrZXkpKSB7XG4gICAgICAgIHN3aXRjaCAodXNhZ2UpIHtcbiAgICAgICAgICAgIGNhc2UgJ2RlY3J5cHQnOlxuICAgICAgICAgICAgY2FzZSAnc2lnbic6XG4gICAgICAgICAgICAgICAgaWYgKGp3ay5pc1ByaXZhdGVKV0soa2V5KSAmJiBqd2tNYXRjaGVzT3AoYWxnLCBrZXksIHVzYWdlKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYEpTT04gV2ViIEtleSBmb3IgdGhpcyBvcGVyYXRpb24gYmUgYSBwcml2YXRlIEpXS2ApO1xuICAgICAgICAgICAgY2FzZSAnZW5jcnlwdCc6XG4gICAgICAgICAgICBjYXNlICd2ZXJpZnknOlxuICAgICAgICAgICAgICAgIGlmIChqd2suaXNQdWJsaWNKV0soa2V5KSAmJiBqd2tNYXRjaGVzT3AoYWxnLCBrZXksIHVzYWdlKSlcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYEpTT04gV2ViIEtleSBmb3IgdGhpcyBvcGVyYXRpb24gYmUgYSBwdWJsaWMgSldLYCk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKCFpc0tleUxpa2Uoa2V5KSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGludmFsaWRLZXlJbnB1dChhbGcsIGtleSwgJ0NyeXB0b0tleScsICdLZXlPYmplY3QnLCAnSlNPTiBXZWIgS2V5JykpO1xuICAgIH1cbiAgICBpZiAoa2V5LnR5cGUgPT09ICdzZWNyZXQnKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYCR7dGFnKGtleSl9IGluc3RhbmNlcyBmb3IgYXN5bW1ldHJpYyBhbGdvcml0aG1zIG11c3Qgbm90IGJlIG9mIHR5cGUgXCJzZWNyZXRcImApO1xuICAgIH1cbiAgICBpZiAoa2V5LnR5cGUgPT09ICdwdWJsaWMnKSB7XG4gICAgICAgIHN3aXRjaCAodXNhZ2UpIHtcbiAgICAgICAgICAgIGNhc2UgJ3NpZ24nOlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYCR7dGFnKGtleSl9IGluc3RhbmNlcyBmb3IgYXN5bW1ldHJpYyBhbGdvcml0aG0gc2lnbmluZyBtdXN0IGJlIG9mIHR5cGUgXCJwcml2YXRlXCJgKTtcbiAgICAgICAgICAgIGNhc2UgJ2RlY3J5cHQnOlxuICAgICAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYCR7dGFnKGtleSl9IGluc3RhbmNlcyBmb3IgYXN5bW1ldHJpYyBhbGdvcml0aG0gZGVjcnlwdGlvbiBtdXN0IGJlIG9mIHR5cGUgXCJwcml2YXRlXCJgKTtcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGtleS50eXBlID09PSAncHJpdmF0ZScpIHtcbiAgICAgICAgc3dpdGNoICh1c2FnZSkge1xuICAgICAgICAgICAgY2FzZSAndmVyaWZ5JzpcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKGAke3RhZyhrZXkpfSBpbnN0YW5jZXMgZm9yIGFzeW1tZXRyaWMgYWxnb3JpdGhtIHZlcmlmeWluZyBtdXN0IGJlIG9mIHR5cGUgXCJwdWJsaWNcImApO1xuICAgICAgICAgICAgY2FzZSAnZW5jcnlwdCc6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgJHt0YWcoa2V5KX0gaW5zdGFuY2VzIGZvciBhc3ltbWV0cmljIGFsZ29yaXRobSBlbmNyeXB0aW9uIG11c3QgYmUgb2YgdHlwZSBcInB1YmxpY1wiYCk7XG4gICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgfVxufTtcbmV4cG9ydCBkZWZhdWx0IChhbGcsIGtleSwgdXNhZ2UpID0+IHtcbiAgICBjb25zdCBzeW1tZXRyaWMgPSBhbGcuc3RhcnRzV2l0aCgnSFMnKSB8fFxuICAgICAgICBhbGcgPT09ICdkaXInIHx8XG4gICAgICAgIGFsZy5zdGFydHNXaXRoKCdQQkVTMicpIHx8XG4gICAgICAgIC9eQSg/OjEyOHwxOTJ8MjU2KSg/OkdDTSk/KD86S1cpPyQvLnRlc3QoYWxnKSB8fFxuICAgICAgICAvXkEoPzoxMjh8MTkyfDI1NilDQkMtSFMoPzoyNTZ8Mzg0fDUxMikkLy50ZXN0KGFsZyk7XG4gICAgaWYgKHN5bW1ldHJpYykge1xuICAgICAgICBzeW1tZXRyaWNUeXBlQ2hlY2soYWxnLCBrZXksIHVzYWdlKTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGFzeW1tZXRyaWNUeXBlQ2hlY2soYWxnLCBrZXksIHVzYWdlKTtcbiAgICB9XG59O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/check_key_type.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/crypto_key.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/crypto_key.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   checkEncCryptoKey: () => (/* binding */ checkEncCryptoKey),\n/* harmony export */   checkSigCryptoKey: () => (/* binding */ checkSigCryptoKey)\n/* harmony export */ });\nfunction unusable(name, prop = 'algorithm.name') {\n    return new TypeError(`CryptoKey does not support this operation, its ${prop} must be ${name}`);\n}\nfunction isAlgorithm(algorithm, name) {\n    return algorithm.name === name;\n}\nfunction getHashLength(hash) {\n    return parseInt(hash.name.slice(4), 10);\n}\nfunction getNamedCurve(alg) {\n    switch (alg) {\n        case 'ES256':\n            return 'P-256';\n        case 'ES384':\n            return 'P-384';\n        case 'ES512':\n            return 'P-521';\n        default:\n            throw new Error('unreachable');\n    }\n}\nfunction checkUsage(key, usage) {\n    if (usage && !key.usages.includes(usage)) {\n        throw new TypeError(`CryptoKey does not support this operation, its usages must include ${usage}.`);\n    }\n}\nfunction checkSigCryptoKey(key, alg, usage) {\n    switch (alg) {\n        case 'HS256':\n        case 'HS384':\n        case 'HS512': {\n            if (!isAlgorithm(key.algorithm, 'HMAC'))\n                throw unusable('HMAC');\n            const expected = parseInt(alg.slice(2), 10);\n            const actual = getHashLength(key.algorithm.hash);\n            if (actual !== expected)\n                throw unusable(`SHA-${expected}`, 'algorithm.hash');\n            break;\n        }\n        case 'RS256':\n        case 'RS384':\n        case 'RS512': {\n            if (!isAlgorithm(key.algorithm, 'RSASSA-PKCS1-v1_5'))\n                throw unusable('RSASSA-PKCS1-v1_5');\n            const expected = parseInt(alg.slice(2), 10);\n            const actual = getHashLength(key.algorithm.hash);\n            if (actual !== expected)\n                throw unusable(`SHA-${expected}`, 'algorithm.hash');\n            break;\n        }\n        case 'PS256':\n        case 'PS384':\n        case 'PS512': {\n            if (!isAlgorithm(key.algorithm, 'RSA-PSS'))\n                throw unusable('RSA-PSS');\n            const expected = parseInt(alg.slice(2), 10);\n            const actual = getHashLength(key.algorithm.hash);\n            if (actual !== expected)\n                throw unusable(`SHA-${expected}`, 'algorithm.hash');\n            break;\n        }\n        case 'Ed25519':\n        case 'EdDSA': {\n            if (!isAlgorithm(key.algorithm, 'Ed25519'))\n                throw unusable('Ed25519');\n            break;\n        }\n        case 'ML-DSA-44':\n        case 'ML-DSA-65':\n        case 'ML-DSA-87': {\n            if (!isAlgorithm(key.algorithm, alg))\n                throw unusable(alg);\n            break;\n        }\n        case 'ES256':\n        case 'ES384':\n        case 'ES512': {\n            if (!isAlgorithm(key.algorithm, 'ECDSA'))\n                throw unusable('ECDSA');\n            const expected = getNamedCurve(alg);\n            const actual = key.algorithm.namedCurve;\n            if (actual !== expected)\n                throw unusable(expected, 'algorithm.namedCurve');\n            break;\n        }\n        default:\n            throw new TypeError('CryptoKey does not support this operation');\n    }\n    checkUsage(key, usage);\n}\nfunction checkEncCryptoKey(key, alg, usage) {\n    switch (alg) {\n        case 'A128GCM':\n        case 'A192GCM':\n        case 'A256GCM': {\n            if (!isAlgorithm(key.algorithm, 'AES-GCM'))\n                throw unusable('AES-GCM');\n            const expected = parseInt(alg.slice(1, 4), 10);\n            const actual = key.algorithm.length;\n            if (actual !== expected)\n                throw unusable(expected, 'algorithm.length');\n            break;\n        }\n        case 'A128KW':\n        case 'A192KW':\n        case 'A256KW': {\n            if (!isAlgorithm(key.algorithm, 'AES-KW'))\n                throw unusable('AES-KW');\n            const expected = parseInt(alg.slice(1, 4), 10);\n            const actual = key.algorithm.length;\n            if (actual !== expected)\n                throw unusable(expected, 'algorithm.length');\n            break;\n        }\n        case 'ECDH': {\n            switch (key.algorithm.name) {\n                case 'ECDH':\n                case 'X25519':\n                    break;\n                default:\n                    throw unusable('ECDH or X25519');\n            }\n            break;\n        }\n        case 'PBES2-HS256+A128KW':\n        case 'PBES2-HS384+A192KW':\n        case 'PBES2-HS512+A256KW':\n            if (!isAlgorithm(key.algorithm, 'PBKDF2'))\n                throw unusable('PBKDF2');\n            break;\n        case 'RSA-OAEP':\n        case 'RSA-OAEP-256':\n        case 'RSA-OAEP-384':\n        case 'RSA-OAEP-512': {\n            if (!isAlgorithm(key.algorithm, 'RSA-OAEP'))\n                throw unusable('RSA-OAEP');\n            const expected = parseInt(alg.slice(9), 10) || 1;\n            const actual = getHashLength(key.algorithm.hash);\n            if (actual !== expected)\n                throw unusable(`SHA-${expected}`, 'algorithm.hash');\n            break;\n        }\n        default:\n            throw new TypeError('CryptoKey does not support this operation');\n    }\n    checkUsage(key, usage);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL2NyeXB0b19rZXkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBQTtBQUNBLDJFQUEyRSxNQUFNLFVBQVUsS0FBSztBQUNoRztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrR0FBa0csTUFBTTtBQUN4RztBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQ0FBc0MsU0FBUztBQUMvQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxTQUFTO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLFNBQVM7QUFDL0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLHNDQUFzQyxTQUFTO0FBQy9DO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxub2RlX21vZHVsZXNcXGpvc2VcXGRpc3RcXHdlYmFwaVxcbGliXFxjcnlwdG9fa2V5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIHVudXNhYmxlKG5hbWUsIHByb3AgPSAnYWxnb3JpdGhtLm5hbWUnKSB7XG4gICAgcmV0dXJuIG5ldyBUeXBlRXJyb3IoYENyeXB0b0tleSBkb2VzIG5vdCBzdXBwb3J0IHRoaXMgb3BlcmF0aW9uLCBpdHMgJHtwcm9wfSBtdXN0IGJlICR7bmFtZX1gKTtcbn1cbmZ1bmN0aW9uIGlzQWxnb3JpdGhtKGFsZ29yaXRobSwgbmFtZSkge1xuICAgIHJldHVybiBhbGdvcml0aG0ubmFtZSA9PT0gbmFtZTtcbn1cbmZ1bmN0aW9uIGdldEhhc2hMZW5ndGgoaGFzaCkge1xuICAgIHJldHVybiBwYXJzZUludChoYXNoLm5hbWUuc2xpY2UoNCksIDEwKTtcbn1cbmZ1bmN0aW9uIGdldE5hbWVkQ3VydmUoYWxnKSB7XG4gICAgc3dpdGNoIChhbGcpIHtcbiAgICAgICAgY2FzZSAnRVMyNTYnOlxuICAgICAgICAgICAgcmV0dXJuICdQLTI1Nic7XG4gICAgICAgIGNhc2UgJ0VTMzg0JzpcbiAgICAgICAgICAgIHJldHVybiAnUC0zODQnO1xuICAgICAgICBjYXNlICdFUzUxMic6XG4gICAgICAgICAgICByZXR1cm4gJ1AtNTIxJztcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcigndW5yZWFjaGFibGUnKTtcbiAgICB9XG59XG5mdW5jdGlvbiBjaGVja1VzYWdlKGtleSwgdXNhZ2UpIHtcbiAgICBpZiAodXNhZ2UgJiYgIWtleS51c2FnZXMuaW5jbHVkZXModXNhZ2UpKSB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoYENyeXB0b0tleSBkb2VzIG5vdCBzdXBwb3J0IHRoaXMgb3BlcmF0aW9uLCBpdHMgdXNhZ2VzIG11c3QgaW5jbHVkZSAke3VzYWdlfS5gKTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gY2hlY2tTaWdDcnlwdG9LZXkoa2V5LCBhbGcsIHVzYWdlKSB7XG4gICAgc3dpdGNoIChhbGcpIHtcbiAgICAgICAgY2FzZSAnSFMyNTYnOlxuICAgICAgICBjYXNlICdIUzM4NCc6XG4gICAgICAgIGNhc2UgJ0hTNTEyJzoge1xuICAgICAgICAgICAgaWYgKCFpc0FsZ29yaXRobShrZXkuYWxnb3JpdGhtLCAnSE1BQycpKVxuICAgICAgICAgICAgICAgIHRocm93IHVudXNhYmxlKCdITUFDJyk7XG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZCA9IHBhcnNlSW50KGFsZy5zbGljZSgyKSwgMTApO1xuICAgICAgICAgICAgY29uc3QgYWN0dWFsID0gZ2V0SGFzaExlbmd0aChrZXkuYWxnb3JpdGhtLmhhc2gpO1xuICAgICAgICAgICAgaWYgKGFjdHVhbCAhPT0gZXhwZWN0ZWQpXG4gICAgICAgICAgICAgICAgdGhyb3cgdW51c2FibGUoYFNIQS0ke2V4cGVjdGVkfWAsICdhbGdvcml0aG0uaGFzaCcpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnUlMyNTYnOlxuICAgICAgICBjYXNlICdSUzM4NCc6XG4gICAgICAgIGNhc2UgJ1JTNTEyJzoge1xuICAgICAgICAgICAgaWYgKCFpc0FsZ29yaXRobShrZXkuYWxnb3JpdGhtLCAnUlNBU1NBLVBLQ1MxLXYxXzUnKSlcbiAgICAgICAgICAgICAgICB0aHJvdyB1bnVzYWJsZSgnUlNBU1NBLVBLQ1MxLXYxXzUnKTtcbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkID0gcGFyc2VJbnQoYWxnLnNsaWNlKDIpLCAxMCk7XG4gICAgICAgICAgICBjb25zdCBhY3R1YWwgPSBnZXRIYXNoTGVuZ3RoKGtleS5hbGdvcml0aG0uaGFzaCk7XG4gICAgICAgICAgICBpZiAoYWN0dWFsICE9PSBleHBlY3RlZClcbiAgICAgICAgICAgICAgICB0aHJvdyB1bnVzYWJsZShgU0hBLSR7ZXhwZWN0ZWR9YCwgJ2FsZ29yaXRobS5oYXNoJyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlICdQUzI1Nic6XG4gICAgICAgIGNhc2UgJ1BTMzg0JzpcbiAgICAgICAgY2FzZSAnUFM1MTInOiB7XG4gICAgICAgICAgICBpZiAoIWlzQWxnb3JpdGhtKGtleS5hbGdvcml0aG0sICdSU0EtUFNTJykpXG4gICAgICAgICAgICAgICAgdGhyb3cgdW51c2FibGUoJ1JTQS1QU1MnKTtcbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkID0gcGFyc2VJbnQoYWxnLnNsaWNlKDIpLCAxMCk7XG4gICAgICAgICAgICBjb25zdCBhY3R1YWwgPSBnZXRIYXNoTGVuZ3RoKGtleS5hbGdvcml0aG0uaGFzaCk7XG4gICAgICAgICAgICBpZiAoYWN0dWFsICE9PSBleHBlY3RlZClcbiAgICAgICAgICAgICAgICB0aHJvdyB1bnVzYWJsZShgU0hBLSR7ZXhwZWN0ZWR9YCwgJ2FsZ29yaXRobS5oYXNoJyk7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlICdFZDI1NTE5JzpcbiAgICAgICAgY2FzZSAnRWREU0EnOiB7XG4gICAgICAgICAgICBpZiAoIWlzQWxnb3JpdGhtKGtleS5hbGdvcml0aG0sICdFZDI1NTE5JykpXG4gICAgICAgICAgICAgICAgdGhyb3cgdW51c2FibGUoJ0VkMjU1MTknKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ01MLURTQS00NCc6XG4gICAgICAgIGNhc2UgJ01MLURTQS02NSc6XG4gICAgICAgIGNhc2UgJ01MLURTQS04Nyc6IHtcbiAgICAgICAgICAgIGlmICghaXNBbGdvcml0aG0oa2V5LmFsZ29yaXRobSwgYWxnKSlcbiAgICAgICAgICAgICAgICB0aHJvdyB1bnVzYWJsZShhbGcpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnRVMyNTYnOlxuICAgICAgICBjYXNlICdFUzM4NCc6XG4gICAgICAgIGNhc2UgJ0VTNTEyJzoge1xuICAgICAgICAgICAgaWYgKCFpc0FsZ29yaXRobShrZXkuYWxnb3JpdGhtLCAnRUNEU0EnKSlcbiAgICAgICAgICAgICAgICB0aHJvdyB1bnVzYWJsZSgnRUNEU0EnKTtcbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkID0gZ2V0TmFtZWRDdXJ2ZShhbGcpO1xuICAgICAgICAgICAgY29uc3QgYWN0dWFsID0ga2V5LmFsZ29yaXRobS5uYW1lZEN1cnZlO1xuICAgICAgICAgICAgaWYgKGFjdHVhbCAhPT0gZXhwZWN0ZWQpXG4gICAgICAgICAgICAgICAgdGhyb3cgdW51c2FibGUoZXhwZWN0ZWQsICdhbGdvcml0aG0ubmFtZWRDdXJ2ZScpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ0NyeXB0b0tleSBkb2VzIG5vdCBzdXBwb3J0IHRoaXMgb3BlcmF0aW9uJyk7XG4gICAgfVxuICAgIGNoZWNrVXNhZ2Uoa2V5LCB1c2FnZSk7XG59XG5leHBvcnQgZnVuY3Rpb24gY2hlY2tFbmNDcnlwdG9LZXkoa2V5LCBhbGcsIHVzYWdlKSB7XG4gICAgc3dpdGNoIChhbGcpIHtcbiAgICAgICAgY2FzZSAnQTEyOEdDTSc6XG4gICAgICAgIGNhc2UgJ0ExOTJHQ00nOlxuICAgICAgICBjYXNlICdBMjU2R0NNJzoge1xuICAgICAgICAgICAgaWYgKCFpc0FsZ29yaXRobShrZXkuYWxnb3JpdGhtLCAnQUVTLUdDTScpKVxuICAgICAgICAgICAgICAgIHRocm93IHVudXNhYmxlKCdBRVMtR0NNJyk7XG4gICAgICAgICAgICBjb25zdCBleHBlY3RlZCA9IHBhcnNlSW50KGFsZy5zbGljZSgxLCA0KSwgMTApO1xuICAgICAgICAgICAgY29uc3QgYWN0dWFsID0ga2V5LmFsZ29yaXRobS5sZW5ndGg7XG4gICAgICAgICAgICBpZiAoYWN0dWFsICE9PSBleHBlY3RlZClcbiAgICAgICAgICAgICAgICB0aHJvdyB1bnVzYWJsZShleHBlY3RlZCwgJ2FsZ29yaXRobS5sZW5ndGgnKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ0ExMjhLVyc6XG4gICAgICAgIGNhc2UgJ0ExOTJLVyc6XG4gICAgICAgIGNhc2UgJ0EyNTZLVyc6IHtcbiAgICAgICAgICAgIGlmICghaXNBbGdvcml0aG0oa2V5LmFsZ29yaXRobSwgJ0FFUy1LVycpKVxuICAgICAgICAgICAgICAgIHRocm93IHVudXNhYmxlKCdBRVMtS1cnKTtcbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkID0gcGFyc2VJbnQoYWxnLnNsaWNlKDEsIDQpLCAxMCk7XG4gICAgICAgICAgICBjb25zdCBhY3R1YWwgPSBrZXkuYWxnb3JpdGhtLmxlbmd0aDtcbiAgICAgICAgICAgIGlmIChhY3R1YWwgIT09IGV4cGVjdGVkKVxuICAgICAgICAgICAgICAgIHRocm93IHVudXNhYmxlKGV4cGVjdGVkLCAnYWxnb3JpdGhtLmxlbmd0aCcpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnRUNESCc6IHtcbiAgICAgICAgICAgIHN3aXRjaCAoa2V5LmFsZ29yaXRobS5uYW1lKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnRUNESCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnWDI1NTE5JzpcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgdW51c2FibGUoJ0VDREggb3IgWDI1NTE5Jyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlICdQQkVTMi1IUzI1NitBMTI4S1cnOlxuICAgICAgICBjYXNlICdQQkVTMi1IUzM4NCtBMTkyS1cnOlxuICAgICAgICBjYXNlICdQQkVTMi1IUzUxMitBMjU2S1cnOlxuICAgICAgICAgICAgaWYgKCFpc0FsZ29yaXRobShrZXkuYWxnb3JpdGhtLCAnUEJLREYyJykpXG4gICAgICAgICAgICAgICAgdGhyb3cgdW51c2FibGUoJ1BCS0RGMicpO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGNhc2UgJ1JTQS1PQUVQJzpcbiAgICAgICAgY2FzZSAnUlNBLU9BRVAtMjU2JzpcbiAgICAgICAgY2FzZSAnUlNBLU9BRVAtMzg0JzpcbiAgICAgICAgY2FzZSAnUlNBLU9BRVAtNTEyJzoge1xuICAgICAgICAgICAgaWYgKCFpc0FsZ29yaXRobShrZXkuYWxnb3JpdGhtLCAnUlNBLU9BRVAnKSlcbiAgICAgICAgICAgICAgICB0aHJvdyB1bnVzYWJsZSgnUlNBLU9BRVAnKTtcbiAgICAgICAgICAgIGNvbnN0IGV4cGVjdGVkID0gcGFyc2VJbnQoYWxnLnNsaWNlKDkpLCAxMCkgfHwgMTtcbiAgICAgICAgICAgIGNvbnN0IGFjdHVhbCA9IGdldEhhc2hMZW5ndGgoa2V5LmFsZ29yaXRobS5oYXNoKTtcbiAgICAgICAgICAgIGlmIChhY3R1YWwgIT09IGV4cGVjdGVkKVxuICAgICAgICAgICAgICAgIHRocm93IHVudXNhYmxlKGBTSEEtJHtleHBlY3RlZH1gLCAnYWxnb3JpdGhtLmhhc2gnKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdDcnlwdG9LZXkgZG9lcyBub3Qgc3VwcG9ydCB0aGlzIG9wZXJhdGlvbicpO1xuICAgIH1cbiAgICBjaGVja1VzYWdlKGtleSwgdXNhZ2UpO1xufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/crypto_key.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/epoch.js":
/*!*****************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/epoch.js ***!
  \*****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((date) => Math.floor(date.getTime() / 1000));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL2Vwb2NoLmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQSxpRUFBZSwyQ0FBMkMsRUFBQyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcbm9kZV9tb2R1bGVzXFxqb3NlXFxkaXN0XFx3ZWJhcGlcXGxpYlxcZXBvY2guanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgKGRhdGUpID0+IE1hdGguZmxvb3IoZGF0ZS5nZXRUaW1lKCkgLyAxMDAwKTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/epoch.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/get_sign_verify_key.js":
/*!*******************************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/get_sign_verify_key.js ***!
  \*******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _crypto_key_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./crypto_key.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/crypto_key.js\");\n/* harmony import */ var _invalid_key_input_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./invalid_key_input.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/invalid_key_input.js\");\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (async (alg, key, usage) => {\n    if (key instanceof Uint8Array) {\n        if (!alg.startsWith('HS')) {\n            throw new TypeError((0,_invalid_key_input_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(key, 'CryptoKey', 'KeyObject', 'JSON Web Key'));\n        }\n        return crypto.subtle.importKey('raw', key, { hash: `SHA-${alg.slice(-3)}`, name: 'HMAC' }, false, [usage]);\n    }\n    (0,_crypto_key_js__WEBPACK_IMPORTED_MODULE_1__.checkSigCryptoKey)(key, alg, usage);\n    return key;\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL2dldF9zaWduX3ZlcmlmeV9rZXkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQW9EO0FBQ0M7QUFDckQsaUVBQWU7QUFDZjtBQUNBO0FBQ0EsZ0NBQWdDLGlFQUFlO0FBQy9DO0FBQ0EscURBQXFELGFBQWEsY0FBYyxpQkFBaUI7QUFDakc7QUFDQSxJQUFJLGlFQUFpQjtBQUNyQjtBQUNBLENBQUMsRUFBQyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcbm9kZV9tb2R1bGVzXFxqb3NlXFxkaXN0XFx3ZWJhcGlcXGxpYlxcZ2V0X3NpZ25fdmVyaWZ5X2tleS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjaGVja1NpZ0NyeXB0b0tleSB9IGZyb20gJy4vY3J5cHRvX2tleS5qcyc7XG5pbXBvcnQgaW52YWxpZEtleUlucHV0IGZyb20gJy4vaW52YWxpZF9rZXlfaW5wdXQuanMnO1xuZXhwb3J0IGRlZmF1bHQgYXN5bmMgKGFsZywga2V5LCB1c2FnZSkgPT4ge1xuICAgIGlmIChrZXkgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XG4gICAgICAgIGlmICghYWxnLnN0YXJ0c1dpdGgoJ0hTJykpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoaW52YWxpZEtleUlucHV0KGtleSwgJ0NyeXB0b0tleScsICdLZXlPYmplY3QnLCAnSlNPTiBXZWIgS2V5JykpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBjcnlwdG8uc3VidGxlLmltcG9ydEtleSgncmF3Jywga2V5LCB7IGhhc2g6IGBTSEEtJHthbGcuc2xpY2UoLTMpfWAsIG5hbWU6ICdITUFDJyB9LCBmYWxzZSwgW3VzYWdlXSk7XG4gICAgfVxuICAgIGNoZWNrU2lnQ3J5cHRvS2V5KGtleSwgYWxnLCB1c2FnZSk7XG4gICAgcmV0dXJuIGtleTtcbn07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/get_sign_verify_key.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/invalid_key_input.js":
/*!*****************************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/invalid_key_input.js ***!
  \*****************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   withAlg: () => (/* binding */ withAlg)\n/* harmony export */ });\nfunction message(msg, actual, ...types) {\n    types = types.filter(Boolean);\n    if (types.length > 2) {\n        const last = types.pop();\n        msg += `one of type ${types.join(', ')}, or ${last}.`;\n    }\n    else if (types.length === 2) {\n        msg += `one of type ${types[0]} or ${types[1]}.`;\n    }\n    else {\n        msg += `of type ${types[0]}.`;\n    }\n    if (actual == null) {\n        msg += ` Received ${actual}`;\n    }\n    else if (typeof actual === 'function' && actual.name) {\n        msg += ` Received function ${actual.name}`;\n    }\n    else if (typeof actual === 'object' && actual != null) {\n        if (actual.constructor?.name) {\n            msg += ` Received an instance of ${actual.constructor.name}`;\n        }\n    }\n    return msg;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((actual, ...types) => {\n    return message('Key must be ', actual, ...types);\n});\nfunction withAlg(alg, actual, ...types) {\n    return message(`Key for the ${alg} algorithm must be `, actual, ...types);\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL2ludmFsaWRfa2V5X2lucHV0LmpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQSw4QkFBOEIsaUJBQWlCLE9BQU8sS0FBSztBQUMzRDtBQUNBO0FBQ0EsOEJBQThCLFVBQVUsS0FBSyxTQUFTO0FBQ3REO0FBQ0E7QUFDQSwwQkFBMEIsU0FBUztBQUNuQztBQUNBO0FBQ0EsNEJBQTRCLE9BQU87QUFDbkM7QUFDQTtBQUNBLHFDQUFxQyxZQUFZO0FBQ2pEO0FBQ0E7QUFDQTtBQUNBLCtDQUErQyx3QkFBd0I7QUFDdkU7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBZTtBQUNmO0FBQ0EsQ0FBQyxFQUFDO0FBQ0s7QUFDUCxrQ0FBa0MsS0FBSztBQUN2QyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcbm9kZV9tb2R1bGVzXFxqb3NlXFxkaXN0XFx3ZWJhcGlcXGxpYlxcaW52YWxpZF9rZXlfaW5wdXQuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gbWVzc2FnZShtc2csIGFjdHVhbCwgLi4udHlwZXMpIHtcbiAgICB0eXBlcyA9IHR5cGVzLmZpbHRlcihCb29sZWFuKTtcbiAgICBpZiAodHlwZXMubGVuZ3RoID4gMikge1xuICAgICAgICBjb25zdCBsYXN0ID0gdHlwZXMucG9wKCk7XG4gICAgICAgIG1zZyArPSBgb25lIG9mIHR5cGUgJHt0eXBlcy5qb2luKCcsICcpfSwgb3IgJHtsYXN0fS5gO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlcy5sZW5ndGggPT09IDIpIHtcbiAgICAgICAgbXNnICs9IGBvbmUgb2YgdHlwZSAke3R5cGVzWzBdfSBvciAke3R5cGVzWzFdfS5gO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgbXNnICs9IGBvZiB0eXBlICR7dHlwZXNbMF19LmA7XG4gICAgfVxuICAgIGlmIChhY3R1YWwgPT0gbnVsbCkge1xuICAgICAgICBtc2cgKz0gYCBSZWNlaXZlZCAke2FjdHVhbH1gO1xuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgYWN0dWFsID09PSAnZnVuY3Rpb24nICYmIGFjdHVhbC5uYW1lKSB7XG4gICAgICAgIG1zZyArPSBgIFJlY2VpdmVkIGZ1bmN0aW9uICR7YWN0dWFsLm5hbWV9YDtcbiAgICB9XG4gICAgZWxzZSBpZiAodHlwZW9mIGFjdHVhbCA9PT0gJ29iamVjdCcgJiYgYWN0dWFsICE9IG51bGwpIHtcbiAgICAgICAgaWYgKGFjdHVhbC5jb25zdHJ1Y3Rvcj8ubmFtZSkge1xuICAgICAgICAgICAgbXNnICs9IGAgUmVjZWl2ZWQgYW4gaW5zdGFuY2Ugb2YgJHthY3R1YWwuY29uc3RydWN0b3IubmFtZX1gO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBtc2c7XG59XG5leHBvcnQgZGVmYXVsdCAoYWN0dWFsLCAuLi50eXBlcykgPT4ge1xuICAgIHJldHVybiBtZXNzYWdlKCdLZXkgbXVzdCBiZSAnLCBhY3R1YWwsIC4uLnR5cGVzKTtcbn07XG5leHBvcnQgZnVuY3Rpb24gd2l0aEFsZyhhbGcsIGFjdHVhbCwgLi4udHlwZXMpIHtcbiAgICByZXR1cm4gbWVzc2FnZShgS2V5IGZvciB0aGUgJHthbGd9IGFsZ29yaXRobSBtdXN0IGJlIGAsIGFjdHVhbCwgLi4udHlwZXMpO1xufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/invalid_key_input.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_disjoint.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_disjoint.js ***!
  \***********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((...headers) => {\n    const sources = headers.filter(Boolean);\n    if (sources.length === 0 || sources.length === 1) {\n        return true;\n    }\n    let acc;\n    for (const header of sources) {\n        const parameters = Object.keys(header);\n        if (!acc || acc.size === 0) {\n            acc = new Set(parameters);\n            continue;\n        }\n        for (const parameter of parameters) {\n            if (acc.has(parameter)) {\n                return false;\n            }\n            acc.add(parameter);\n        }\n    }\n    return true;\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL2lzX2Rpc2pvaW50LmpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQSxpRUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxFQUFDIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxub2RlX21vZHVsZXNcXGpvc2VcXGRpc3RcXHdlYmFwaVxcbGliXFxpc19kaXNqb2ludC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgZGVmYXVsdCAoLi4uaGVhZGVycykgPT4ge1xuICAgIGNvbnN0IHNvdXJjZXMgPSBoZWFkZXJzLmZpbHRlcihCb29sZWFuKTtcbiAgICBpZiAoc291cmNlcy5sZW5ndGggPT09IDAgfHwgc291cmNlcy5sZW5ndGggPT09IDEpIHtcbiAgICAgICAgcmV0dXJuIHRydWU7XG4gICAgfVxuICAgIGxldCBhY2M7XG4gICAgZm9yIChjb25zdCBoZWFkZXIgb2Ygc291cmNlcykge1xuICAgICAgICBjb25zdCBwYXJhbWV0ZXJzID0gT2JqZWN0LmtleXMoaGVhZGVyKTtcbiAgICAgICAgaWYgKCFhY2MgfHwgYWNjLnNpemUgPT09IDApIHtcbiAgICAgICAgICAgIGFjYyA9IG5ldyBTZXQocGFyYW1ldGVycyk7XG4gICAgICAgICAgICBjb250aW51ZTtcbiAgICAgICAgfVxuICAgICAgICBmb3IgKGNvbnN0IHBhcmFtZXRlciBvZiBwYXJhbWV0ZXJzKSB7XG4gICAgICAgICAgICBpZiAoYWNjLmhhcyhwYXJhbWV0ZXIpKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWNjLmFkZChwYXJhbWV0ZXIpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiB0cnVlO1xufTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_disjoint.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_jwk.js":
/*!******************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_jwk.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   isJWK: () => (/* binding */ isJWK),\n/* harmony export */   isPrivateJWK: () => (/* binding */ isPrivateJWK),\n/* harmony export */   isPublicJWK: () => (/* binding */ isPublicJWK),\n/* harmony export */   isSecretJWK: () => (/* binding */ isSecretJWK)\n/* harmony export */ });\n/* harmony import */ var _is_object_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./is_object.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_object.js\");\n\nfunction isJWK(key) {\n    return (0,_is_object_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(key) && typeof key.kty === 'string';\n}\nfunction isPrivateJWK(key) {\n    return (key.kty !== 'oct' &&\n        ((key.kty === 'AKP' && typeof key.priv === 'string') || typeof key.d === 'string'));\n}\nfunction isPublicJWK(key) {\n    return key.kty !== 'oct' && typeof key.d === 'undefined' && typeof key.priv === 'undefined';\n}\nfunction isSecretJWK(key) {\n    return key.kty === 'oct' && typeof key.k === 'string';\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL2lzX2p3ay5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFzQztBQUMvQjtBQUNQLFdBQVcseURBQVE7QUFDbkI7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNPO0FBQ1A7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcbm9kZV9tb2R1bGVzXFxqb3NlXFxkaXN0XFx3ZWJhcGlcXGxpYlxcaXNfandrLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBpc09iamVjdCBmcm9tICcuL2lzX29iamVjdC5qcyc7XG5leHBvcnQgZnVuY3Rpb24gaXNKV0soa2V5KSB7XG4gICAgcmV0dXJuIGlzT2JqZWN0KGtleSkgJiYgdHlwZW9mIGtleS5rdHkgPT09ICdzdHJpbmcnO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGlzUHJpdmF0ZUpXSyhrZXkpIHtcbiAgICByZXR1cm4gKGtleS5rdHkgIT09ICdvY3QnICYmXG4gICAgICAgICgoa2V5Lmt0eSA9PT0gJ0FLUCcgJiYgdHlwZW9mIGtleS5wcml2ID09PSAnc3RyaW5nJykgfHwgdHlwZW9mIGtleS5kID09PSAnc3RyaW5nJykpO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGlzUHVibGljSldLKGtleSkge1xuICAgIHJldHVybiBrZXkua3R5ICE9PSAnb2N0JyAmJiB0eXBlb2Yga2V5LmQgPT09ICd1bmRlZmluZWQnICYmIHR5cGVvZiBrZXkucHJpdiA9PT0gJ3VuZGVmaW5lZCc7XG59XG5leHBvcnQgZnVuY3Rpb24gaXNTZWNyZXRKV0soa2V5KSB7XG4gICAgcmV0dXJuIGtleS5rdHkgPT09ICdvY3QnICYmIHR5cGVvZiBrZXkuayA9PT0gJ3N0cmluZyc7XG59XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_jwk.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_key_like.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_key_like.js ***!
  \***********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   assertCryptoKey: () => (/* binding */ assertCryptoKey),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   isCryptoKey: () => (/* binding */ isCryptoKey),\n/* harmony export */   isKeyObject: () => (/* binding */ isKeyObject)\n/* harmony export */ });\nfunction assertCryptoKey(key) {\n    if (!isCryptoKey(key)) {\n        throw new Error('CryptoKey instance expected');\n    }\n}\nfunction isCryptoKey(key) {\n    return key?.[Symbol.toStringTag] === 'CryptoKey';\n}\nfunction isKeyObject(key) {\n    return key?.[Symbol.toStringTag] === 'KeyObject';\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((key) => {\n    return isCryptoKey(key) || isKeyObject(key);\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL2lzX2tleV9saWtlLmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFBTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0EsaUVBQWU7QUFDZjtBQUNBLENBQUMsRUFBQyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcbm9kZV9tb2R1bGVzXFxqb3NlXFxkaXN0XFx3ZWJhcGlcXGxpYlxcaXNfa2V5X2xpa2UuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGZ1bmN0aW9uIGFzc2VydENyeXB0b0tleShrZXkpIHtcbiAgICBpZiAoIWlzQ3J5cHRvS2V5KGtleSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDcnlwdG9LZXkgaW5zdGFuY2UgZXhwZWN0ZWQnKTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gaXNDcnlwdG9LZXkoa2V5KSB7XG4gICAgcmV0dXJuIGtleT8uW1N5bWJvbC50b1N0cmluZ1RhZ10gPT09ICdDcnlwdG9LZXknO1xufVxuZXhwb3J0IGZ1bmN0aW9uIGlzS2V5T2JqZWN0KGtleSkge1xuICAgIHJldHVybiBrZXk/LltTeW1ib2wudG9TdHJpbmdUYWddID09PSAnS2V5T2JqZWN0Jztcbn1cbmV4cG9ydCBkZWZhdWx0IChrZXkpID0+IHtcbiAgICByZXR1cm4gaXNDcnlwdG9LZXkoa2V5KSB8fCBpc0tleU9iamVjdChrZXkpO1xufTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_key_like.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_object.js":
/*!*********************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_object.js ***!
  \*********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nfunction isObjectLike(value) {\n    return typeof value === 'object' && value !== null;\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((input) => {\n    if (!isObjectLike(input) || Object.prototype.toString.call(input) !== '[object Object]') {\n        return false;\n    }\n    if (Object.getPrototypeOf(input) === null) {\n        return true;\n    }\n    let proto = input;\n    while (Object.getPrototypeOf(proto) !== null) {\n        proto = Object.getPrototypeOf(proto);\n    }\n    return Object.getPrototypeOf(input) === proto;\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL2lzX29iamVjdC5qcyIsIm1hcHBpbmdzIjoiOzs7O0FBQUE7QUFDQTtBQUNBO0FBQ0EsaUVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxFQUFDIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxub2RlX21vZHVsZXNcXGpvc2VcXGRpc3RcXHdlYmFwaVxcbGliXFxpc19vYmplY3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZnVuY3Rpb24gaXNPYmplY3RMaWtlKHZhbHVlKSB7XG4gICAgcmV0dXJuIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgIT09IG51bGw7XG59XG5leHBvcnQgZGVmYXVsdCAoaW5wdXQpID0+IHtcbiAgICBpZiAoIWlzT2JqZWN0TGlrZShpbnB1dCkgfHwgT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZy5jYWxsKGlucHV0KSAhPT0gJ1tvYmplY3QgT2JqZWN0XScpIHtcbiAgICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgICBpZiAoT2JqZWN0LmdldFByb3RvdHlwZU9mKGlucHV0KSA9PT0gbnVsbCkge1xuICAgICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9XG4gICAgbGV0IHByb3RvID0gaW5wdXQ7XG4gICAgd2hpbGUgKE9iamVjdC5nZXRQcm90b3R5cGVPZihwcm90bykgIT09IG51bGwpIHtcbiAgICAgICAgcHJvdG8gPSBPYmplY3QuZ2V0UHJvdG90eXBlT2YocHJvdG8pO1xuICAgIH1cbiAgICByZXR1cm4gT2JqZWN0LmdldFByb3RvdHlwZU9mKGlucHV0KSA9PT0gcHJvdG87XG59O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_object.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/jwk_to_key.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/jwk_to_key.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _util_errors_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../util/errors.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/errors.js\");\n\nfunction subtleMapping(jwk) {\n    let algorithm;\n    let keyUsages;\n    switch (jwk.kty) {\n        case 'AKP': {\n            switch (jwk.alg) {\n                case 'ML-DSA-44':\n                case 'ML-DSA-65':\n                case 'ML-DSA-87':\n                    algorithm = { name: jwk.alg };\n                    keyUsages = jwk.priv ? ['sign'] : ['verify'];\n                    break;\n                default:\n                    throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n            }\n            break;\n        }\n        case 'RSA': {\n            switch (jwk.alg) {\n                case 'PS256':\n                case 'PS384':\n                case 'PS512':\n                    algorithm = { name: 'RSA-PSS', hash: `SHA-${jwk.alg.slice(-3)}` };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'RS256':\n                case 'RS384':\n                case 'RS512':\n                    algorithm = { name: 'RSASSA-PKCS1-v1_5', hash: `SHA-${jwk.alg.slice(-3)}` };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'RSA-OAEP':\n                case 'RSA-OAEP-256':\n                case 'RSA-OAEP-384':\n                case 'RSA-OAEP-512':\n                    algorithm = {\n                        name: 'RSA-OAEP',\n                        hash: `SHA-${parseInt(jwk.alg.slice(-3), 10) || 1}`,\n                    };\n                    keyUsages = jwk.d ? ['decrypt', 'unwrapKey'] : ['encrypt', 'wrapKey'];\n                    break;\n                default:\n                    throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n            }\n            break;\n        }\n        case 'EC': {\n            switch (jwk.alg) {\n                case 'ES256':\n                    algorithm = { name: 'ECDSA', namedCurve: 'P-256' };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'ES384':\n                    algorithm = { name: 'ECDSA', namedCurve: 'P-384' };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'ES512':\n                    algorithm = { name: 'ECDSA', namedCurve: 'P-521' };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'ECDH-ES':\n                case 'ECDH-ES+A128KW':\n                case 'ECDH-ES+A192KW':\n                case 'ECDH-ES+A256KW':\n                    algorithm = { name: 'ECDH', namedCurve: jwk.crv };\n                    keyUsages = jwk.d ? ['deriveBits'] : [];\n                    break;\n                default:\n                    throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n            }\n            break;\n        }\n        case 'OKP': {\n            switch (jwk.alg) {\n                case 'Ed25519':\n                case 'EdDSA':\n                    algorithm = { name: 'Ed25519' };\n                    keyUsages = jwk.d ? ['sign'] : ['verify'];\n                    break;\n                case 'ECDH-ES':\n                case 'ECDH-ES+A128KW':\n                case 'ECDH-ES+A192KW':\n                case 'ECDH-ES+A256KW':\n                    algorithm = { name: jwk.crv };\n                    keyUsages = jwk.d ? ['deriveBits'] : [];\n                    break;\n                default:\n                    throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JOSENotSupported('Invalid or unsupported JWK \"alg\" (Algorithm) Parameter value');\n            }\n            break;\n        }\n        default:\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JOSENotSupported('Invalid or unsupported JWK \"kty\" (Key Type) Parameter value');\n    }\n    return { algorithm, keyUsages };\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (async (jwk) => {\n    if (!jwk.alg) {\n        throw new TypeError('\"alg\" argument is required when \"jwk.alg\" is not present');\n    }\n    const { algorithm, keyUsages } = subtleMapping(jwk);\n    const keyData = { ...jwk };\n    if (keyData.kty !== 'AKP') {\n        delete keyData.alg;\n    }\n    delete keyData.use;\n    return crypto.subtle.importKey('jwk', keyData, algorithm, jwk.ext ?? (jwk.d || jwk.priv ? false : true), jwk.key_ops ?? keyUsages);\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL2p3a190b19rZXkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBcUQ7QUFDckQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qiw2REFBZ0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQyw4QkFBOEIsa0JBQWtCO0FBQ2xGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0Msd0NBQXdDLGtCQUFrQjtBQUM1RjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EscUNBQXFDLHFDQUFxQztBQUMxRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qiw2REFBZ0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLGtDQUFrQztBQUNsQztBQUNBO0FBQ0E7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qiw2REFBZ0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0M7QUFDbEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0NBQWtDO0FBQ2xDO0FBQ0E7QUFDQTtBQUNBLDhCQUE4Qiw2REFBZ0I7QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IsNkRBQWdCO0FBQ3RDO0FBQ0EsYUFBYTtBQUNiO0FBQ0EsaUVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQSxZQUFZLHVCQUF1QjtBQUNuQyxzQkFBc0I7QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsRUFBQyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcbm9kZV9tb2R1bGVzXFxqb3NlXFxkaXN0XFx3ZWJhcGlcXGxpYlxcandrX3RvX2tleS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBKT1NFTm90U3VwcG9ydGVkIH0gZnJvbSAnLi4vdXRpbC9lcnJvcnMuanMnO1xuZnVuY3Rpb24gc3VidGxlTWFwcGluZyhqd2spIHtcbiAgICBsZXQgYWxnb3JpdGhtO1xuICAgIGxldCBrZXlVc2FnZXM7XG4gICAgc3dpdGNoIChqd2sua3R5KSB7XG4gICAgICAgIGNhc2UgJ0FLUCc6IHtcbiAgICAgICAgICAgIHN3aXRjaCAoandrLmFsZykge1xuICAgICAgICAgICAgICAgIGNhc2UgJ01MLURTQS00NCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnTUwtRFNBLTY1JzpcbiAgICAgICAgICAgICAgICBjYXNlICdNTC1EU0EtODcnOlxuICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG0gPSB7IG5hbWU6IGp3ay5hbGcgfTtcbiAgICAgICAgICAgICAgICAgICAga2V5VXNhZ2VzID0gandrLnByaXYgPyBbJ3NpZ24nXSA6IFsndmVyaWZ5J107XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgICAgIHRocm93IG5ldyBKT1NFTm90U3VwcG9ydGVkKCdJbnZhbGlkIG9yIHVuc3VwcG9ydGVkIEpXSyBcImFsZ1wiIChBbGdvcml0aG0pIFBhcmFtZXRlciB2YWx1ZScpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIH1cbiAgICAgICAgY2FzZSAnUlNBJzoge1xuICAgICAgICAgICAgc3dpdGNoIChqd2suYWxnKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnUFMyNTYnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ1BTMzg0JzpcbiAgICAgICAgICAgICAgICBjYXNlICdQUzUxMic6XG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobSA9IHsgbmFtZTogJ1JTQS1QU1MnLCBoYXNoOiBgU0hBLSR7andrLmFsZy5zbGljZSgtMyl9YCB9O1xuICAgICAgICAgICAgICAgICAgICBrZXlVc2FnZXMgPSBqd2suZCA/IFsnc2lnbiddIDogWyd2ZXJpZnknXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnUlMyNTYnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ1JTMzg0JzpcbiAgICAgICAgICAgICAgICBjYXNlICdSUzUxMic6XG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobSA9IHsgbmFtZTogJ1JTQVNTQS1QS0NTMS12MV81JywgaGFzaDogYFNIQS0ke2p3ay5hbGcuc2xpY2UoLTMpfWAgfTtcbiAgICAgICAgICAgICAgICAgICAga2V5VXNhZ2VzID0gandrLmQgPyBbJ3NpZ24nXSA6IFsndmVyaWZ5J107XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ1JTQS1PQUVQJzpcbiAgICAgICAgICAgICAgICBjYXNlICdSU0EtT0FFUC0yNTYnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ1JTQS1PQUVQLTM4NCc6XG4gICAgICAgICAgICAgICAgY2FzZSAnUlNBLU9BRVAtNTEyJzpcbiAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtID0ge1xuICAgICAgICAgICAgICAgICAgICAgICAgbmFtZTogJ1JTQS1PQUVQJyxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhhc2g6IGBTSEEtJHtwYXJzZUludChqd2suYWxnLnNsaWNlKC0zKSwgMTApIHx8IDF9YCxcbiAgICAgICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgICAgICAgICAga2V5VXNhZ2VzID0gandrLmQgPyBbJ2RlY3J5cHQnLCAndW53cmFwS2V5J10gOiBbJ2VuY3J5cHQnLCAnd3JhcEtleSddO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgICAgICAgICB0aHJvdyBuZXcgSk9TRU5vdFN1cHBvcnRlZCgnSW52YWxpZCBvciB1bnN1cHBvcnRlZCBKV0sgXCJhbGdcIiAoQWxnb3JpdGhtKSBQYXJhbWV0ZXIgdmFsdWUnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICB9XG4gICAgICAgIGNhc2UgJ0VDJzoge1xuICAgICAgICAgICAgc3dpdGNoIChqd2suYWxnKSB7XG4gICAgICAgICAgICAgICAgY2FzZSAnRVMyNTYnOlxuICAgICAgICAgICAgICAgICAgICBhbGdvcml0aG0gPSB7IG5hbWU6ICdFQ0RTQScsIG5hbWVkQ3VydmU6ICdQLTI1NicgfTtcbiAgICAgICAgICAgICAgICAgICAga2V5VXNhZ2VzID0gandrLmQgPyBbJ3NpZ24nXSA6IFsndmVyaWZ5J107XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ0VTMzg0JzpcbiAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtID0geyBuYW1lOiAnRUNEU0EnLCBuYW1lZEN1cnZlOiAnUC0zODQnIH07XG4gICAgICAgICAgICAgICAgICAgIGtleVVzYWdlcyA9IGp3ay5kID8gWydzaWduJ10gOiBbJ3ZlcmlmeSddO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdFUzUxMic6XG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobSA9IHsgbmFtZTogJ0VDRFNBJywgbmFtZWRDdXJ2ZTogJ1AtNTIxJyB9O1xuICAgICAgICAgICAgICAgICAgICBrZXlVc2FnZXMgPSBqd2suZCA/IFsnc2lnbiddIDogWyd2ZXJpZnknXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnRUNESC1FUyc6XG4gICAgICAgICAgICAgICAgY2FzZSAnRUNESC1FUytBMTI4S1cnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ0VDREgtRVMrQTE5MktXJzpcbiAgICAgICAgICAgICAgICBjYXNlICdFQ0RILUVTK0EyNTZLVyc6XG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobSA9IHsgbmFtZTogJ0VDREgnLCBuYW1lZEN1cnZlOiBqd2suY3J2IH07XG4gICAgICAgICAgICAgICAgICAgIGtleVVzYWdlcyA9IGp3ay5kID8gWydkZXJpdmVCaXRzJ10gOiBbXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEpPU0VOb3RTdXBwb3J0ZWQoJ0ludmFsaWQgb3IgdW5zdXBwb3J0ZWQgSldLIFwiYWxnXCIgKEFsZ29yaXRobSkgUGFyYW1ldGVyIHZhbHVlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBjYXNlICdPS1AnOiB7XG4gICAgICAgICAgICBzd2l0Y2ggKGp3ay5hbGcpIHtcbiAgICAgICAgICAgICAgICBjYXNlICdFZDI1NTE5JzpcbiAgICAgICAgICAgICAgICBjYXNlICdFZERTQSc6XG4gICAgICAgICAgICAgICAgICAgIGFsZ29yaXRobSA9IHsgbmFtZTogJ0VkMjU1MTknIH07XG4gICAgICAgICAgICAgICAgICAgIGtleVVzYWdlcyA9IGp3ay5kID8gWydzaWduJ10gOiBbJ3ZlcmlmeSddO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdFQ0RILUVTJzpcbiAgICAgICAgICAgICAgICBjYXNlICdFQ0RILUVTK0ExMjhLVyc6XG4gICAgICAgICAgICAgICAgY2FzZSAnRUNESC1FUytBMTkyS1cnOlxuICAgICAgICAgICAgICAgIGNhc2UgJ0VDREgtRVMrQTI1NktXJzpcbiAgICAgICAgICAgICAgICAgICAgYWxnb3JpdGhtID0geyBuYW1lOiBqd2suY3J2IH07XG4gICAgICAgICAgICAgICAgICAgIGtleVVzYWdlcyA9IGp3ay5kID8gWydkZXJpdmVCaXRzJ10gOiBbXTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgICAgICAgICAgdGhyb3cgbmV3IEpPU0VOb3RTdXBwb3J0ZWQoJ0ludmFsaWQgb3IgdW5zdXBwb3J0ZWQgSldLIFwiYWxnXCIgKEFsZ29yaXRobSkgUGFyYW1ldGVyIHZhbHVlJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgfVxuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdGhyb3cgbmV3IEpPU0VOb3RTdXBwb3J0ZWQoJ0ludmFsaWQgb3IgdW5zdXBwb3J0ZWQgSldLIFwia3R5XCIgKEtleSBUeXBlKSBQYXJhbWV0ZXIgdmFsdWUnKTtcbiAgICB9XG4gICAgcmV0dXJuIHsgYWxnb3JpdGhtLCBrZXlVc2FnZXMgfTtcbn1cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIChqd2spID0+IHtcbiAgICBpZiAoIWp3ay5hbGcpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignXCJhbGdcIiBhcmd1bWVudCBpcyByZXF1aXJlZCB3aGVuIFwiandrLmFsZ1wiIGlzIG5vdCBwcmVzZW50Jyk7XG4gICAgfVxuICAgIGNvbnN0IHsgYWxnb3JpdGhtLCBrZXlVc2FnZXMgfSA9IHN1YnRsZU1hcHBpbmcoandrKTtcbiAgICBjb25zdCBrZXlEYXRhID0geyAuLi5qd2sgfTtcbiAgICBpZiAoa2V5RGF0YS5rdHkgIT09ICdBS1AnKSB7XG4gICAgICAgIGRlbGV0ZSBrZXlEYXRhLmFsZztcbiAgICB9XG4gICAgZGVsZXRlIGtleURhdGEudXNlO1xuICAgIHJldHVybiBjcnlwdG8uc3VidGxlLmltcG9ydEtleSgnandrJywga2V5RGF0YSwgYWxnb3JpdGhtLCBqd2suZXh0ID8/IChqd2suZCB8fCBqd2sucHJpdiA/IGZhbHNlIDogdHJ1ZSksIGp3ay5rZXlfb3BzID8/IGtleVVzYWdlcyk7XG59O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/jwk_to_key.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/jwt_claims_set.js":
/*!**************************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/jwt_claims_set.js ***!
  \**************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   JWTClaimsBuilder: () => (/* binding */ JWTClaimsBuilder),\n/* harmony export */   validateClaimsSet: () => (/* binding */ validateClaimsSet)\n/* harmony export */ });\n/* harmony import */ var _util_errors_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../util/errors.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/errors.js\");\n/* harmony import */ var _buffer_utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./buffer_utils.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/buffer_utils.js\");\n/* harmony import */ var _epoch_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./epoch.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/epoch.js\");\n/* harmony import */ var _secs_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./secs.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/secs.js\");\n/* harmony import */ var _is_object_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./is_object.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_object.js\");\n\n\n\n\n\n\nfunction validateInput(label, input) {\n    if (!Number.isFinite(input)) {\n        throw new TypeError(`Invalid ${label} input`);\n    }\n    return input;\n}\nconst normalizeTyp = (value) => {\n    if (value.includes('/')) {\n        return value.toLowerCase();\n    }\n    return `application/${value.toLowerCase()}`;\n};\nconst checkAudiencePresence = (audPayload, audOption) => {\n    if (typeof audPayload === 'string') {\n        return audOption.includes(audPayload);\n    }\n    if (Array.isArray(audPayload)) {\n        return audOption.some(Set.prototype.has.bind(new Set(audPayload)));\n    }\n    return false;\n};\nfunction validateClaimsSet(protectedHeader, encodedPayload, options = {}) {\n    let payload;\n    try {\n        payload = JSON.parse(_buffer_utils_js__WEBPACK_IMPORTED_MODULE_0__.decoder.decode(encodedPayload));\n    }\n    catch {\n    }\n    if (!(0,_is_object_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(payload)) {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_2__.JWTInvalid('JWT Claims Set must be a top-level JSON object');\n    }\n    const { typ } = options;\n    if (typ &&\n        (typeof protectedHeader.typ !== 'string' ||\n            normalizeTyp(protectedHeader.typ) !== normalizeTyp(typ))) {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_2__.JWTClaimValidationFailed('unexpected \"typ\" JWT header value', payload, 'typ', 'check_failed');\n    }\n    const { requiredClaims = [], issuer, subject, audience, maxTokenAge } = options;\n    const presenceCheck = [...requiredClaims];\n    if (maxTokenAge !== undefined)\n        presenceCheck.push('iat');\n    if (audience !== undefined)\n        presenceCheck.push('aud');\n    if (subject !== undefined)\n        presenceCheck.push('sub');\n    if (issuer !== undefined)\n        presenceCheck.push('iss');\n    for (const claim of new Set(presenceCheck.reverse())) {\n        if (!(claim in payload)) {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_2__.JWTClaimValidationFailed(`missing required \"${claim}\" claim`, payload, claim, 'missing');\n        }\n    }\n    if (issuer &&\n        !(Array.isArray(issuer) ? issuer : [issuer]).includes(payload.iss)) {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_2__.JWTClaimValidationFailed('unexpected \"iss\" claim value', payload, 'iss', 'check_failed');\n    }\n    if (subject && payload.sub !== subject) {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_2__.JWTClaimValidationFailed('unexpected \"sub\" claim value', payload, 'sub', 'check_failed');\n    }\n    if (audience &&\n        !checkAudiencePresence(payload.aud, typeof audience === 'string' ? [audience] : audience)) {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_2__.JWTClaimValidationFailed('unexpected \"aud\" claim value', payload, 'aud', 'check_failed');\n    }\n    let tolerance;\n    switch (typeof options.clockTolerance) {\n        case 'string':\n            tolerance = (0,_secs_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(options.clockTolerance);\n            break;\n        case 'number':\n            tolerance = options.clockTolerance;\n            break;\n        case 'undefined':\n            tolerance = 0;\n            break;\n        default:\n            throw new TypeError('Invalid clockTolerance option type');\n    }\n    const { currentDate } = options;\n    const now = (0,_epoch_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(currentDate || new Date());\n    if ((payload.iat !== undefined || maxTokenAge) && typeof payload.iat !== 'number') {\n        throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_2__.JWTClaimValidationFailed('\"iat\" claim must be a number', payload, 'iat', 'invalid');\n    }\n    if (payload.nbf !== undefined) {\n        if (typeof payload.nbf !== 'number') {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_2__.JWTClaimValidationFailed('\"nbf\" claim must be a number', payload, 'nbf', 'invalid');\n        }\n        if (payload.nbf > now + tolerance) {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_2__.JWTClaimValidationFailed('\"nbf\" claim timestamp check failed', payload, 'nbf', 'check_failed');\n        }\n    }\n    if (payload.exp !== undefined) {\n        if (typeof payload.exp !== 'number') {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_2__.JWTClaimValidationFailed('\"exp\" claim must be a number', payload, 'exp', 'invalid');\n        }\n        if (payload.exp <= now - tolerance) {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_2__.JWTExpired('\"exp\" claim timestamp check failed', payload, 'exp', 'check_failed');\n        }\n    }\n    if (maxTokenAge) {\n        const age = now - payload.iat;\n        const max = typeof maxTokenAge === 'number' ? maxTokenAge : (0,_secs_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(maxTokenAge);\n        if (age - tolerance > max) {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_2__.JWTExpired('\"iat\" claim timestamp check failed (too far in the past)', payload, 'iat', 'check_failed');\n        }\n        if (age < 0 - tolerance) {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_2__.JWTClaimValidationFailed('\"iat\" claim timestamp check failed (it should be in the past)', payload, 'iat', 'check_failed');\n        }\n    }\n    return payload;\n}\nclass JWTClaimsBuilder {\n    #payload;\n    constructor(payload) {\n        if (!(0,_is_object_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(payload)) {\n            throw new TypeError('JWT Claims Set MUST be an object');\n        }\n        this.#payload = structuredClone(payload);\n    }\n    data() {\n        return _buffer_utils_js__WEBPACK_IMPORTED_MODULE_0__.encoder.encode(JSON.stringify(this.#payload));\n    }\n    get iss() {\n        return this.#payload.iss;\n    }\n    set iss(value) {\n        this.#payload.iss = value;\n    }\n    get sub() {\n        return this.#payload.sub;\n    }\n    set sub(value) {\n        this.#payload.sub = value;\n    }\n    get aud() {\n        return this.#payload.aud;\n    }\n    set aud(value) {\n        this.#payload.aud = value;\n    }\n    set jti(value) {\n        this.#payload.jti = value;\n    }\n    set nbf(value) {\n        if (typeof value === 'number') {\n            this.#payload.nbf = validateInput('setNotBefore', value);\n        }\n        else if (value instanceof Date) {\n            this.#payload.nbf = validateInput('setNotBefore', (0,_epoch_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(value));\n        }\n        else {\n            this.#payload.nbf = (0,_epoch_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(new Date()) + (0,_secs_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(value);\n        }\n    }\n    set exp(value) {\n        if (typeof value === 'number') {\n            this.#payload.exp = validateInput('setExpirationTime', value);\n        }\n        else if (value instanceof Date) {\n            this.#payload.exp = validateInput('setExpirationTime', (0,_epoch_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(value));\n        }\n        else {\n            this.#payload.exp = (0,_epoch_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(new Date()) + (0,_secs_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(value);\n        }\n    }\n    set iat(value) {\n        if (typeof value === 'undefined') {\n            this.#payload.iat = (0,_epoch_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(new Date());\n        }\n        else if (value instanceof Date) {\n            this.#payload.iat = validateInput('setIssuedAt', (0,_epoch_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(value));\n        }\n        else if (typeof value === 'string') {\n            this.#payload.iat = validateInput('setIssuedAt', (0,_epoch_js__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(new Date()) + (0,_secs_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(value));\n        }\n        else {\n            this.#payload.iat = validateInput('setIssuedAt', value);\n        }\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL2p3dF9jbGFpbXNfc2V0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBcUY7QUFDekM7QUFDYjtBQUNGO0FBQ1M7QUFDTTtBQUM1QztBQUNBO0FBQ0EsdUNBQXVDLE9BQU87QUFDOUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwwQkFBMEIsb0JBQW9CO0FBQzlDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ08sd0VBQXdFO0FBQy9FO0FBQ0E7QUFDQSw2QkFBNkIscURBQU87QUFDcEM7QUFDQTtBQUNBO0FBQ0EsU0FBUyx5REFBUTtBQUNqQixrQkFBa0IsdURBQVU7QUFDNUI7QUFDQSxZQUFZLE1BQU07QUFDbEI7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLHFFQUF3QjtBQUMxQztBQUNBLFlBQVksOERBQThEO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxzQkFBc0IscUVBQXdCLHNCQUFzQixNQUFNO0FBQzFFO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLHFFQUF3QjtBQUMxQztBQUNBO0FBQ0Esa0JBQWtCLHFFQUF3QjtBQUMxQztBQUNBO0FBQ0E7QUFDQSxrQkFBa0IscUVBQXdCO0FBQzFDO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esd0JBQXdCLG9EQUFJO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsWUFBWSxjQUFjO0FBQzFCLGdCQUFnQixxREFBSztBQUNyQjtBQUNBLGtCQUFrQixxRUFBd0I7QUFDMUM7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLHFFQUF3QjtBQUM5QztBQUNBO0FBQ0Esc0JBQXNCLHFFQUF3QjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNBLHNCQUFzQixxRUFBd0I7QUFDOUM7QUFDQTtBQUNBLHNCQUFzQix1REFBVTtBQUNoQztBQUNBO0FBQ0E7QUFDQTtBQUNBLG9FQUFvRSxvREFBSTtBQUN4RTtBQUNBLHNCQUFzQix1REFBVTtBQUNoQztBQUNBO0FBQ0Esc0JBQXNCLHFFQUF3QjtBQUM5QztBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBLGFBQWEseURBQVE7QUFDckI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGVBQWUscURBQU87QUFDdEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsOERBQThELHFEQUFLO0FBQ25FO0FBQ0E7QUFDQSxnQ0FBZ0MscURBQUssZUFBZSxvREFBSTtBQUN4RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLG1FQUFtRSxxREFBSztBQUN4RTtBQUNBO0FBQ0EsZ0NBQWdDLHFEQUFLLGVBQWUsb0RBQUk7QUFDeEQ7QUFDQTtBQUNBO0FBQ0E7QUFDQSxnQ0FBZ0MscURBQUs7QUFDckM7QUFDQTtBQUNBLDZEQUE2RCxxREFBSztBQUNsRTtBQUNBO0FBQ0EsNkRBQTZELHFEQUFLLGVBQWUsb0RBQUk7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxub2RlX21vZHVsZXNcXGpvc2VcXGRpc3RcXHdlYmFwaVxcbGliXFxqd3RfY2xhaW1zX3NldC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBKV1RDbGFpbVZhbGlkYXRpb25GYWlsZWQsIEpXVEV4cGlyZWQsIEpXVEludmFsaWQgfSBmcm9tICcuLi91dGlsL2Vycm9ycy5qcyc7XG5pbXBvcnQgeyBkZWNvZGVyIH0gZnJvbSAnLi9idWZmZXJfdXRpbHMuanMnO1xuaW1wb3J0IGVwb2NoIGZyb20gJy4vZXBvY2guanMnO1xuaW1wb3J0IHNlY3MgZnJvbSAnLi9zZWNzLmpzJztcbmltcG9ydCBpc09iamVjdCBmcm9tICcuL2lzX29iamVjdC5qcyc7XG5pbXBvcnQgeyBlbmNvZGVyIH0gZnJvbSAnLi9idWZmZXJfdXRpbHMuanMnO1xuZnVuY3Rpb24gdmFsaWRhdGVJbnB1dChsYWJlbCwgaW5wdXQpIHtcbiAgICBpZiAoIU51bWJlci5pc0Zpbml0ZShpbnB1dCkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgSW52YWxpZCAke2xhYmVsfSBpbnB1dGApO1xuICAgIH1cbiAgICByZXR1cm4gaW5wdXQ7XG59XG5jb25zdCBub3JtYWxpemVUeXAgPSAodmFsdWUpID0+IHtcbiAgICBpZiAodmFsdWUuaW5jbHVkZXMoJy8nKSkge1xuICAgICAgICByZXR1cm4gdmFsdWUudG9Mb3dlckNhc2UoKTtcbiAgICB9XG4gICAgcmV0dXJuIGBhcHBsaWNhdGlvbi8ke3ZhbHVlLnRvTG93ZXJDYXNlKCl9YDtcbn07XG5jb25zdCBjaGVja0F1ZGllbmNlUHJlc2VuY2UgPSAoYXVkUGF5bG9hZCwgYXVkT3B0aW9uKSA9PiB7XG4gICAgaWYgKHR5cGVvZiBhdWRQYXlsb2FkID09PSAnc3RyaW5nJykge1xuICAgICAgICByZXR1cm4gYXVkT3B0aW9uLmluY2x1ZGVzKGF1ZFBheWxvYWQpO1xuICAgIH1cbiAgICBpZiAoQXJyYXkuaXNBcnJheShhdWRQYXlsb2FkKSkge1xuICAgICAgICByZXR1cm4gYXVkT3B0aW9uLnNvbWUoU2V0LnByb3RvdHlwZS5oYXMuYmluZChuZXcgU2V0KGF1ZFBheWxvYWQpKSk7XG4gICAgfVxuICAgIHJldHVybiBmYWxzZTtcbn07XG5leHBvcnQgZnVuY3Rpb24gdmFsaWRhdGVDbGFpbXNTZXQocHJvdGVjdGVkSGVhZGVyLCBlbmNvZGVkUGF5bG9hZCwgb3B0aW9ucyA9IHt9KSB7XG4gICAgbGV0IHBheWxvYWQ7XG4gICAgdHJ5IHtcbiAgICAgICAgcGF5bG9hZCA9IEpTT04ucGFyc2UoZGVjb2Rlci5kZWNvZGUoZW5jb2RlZFBheWxvYWQpKTtcbiAgICB9XG4gICAgY2F0Y2gge1xuICAgIH1cbiAgICBpZiAoIWlzT2JqZWN0KHBheWxvYWQpKSB7XG4gICAgICAgIHRocm93IG5ldyBKV1RJbnZhbGlkKCdKV1QgQ2xhaW1zIFNldCBtdXN0IGJlIGEgdG9wLWxldmVsIEpTT04gb2JqZWN0Jyk7XG4gICAgfVxuICAgIGNvbnN0IHsgdHlwIH0gPSBvcHRpb25zO1xuICAgIGlmICh0eXAgJiZcbiAgICAgICAgKHR5cGVvZiBwcm90ZWN0ZWRIZWFkZXIudHlwICE9PSAnc3RyaW5nJyB8fFxuICAgICAgICAgICAgbm9ybWFsaXplVHlwKHByb3RlY3RlZEhlYWRlci50eXApICE9PSBub3JtYWxpemVUeXAodHlwKSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IEpXVENsYWltVmFsaWRhdGlvbkZhaWxlZCgndW5leHBlY3RlZCBcInR5cFwiIEpXVCBoZWFkZXIgdmFsdWUnLCBwYXlsb2FkLCAndHlwJywgJ2NoZWNrX2ZhaWxlZCcpO1xuICAgIH1cbiAgICBjb25zdCB7IHJlcXVpcmVkQ2xhaW1zID0gW10sIGlzc3Vlciwgc3ViamVjdCwgYXVkaWVuY2UsIG1heFRva2VuQWdlIH0gPSBvcHRpb25zO1xuICAgIGNvbnN0IHByZXNlbmNlQ2hlY2sgPSBbLi4ucmVxdWlyZWRDbGFpbXNdO1xuICAgIGlmIChtYXhUb2tlbkFnZSAhPT0gdW5kZWZpbmVkKVxuICAgICAgICBwcmVzZW5jZUNoZWNrLnB1c2goJ2lhdCcpO1xuICAgIGlmIChhdWRpZW5jZSAhPT0gdW5kZWZpbmVkKVxuICAgICAgICBwcmVzZW5jZUNoZWNrLnB1c2goJ2F1ZCcpO1xuICAgIGlmIChzdWJqZWN0ICE9PSB1bmRlZmluZWQpXG4gICAgICAgIHByZXNlbmNlQ2hlY2sucHVzaCgnc3ViJyk7XG4gICAgaWYgKGlzc3VlciAhPT0gdW5kZWZpbmVkKVxuICAgICAgICBwcmVzZW5jZUNoZWNrLnB1c2goJ2lzcycpO1xuICAgIGZvciAoY29uc3QgY2xhaW0gb2YgbmV3IFNldChwcmVzZW5jZUNoZWNrLnJldmVyc2UoKSkpIHtcbiAgICAgICAgaWYgKCEoY2xhaW0gaW4gcGF5bG9hZCkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBKV1RDbGFpbVZhbGlkYXRpb25GYWlsZWQoYG1pc3NpbmcgcmVxdWlyZWQgXCIke2NsYWltfVwiIGNsYWltYCwgcGF5bG9hZCwgY2xhaW0sICdtaXNzaW5nJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKGlzc3VlciAmJlxuICAgICAgICAhKEFycmF5LmlzQXJyYXkoaXNzdWVyKSA/IGlzc3VlciA6IFtpc3N1ZXJdKS5pbmNsdWRlcyhwYXlsb2FkLmlzcykpIHtcbiAgICAgICAgdGhyb3cgbmV3IEpXVENsYWltVmFsaWRhdGlvbkZhaWxlZCgndW5leHBlY3RlZCBcImlzc1wiIGNsYWltIHZhbHVlJywgcGF5bG9hZCwgJ2lzcycsICdjaGVja19mYWlsZWQnKTtcbiAgICB9XG4gICAgaWYgKHN1YmplY3QgJiYgcGF5bG9hZC5zdWIgIT09IHN1YmplY3QpIHtcbiAgICAgICAgdGhyb3cgbmV3IEpXVENsYWltVmFsaWRhdGlvbkZhaWxlZCgndW5leHBlY3RlZCBcInN1YlwiIGNsYWltIHZhbHVlJywgcGF5bG9hZCwgJ3N1YicsICdjaGVja19mYWlsZWQnKTtcbiAgICB9XG4gICAgaWYgKGF1ZGllbmNlICYmXG4gICAgICAgICFjaGVja0F1ZGllbmNlUHJlc2VuY2UocGF5bG9hZC5hdWQsIHR5cGVvZiBhdWRpZW5jZSA9PT0gJ3N0cmluZycgPyBbYXVkaWVuY2VdIDogYXVkaWVuY2UpKSB7XG4gICAgICAgIHRocm93IG5ldyBKV1RDbGFpbVZhbGlkYXRpb25GYWlsZWQoJ3VuZXhwZWN0ZWQgXCJhdWRcIiBjbGFpbSB2YWx1ZScsIHBheWxvYWQsICdhdWQnLCAnY2hlY2tfZmFpbGVkJyk7XG4gICAgfVxuICAgIGxldCB0b2xlcmFuY2U7XG4gICAgc3dpdGNoICh0eXBlb2Ygb3B0aW9ucy5jbG9ja1RvbGVyYW5jZSkge1xuICAgICAgICBjYXNlICdzdHJpbmcnOlxuICAgICAgICAgICAgdG9sZXJhbmNlID0gc2VjcyhvcHRpb25zLmNsb2NrVG9sZXJhbmNlKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdudW1iZXInOlxuICAgICAgICAgICAgdG9sZXJhbmNlID0gb3B0aW9ucy5jbG9ja1RvbGVyYW5jZTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICd1bmRlZmluZWQnOlxuICAgICAgICAgICAgdG9sZXJhbmNlID0gMDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBkZWZhdWx0OlxuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCBjbG9ja1RvbGVyYW5jZSBvcHRpb24gdHlwZScpO1xuICAgIH1cbiAgICBjb25zdCB7IGN1cnJlbnREYXRlIH0gPSBvcHRpb25zO1xuICAgIGNvbnN0IG5vdyA9IGVwb2NoKGN1cnJlbnREYXRlIHx8IG5ldyBEYXRlKCkpO1xuICAgIGlmICgocGF5bG9hZC5pYXQgIT09IHVuZGVmaW5lZCB8fCBtYXhUb2tlbkFnZSkgJiYgdHlwZW9mIHBheWxvYWQuaWF0ICE9PSAnbnVtYmVyJykge1xuICAgICAgICB0aHJvdyBuZXcgSldUQ2xhaW1WYWxpZGF0aW9uRmFpbGVkKCdcImlhdFwiIGNsYWltIG11c3QgYmUgYSBudW1iZXInLCBwYXlsb2FkLCAnaWF0JywgJ2ludmFsaWQnKTtcbiAgICB9XG4gICAgaWYgKHBheWxvYWQubmJmICE9PSB1bmRlZmluZWQpIHtcbiAgICAgICAgaWYgKHR5cGVvZiBwYXlsb2FkLm5iZiAhPT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBKV1RDbGFpbVZhbGlkYXRpb25GYWlsZWQoJ1wibmJmXCIgY2xhaW0gbXVzdCBiZSBhIG51bWJlcicsIHBheWxvYWQsICduYmYnLCAnaW52YWxpZCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChwYXlsb2FkLm5iZiA+IG5vdyArIHRvbGVyYW5jZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEpXVENsYWltVmFsaWRhdGlvbkZhaWxlZCgnXCJuYmZcIiBjbGFpbSB0aW1lc3RhbXAgY2hlY2sgZmFpbGVkJywgcGF5bG9hZCwgJ25iZicsICdjaGVja19mYWlsZWQnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAocGF5bG9hZC5leHAgIT09IHVuZGVmaW5lZCkge1xuICAgICAgICBpZiAodHlwZW9mIHBheWxvYWQuZXhwICE9PSAnbnVtYmVyJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEpXVENsYWltVmFsaWRhdGlvbkZhaWxlZCgnXCJleHBcIiBjbGFpbSBtdXN0IGJlIGEgbnVtYmVyJywgcGF5bG9hZCwgJ2V4cCcsICdpbnZhbGlkJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKHBheWxvYWQuZXhwIDw9IG5vdyAtIHRvbGVyYW5jZSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEpXVEV4cGlyZWQoJ1wiZXhwXCIgY2xhaW0gdGltZXN0YW1wIGNoZWNrIGZhaWxlZCcsIHBheWxvYWQsICdleHAnLCAnY2hlY2tfZmFpbGVkJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaWYgKG1heFRva2VuQWdlKSB7XG4gICAgICAgIGNvbnN0IGFnZSA9IG5vdyAtIHBheWxvYWQuaWF0O1xuICAgICAgICBjb25zdCBtYXggPSB0eXBlb2YgbWF4VG9rZW5BZ2UgPT09ICdudW1iZXInID8gbWF4VG9rZW5BZ2UgOiBzZWNzKG1heFRva2VuQWdlKTtcbiAgICAgICAgaWYgKGFnZSAtIHRvbGVyYW5jZSA+IG1heCkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEpXVEV4cGlyZWQoJ1wiaWF0XCIgY2xhaW0gdGltZXN0YW1wIGNoZWNrIGZhaWxlZCAodG9vIGZhciBpbiB0aGUgcGFzdCknLCBwYXlsb2FkLCAnaWF0JywgJ2NoZWNrX2ZhaWxlZCcpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhZ2UgPCAwIC0gdG9sZXJhbmNlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgSldUQ2xhaW1WYWxpZGF0aW9uRmFpbGVkKCdcImlhdFwiIGNsYWltIHRpbWVzdGFtcCBjaGVjayBmYWlsZWQgKGl0IHNob3VsZCBiZSBpbiB0aGUgcGFzdCknLCBwYXlsb2FkLCAnaWF0JywgJ2NoZWNrX2ZhaWxlZCcpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBwYXlsb2FkO1xufVxuZXhwb3J0IGNsYXNzIEpXVENsYWltc0J1aWxkZXIge1xuICAgICNwYXlsb2FkO1xuICAgIGNvbnN0cnVjdG9yKHBheWxvYWQpIHtcbiAgICAgICAgaWYgKCFpc09iamVjdChwYXlsb2FkKSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSldUIENsYWltcyBTZXQgTVVTVCBiZSBhbiBvYmplY3QnKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLiNwYXlsb2FkID0gc3RydWN0dXJlZENsb25lKHBheWxvYWQpO1xuICAgIH1cbiAgICBkYXRhKCkge1xuICAgICAgICByZXR1cm4gZW5jb2Rlci5lbmNvZGUoSlNPTi5zdHJpbmdpZnkodGhpcy4jcGF5bG9hZCkpO1xuICAgIH1cbiAgICBnZXQgaXNzKCkge1xuICAgICAgICByZXR1cm4gdGhpcy4jcGF5bG9hZC5pc3M7XG4gICAgfVxuICAgIHNldCBpc3ModmFsdWUpIHtcbiAgICAgICAgdGhpcy4jcGF5bG9hZC5pc3MgPSB2YWx1ZTtcbiAgICB9XG4gICAgZ2V0IHN1YigpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuI3BheWxvYWQuc3ViO1xuICAgIH1cbiAgICBzZXQgc3ViKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuI3BheWxvYWQuc3ViID0gdmFsdWU7XG4gICAgfVxuICAgIGdldCBhdWQoKSB7XG4gICAgICAgIHJldHVybiB0aGlzLiNwYXlsb2FkLmF1ZDtcbiAgICB9XG4gICAgc2V0IGF1ZCh2YWx1ZSkge1xuICAgICAgICB0aGlzLiNwYXlsb2FkLmF1ZCA9IHZhbHVlO1xuICAgIH1cbiAgICBzZXQganRpKHZhbHVlKSB7XG4gICAgICAgIHRoaXMuI3BheWxvYWQuanRpID0gdmFsdWU7XG4gICAgfVxuICAgIHNldCBuYmYodmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIHRoaXMuI3BheWxvYWQubmJmID0gdmFsaWRhdGVJbnB1dCgnc2V0Tm90QmVmb3JlJywgdmFsdWUpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICAgICAgdGhpcy4jcGF5bG9hZC5uYmYgPSB2YWxpZGF0ZUlucHV0KCdzZXROb3RCZWZvcmUnLCBlcG9jaCh2YWx1ZSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy4jcGF5bG9hZC5uYmYgPSBlcG9jaChuZXcgRGF0ZSgpKSArIHNlY3ModmFsdWUpO1xuICAgICAgICB9XG4gICAgfVxuICAgIHNldCBleHAodmFsdWUpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ251bWJlcicpIHtcbiAgICAgICAgICAgIHRoaXMuI3BheWxvYWQuZXhwID0gdmFsaWRhdGVJbnB1dCgnc2V0RXhwaXJhdGlvblRpbWUnLCB2YWx1ZSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodmFsdWUgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICAgICAgICB0aGlzLiNwYXlsb2FkLmV4cCA9IHZhbGlkYXRlSW5wdXQoJ3NldEV4cGlyYXRpb25UaW1lJywgZXBvY2godmFsdWUpKTtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRoaXMuI3BheWxvYWQuZXhwID0gZXBvY2gobmV3IERhdGUoKSkgKyBzZWNzKHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBzZXQgaWF0KHZhbHVlKSB7XG4gICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICd1bmRlZmluZWQnKSB7XG4gICAgICAgICAgICB0aGlzLiNwYXlsb2FkLmlhdCA9IGVwb2NoKG5ldyBEYXRlKCkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2UgaWYgKHZhbHVlIGluc3RhbmNlb2YgRGF0ZSkge1xuICAgICAgICAgICAgdGhpcy4jcGF5bG9hZC5pYXQgPSB2YWxpZGF0ZUlucHV0KCdzZXRJc3N1ZWRBdCcsIGVwb2NoKHZhbHVlKSk7XG4gICAgICAgIH1cbiAgICAgICAgZWxzZSBpZiAodHlwZW9mIHZhbHVlID09PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdGhpcy4jcGF5bG9hZC5pYXQgPSB2YWxpZGF0ZUlucHV0KCdzZXRJc3N1ZWRBdCcsIGVwb2NoKG5ldyBEYXRlKCkpICsgc2Vjcyh2YWx1ZSkpO1xuICAgICAgICB9XG4gICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgdGhpcy4jcGF5bG9hZC5pYXQgPSB2YWxpZGF0ZUlucHV0KCdzZXRJc3N1ZWRBdCcsIHZhbHVlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/jwt_claims_set.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/normalize_key.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/normalize_key.js ***!
  \*************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _is_jwk_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./is_jwk.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_jwk.js\");\n/* harmony import */ var _util_base64url_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../util/base64url.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/base64url.js\");\n/* harmony import */ var _jwk_to_key_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./jwk_to_key.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/jwk_to_key.js\");\n/* harmony import */ var _is_key_like_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./is_key_like.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_key_like.js\");\n\n\n\n\nlet cache;\nconst handleJWK = async (key, jwk, alg, freeze = false) => {\n    cache ||= new WeakMap();\n    let cached = cache.get(key);\n    if (cached?.[alg]) {\n        return cached[alg];\n    }\n    const cryptoKey = await (0,_jwk_to_key_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])({ ...jwk, alg });\n    if (freeze)\n        Object.freeze(key);\n    if (!cached) {\n        cache.set(key, { [alg]: cryptoKey });\n    }\n    else {\n        cached[alg] = cryptoKey;\n    }\n    return cryptoKey;\n};\nconst handleKeyObject = (keyObject, alg) => {\n    cache ||= new WeakMap();\n    let cached = cache.get(keyObject);\n    if (cached?.[alg]) {\n        return cached[alg];\n    }\n    const isPublic = keyObject.type === 'public';\n    const extractable = isPublic ? true : false;\n    let cryptoKey;\n    if (keyObject.asymmetricKeyType === 'x25519') {\n        switch (alg) {\n            case 'ECDH-ES':\n            case 'ECDH-ES+A128KW':\n            case 'ECDH-ES+A192KW':\n            case 'ECDH-ES+A256KW':\n                break;\n            default:\n                throw new TypeError('given KeyObject instance cannot be used for this algorithm');\n        }\n        cryptoKey = keyObject.toCryptoKey(keyObject.asymmetricKeyType, extractable, isPublic ? [] : ['deriveBits']);\n    }\n    if (keyObject.asymmetricKeyType === 'ed25519') {\n        if (alg !== 'EdDSA' && alg !== 'Ed25519') {\n            throw new TypeError('given KeyObject instance cannot be used for this algorithm');\n        }\n        cryptoKey = keyObject.toCryptoKey(keyObject.asymmetricKeyType, extractable, [\n            isPublic ? 'verify' : 'sign',\n        ]);\n    }\n    switch (keyObject.asymmetricKeyType) {\n        case 'ml-dsa-44':\n        case 'ml-dsa-65':\n        case 'ml-dsa-87': {\n            if (alg !== keyObject.asymmetricKeyType.toUpperCase()) {\n                throw new TypeError('given KeyObject instance cannot be used for this algorithm');\n            }\n            cryptoKey = keyObject.toCryptoKey(keyObject.asymmetricKeyType, extractable, [\n                isPublic ? 'verify' : 'sign',\n            ]);\n        }\n    }\n    if (keyObject.asymmetricKeyType === 'rsa') {\n        let hash;\n        switch (alg) {\n            case 'RSA-OAEP':\n                hash = 'SHA-1';\n                break;\n            case 'RS256':\n            case 'PS256':\n            case 'RSA-OAEP-256':\n                hash = 'SHA-256';\n                break;\n            case 'RS384':\n            case 'PS384':\n            case 'RSA-OAEP-384':\n                hash = 'SHA-384';\n                break;\n            case 'RS512':\n            case 'PS512':\n            case 'RSA-OAEP-512':\n                hash = 'SHA-512';\n                break;\n            default:\n                throw new TypeError('given KeyObject instance cannot be used for this algorithm');\n        }\n        if (alg.startsWith('RSA-OAEP')) {\n            return keyObject.toCryptoKey({\n                name: 'RSA-OAEP',\n                hash,\n            }, extractable, isPublic ? ['encrypt'] : ['decrypt']);\n        }\n        cryptoKey = keyObject.toCryptoKey({\n            name: alg.startsWith('PS') ? 'RSA-PSS' : 'RSASSA-PKCS1-v1_5',\n            hash,\n        }, extractable, [isPublic ? 'verify' : 'sign']);\n    }\n    if (keyObject.asymmetricKeyType === 'ec') {\n        const nist = new Map([\n            ['prime256v1', 'P-256'],\n            ['secp384r1', 'P-384'],\n            ['secp521r1', 'P-521'],\n        ]);\n        const namedCurve = nist.get(keyObject.asymmetricKeyDetails?.namedCurve);\n        if (!namedCurve) {\n            throw new TypeError('given KeyObject instance cannot be used for this algorithm');\n        }\n        if (alg === 'ES256' && namedCurve === 'P-256') {\n            cryptoKey = keyObject.toCryptoKey({\n                name: 'ECDSA',\n                namedCurve,\n            }, extractable, [isPublic ? 'verify' : 'sign']);\n        }\n        if (alg === 'ES384' && namedCurve === 'P-384') {\n            cryptoKey = keyObject.toCryptoKey({\n                name: 'ECDSA',\n                namedCurve,\n            }, extractable, [isPublic ? 'verify' : 'sign']);\n        }\n        if (alg === 'ES512' && namedCurve === 'P-521') {\n            cryptoKey = keyObject.toCryptoKey({\n                name: 'ECDSA',\n                namedCurve,\n            }, extractable, [isPublic ? 'verify' : 'sign']);\n        }\n        if (alg.startsWith('ECDH-ES')) {\n            cryptoKey = keyObject.toCryptoKey({\n                name: 'ECDH',\n                namedCurve,\n            }, extractable, isPublic ? [] : ['deriveBits']);\n        }\n    }\n    if (!cryptoKey) {\n        throw new TypeError('given KeyObject instance cannot be used for this algorithm');\n    }\n    if (!cached) {\n        cache.set(keyObject, { [alg]: cryptoKey });\n    }\n    else {\n        cached[alg] = cryptoKey;\n    }\n    return cryptoKey;\n};\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (async (key, alg) => {\n    if (key instanceof Uint8Array) {\n        return key;\n    }\n    if ((0,_is_key_like_js__WEBPACK_IMPORTED_MODULE_1__.isCryptoKey)(key)) {\n        return key;\n    }\n    if ((0,_is_key_like_js__WEBPACK_IMPORTED_MODULE_1__.isKeyObject)(key)) {\n        if (key.type === 'secret') {\n            return key.export();\n        }\n        if ('toCryptoKey' in key && typeof key.toCryptoKey === 'function') {\n            try {\n                return handleKeyObject(key, alg);\n            }\n            catch (err) {\n                if (err instanceof TypeError) {\n                    throw err;\n                }\n            }\n        }\n        let jwk = key.export({ format: 'jwk' });\n        return handleJWK(key, jwk, alg);\n    }\n    if ((0,_is_jwk_js__WEBPACK_IMPORTED_MODULE_2__.isJWK)(key)) {\n        if (key.k) {\n            return (0,_util_base64url_js__WEBPACK_IMPORTED_MODULE_3__.decode)(key.k);\n        }\n        return handleJWK(key, key, alg, true);\n    }\n    throw new Error('unreachable');\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL25vcm1hbGl6ZV9rZXkuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBb0M7QUFDVTtBQUNOO0FBQ29CO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNEJBQTRCLDBEQUFTLEdBQUcsYUFBYTtBQUNyRDtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsa0JBQWtCO0FBQzNDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsYUFBYTtBQUNiO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxhQUFhO0FBQ2I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsK0JBQStCLGtCQUFrQjtBQUNqRDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxpRUFBZTtBQUNmO0FBQ0E7QUFDQTtBQUNBLFFBQVEsNERBQVc7QUFDbkI7QUFDQTtBQUNBLFFBQVEsNERBQVc7QUFDbkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwrQkFBK0IsZUFBZTtBQUM5QztBQUNBO0FBQ0EsUUFBUSxpREFBSztBQUNiO0FBQ0EsbUJBQW1CLDBEQUFNO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsQ0FBQyxFQUFDIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxub2RlX21vZHVsZXNcXGpvc2VcXGRpc3RcXHdlYmFwaVxcbGliXFxub3JtYWxpemVfa2V5LmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGlzSldLIH0gZnJvbSAnLi9pc19qd2suanMnO1xuaW1wb3J0IHsgZGVjb2RlIH0gZnJvbSAnLi4vdXRpbC9iYXNlNjR1cmwuanMnO1xuaW1wb3J0IGltcG9ydEpXSyBmcm9tICcuL2p3a190b19rZXkuanMnO1xuaW1wb3J0IHsgaXNDcnlwdG9LZXksIGlzS2V5T2JqZWN0IH0gZnJvbSAnLi9pc19rZXlfbGlrZS5qcyc7XG5sZXQgY2FjaGU7XG5jb25zdCBoYW5kbGVKV0sgPSBhc3luYyAoa2V5LCBqd2ssIGFsZywgZnJlZXplID0gZmFsc2UpID0+IHtcbiAgICBjYWNoZSB8fD0gbmV3IFdlYWtNYXAoKTtcbiAgICBsZXQgY2FjaGVkID0gY2FjaGUuZ2V0KGtleSk7XG4gICAgaWYgKGNhY2hlZD8uW2FsZ10pIHtcbiAgICAgICAgcmV0dXJuIGNhY2hlZFthbGddO1xuICAgIH1cbiAgICBjb25zdCBjcnlwdG9LZXkgPSBhd2FpdCBpbXBvcnRKV0soeyAuLi5qd2ssIGFsZyB9KTtcbiAgICBpZiAoZnJlZXplKVxuICAgICAgICBPYmplY3QuZnJlZXplKGtleSk7XG4gICAgaWYgKCFjYWNoZWQpIHtcbiAgICAgICAgY2FjaGUuc2V0KGtleSwgeyBbYWxnXTogY3J5cHRvS2V5IH0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgY2FjaGVkW2FsZ10gPSBjcnlwdG9LZXk7XG4gICAgfVxuICAgIHJldHVybiBjcnlwdG9LZXk7XG59O1xuY29uc3QgaGFuZGxlS2V5T2JqZWN0ID0gKGtleU9iamVjdCwgYWxnKSA9PiB7XG4gICAgY2FjaGUgfHw9IG5ldyBXZWFrTWFwKCk7XG4gICAgbGV0IGNhY2hlZCA9IGNhY2hlLmdldChrZXlPYmplY3QpO1xuICAgIGlmIChjYWNoZWQ/LlthbGddKSB7XG4gICAgICAgIHJldHVybiBjYWNoZWRbYWxnXTtcbiAgICB9XG4gICAgY29uc3QgaXNQdWJsaWMgPSBrZXlPYmplY3QudHlwZSA9PT0gJ3B1YmxpYyc7XG4gICAgY29uc3QgZXh0cmFjdGFibGUgPSBpc1B1YmxpYyA/IHRydWUgOiBmYWxzZTtcbiAgICBsZXQgY3J5cHRvS2V5O1xuICAgIGlmIChrZXlPYmplY3QuYXN5bW1ldHJpY0tleVR5cGUgPT09ICd4MjU1MTknKSB7XG4gICAgICAgIHN3aXRjaCAoYWxnKSB7XG4gICAgICAgICAgICBjYXNlICdFQ0RILUVTJzpcbiAgICAgICAgICAgIGNhc2UgJ0VDREgtRVMrQTEyOEtXJzpcbiAgICAgICAgICAgIGNhc2UgJ0VDREgtRVMrQTE5MktXJzpcbiAgICAgICAgICAgIGNhc2UgJ0VDREgtRVMrQTI1NktXJzpcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignZ2l2ZW4gS2V5T2JqZWN0IGluc3RhbmNlIGNhbm5vdCBiZSB1c2VkIGZvciB0aGlzIGFsZ29yaXRobScpO1xuICAgICAgICB9XG4gICAgICAgIGNyeXB0b0tleSA9IGtleU9iamVjdC50b0NyeXB0b0tleShrZXlPYmplY3QuYXN5bW1ldHJpY0tleVR5cGUsIGV4dHJhY3RhYmxlLCBpc1B1YmxpYyA/IFtdIDogWydkZXJpdmVCaXRzJ10pO1xuICAgIH1cbiAgICBpZiAoa2V5T2JqZWN0LmFzeW1tZXRyaWNLZXlUeXBlID09PSAnZWQyNTUxOScpIHtcbiAgICAgICAgaWYgKGFsZyAhPT0gJ0VkRFNBJyAmJiBhbGcgIT09ICdFZDI1NTE5Jykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignZ2l2ZW4gS2V5T2JqZWN0IGluc3RhbmNlIGNhbm5vdCBiZSB1c2VkIGZvciB0aGlzIGFsZ29yaXRobScpO1xuICAgICAgICB9XG4gICAgICAgIGNyeXB0b0tleSA9IGtleU9iamVjdC50b0NyeXB0b0tleShrZXlPYmplY3QuYXN5bW1ldHJpY0tleVR5cGUsIGV4dHJhY3RhYmxlLCBbXG4gICAgICAgICAgICBpc1B1YmxpYyA/ICd2ZXJpZnknIDogJ3NpZ24nLFxuICAgICAgICBdKTtcbiAgICB9XG4gICAgc3dpdGNoIChrZXlPYmplY3QuYXN5bW1ldHJpY0tleVR5cGUpIHtcbiAgICAgICAgY2FzZSAnbWwtZHNhLTQ0JzpcbiAgICAgICAgY2FzZSAnbWwtZHNhLTY1JzpcbiAgICAgICAgY2FzZSAnbWwtZHNhLTg3Jzoge1xuICAgICAgICAgICAgaWYgKGFsZyAhPT0ga2V5T2JqZWN0LmFzeW1tZXRyaWNLZXlUeXBlLnRvVXBwZXJDYXNlKCkpIHtcbiAgICAgICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdnaXZlbiBLZXlPYmplY3QgaW5zdGFuY2UgY2Fubm90IGJlIHVzZWQgZm9yIHRoaXMgYWxnb3JpdGhtJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjcnlwdG9LZXkgPSBrZXlPYmplY3QudG9DcnlwdG9LZXkoa2V5T2JqZWN0LmFzeW1tZXRyaWNLZXlUeXBlLCBleHRyYWN0YWJsZSwgW1xuICAgICAgICAgICAgICAgIGlzUHVibGljID8gJ3ZlcmlmeScgOiAnc2lnbicsXG4gICAgICAgICAgICBdKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoa2V5T2JqZWN0LmFzeW1tZXRyaWNLZXlUeXBlID09PSAncnNhJykge1xuICAgICAgICBsZXQgaGFzaDtcbiAgICAgICAgc3dpdGNoIChhbGcpIHtcbiAgICAgICAgICAgIGNhc2UgJ1JTQS1PQUVQJzpcbiAgICAgICAgICAgICAgICBoYXNoID0gJ1NIQS0xJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ1JTMjU2JzpcbiAgICAgICAgICAgIGNhc2UgJ1BTMjU2JzpcbiAgICAgICAgICAgIGNhc2UgJ1JTQS1PQUVQLTI1Nic6XG4gICAgICAgICAgICAgICAgaGFzaCA9ICdTSEEtMjU2JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ1JTMzg0JzpcbiAgICAgICAgICAgIGNhc2UgJ1BTMzg0JzpcbiAgICAgICAgICAgIGNhc2UgJ1JTQS1PQUVQLTM4NCc6XG4gICAgICAgICAgICAgICAgaGFzaCA9ICdTSEEtMzg0JztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGNhc2UgJ1JTNTEyJzpcbiAgICAgICAgICAgIGNhc2UgJ1BTNTEyJzpcbiAgICAgICAgICAgIGNhc2UgJ1JTQS1PQUVQLTUxMic6XG4gICAgICAgICAgICAgICAgaGFzaCA9ICdTSEEtNTEyJztcbiAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignZ2l2ZW4gS2V5T2JqZWN0IGluc3RhbmNlIGNhbm5vdCBiZSB1c2VkIGZvciB0aGlzIGFsZ29yaXRobScpO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhbGcuc3RhcnRzV2l0aCgnUlNBLU9BRVAnKSkge1xuICAgICAgICAgICAgcmV0dXJuIGtleU9iamVjdC50b0NyeXB0b0tleSh7XG4gICAgICAgICAgICAgICAgbmFtZTogJ1JTQS1PQUVQJyxcbiAgICAgICAgICAgICAgICBoYXNoLFxuICAgICAgICAgICAgfSwgZXh0cmFjdGFibGUsIGlzUHVibGljID8gWydlbmNyeXB0J10gOiBbJ2RlY3J5cHQnXSk7XG4gICAgICAgIH1cbiAgICAgICAgY3J5cHRvS2V5ID0ga2V5T2JqZWN0LnRvQ3J5cHRvS2V5KHtcbiAgICAgICAgICAgIG5hbWU6IGFsZy5zdGFydHNXaXRoKCdQUycpID8gJ1JTQS1QU1MnIDogJ1JTQVNTQS1QS0NTMS12MV81JyxcbiAgICAgICAgICAgIGhhc2gsXG4gICAgICAgIH0sIGV4dHJhY3RhYmxlLCBbaXNQdWJsaWMgPyAndmVyaWZ5JyA6ICdzaWduJ10pO1xuICAgIH1cbiAgICBpZiAoa2V5T2JqZWN0LmFzeW1tZXRyaWNLZXlUeXBlID09PSAnZWMnKSB7XG4gICAgICAgIGNvbnN0IG5pc3QgPSBuZXcgTWFwKFtcbiAgICAgICAgICAgIFsncHJpbWUyNTZ2MScsICdQLTI1NiddLFxuICAgICAgICAgICAgWydzZWNwMzg0cjEnLCAnUC0zODQnXSxcbiAgICAgICAgICAgIFsnc2VjcDUyMXIxJywgJ1AtNTIxJ10sXG4gICAgICAgIF0pO1xuICAgICAgICBjb25zdCBuYW1lZEN1cnZlID0gbmlzdC5nZXQoa2V5T2JqZWN0LmFzeW1tZXRyaWNLZXlEZXRhaWxzPy5uYW1lZEN1cnZlKTtcbiAgICAgICAgaWYgKCFuYW1lZEN1cnZlKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdnaXZlbiBLZXlPYmplY3QgaW5zdGFuY2UgY2Fubm90IGJlIHVzZWQgZm9yIHRoaXMgYWxnb3JpdGhtJyk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFsZyA9PT0gJ0VTMjU2JyAmJiBuYW1lZEN1cnZlID09PSAnUC0yNTYnKSB7XG4gICAgICAgICAgICBjcnlwdG9LZXkgPSBrZXlPYmplY3QudG9DcnlwdG9LZXkoe1xuICAgICAgICAgICAgICAgIG5hbWU6ICdFQ0RTQScsXG4gICAgICAgICAgICAgICAgbmFtZWRDdXJ2ZSxcbiAgICAgICAgICAgIH0sIGV4dHJhY3RhYmxlLCBbaXNQdWJsaWMgPyAndmVyaWZ5JyA6ICdzaWduJ10pO1xuICAgICAgICB9XG4gICAgICAgIGlmIChhbGcgPT09ICdFUzM4NCcgJiYgbmFtZWRDdXJ2ZSA9PT0gJ1AtMzg0Jykge1xuICAgICAgICAgICAgY3J5cHRvS2V5ID0ga2V5T2JqZWN0LnRvQ3J5cHRvS2V5KHtcbiAgICAgICAgICAgICAgICBuYW1lOiAnRUNEU0EnLFxuICAgICAgICAgICAgICAgIG5hbWVkQ3VydmUsXG4gICAgICAgICAgICB9LCBleHRyYWN0YWJsZSwgW2lzUHVibGljID8gJ3ZlcmlmeScgOiAnc2lnbiddKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAoYWxnID09PSAnRVM1MTInICYmIG5hbWVkQ3VydmUgPT09ICdQLTUyMScpIHtcbiAgICAgICAgICAgIGNyeXB0b0tleSA9IGtleU9iamVjdC50b0NyeXB0b0tleSh7XG4gICAgICAgICAgICAgICAgbmFtZTogJ0VDRFNBJyxcbiAgICAgICAgICAgICAgICBuYW1lZEN1cnZlLFxuICAgICAgICAgICAgfSwgZXh0cmFjdGFibGUsIFtpc1B1YmxpYyA/ICd2ZXJpZnknIDogJ3NpZ24nXSk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGFsZy5zdGFydHNXaXRoKCdFQ0RILUVTJykpIHtcbiAgICAgICAgICAgIGNyeXB0b0tleSA9IGtleU9iamVjdC50b0NyeXB0b0tleSh7XG4gICAgICAgICAgICAgICAgbmFtZTogJ0VDREgnLFxuICAgICAgICAgICAgICAgIG5hbWVkQ3VydmUsXG4gICAgICAgICAgICB9LCBleHRyYWN0YWJsZSwgaXNQdWJsaWMgPyBbXSA6IFsnZGVyaXZlQml0cyddKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBpZiAoIWNyeXB0b0tleSkge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdnaXZlbiBLZXlPYmplY3QgaW5zdGFuY2UgY2Fubm90IGJlIHVzZWQgZm9yIHRoaXMgYWxnb3JpdGhtJyk7XG4gICAgfVxuICAgIGlmICghY2FjaGVkKSB7XG4gICAgICAgIGNhY2hlLnNldChrZXlPYmplY3QsIHsgW2FsZ106IGNyeXB0b0tleSB9KTtcbiAgICB9XG4gICAgZWxzZSB7XG4gICAgICAgIGNhY2hlZFthbGddID0gY3J5cHRvS2V5O1xuICAgIH1cbiAgICByZXR1cm4gY3J5cHRvS2V5O1xufTtcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIChrZXksIGFsZykgPT4ge1xuICAgIGlmIChrZXkgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7XG4gICAgICAgIHJldHVybiBrZXk7XG4gICAgfVxuICAgIGlmIChpc0NyeXB0b0tleShrZXkpKSB7XG4gICAgICAgIHJldHVybiBrZXk7XG4gICAgfVxuICAgIGlmIChpc0tleU9iamVjdChrZXkpKSB7XG4gICAgICAgIGlmIChrZXkudHlwZSA9PT0gJ3NlY3JldCcpIHtcbiAgICAgICAgICAgIHJldHVybiBrZXkuZXhwb3J0KCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKCd0b0NyeXB0b0tleScgaW4ga2V5ICYmIHR5cGVvZiBrZXkudG9DcnlwdG9LZXkgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGhhbmRsZUtleU9iamVjdChrZXksIGFsZyk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgaWYgKGVyciBpbnN0YW5jZW9mIFR5cGVFcnJvcikge1xuICAgICAgICAgICAgICAgICAgICB0aHJvdyBlcnI7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICAgIGxldCBqd2sgPSBrZXkuZXhwb3J0KHsgZm9ybWF0OiAnandrJyB9KTtcbiAgICAgICAgcmV0dXJuIGhhbmRsZUpXSyhrZXksIGp3aywgYWxnKTtcbiAgICB9XG4gICAgaWYgKGlzSldLKGtleSkpIHtcbiAgICAgICAgaWYgKGtleS5rKSB7XG4gICAgICAgICAgICByZXR1cm4gZGVjb2RlKGtleS5rKTtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gaGFuZGxlSldLKGtleSwga2V5LCBhbGcsIHRydWUpO1xuICAgIH1cbiAgICB0aHJvdyBuZXcgRXJyb3IoJ3VucmVhY2hhYmxlJyk7XG59O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/normalize_key.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/secs.js":
/*!****************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/secs.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\nconst minute = 60;\nconst hour = minute * 60;\nconst day = hour * 24;\nconst week = day * 7;\nconst year = day * 365.25;\nconst REGEX = /^(\\+|\\-)? ?(\\d+|\\d+\\.\\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)(?: (ago|from now))?$/i;\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((str) => {\n    const matched = REGEX.exec(str);\n    if (!matched || (matched[4] && matched[1])) {\n        throw new TypeError('Invalid time period format');\n    }\n    const value = parseFloat(matched[2]);\n    const unit = matched[3].toLowerCase();\n    let numericDate;\n    switch (unit) {\n        case 'sec':\n        case 'secs':\n        case 'second':\n        case 'seconds':\n        case 's':\n            numericDate = Math.round(value);\n            break;\n        case 'minute':\n        case 'minutes':\n        case 'min':\n        case 'mins':\n        case 'm':\n            numericDate = Math.round(value * minute);\n            break;\n        case 'hour':\n        case 'hours':\n        case 'hr':\n        case 'hrs':\n        case 'h':\n            numericDate = Math.round(value * hour);\n            break;\n        case 'day':\n        case 'days':\n        case 'd':\n            numericDate = Math.round(value * day);\n            break;\n        case 'week':\n        case 'weeks':\n        case 'w':\n            numericDate = Math.round(value * week);\n            break;\n        default:\n            numericDate = Math.round(value * year);\n            break;\n    }\n    if (matched[1] === '-' || matched[4] === 'ago') {\n        return -numericDate;\n    }\n    return numericDate;\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL3NlY3MuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGlFQUFlO0FBQ2Y7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUMsRUFBQyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcbm9kZV9tb2R1bGVzXFxqb3NlXFxkaXN0XFx3ZWJhcGlcXGxpYlxcc2Vjcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBtaW51dGUgPSA2MDtcbmNvbnN0IGhvdXIgPSBtaW51dGUgKiA2MDtcbmNvbnN0IGRheSA9IGhvdXIgKiAyNDtcbmNvbnN0IHdlZWsgPSBkYXkgKiA3O1xuY29uc3QgeWVhciA9IGRheSAqIDM2NS4yNTtcbmNvbnN0IFJFR0VYID0gL14oXFwrfFxcLSk/ID8oXFxkK3xcXGQrXFwuXFxkKykgPyhzZWNvbmRzP3xzZWNzP3xzfG1pbnV0ZXM/fG1pbnM/fG18aG91cnM/fGhycz98aHxkYXlzP3xkfHdlZWtzP3x3fHllYXJzP3x5cnM/fHkpKD86IChhZ298ZnJvbSBub3cpKT8kL2k7XG5leHBvcnQgZGVmYXVsdCAoc3RyKSA9PiB7XG4gICAgY29uc3QgbWF0Y2hlZCA9IFJFR0VYLmV4ZWMoc3RyKTtcbiAgICBpZiAoIW1hdGNoZWQgfHwgKG1hdGNoZWRbNF0gJiYgbWF0Y2hlZFsxXSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcignSW52YWxpZCB0aW1lIHBlcmlvZCBmb3JtYXQnKTtcbiAgICB9XG4gICAgY29uc3QgdmFsdWUgPSBwYXJzZUZsb2F0KG1hdGNoZWRbMl0pO1xuICAgIGNvbnN0IHVuaXQgPSBtYXRjaGVkWzNdLnRvTG93ZXJDYXNlKCk7XG4gICAgbGV0IG51bWVyaWNEYXRlO1xuICAgIHN3aXRjaCAodW5pdCkge1xuICAgICAgICBjYXNlICdzZWMnOlxuICAgICAgICBjYXNlICdzZWNzJzpcbiAgICAgICAgY2FzZSAnc2Vjb25kJzpcbiAgICAgICAgY2FzZSAnc2Vjb25kcyc6XG4gICAgICAgIGNhc2UgJ3MnOlxuICAgICAgICAgICAgbnVtZXJpY0RhdGUgPSBNYXRoLnJvdW5kKHZhbHVlKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdtaW51dGUnOlxuICAgICAgICBjYXNlICdtaW51dGVzJzpcbiAgICAgICAgY2FzZSAnbWluJzpcbiAgICAgICAgY2FzZSAnbWlucyc6XG4gICAgICAgIGNhc2UgJ20nOlxuICAgICAgICAgICAgbnVtZXJpY0RhdGUgPSBNYXRoLnJvdW5kKHZhbHVlICogbWludXRlKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICdob3VyJzpcbiAgICAgICAgY2FzZSAnaG91cnMnOlxuICAgICAgICBjYXNlICdocic6XG4gICAgICAgIGNhc2UgJ2hycyc6XG4gICAgICAgIGNhc2UgJ2gnOlxuICAgICAgICAgICAgbnVtZXJpY0RhdGUgPSBNYXRoLnJvdW5kKHZhbHVlICogaG91cik7XG4gICAgICAgICAgICBicmVhaztcbiAgICAgICAgY2FzZSAnZGF5JzpcbiAgICAgICAgY2FzZSAnZGF5cyc6XG4gICAgICAgIGNhc2UgJ2QnOlxuICAgICAgICAgICAgbnVtZXJpY0RhdGUgPSBNYXRoLnJvdW5kKHZhbHVlICogZGF5KTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICBjYXNlICd3ZWVrJzpcbiAgICAgICAgY2FzZSAnd2Vla3MnOlxuICAgICAgICBjYXNlICd3JzpcbiAgICAgICAgICAgIG51bWVyaWNEYXRlID0gTWF0aC5yb3VuZCh2YWx1ZSAqIHdlZWspO1xuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICBudW1lcmljRGF0ZSA9IE1hdGgucm91bmQodmFsdWUgKiB5ZWFyKTtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgIH1cbiAgICBpZiAobWF0Y2hlZFsxXSA9PT0gJy0nIHx8IG1hdGNoZWRbNF0gPT09ICdhZ28nKSB7XG4gICAgICAgIHJldHVybiAtbnVtZXJpY0RhdGU7XG4gICAgfVxuICAgIHJldHVybiBudW1lcmljRGF0ZTtcbn07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/secs.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/sign.js":
/*!****************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/sign.js ***!
  \****************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _subtle_dsa_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./subtle_dsa.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/subtle_dsa.js\");\n/* harmony import */ var _check_key_length_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./check_key_length.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/check_key_length.js\");\n/* harmony import */ var _get_sign_verify_key_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./get_sign_verify_key.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/get_sign_verify_key.js\");\n\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (async (alg, key, data) => {\n    const cryptoKey = await (0,_get_sign_verify_key_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(alg, key, 'sign');\n    (0,_check_key_length_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(alg, cryptoKey);\n    const signature = await crypto.subtle.sign((0,_subtle_dsa_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(alg, cryptoKey.algorithm), cryptoKey, data);\n    return new Uint8Array(signature);\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL3NpZ24uanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUE4QztBQUNLO0FBQ0Q7QUFDbEQsaUVBQWU7QUFDZiw0QkFBNEIsbUVBQVU7QUFDdEMsSUFBSSxnRUFBYztBQUNsQiwrQ0FBK0MsMERBQWU7QUFDOUQ7QUFDQSxDQUFDLEVBQUMiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXG5vZGVfbW9kdWxlc1xcam9zZVxcZGlzdFxcd2ViYXBpXFxsaWJcXHNpZ24uanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHN1YnRsZUFsZ29yaXRobSBmcm9tICcuL3N1YnRsZV9kc2EuanMnO1xuaW1wb3J0IGNoZWNrS2V5TGVuZ3RoIGZyb20gJy4vY2hlY2tfa2V5X2xlbmd0aC5qcyc7XG5pbXBvcnQgZ2V0U2lnbktleSBmcm9tICcuL2dldF9zaWduX3ZlcmlmeV9rZXkuanMnO1xuZXhwb3J0IGRlZmF1bHQgYXN5bmMgKGFsZywga2V5LCBkYXRhKSA9PiB7XG4gICAgY29uc3QgY3J5cHRvS2V5ID0gYXdhaXQgZ2V0U2lnbktleShhbGcsIGtleSwgJ3NpZ24nKTtcbiAgICBjaGVja0tleUxlbmd0aChhbGcsIGNyeXB0b0tleSk7XG4gICAgY29uc3Qgc2lnbmF0dXJlID0gYXdhaXQgY3J5cHRvLnN1YnRsZS5zaWduKHN1YnRsZUFsZ29yaXRobShhbGcsIGNyeXB0b0tleS5hbGdvcml0aG0pLCBjcnlwdG9LZXksIGRhdGEpO1xuICAgIHJldHVybiBuZXcgVWludDhBcnJheShzaWduYXR1cmUpO1xufTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/sign.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/subtle_dsa.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/subtle_dsa.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _util_errors_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../util/errors.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/errors.js\");\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((alg, algorithm) => {\n    const hash = `SHA-${alg.slice(-3)}`;\n    switch (alg) {\n        case 'HS256':\n        case 'HS384':\n        case 'HS512':\n            return { hash, name: 'HMAC' };\n        case 'PS256':\n        case 'PS384':\n        case 'PS512':\n            return { hash, name: 'RSA-PSS', saltLength: parseInt(alg.slice(-3), 10) >> 3 };\n        case 'RS256':\n        case 'RS384':\n        case 'RS512':\n            return { hash, name: 'RSASSA-PKCS1-v1_5' };\n        case 'ES256':\n        case 'ES384':\n        case 'ES512':\n            return { hash, name: 'ECDSA', namedCurve: algorithm.namedCurve };\n        case 'Ed25519':\n        case 'EdDSA':\n            return { name: 'Ed25519' };\n        case 'ML-DSA-44':\n        case 'ML-DSA-65':\n        case 'ML-DSA-87':\n            return { name: alg };\n        default:\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JOSENotSupported(`alg ${alg} is not supported either by JOSE or your javascript runtime`);\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL3N1YnRsZV9kc2EuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBcUQ7QUFDckQsaUVBQWU7QUFDZix3QkFBd0IsY0FBYztBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0E7QUFDQSxxQkFBcUI7QUFDckI7QUFDQTtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBO0FBQ0EscUJBQXFCO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBLHFCQUFxQjtBQUNyQjtBQUNBLHNCQUFzQiw2REFBZ0IsUUFBUSxLQUFLO0FBQ25EO0FBQ0EsQ0FBQyxFQUFDIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxub2RlX21vZHVsZXNcXGpvc2VcXGRpc3RcXHdlYmFwaVxcbGliXFxzdWJ0bGVfZHNhLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEpPU0VOb3RTdXBwb3J0ZWQgfSBmcm9tICcuLi91dGlsL2Vycm9ycy5qcyc7XG5leHBvcnQgZGVmYXVsdCAoYWxnLCBhbGdvcml0aG0pID0+IHtcbiAgICBjb25zdCBoYXNoID0gYFNIQS0ke2FsZy5zbGljZSgtMyl9YDtcbiAgICBzd2l0Y2ggKGFsZykge1xuICAgICAgICBjYXNlICdIUzI1Nic6XG4gICAgICAgIGNhc2UgJ0hTMzg0JzpcbiAgICAgICAgY2FzZSAnSFM1MTInOlxuICAgICAgICAgICAgcmV0dXJuIHsgaGFzaCwgbmFtZTogJ0hNQUMnIH07XG4gICAgICAgIGNhc2UgJ1BTMjU2JzpcbiAgICAgICAgY2FzZSAnUFMzODQnOlxuICAgICAgICBjYXNlICdQUzUxMic6XG4gICAgICAgICAgICByZXR1cm4geyBoYXNoLCBuYW1lOiAnUlNBLVBTUycsIHNhbHRMZW5ndGg6IHBhcnNlSW50KGFsZy5zbGljZSgtMyksIDEwKSA+PiAzIH07XG4gICAgICAgIGNhc2UgJ1JTMjU2JzpcbiAgICAgICAgY2FzZSAnUlMzODQnOlxuICAgICAgICBjYXNlICdSUzUxMic6XG4gICAgICAgICAgICByZXR1cm4geyBoYXNoLCBuYW1lOiAnUlNBU1NBLVBLQ1MxLXYxXzUnIH07XG4gICAgICAgIGNhc2UgJ0VTMjU2JzpcbiAgICAgICAgY2FzZSAnRVMzODQnOlxuICAgICAgICBjYXNlICdFUzUxMic6XG4gICAgICAgICAgICByZXR1cm4geyBoYXNoLCBuYW1lOiAnRUNEU0EnLCBuYW1lZEN1cnZlOiBhbGdvcml0aG0ubmFtZWRDdXJ2ZSB9O1xuICAgICAgICBjYXNlICdFZDI1NTE5JzpcbiAgICAgICAgY2FzZSAnRWREU0EnOlxuICAgICAgICAgICAgcmV0dXJuIHsgbmFtZTogJ0VkMjU1MTknIH07XG4gICAgICAgIGNhc2UgJ01MLURTQS00NCc6XG4gICAgICAgIGNhc2UgJ01MLURTQS02NSc6XG4gICAgICAgIGNhc2UgJ01MLURTQS04Nyc6XG4gICAgICAgICAgICByZXR1cm4geyBuYW1lOiBhbGcgfTtcbiAgICAgICAgZGVmYXVsdDpcbiAgICAgICAgICAgIHRocm93IG5ldyBKT1NFTm90U3VwcG9ydGVkKGBhbGcgJHthbGd9IGlzIG5vdCBzdXBwb3J0ZWQgZWl0aGVyIGJ5IEpPU0Ugb3IgeW91ciBqYXZhc2NyaXB0IHJ1bnRpbWVgKTtcbiAgICB9XG59O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/subtle_dsa.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/validate_algorithms.js":
/*!*******************************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/validate_algorithms.js ***!
  \*******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((option, algorithms) => {\n    if (algorithms !== undefined &&\n        (!Array.isArray(algorithms) || algorithms.some((s) => typeof s !== 'string'))) {\n        throw new TypeError(`\"${option}\" option must be an array of strings`);\n    }\n    if (!algorithms) {\n        return undefined;\n    }\n    return new Set(algorithms);\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL3ZhbGlkYXRlX2FsZ29yaXRobXMuanMiLCJtYXBwaW5ncyI6Ijs7OztBQUFBLGlFQUFlO0FBQ2Y7QUFDQTtBQUNBLGdDQUFnQyxPQUFPO0FBQ3ZDO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLEVBQUMiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXG5vZGVfbW9kdWxlc1xcam9zZVxcZGlzdFxcd2ViYXBpXFxsaWJcXHZhbGlkYXRlX2FsZ29yaXRobXMuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgKG9wdGlvbiwgYWxnb3JpdGhtcykgPT4ge1xuICAgIGlmIChhbGdvcml0aG1zICE9PSB1bmRlZmluZWQgJiZcbiAgICAgICAgKCFBcnJheS5pc0FycmF5KGFsZ29yaXRobXMpIHx8IGFsZ29yaXRobXMuc29tZSgocykgPT4gdHlwZW9mIHMgIT09ICdzdHJpbmcnKSkpIHtcbiAgICAgICAgdGhyb3cgbmV3IFR5cGVFcnJvcihgXCIke29wdGlvbn1cIiBvcHRpb24gbXVzdCBiZSBhbiBhcnJheSBvZiBzdHJpbmdzYCk7XG4gICAgfVxuICAgIGlmICghYWxnb3JpdGhtcykge1xuICAgICAgICByZXR1cm4gdW5kZWZpbmVkO1xuICAgIH1cbiAgICByZXR1cm4gbmV3IFNldChhbGdvcml0aG1zKTtcbn07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/validate_algorithms.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/validate_crit.js":
/*!*************************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/validate_crit.js ***!
  \*************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _util_errors_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../util/errors.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/errors.js\");\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((Err, recognizedDefault, recognizedOption, protectedHeader, joseHeader) => {\n    if (joseHeader.crit !== undefined && protectedHeader?.crit === undefined) {\n        throw new Err('\"crit\" (Critical) Header Parameter MUST be integrity protected');\n    }\n    if (!protectedHeader || protectedHeader.crit === undefined) {\n        return new Set();\n    }\n    if (!Array.isArray(protectedHeader.crit) ||\n        protectedHeader.crit.length === 0 ||\n        protectedHeader.crit.some((input) => typeof input !== 'string' || input.length === 0)) {\n        throw new Err('\"crit\" (Critical) Header Parameter MUST be an array of non-empty strings when present');\n    }\n    let recognized;\n    if (recognizedOption !== undefined) {\n        recognized = new Map([...Object.entries(recognizedOption), ...recognizedDefault.entries()]);\n    }\n    else {\n        recognized = recognizedDefault;\n    }\n    for (const parameter of protectedHeader.crit) {\n        if (!recognized.has(parameter)) {\n            throw new _util_errors_js__WEBPACK_IMPORTED_MODULE_0__.JOSENotSupported(`Extension Header Parameter \"${parameter}\" is not recognized`);\n        }\n        if (joseHeader[parameter] === undefined) {\n            throw new Err(`Extension Header Parameter \"${parameter}\" is missing`);\n        }\n        if (recognized.get(parameter) && protectedHeader[parameter] === undefined) {\n            throw new Err(`Extension Header Parameter \"${parameter}\" MUST be integrity protected`);\n        }\n    }\n    return new Set(protectedHeader.crit);\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL3ZhbGlkYXRlX2NyaXQuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7QUFBNkU7QUFDN0UsaUVBQWU7QUFDZjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLDZEQUFnQixnQ0FBZ0MsVUFBVTtBQUNoRjtBQUNBO0FBQ0EseURBQXlELFVBQVU7QUFDbkU7QUFDQTtBQUNBLHlEQUF5RCxVQUFVO0FBQ25FO0FBQ0E7QUFDQTtBQUNBLENBQUMsRUFBQyIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcbm9kZV9tb2R1bGVzXFxqb3NlXFxkaXN0XFx3ZWJhcGlcXGxpYlxcdmFsaWRhdGVfY3JpdC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBKT1NFTm90U3VwcG9ydGVkLCBKV0VJbnZhbGlkLCBKV1NJbnZhbGlkIH0gZnJvbSAnLi4vdXRpbC9lcnJvcnMuanMnO1xuZXhwb3J0IGRlZmF1bHQgKEVyciwgcmVjb2duaXplZERlZmF1bHQsIHJlY29nbml6ZWRPcHRpb24sIHByb3RlY3RlZEhlYWRlciwgam9zZUhlYWRlcikgPT4ge1xuICAgIGlmIChqb3NlSGVhZGVyLmNyaXQgIT09IHVuZGVmaW5lZCAmJiBwcm90ZWN0ZWRIZWFkZXI/LmNyaXQgPT09IHVuZGVmaW5lZCkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyKCdcImNyaXRcIiAoQ3JpdGljYWwpIEhlYWRlciBQYXJhbWV0ZXIgTVVTVCBiZSBpbnRlZ3JpdHkgcHJvdGVjdGVkJyk7XG4gICAgfVxuICAgIGlmICghcHJvdGVjdGVkSGVhZGVyIHx8IHByb3RlY3RlZEhlYWRlci5jcml0ID09PSB1bmRlZmluZWQpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBTZXQoKTtcbiAgICB9XG4gICAgaWYgKCFBcnJheS5pc0FycmF5KHByb3RlY3RlZEhlYWRlci5jcml0KSB8fFxuICAgICAgICBwcm90ZWN0ZWRIZWFkZXIuY3JpdC5sZW5ndGggPT09IDAgfHxcbiAgICAgICAgcHJvdGVjdGVkSGVhZGVyLmNyaXQuc29tZSgoaW5wdXQpID0+IHR5cGVvZiBpbnB1dCAhPT0gJ3N0cmluZycgfHwgaW5wdXQubGVuZ3RoID09PSAwKSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyKCdcImNyaXRcIiAoQ3JpdGljYWwpIEhlYWRlciBQYXJhbWV0ZXIgTVVTVCBiZSBhbiBhcnJheSBvZiBub24tZW1wdHkgc3RyaW5ncyB3aGVuIHByZXNlbnQnKTtcbiAgICB9XG4gICAgbGV0IHJlY29nbml6ZWQ7XG4gICAgaWYgKHJlY29nbml6ZWRPcHRpb24gIT09IHVuZGVmaW5lZCkge1xuICAgICAgICByZWNvZ25pemVkID0gbmV3IE1hcChbLi4uT2JqZWN0LmVudHJpZXMocmVjb2duaXplZE9wdGlvbiksIC4uLnJlY29nbml6ZWREZWZhdWx0LmVudHJpZXMoKV0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgICAgcmVjb2duaXplZCA9IHJlY29nbml6ZWREZWZhdWx0O1xuICAgIH1cbiAgICBmb3IgKGNvbnN0IHBhcmFtZXRlciBvZiBwcm90ZWN0ZWRIZWFkZXIuY3JpdCkge1xuICAgICAgICBpZiAoIXJlY29nbml6ZWQuaGFzKHBhcmFtZXRlcikpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBKT1NFTm90U3VwcG9ydGVkKGBFeHRlbnNpb24gSGVhZGVyIFBhcmFtZXRlciBcIiR7cGFyYW1ldGVyfVwiIGlzIG5vdCByZWNvZ25pemVkYCk7XG4gICAgICAgIH1cbiAgICAgICAgaWYgKGpvc2VIZWFkZXJbcGFyYW1ldGVyXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyKGBFeHRlbnNpb24gSGVhZGVyIFBhcmFtZXRlciBcIiR7cGFyYW1ldGVyfVwiIGlzIG1pc3NpbmdgKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAocmVjb2duaXplZC5nZXQocGFyYW1ldGVyKSAmJiBwcm90ZWN0ZWRIZWFkZXJbcGFyYW1ldGVyXSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyKGBFeHRlbnNpb24gSGVhZGVyIFBhcmFtZXRlciBcIiR7cGFyYW1ldGVyfVwiIE1VU1QgYmUgaW50ZWdyaXR5IHByb3RlY3RlZGApO1xuICAgICAgICB9XG4gICAgfVxuICAgIHJldHVybiBuZXcgU2V0KHByb3RlY3RlZEhlYWRlci5jcml0KTtcbn07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/validate_crit.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/verify.js":
/*!******************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/lib/verify.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var _subtle_dsa_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./subtle_dsa.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/subtle_dsa.js\");\n/* harmony import */ var _check_key_length_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./check_key_length.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/check_key_length.js\");\n/* harmony import */ var _get_sign_verify_key_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./get_sign_verify_key.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/get_sign_verify_key.js\");\n\n\n\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (async (alg, key, signature, data) => {\n    const cryptoKey = await (0,_get_sign_verify_key_js__WEBPACK_IMPORTED_MODULE_0__[\"default\"])(alg, key, 'verify');\n    (0,_check_key_length_js__WEBPACK_IMPORTED_MODULE_1__[\"default\"])(alg, cryptoKey);\n    const algorithm = (0,_subtle_dsa_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(alg, cryptoKey.algorithm);\n    try {\n        return await crypto.subtle.verify(algorithm, cryptoKey, signature, data);\n    }\n    catch {\n        return false;\n    }\n});\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvbGliL3ZlcmlmeS5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQThDO0FBQ0s7QUFDQztBQUNwRCxpRUFBZTtBQUNmLDRCQUE0QixtRUFBWTtBQUN4QyxJQUFJLGdFQUFjO0FBQ2xCLHNCQUFzQiwwREFBZTtBQUNyQztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDLEVBQUMiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXG5vZGVfbW9kdWxlc1xcam9zZVxcZGlzdFxcd2ViYXBpXFxsaWJcXHZlcmlmeS5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgc3VidGxlQWxnb3JpdGhtIGZyb20gJy4vc3VidGxlX2RzYS5qcyc7XG5pbXBvcnQgY2hlY2tLZXlMZW5ndGggZnJvbSAnLi9jaGVja19rZXlfbGVuZ3RoLmpzJztcbmltcG9ydCBnZXRWZXJpZnlLZXkgZnJvbSAnLi9nZXRfc2lnbl92ZXJpZnlfa2V5LmpzJztcbmV4cG9ydCBkZWZhdWx0IGFzeW5jIChhbGcsIGtleSwgc2lnbmF0dXJlLCBkYXRhKSA9PiB7XG4gICAgY29uc3QgY3J5cHRvS2V5ID0gYXdhaXQgZ2V0VmVyaWZ5S2V5KGFsZywga2V5LCAndmVyaWZ5Jyk7XG4gICAgY2hlY2tLZXlMZW5ndGgoYWxnLCBjcnlwdG9LZXkpO1xuICAgIGNvbnN0IGFsZ29yaXRobSA9IHN1YnRsZUFsZ29yaXRobShhbGcsIGNyeXB0b0tleS5hbGdvcml0aG0pO1xuICAgIHRyeSB7XG4gICAgICAgIHJldHVybiBhd2FpdCBjcnlwdG8uc3VidGxlLnZlcmlmeShhbGdvcml0aG0sIGNyeXB0b0tleSwgc2lnbmF0dXJlLCBkYXRhKTtcbiAgICB9XG4gICAgY2F0Y2gge1xuICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxufTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/verify.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/base64url.js":
/*!**********************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/util/base64url.js ***!
  \**********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decode: () => (/* binding */ decode),\n/* harmony export */   encode: () => (/* binding */ encode)\n/* harmony export */ });\n/* harmony import */ var _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/buffer_utils.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/buffer_utils.js\");\n/* harmony import */ var _lib_base64_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../lib/base64.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/base64.js\");\n\n\nfunction decode(input) {\n    if (Uint8Array.fromBase64) {\n        return Uint8Array.fromBase64(typeof input === 'string' ? input : _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_0__.decoder.decode(input), {\n            alphabet: 'base64url',\n        });\n    }\n    let encoded = input;\n    if (encoded instanceof Uint8Array) {\n        encoded = _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_0__.decoder.decode(encoded);\n    }\n    encoded = encoded.replace(/-/g, '+').replace(/_/g, '/').replace(/\\s/g, '');\n    try {\n        return (0,_lib_base64_js__WEBPACK_IMPORTED_MODULE_1__.decodeBase64)(encoded);\n    }\n    catch {\n        throw new TypeError('The input to be decoded is not correctly encoded.');\n    }\n}\nfunction encode(input) {\n    let unencoded = input;\n    if (typeof unencoded === 'string') {\n        unencoded = _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_0__.encoder.encode(unencoded);\n    }\n    if (Uint8Array.prototype.toBase64) {\n        return unencoded.toBase64({ alphabet: 'base64url', omitPadding: true });\n    }\n    return (0,_lib_base64_js__WEBPACK_IMPORTED_MODULE_1__.encodeBase64)(unencoded).replace(/=/g, '').replace(/\\+/g, '-').replace(/\\//g, '_');\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvdXRpbC9iYXNlNjR1cmwuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUEwRDtBQUNJO0FBQ3ZEO0FBQ1A7QUFDQSx5RUFBeUUseURBQU87QUFDaEY7QUFDQSxTQUFTO0FBQ1Q7QUFDQTtBQUNBO0FBQ0Esa0JBQWtCLHlEQUFPO0FBQ3pCO0FBQ0E7QUFDQTtBQUNBLGVBQWUsNERBQVk7QUFDM0I7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBLG9CQUFvQix5REFBTztBQUMzQjtBQUNBO0FBQ0Esb0NBQW9DLDBDQUEwQztBQUM5RTtBQUNBLFdBQVcsNERBQVk7QUFDdkIiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXG5vZGVfbW9kdWxlc1xcam9zZVxcZGlzdFxcd2ViYXBpXFx1dGlsXFxiYXNlNjR1cmwuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZW5jb2RlciwgZGVjb2RlciB9IGZyb20gJy4uL2xpYi9idWZmZXJfdXRpbHMuanMnO1xuaW1wb3J0IHsgZW5jb2RlQmFzZTY0LCBkZWNvZGVCYXNlNjQgfSBmcm9tICcuLi9saWIvYmFzZTY0LmpzJztcbmV4cG9ydCBmdW5jdGlvbiBkZWNvZGUoaW5wdXQpIHtcbiAgICBpZiAoVWludDhBcnJheS5mcm9tQmFzZTY0KSB7XG4gICAgICAgIHJldHVybiBVaW50OEFycmF5LmZyb21CYXNlNjQodHlwZW9mIGlucHV0ID09PSAnc3RyaW5nJyA/IGlucHV0IDogZGVjb2Rlci5kZWNvZGUoaW5wdXQpLCB7XG4gICAgICAgICAgICBhbHBoYWJldDogJ2Jhc2U2NHVybCcsXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBsZXQgZW5jb2RlZCA9IGlucHV0O1xuICAgIGlmIChlbmNvZGVkIGluc3RhbmNlb2YgVWludDhBcnJheSkge1xuICAgICAgICBlbmNvZGVkID0gZGVjb2Rlci5kZWNvZGUoZW5jb2RlZCk7XG4gICAgfVxuICAgIGVuY29kZWQgPSBlbmNvZGVkLnJlcGxhY2UoLy0vZywgJysnKS5yZXBsYWNlKC9fL2csICcvJykucmVwbGFjZSgvXFxzL2csICcnKTtcbiAgICB0cnkge1xuICAgICAgICByZXR1cm4gZGVjb2RlQmFzZTY0KGVuY29kZWQpO1xuICAgIH1cbiAgICBjYXRjaCB7XG4gICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1RoZSBpbnB1dCB0byBiZSBkZWNvZGVkIGlzIG5vdCBjb3JyZWN0bHkgZW5jb2RlZC4nKTtcbiAgICB9XG59XG5leHBvcnQgZnVuY3Rpb24gZW5jb2RlKGlucHV0KSB7XG4gICAgbGV0IHVuZW5jb2RlZCA9IGlucHV0O1xuICAgIGlmICh0eXBlb2YgdW5lbmNvZGVkID09PSAnc3RyaW5nJykge1xuICAgICAgICB1bmVuY29kZWQgPSBlbmNvZGVyLmVuY29kZSh1bmVuY29kZWQpO1xuICAgIH1cbiAgICBpZiAoVWludDhBcnJheS5wcm90b3R5cGUudG9CYXNlNjQpIHtcbiAgICAgICAgcmV0dXJuIHVuZW5jb2RlZC50b0Jhc2U2NCh7IGFscGhhYmV0OiAnYmFzZTY0dXJsJywgb21pdFBhZGRpbmc6IHRydWUgfSk7XG4gICAgfVxuICAgIHJldHVybiBlbmNvZGVCYXNlNjQodW5lbmNvZGVkKS5yZXBsYWNlKC89L2csICcnKS5yZXBsYWNlKC9cXCsvZywgJy0nKS5yZXBsYWNlKC9cXC8vZywgJ18nKTtcbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/base64url.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/decode_jwt.js":
/*!***********************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/util/decode_jwt.js ***!
  \***********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decodeJwt: () => (/* binding */ decodeJwt)\n/* harmony export */ });\n/* harmony import */ var _base64url_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./base64url.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/base64url.js\");\n/* harmony import */ var _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../lib/buffer_utils.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/buffer_utils.js\");\n/* harmony import */ var _lib_is_object_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../lib/is_object.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_object.js\");\n/* harmony import */ var _errors_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./errors.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/errors.js\");\n\n\n\n\nfunction decodeJwt(jwt) {\n    if (typeof jwt !== 'string')\n        throw new _errors_js__WEBPACK_IMPORTED_MODULE_0__.JWTInvalid('JWTs must use Compact JWS serialization, JWT must be a string');\n    const { 1: payload, length } = jwt.split('.');\n    if (length === 5)\n        throw new _errors_js__WEBPACK_IMPORTED_MODULE_0__.JWTInvalid('Only JWTs using Compact JWS serialization can be decoded');\n    if (length !== 3)\n        throw new _errors_js__WEBPACK_IMPORTED_MODULE_0__.JWTInvalid('Invalid JWT');\n    if (!payload)\n        throw new _errors_js__WEBPACK_IMPORTED_MODULE_0__.JWTInvalid('JWTs must contain a payload');\n    let decoded;\n    try {\n        decoded = (0,_base64url_js__WEBPACK_IMPORTED_MODULE_1__.decode)(payload);\n    }\n    catch {\n        throw new _errors_js__WEBPACK_IMPORTED_MODULE_0__.JWTInvalid('Failed to base64url decode the payload');\n    }\n    let result;\n    try {\n        result = JSON.parse(_lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_2__.decoder.decode(decoded));\n    }\n    catch {\n        throw new _errors_js__WEBPACK_IMPORTED_MODULE_0__.JWTInvalid('Failed to parse the decoded payload as JSON');\n    }\n    if (!(0,_lib_is_object_js__WEBPACK_IMPORTED_MODULE_3__[\"default\"])(result))\n        throw new _errors_js__WEBPACK_IMPORTED_MODULE_0__.JWTInvalid('Invalid JWT Claims Set');\n    return result;\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvdXRpbC9kZWNvZGVfand0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7O0FBQWdEO0FBQ0M7QUFDTjtBQUNGO0FBQ2xDO0FBQ1A7QUFDQSxrQkFBa0Isa0RBQVU7QUFDNUIsWUFBWSxxQkFBcUI7QUFDakM7QUFDQSxrQkFBa0Isa0RBQVU7QUFDNUI7QUFDQSxrQkFBa0Isa0RBQVU7QUFDNUI7QUFDQSxrQkFBa0Isa0RBQVU7QUFDNUI7QUFDQTtBQUNBLGtCQUFrQixxREFBSTtBQUN0QjtBQUNBO0FBQ0Esa0JBQWtCLGtEQUFVO0FBQzVCO0FBQ0E7QUFDQTtBQUNBLDRCQUE0Qix5REFBTztBQUNuQztBQUNBO0FBQ0Esa0JBQWtCLGtEQUFVO0FBQzVCO0FBQ0EsU0FBUyw2REFBUTtBQUNqQixrQkFBa0Isa0RBQVU7QUFDNUI7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcbm9kZV9tb2R1bGVzXFxqb3NlXFxkaXN0XFx3ZWJhcGlcXHV0aWxcXGRlY29kZV9qd3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgZGVjb2RlIGFzIGI2NHUgfSBmcm9tICcuL2Jhc2U2NHVybC5qcyc7XG5pbXBvcnQgeyBkZWNvZGVyIH0gZnJvbSAnLi4vbGliL2J1ZmZlcl91dGlscy5qcyc7XG5pbXBvcnQgaXNPYmplY3QgZnJvbSAnLi4vbGliL2lzX29iamVjdC5qcyc7XG5pbXBvcnQgeyBKV1RJbnZhbGlkIH0gZnJvbSAnLi9lcnJvcnMuanMnO1xuZXhwb3J0IGZ1bmN0aW9uIGRlY29kZUp3dChqd3QpIHtcbiAgICBpZiAodHlwZW9mIGp3dCAhPT0gJ3N0cmluZycpXG4gICAgICAgIHRocm93IG5ldyBKV1RJbnZhbGlkKCdKV1RzIG11c3QgdXNlIENvbXBhY3QgSldTIHNlcmlhbGl6YXRpb24sIEpXVCBtdXN0IGJlIGEgc3RyaW5nJyk7XG4gICAgY29uc3QgeyAxOiBwYXlsb2FkLCBsZW5ndGggfSA9IGp3dC5zcGxpdCgnLicpO1xuICAgIGlmIChsZW5ndGggPT09IDUpXG4gICAgICAgIHRocm93IG5ldyBKV1RJbnZhbGlkKCdPbmx5IEpXVHMgdXNpbmcgQ29tcGFjdCBKV1Mgc2VyaWFsaXphdGlvbiBjYW4gYmUgZGVjb2RlZCcpO1xuICAgIGlmIChsZW5ndGggIT09IDMpXG4gICAgICAgIHRocm93IG5ldyBKV1RJbnZhbGlkKCdJbnZhbGlkIEpXVCcpO1xuICAgIGlmICghcGF5bG9hZClcbiAgICAgICAgdGhyb3cgbmV3IEpXVEludmFsaWQoJ0pXVHMgbXVzdCBjb250YWluIGEgcGF5bG9hZCcpO1xuICAgIGxldCBkZWNvZGVkO1xuICAgIHRyeSB7XG4gICAgICAgIGRlY29kZWQgPSBiNjR1KHBheWxvYWQpO1xuICAgIH1cbiAgICBjYXRjaCB7XG4gICAgICAgIHRocm93IG5ldyBKV1RJbnZhbGlkKCdGYWlsZWQgdG8gYmFzZTY0dXJsIGRlY29kZSB0aGUgcGF5bG9hZCcpO1xuICAgIH1cbiAgICBsZXQgcmVzdWx0O1xuICAgIHRyeSB7XG4gICAgICAgIHJlc3VsdCA9IEpTT04ucGFyc2UoZGVjb2Rlci5kZWNvZGUoZGVjb2RlZCkpO1xuICAgIH1cbiAgICBjYXRjaCB7XG4gICAgICAgIHRocm93IG5ldyBKV1RJbnZhbGlkKCdGYWlsZWQgdG8gcGFyc2UgdGhlIGRlY29kZWQgcGF5bG9hZCBhcyBKU09OJyk7XG4gICAgfVxuICAgIGlmICghaXNPYmplY3QocmVzdWx0KSlcbiAgICAgICAgdGhyb3cgbmV3IEpXVEludmFsaWQoJ0ludmFsaWQgSldUIENsYWltcyBTZXQnKTtcbiAgICByZXR1cm4gcmVzdWx0O1xufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/decode_jwt.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/decode_protected_header.js":
/*!************************************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/util/decode_protected_header.js ***!
  \************************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   decodeProtectedHeader: () => (/* binding */ decodeProtectedHeader)\n/* harmony export */ });\n/* harmony import */ var _base64url_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./base64url.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/base64url.js\");\n/* harmony import */ var _lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../lib/buffer_utils.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/buffer_utils.js\");\n/* harmony import */ var _lib_is_object_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../lib/is_object.js */ \"(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/lib/is_object.js\");\n\n\n\nfunction decodeProtectedHeader(token) {\n    let protectedB64u;\n    if (typeof token === 'string') {\n        const parts = token.split('.');\n        if (parts.length === 3 || parts.length === 5) {\n            ;\n            [protectedB64u] = parts;\n        }\n    }\n    else if (typeof token === 'object' && token) {\n        if ('protected' in token) {\n            protectedB64u = token.protected;\n        }\n        else {\n            throw new TypeError('Token does not contain a Protected Header');\n        }\n    }\n    try {\n        if (typeof protectedB64u !== 'string' || !protectedB64u) {\n            throw new Error();\n        }\n        const result = JSON.parse(_lib_buffer_utils_js__WEBPACK_IMPORTED_MODULE_0__.decoder.decode((0,_base64url_js__WEBPACK_IMPORTED_MODULE_1__.decode)(protectedB64u)));\n        if (!(0,_lib_is_object_js__WEBPACK_IMPORTED_MODULE_2__[\"default\"])(result)) {\n            throw new Error();\n        }\n        return result;\n    }\n    catch {\n        throw new TypeError('Invalid Token or Protected Header formatting');\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvdXRpbC9kZWNvZGVfcHJvdGVjdGVkX2hlYWRlci5qcyIsIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQWdEO0FBQ0M7QUFDTjtBQUNwQztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxrQ0FBa0MseURBQU8sUUFBUSxxREFBSTtBQUNyRCxhQUFhLDZEQUFRO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXG5vZGVfbW9kdWxlc1xcam9zZVxcZGlzdFxcd2ViYXBpXFx1dGlsXFxkZWNvZGVfcHJvdGVjdGVkX2hlYWRlci5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBkZWNvZGUgYXMgYjY0dSB9IGZyb20gJy4vYmFzZTY0dXJsLmpzJztcbmltcG9ydCB7IGRlY29kZXIgfSBmcm9tICcuLi9saWIvYnVmZmVyX3V0aWxzLmpzJztcbmltcG9ydCBpc09iamVjdCBmcm9tICcuLi9saWIvaXNfb2JqZWN0LmpzJztcbmV4cG9ydCBmdW5jdGlvbiBkZWNvZGVQcm90ZWN0ZWRIZWFkZXIodG9rZW4pIHtcbiAgICBsZXQgcHJvdGVjdGVkQjY0dTtcbiAgICBpZiAodHlwZW9mIHRva2VuID09PSAnc3RyaW5nJykge1xuICAgICAgICBjb25zdCBwYXJ0cyA9IHRva2VuLnNwbGl0KCcuJyk7XG4gICAgICAgIGlmIChwYXJ0cy5sZW5ndGggPT09IDMgfHwgcGFydHMubGVuZ3RoID09PSA1KSB7XG4gICAgICAgICAgICA7XG4gICAgICAgICAgICBbcHJvdGVjdGVkQjY0dV0gPSBwYXJ0cztcbiAgICAgICAgfVxuICAgIH1cbiAgICBlbHNlIGlmICh0eXBlb2YgdG9rZW4gPT09ICdvYmplY3QnICYmIHRva2VuKSB7XG4gICAgICAgIGlmICgncHJvdGVjdGVkJyBpbiB0b2tlbikge1xuICAgICAgICAgICAgcHJvdGVjdGVkQjY0dSA9IHRva2VuLnByb3RlY3RlZDtcbiAgICAgICAgfVxuICAgICAgICBlbHNlIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoJ1Rva2VuIGRvZXMgbm90IGNvbnRhaW4gYSBQcm90ZWN0ZWQgSGVhZGVyJyk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgdHJ5IHtcbiAgICAgICAgaWYgKHR5cGVvZiBwcm90ZWN0ZWRCNjR1ICE9PSAnc3RyaW5nJyB8fCAhcHJvdGVjdGVkQjY0dSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCk7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgcmVzdWx0ID0gSlNPTi5wYXJzZShkZWNvZGVyLmRlY29kZShiNjR1KHByb3RlY3RlZEI2NHUpKSk7XG4gICAgICAgIGlmICghaXNPYmplY3QocmVzdWx0KSkge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICB9XG4gICAgY2F0Y2gge1xuICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdJbnZhbGlkIFRva2VuIG9yIFByb3RlY3RlZCBIZWFkZXIgZm9ybWF0dGluZycpO1xuICAgIH1cbn1cbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/decode_protected_header.js\n");

/***/ }),

/***/ "(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/errors.js":
/*!*******************************************************************************!*\
  !*** ./node_modules/better-auth/node_modules/jose/dist/webapi/util/errors.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   JOSEAlgNotAllowed: () => (/* binding */ JOSEAlgNotAllowed),\n/* harmony export */   JOSEError: () => (/* binding */ JOSEError),\n/* harmony export */   JOSENotSupported: () => (/* binding */ JOSENotSupported),\n/* harmony export */   JWEDecryptionFailed: () => (/* binding */ JWEDecryptionFailed),\n/* harmony export */   JWEInvalid: () => (/* binding */ JWEInvalid),\n/* harmony export */   JWKInvalid: () => (/* binding */ JWKInvalid),\n/* harmony export */   JWKSInvalid: () => (/* binding */ JWKSInvalid),\n/* harmony export */   JWKSMultipleMatchingKeys: () => (/* binding */ JWKSMultipleMatchingKeys),\n/* harmony export */   JWKSNoMatchingKey: () => (/* binding */ JWKSNoMatchingKey),\n/* harmony export */   JWKSTimeout: () => (/* binding */ JWKSTimeout),\n/* harmony export */   JWSInvalid: () => (/* binding */ JWSInvalid),\n/* harmony export */   JWSSignatureVerificationFailed: () => (/* binding */ JWSSignatureVerificationFailed),\n/* harmony export */   JWTClaimValidationFailed: () => (/* binding */ JWTClaimValidationFailed),\n/* harmony export */   JWTExpired: () => (/* binding */ JWTExpired),\n/* harmony export */   JWTInvalid: () => (/* binding */ JWTInvalid)\n/* harmony export */ });\nclass JOSEError extends Error {\n    static code = 'ERR_JOSE_GENERIC';\n    code = 'ERR_JOSE_GENERIC';\n    constructor(message, options) {\n        super(message, options);\n        this.name = this.constructor.name;\n        Error.captureStackTrace?.(this, this.constructor);\n    }\n}\nclass JWTClaimValidationFailed extends JOSEError {\n    static code = 'ERR_JWT_CLAIM_VALIDATION_FAILED';\n    code = 'ERR_JWT_CLAIM_VALIDATION_FAILED';\n    claim;\n    reason;\n    payload;\n    constructor(message, payload, claim = 'unspecified', reason = 'unspecified') {\n        super(message, { cause: { claim, reason, payload } });\n        this.claim = claim;\n        this.reason = reason;\n        this.payload = payload;\n    }\n}\nclass JWTExpired extends JOSEError {\n    static code = 'ERR_JWT_EXPIRED';\n    code = 'ERR_JWT_EXPIRED';\n    claim;\n    reason;\n    payload;\n    constructor(message, payload, claim = 'unspecified', reason = 'unspecified') {\n        super(message, { cause: { claim, reason, payload } });\n        this.claim = claim;\n        this.reason = reason;\n        this.payload = payload;\n    }\n}\nclass JOSEAlgNotAllowed extends JOSEError {\n    static code = 'ERR_JOSE_ALG_NOT_ALLOWED';\n    code = 'ERR_JOSE_ALG_NOT_ALLOWED';\n}\nclass JOSENotSupported extends JOSEError {\n    static code = 'ERR_JOSE_NOT_SUPPORTED';\n    code = 'ERR_JOSE_NOT_SUPPORTED';\n}\nclass JWEDecryptionFailed extends JOSEError {\n    static code = 'ERR_JWE_DECRYPTION_FAILED';\n    code = 'ERR_JWE_DECRYPTION_FAILED';\n    constructor(message = 'decryption operation failed', options) {\n        super(message, options);\n    }\n}\nclass JWEInvalid extends JOSEError {\n    static code = 'ERR_JWE_INVALID';\n    code = 'ERR_JWE_INVALID';\n}\nclass JWSInvalid extends JOSEError {\n    static code = 'ERR_JWS_INVALID';\n    code = 'ERR_JWS_INVALID';\n}\nclass JWTInvalid extends JOSEError {\n    static code = 'ERR_JWT_INVALID';\n    code = 'ERR_JWT_INVALID';\n}\nclass JWKInvalid extends JOSEError {\n    static code = 'ERR_JWK_INVALID';\n    code = 'ERR_JWK_INVALID';\n}\nclass JWKSInvalid extends JOSEError {\n    static code = 'ERR_JWKS_INVALID';\n    code = 'ERR_JWKS_INVALID';\n}\nclass JWKSNoMatchingKey extends JOSEError {\n    static code = 'ERR_JWKS_NO_MATCHING_KEY';\n    code = 'ERR_JWKS_NO_MATCHING_KEY';\n    constructor(message = 'no applicable key found in the JSON Web Key Set', options) {\n        super(message, options);\n    }\n}\nclass JWKSMultipleMatchingKeys extends JOSEError {\n    [Symbol.asyncIterator];\n    static code = 'ERR_JWKS_MULTIPLE_MATCHING_KEYS';\n    code = 'ERR_JWKS_MULTIPLE_MATCHING_KEYS';\n    constructor(message = 'multiple matching keys found in the JSON Web Key Set', options) {\n        super(message, options);\n    }\n}\nclass JWKSTimeout extends JOSEError {\n    static code = 'ERR_JWKS_TIMEOUT';\n    code = 'ERR_JWKS_TIMEOUT';\n    constructor(message = 'request timed out', options) {\n        super(message, options);\n    }\n}\nclass JWSSignatureVerificationFailed extends JOSEError {\n    static code = 'ERR_JWS_SIGNATURE_VERIFICATION_FAILED';\n    code = 'ERR_JWS_SIGNATURE_VERIFICATION_FAILED';\n    constructor(message = 'signature verification failed', options) {\n        super(message, options);\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHJzYykvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvbm9kZV9tb2R1bGVzL2pvc2UvZGlzdC93ZWJhcGkvdXRpbC9lcnJvcnMuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQU87QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx5QkFBeUIsU0FBUywwQkFBMEI7QUFDNUQ7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EseUJBQXlCLFNBQVMsMEJBQTBCO0FBQzVEO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNPO0FBQ1A7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ087QUFDUDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDTztBQUNQO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcbm9kZV9tb2R1bGVzXFxqb3NlXFxkaXN0XFx3ZWJhcGlcXHV0aWxcXGVycm9ycy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgY2xhc3MgSk9TRUVycm9yIGV4dGVuZHMgRXJyb3Ige1xuICAgIHN0YXRpYyBjb2RlID0gJ0VSUl9KT1NFX0dFTkVSSUMnO1xuICAgIGNvZGUgPSAnRVJSX0pPU0VfR0VORVJJQyc7XG4gICAgY29uc3RydWN0b3IobWVzc2FnZSwgb3B0aW9ucykge1xuICAgICAgICBzdXBlcihtZXNzYWdlLCBvcHRpb25zKTtcbiAgICAgICAgdGhpcy5uYW1lID0gdGhpcy5jb25zdHJ1Y3Rvci5uYW1lO1xuICAgICAgICBFcnJvci5jYXB0dXJlU3RhY2tUcmFjZT8uKHRoaXMsIHRoaXMuY29uc3RydWN0b3IpO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBKV1RDbGFpbVZhbGlkYXRpb25GYWlsZWQgZXh0ZW5kcyBKT1NFRXJyb3Ige1xuICAgIHN0YXRpYyBjb2RlID0gJ0VSUl9KV1RfQ0xBSU1fVkFMSURBVElPTl9GQUlMRUQnO1xuICAgIGNvZGUgPSAnRVJSX0pXVF9DTEFJTV9WQUxJREFUSU9OX0ZBSUxFRCc7XG4gICAgY2xhaW07XG4gICAgcmVhc29uO1xuICAgIHBheWxvYWQ7XG4gICAgY29uc3RydWN0b3IobWVzc2FnZSwgcGF5bG9hZCwgY2xhaW0gPSAndW5zcGVjaWZpZWQnLCByZWFzb24gPSAndW5zcGVjaWZpZWQnKSB7XG4gICAgICAgIHN1cGVyKG1lc3NhZ2UsIHsgY2F1c2U6IHsgY2xhaW0sIHJlYXNvbiwgcGF5bG9hZCB9IH0pO1xuICAgICAgICB0aGlzLmNsYWltID0gY2xhaW07XG4gICAgICAgIHRoaXMucmVhc29uID0gcmVhc29uO1xuICAgICAgICB0aGlzLnBheWxvYWQgPSBwYXlsb2FkO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBKV1RFeHBpcmVkIGV4dGVuZHMgSk9TRUVycm9yIHtcbiAgICBzdGF0aWMgY29kZSA9ICdFUlJfSldUX0VYUElSRUQnO1xuICAgIGNvZGUgPSAnRVJSX0pXVF9FWFBJUkVEJztcbiAgICBjbGFpbTtcbiAgICByZWFzb247XG4gICAgcGF5bG9hZDtcbiAgICBjb25zdHJ1Y3RvcihtZXNzYWdlLCBwYXlsb2FkLCBjbGFpbSA9ICd1bnNwZWNpZmllZCcsIHJlYXNvbiA9ICd1bnNwZWNpZmllZCcpIHtcbiAgICAgICAgc3VwZXIobWVzc2FnZSwgeyBjYXVzZTogeyBjbGFpbSwgcmVhc29uLCBwYXlsb2FkIH0gfSk7XG4gICAgICAgIHRoaXMuY2xhaW0gPSBjbGFpbTtcbiAgICAgICAgdGhpcy5yZWFzb24gPSByZWFzb247XG4gICAgICAgIHRoaXMucGF5bG9hZCA9IHBheWxvYWQ7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIEpPU0VBbGdOb3RBbGxvd2VkIGV4dGVuZHMgSk9TRUVycm9yIHtcbiAgICBzdGF0aWMgY29kZSA9ICdFUlJfSk9TRV9BTEdfTk9UX0FMTE9XRUQnO1xuICAgIGNvZGUgPSAnRVJSX0pPU0VfQUxHX05PVF9BTExPV0VEJztcbn1cbmV4cG9ydCBjbGFzcyBKT1NFTm90U3VwcG9ydGVkIGV4dGVuZHMgSk9TRUVycm9yIHtcbiAgICBzdGF0aWMgY29kZSA9ICdFUlJfSk9TRV9OT1RfU1VQUE9SVEVEJztcbiAgICBjb2RlID0gJ0VSUl9KT1NFX05PVF9TVVBQT1JURUQnO1xufVxuZXhwb3J0IGNsYXNzIEpXRURlY3J5cHRpb25GYWlsZWQgZXh0ZW5kcyBKT1NFRXJyb3Ige1xuICAgIHN0YXRpYyBjb2RlID0gJ0VSUl9KV0VfREVDUllQVElPTl9GQUlMRUQnO1xuICAgIGNvZGUgPSAnRVJSX0pXRV9ERUNSWVBUSU9OX0ZBSUxFRCc7XG4gICAgY29uc3RydWN0b3IobWVzc2FnZSA9ICdkZWNyeXB0aW9uIG9wZXJhdGlvbiBmYWlsZWQnLCBvcHRpb25zKSB7XG4gICAgICAgIHN1cGVyKG1lc3NhZ2UsIG9wdGlvbnMpO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBKV0VJbnZhbGlkIGV4dGVuZHMgSk9TRUVycm9yIHtcbiAgICBzdGF0aWMgY29kZSA9ICdFUlJfSldFX0lOVkFMSUQnO1xuICAgIGNvZGUgPSAnRVJSX0pXRV9JTlZBTElEJztcbn1cbmV4cG9ydCBjbGFzcyBKV1NJbnZhbGlkIGV4dGVuZHMgSk9TRUVycm9yIHtcbiAgICBzdGF0aWMgY29kZSA9ICdFUlJfSldTX0lOVkFMSUQnO1xuICAgIGNvZGUgPSAnRVJSX0pXU19JTlZBTElEJztcbn1cbmV4cG9ydCBjbGFzcyBKV1RJbnZhbGlkIGV4dGVuZHMgSk9TRUVycm9yIHtcbiAgICBzdGF0aWMgY29kZSA9ICdFUlJfSldUX0lOVkFMSUQnO1xuICAgIGNvZGUgPSAnRVJSX0pXVF9JTlZBTElEJztcbn1cbmV4cG9ydCBjbGFzcyBKV0tJbnZhbGlkIGV4dGVuZHMgSk9TRUVycm9yIHtcbiAgICBzdGF0aWMgY29kZSA9ICdFUlJfSldLX0lOVkFMSUQnO1xuICAgIGNvZGUgPSAnRVJSX0pXS19JTlZBTElEJztcbn1cbmV4cG9ydCBjbGFzcyBKV0tTSW52YWxpZCBleHRlbmRzIEpPU0VFcnJvciB7XG4gICAgc3RhdGljIGNvZGUgPSAnRVJSX0pXS1NfSU5WQUxJRCc7XG4gICAgY29kZSA9ICdFUlJfSldLU19JTlZBTElEJztcbn1cbmV4cG9ydCBjbGFzcyBKV0tTTm9NYXRjaGluZ0tleSBleHRlbmRzIEpPU0VFcnJvciB7XG4gICAgc3RhdGljIGNvZGUgPSAnRVJSX0pXS1NfTk9fTUFUQ0hJTkdfS0VZJztcbiAgICBjb2RlID0gJ0VSUl9KV0tTX05PX01BVENISU5HX0tFWSc7XG4gICAgY29uc3RydWN0b3IobWVzc2FnZSA9ICdubyBhcHBsaWNhYmxlIGtleSBmb3VuZCBpbiB0aGUgSlNPTiBXZWIgS2V5IFNldCcsIG9wdGlvbnMpIHtcbiAgICAgICAgc3VwZXIobWVzc2FnZSwgb3B0aW9ucyk7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIEpXS1NNdWx0aXBsZU1hdGNoaW5nS2V5cyBleHRlbmRzIEpPU0VFcnJvciB7XG4gICAgW1N5bWJvbC5hc3luY0l0ZXJhdG9yXTtcbiAgICBzdGF0aWMgY29kZSA9ICdFUlJfSldLU19NVUxUSVBMRV9NQVRDSElOR19LRVlTJztcbiAgICBjb2RlID0gJ0VSUl9KV0tTX01VTFRJUExFX01BVENISU5HX0tFWVMnO1xuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2UgPSAnbXVsdGlwbGUgbWF0Y2hpbmcga2V5cyBmb3VuZCBpbiB0aGUgSlNPTiBXZWIgS2V5IFNldCcsIG9wdGlvbnMpIHtcbiAgICAgICAgc3VwZXIobWVzc2FnZSwgb3B0aW9ucyk7XG4gICAgfVxufVxuZXhwb3J0IGNsYXNzIEpXS1NUaW1lb3V0IGV4dGVuZHMgSk9TRUVycm9yIHtcbiAgICBzdGF0aWMgY29kZSA9ICdFUlJfSldLU19USU1FT1VUJztcbiAgICBjb2RlID0gJ0VSUl9KV0tTX1RJTUVPVVQnO1xuICAgIGNvbnN0cnVjdG9yKG1lc3NhZ2UgPSAncmVxdWVzdCB0aW1lZCBvdXQnLCBvcHRpb25zKSB7XG4gICAgICAgIHN1cGVyKG1lc3NhZ2UsIG9wdGlvbnMpO1xuICAgIH1cbn1cbmV4cG9ydCBjbGFzcyBKV1NTaWduYXR1cmVWZXJpZmljYXRpb25GYWlsZWQgZXh0ZW5kcyBKT1NFRXJyb3Ige1xuICAgIHN0YXRpYyBjb2RlID0gJ0VSUl9KV1NfU0lHTkFUVVJFX1ZFUklGSUNBVElPTl9GQUlMRUQnO1xuICAgIGNvZGUgPSAnRVJSX0pXU19TSUdOQVRVUkVfVkVSSUZJQ0FUSU9OX0ZBSUxFRCc7XG4gICAgY29uc3RydWN0b3IobWVzc2FnZSA9ICdzaWduYXR1cmUgdmVyaWZpY2F0aW9uIGZhaWxlZCcsIG9wdGlvbnMpIHtcbiAgICAgICAgc3VwZXIobWVzc2FnZSwgb3B0aW9ucyk7XG4gICAgfVxufVxuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(rsc)/./node_modules/better-auth/node_modules/jose/dist/webapi/util/errors.js\n");

/***/ }),

/***/ "(ssr)/./node_modules/better-auth/dist/client/react/index.mjs":
/*!**************************************************************!*\
  !*** ./node_modules/better-auth/dist/client/react/index.mjs ***!
  \**************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   capitalizeFirstLetter: () => (/* binding */ capitalizeFirstLetter),\n/* harmony export */   createAuthClient: () => (/* binding */ createAuthClient),\n/* harmony export */   useStore: () => (/* binding */ useStore)\n/* harmony export */ });\n/* harmony import */ var _shared_better_auth_D7Ni8r_z_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../shared/better-auth.D7Ni8r_z.mjs */ \"(ssr)/./node_modules/better-auth/dist/shared/better-auth.D7Ni8r_z.mjs\");\n/* harmony import */ var nanostores__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! nanostores */ \"(ssr)/./node_modules/nanostores/listen-keys/index.js\");\n/* harmony import */ var react__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! react */ \"(ssr)/./node_modules/next/dist/server/route-modules/app-page/vendored/ssr/react.js\");\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! @better-fetch/fetch */ \"(ssr)/./node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var _shared_better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../shared/better-auth.CuS_eDdK.mjs */ \"(ssr)/./node_modules/better-auth/dist/shared/better-auth.CuS_eDdK.mjs\");\n/* harmony import */ var _shared_better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../shared/better-auth.CMQ3rA-I.mjs */ \"(ssr)/./node_modules/better-auth/dist/shared/better-auth.CMQ3rA-I.mjs\");\n/* harmony import */ var _shared_better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../shared/better-auth.DdzSJf-n.mjs */ \"(ssr)/./node_modules/better-auth/dist/shared/better-auth.DdzSJf-n.mjs\");\n/* harmony import */ var _shared_better_auth_CkGsgrvv_mjs__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../shared/better-auth.CkGsgrvv.mjs */ \"(ssr)/./node_modules/better-auth/dist/shared/better-auth.CkGsgrvv.mjs\");\n/* harmony import */ var _shared_better_auth_ffWeg50w_mjs__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../shared/better-auth.ffWeg50w.mjs */ \"(ssr)/./node_modules/better-auth/dist/shared/better-auth.ffWeg50w.mjs\");\n\n\n\n\n\n\n\n\n\n\nfunction useStore(store, options = {}) {\n  let snapshotRef = (0,react__WEBPACK_IMPORTED_MODULE_1__.useRef)(store.get());\n  const { keys, deps = [store, keys] } = options;\n  let subscribe = (0,react__WEBPACK_IMPORTED_MODULE_1__.useCallback)((onChange) => {\n    const emitChange = (value) => {\n      if (snapshotRef.current === value) return;\n      snapshotRef.current = value;\n      onChange();\n    };\n    emitChange(store.value);\n    if (keys?.length) {\n      return (0,nanostores__WEBPACK_IMPORTED_MODULE_8__.listenKeys)(store, keys, emitChange);\n    }\n    return store.listen(emitChange);\n  }, deps);\n  let get = () => snapshotRef.current;\n  return (0,react__WEBPACK_IMPORTED_MODULE_1__.useSyncExternalStore)(subscribe, get, get);\n}\n\nfunction getAtomKey(str) {\n  return `use${capitalizeFirstLetter(str)}`;\n}\nfunction capitalizeFirstLetter(str) {\n  return str.charAt(0).toUpperCase() + str.slice(1);\n}\nfunction createAuthClient(options) {\n  const {\n    pluginPathMethods,\n    pluginsActions,\n    pluginsAtoms,\n    $fetch,\n    $store,\n    atomListeners\n  } = (0,_shared_better_auth_D7Ni8r_z_mjs__WEBPACK_IMPORTED_MODULE_0__.g)(options);\n  let resolvedHooks = {};\n  for (const [key, value] of Object.entries(pluginsAtoms)) {\n    resolvedHooks[getAtomKey(key)] = () => useStore(value);\n  }\n  const routes = {\n    ...pluginsActions,\n    ...resolvedHooks,\n    $fetch,\n    $store\n  };\n  const proxy = (0,_shared_better_auth_D7Ni8r_z_mjs__WEBPACK_IMPORTED_MODULE_0__.c)(\n    routes,\n    $fetch,\n    pluginPathMethods,\n    pluginsAtoms,\n    atomListeners\n  );\n  return proxy;\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9jbGllbnQvcmVhY3QvaW5kZXgubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7OztBQUEwRztBQUNsRTtBQUMwQjtBQUNyQztBQUNrQjtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUUvQyxxQ0FBcUM7QUFDckMsb0JBQW9CLDZDQUFNO0FBQzFCLFVBQVUsNkJBQTZCO0FBQ3ZDLGtCQUFrQixrREFBVztBQUM3QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsc0RBQVU7QUFDdkI7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBLFNBQVMsMkRBQW9CO0FBQzdCOztBQUVBO0FBQ0EsZUFBZSwyQkFBMkI7QUFDMUM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSSxFQUFFLG1FQUFlO0FBQ3JCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0JBQWdCLG1FQUFzQjtBQUN0QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQUU2RCIsInNvdXJjZXMiOlsiQzpcXFVzZXJzXFxhdGhhcnZhXFxEZXNrdG9wXFxTd2FzdGhBSVxcbm9kZV9tb2R1bGVzXFxiZXR0ZXItYXV0aFxcZGlzdFxcY2xpZW50XFxyZWFjdFxcaW5kZXgubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGcgYXMgZ2V0Q2xpZW50Q29uZmlnLCBjIGFzIGNyZWF0ZUR5bmFtaWNQYXRoUHJveHkgfSBmcm9tICcuLi8uLi9zaGFyZWQvYmV0dGVyLWF1dGguRDdOaThyX3oubWpzJztcbmltcG9ydCB7IGxpc3RlbktleXMgfSBmcm9tICduYW5vc3RvcmVzJztcbmltcG9ydCB7IHVzZVJlZiwgdXNlQ2FsbGJhY2ssIHVzZVN5bmNFeHRlcm5hbFN0b3JlIH0gZnJvbSAncmVhY3QnO1xuaW1wb3J0ICdAYmV0dGVyLWZldGNoL2ZldGNoJztcbmltcG9ydCAnLi4vLi4vc2hhcmVkL2JldHRlci1hdXRoLkN1U19lRGRLLm1qcyc7XG5pbXBvcnQgJy4uLy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5DTVEzckEtSS5tanMnO1xuaW1wb3J0ICcuLi8uLi9zaGFyZWQvYmV0dGVyLWF1dGguRGR6U0pmLW4ubWpzJztcbmltcG9ydCAnLi4vLi4vc2hhcmVkL2JldHRlci1hdXRoLkNrR3NncnZ2Lm1qcyc7XG5pbXBvcnQgJy4uLy4uL3NoYXJlZC9iZXR0ZXItYXV0aC5mZldlZzUwdy5tanMnO1xuXG5mdW5jdGlvbiB1c2VTdG9yZShzdG9yZSwgb3B0aW9ucyA9IHt9KSB7XG4gIGxldCBzbmFwc2hvdFJlZiA9IHVzZVJlZihzdG9yZS5nZXQoKSk7XG4gIGNvbnN0IHsga2V5cywgZGVwcyA9IFtzdG9yZSwga2V5c10gfSA9IG9wdGlvbnM7XG4gIGxldCBzdWJzY3JpYmUgPSB1c2VDYWxsYmFjaygob25DaGFuZ2UpID0+IHtcbiAgICBjb25zdCBlbWl0Q2hhbmdlID0gKHZhbHVlKSA9PiB7XG4gICAgICBpZiAoc25hcHNob3RSZWYuY3VycmVudCA9PT0gdmFsdWUpIHJldHVybjtcbiAgICAgIHNuYXBzaG90UmVmLmN1cnJlbnQgPSB2YWx1ZTtcbiAgICAgIG9uQ2hhbmdlKCk7XG4gICAgfTtcbiAgICBlbWl0Q2hhbmdlKHN0b3JlLnZhbHVlKTtcbiAgICBpZiAoa2V5cz8ubGVuZ3RoKSB7XG4gICAgICByZXR1cm4gbGlzdGVuS2V5cyhzdG9yZSwga2V5cywgZW1pdENoYW5nZSk7XG4gICAgfVxuICAgIHJldHVybiBzdG9yZS5saXN0ZW4oZW1pdENoYW5nZSk7XG4gIH0sIGRlcHMpO1xuICBsZXQgZ2V0ID0gKCkgPT4gc25hcHNob3RSZWYuY3VycmVudDtcbiAgcmV0dXJuIHVzZVN5bmNFeHRlcm5hbFN0b3JlKHN1YnNjcmliZSwgZ2V0LCBnZXQpO1xufVxuXG5mdW5jdGlvbiBnZXRBdG9tS2V5KHN0cikge1xuICByZXR1cm4gYHVzZSR7Y2FwaXRhbGl6ZUZpcnN0TGV0dGVyKHN0cil9YDtcbn1cbmZ1bmN0aW9uIGNhcGl0YWxpemVGaXJzdExldHRlcihzdHIpIHtcbiAgcmV0dXJuIHN0ci5jaGFyQXQoMCkudG9VcHBlckNhc2UoKSArIHN0ci5zbGljZSgxKTtcbn1cbmZ1bmN0aW9uIGNyZWF0ZUF1dGhDbGllbnQob3B0aW9ucykge1xuICBjb25zdCB7XG4gICAgcGx1Z2luUGF0aE1ldGhvZHMsXG4gICAgcGx1Z2luc0FjdGlvbnMsXG4gICAgcGx1Z2luc0F0b21zLFxuICAgICRmZXRjaCxcbiAgICAkc3RvcmUsXG4gICAgYXRvbUxpc3RlbmVyc1xuICB9ID0gZ2V0Q2xpZW50Q29uZmlnKG9wdGlvbnMpO1xuICBsZXQgcmVzb2x2ZWRIb29rcyA9IHt9O1xuICBmb3IgKGNvbnN0IFtrZXksIHZhbHVlXSBvZiBPYmplY3QuZW50cmllcyhwbHVnaW5zQXRvbXMpKSB7XG4gICAgcmVzb2x2ZWRIb29rc1tnZXRBdG9tS2V5KGtleSldID0gKCkgPT4gdXNlU3RvcmUodmFsdWUpO1xuICB9XG4gIGNvbnN0IHJvdXRlcyA9IHtcbiAgICAuLi5wbHVnaW5zQWN0aW9ucyxcbiAgICAuLi5yZXNvbHZlZEhvb2tzLFxuICAgICRmZXRjaCxcbiAgICAkc3RvcmVcbiAgfTtcbiAgY29uc3QgcHJveHkgPSBjcmVhdGVEeW5hbWljUGF0aFByb3h5KFxuICAgIHJvdXRlcyxcbiAgICAkZmV0Y2gsXG4gICAgcGx1Z2luUGF0aE1ldGhvZHMsXG4gICAgcGx1Z2luc0F0b21zLFxuICAgIGF0b21MaXN0ZW5lcnNcbiAgKTtcbiAgcmV0dXJuIHByb3h5O1xufVxuXG5leHBvcnQgeyBjYXBpdGFsaXplRmlyc3RMZXR0ZXIsIGNyZWF0ZUF1dGhDbGllbnQsIHVzZVN0b3JlIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/better-auth/dist/client/react/index.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/better-auth/dist/shared/better-auth.CMQ3rA-I.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.CMQ3rA-I.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   E: () => (/* binding */ ENV),\n/* harmony export */   a: () => (/* binding */ isProduction),\n/* harmony export */   b: () => (/* binding */ isDevelopment),\n/* harmony export */   c: () => (/* binding */ getBooleanEnvVar),\n/* harmony export */   e: () => (/* binding */ env),\n/* harmony export */   g: () => (/* binding */ getEnvVar),\n/* harmony export */   i: () => (/* binding */ isTest)\n/* harmony export */ });\nconst _envShim = /* @__PURE__ */ Object.create(null);\nconst _getEnv = (useShim) => globalThis.process?.env || //@ts-expect-error\nglobalThis.Deno?.env.toObject() || //@ts-expect-error\nglobalThis.__env__ || (useShim ? _envShim : globalThis);\nconst env = new Proxy(_envShim, {\n  get(_, prop) {\n    const env2 = _getEnv();\n    return env2[prop] ?? _envShim[prop];\n  },\n  has(_, prop) {\n    const env2 = _getEnv();\n    return prop in env2 || prop in _envShim;\n  },\n  set(_, prop, value) {\n    const env2 = _getEnv(true);\n    env2[prop] = value;\n    return true;\n  },\n  deleteProperty(_, prop) {\n    if (!prop) {\n      return false;\n    }\n    const env2 = _getEnv(true);\n    delete env2[prop];\n    return true;\n  },\n  ownKeys() {\n    const env2 = _getEnv(true);\n    return Object.keys(env2);\n  }\n});\nfunction toBoolean(val) {\n  return val ? val !== \"false\" : false;\n}\nconst nodeENV = typeof process !== \"undefined\" && process.env && \"development\" || \"\";\nconst isProduction = nodeENV === \"production\";\nconst isDevelopment = nodeENV === \"dev\" || nodeENV === \"development\";\nconst isTest = () => nodeENV === \"test\" || toBoolean(env.TEST);\nfunction getEnvVar(key, fallback) {\n  if (typeof process !== \"undefined\" && process.env) {\n    return process.env[key] ?? fallback;\n  }\n  if (typeof Deno !== \"undefined\") {\n    return Deno.env.get(key) ?? fallback;\n  }\n  if (typeof Bun !== \"undefined\") {\n    return Bun.env[key] ?? fallback;\n  }\n  return fallback;\n}\nfunction getBooleanEnvVar(key, fallback = true) {\n  const value = getEnvVar(key);\n  if (!value) return fallback;\n  return value !== \"0\" && value.toLowerCase() !== \"false\" && value !== \"\";\n}\nconst ENV = {\n  get BETTER_AUTH_TELEMETRY_ENDPOINT() {\n    return getEnvVar(\n      \"BETTER_AUTH_TELEMETRY_ENDPOINT\",\n      \"https://telemetry.better-auth.com/v1/track\"\n    );\n  }\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQ01RM3JBLUkubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsR0FBRztBQUNIO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBLENBQUM7QUFDRDtBQUNBO0FBQ0E7QUFDQSxpRUFBaUUsYUFBb0I7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRXlIIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxzaGFyZWRcXGJldHRlci1hdXRoLkNNUTNyQS1JLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjb25zdCBfZW52U2hpbSA9IC8qIEBfX1BVUkVfXyAqLyBPYmplY3QuY3JlYXRlKG51bGwpO1xuY29uc3QgX2dldEVudiA9ICh1c2VTaGltKSA9PiBnbG9iYWxUaGlzLnByb2Nlc3M/LmVudiB8fCAvL0B0cy1leHBlY3QtZXJyb3Jcbmdsb2JhbFRoaXMuRGVubz8uZW52LnRvT2JqZWN0KCkgfHwgLy9AdHMtZXhwZWN0LWVycm9yXG5nbG9iYWxUaGlzLl9fZW52X18gfHwgKHVzZVNoaW0gPyBfZW52U2hpbSA6IGdsb2JhbFRoaXMpO1xuY29uc3QgZW52ID0gbmV3IFByb3h5KF9lbnZTaGltLCB7XG4gIGdldChfLCBwcm9wKSB7XG4gICAgY29uc3QgZW52MiA9IF9nZXRFbnYoKTtcbiAgICByZXR1cm4gZW52Mltwcm9wXSA/PyBfZW52U2hpbVtwcm9wXTtcbiAgfSxcbiAgaGFzKF8sIHByb3ApIHtcbiAgICBjb25zdCBlbnYyID0gX2dldEVudigpO1xuICAgIHJldHVybiBwcm9wIGluIGVudjIgfHwgcHJvcCBpbiBfZW52U2hpbTtcbiAgfSxcbiAgc2V0KF8sIHByb3AsIHZhbHVlKSB7XG4gICAgY29uc3QgZW52MiA9IF9nZXRFbnYodHJ1ZSk7XG4gICAgZW52Mltwcm9wXSA9IHZhbHVlO1xuICAgIHJldHVybiB0cnVlO1xuICB9LFxuICBkZWxldGVQcm9wZXJ0eShfLCBwcm9wKSB7XG4gICAgaWYgKCFwcm9wKSB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICAgIGNvbnN0IGVudjIgPSBfZ2V0RW52KHRydWUpO1xuICAgIGRlbGV0ZSBlbnYyW3Byb3BdO1xuICAgIHJldHVybiB0cnVlO1xuICB9LFxuICBvd25LZXlzKCkge1xuICAgIGNvbnN0IGVudjIgPSBfZ2V0RW52KHRydWUpO1xuICAgIHJldHVybiBPYmplY3Qua2V5cyhlbnYyKTtcbiAgfVxufSk7XG5mdW5jdGlvbiB0b0Jvb2xlYW4odmFsKSB7XG4gIHJldHVybiB2YWwgPyB2YWwgIT09IFwiZmFsc2VcIiA6IGZhbHNlO1xufVxuY29uc3Qgbm9kZUVOViA9IHR5cGVvZiBwcm9jZXNzICE9PSBcInVuZGVmaW5lZFwiICYmIHByb2Nlc3MuZW52ICYmIHByb2Nlc3MuZW52Lk5PREVfRU5WIHx8IFwiXCI7XG5jb25zdCBpc1Byb2R1Y3Rpb24gPSBub2RlRU5WID09PSBcInByb2R1Y3Rpb25cIjtcbmNvbnN0IGlzRGV2ZWxvcG1lbnQgPSBub2RlRU5WID09PSBcImRldlwiIHx8IG5vZGVFTlYgPT09IFwiZGV2ZWxvcG1lbnRcIjtcbmNvbnN0IGlzVGVzdCA9ICgpID0+IG5vZGVFTlYgPT09IFwidGVzdFwiIHx8IHRvQm9vbGVhbihlbnYuVEVTVCk7XG5mdW5jdGlvbiBnZXRFbnZWYXIoa2V5LCBmYWxsYmFjaykge1xuICBpZiAodHlwZW9mIHByb2Nlc3MgIT09IFwidW5kZWZpbmVkXCIgJiYgcHJvY2Vzcy5lbnYpIHtcbiAgICByZXR1cm4gcHJvY2Vzcy5lbnZba2V5XSA/PyBmYWxsYmFjaztcbiAgfVxuICBpZiAodHlwZW9mIERlbm8gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICByZXR1cm4gRGVuby5lbnYuZ2V0KGtleSkgPz8gZmFsbGJhY2s7XG4gIH1cbiAgaWYgKHR5cGVvZiBCdW4gIT09IFwidW5kZWZpbmVkXCIpIHtcbiAgICByZXR1cm4gQnVuLmVudltrZXldID8/IGZhbGxiYWNrO1xuICB9XG4gIHJldHVybiBmYWxsYmFjaztcbn1cbmZ1bmN0aW9uIGdldEJvb2xlYW5FbnZWYXIoa2V5LCBmYWxsYmFjayA9IHRydWUpIHtcbiAgY29uc3QgdmFsdWUgPSBnZXRFbnZWYXIoa2V5KTtcbiAgaWYgKCF2YWx1ZSkgcmV0dXJuIGZhbGxiYWNrO1xuICByZXR1cm4gdmFsdWUgIT09IFwiMFwiICYmIHZhbHVlLnRvTG93ZXJDYXNlKCkgIT09IFwiZmFsc2VcIiAmJiB2YWx1ZSAhPT0gXCJcIjtcbn1cbmNvbnN0IEVOViA9IHtcbiAgZ2V0IEJFVFRFUl9BVVRIX1RFTEVNRVRSWV9FTkRQT0lOVCgpIHtcbiAgICByZXR1cm4gZ2V0RW52VmFyKFxuICAgICAgXCJCRVRURVJfQVVUSF9URUxFTUVUUllfRU5EUE9JTlRcIixcbiAgICAgIFwiaHR0cHM6Ly90ZWxlbWV0cnkuYmV0dGVyLWF1dGguY29tL3YxL3RyYWNrXCJcbiAgICApO1xuICB9XG59O1xuXG5leHBvcnQgeyBFTlYgYXMgRSwgaXNQcm9kdWN0aW9uIGFzIGEsIGlzRGV2ZWxvcG1lbnQgYXMgYiwgZ2V0Qm9vbGVhbkVudlZhciBhcyBjLCBlbnYgYXMgZSwgZ2V0RW52VmFyIGFzIGcsIGlzVGVzdCBhcyBpIH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/better-auth/dist/shared/better-auth.CMQ3rA-I.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/better-auth/dist/shared/better-auth.CkGsgrvv.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.CkGsgrvv.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   u: () => (/* binding */ useAuthQuery)\n/* harmony export */ });\n/* harmony import */ var nanostores__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! nanostores */ \"(ssr)/./node_modules/nanostores/atom/index.js\");\n/* harmony import */ var nanostores__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! nanostores */ \"(ssr)/./node_modules/nanostores/lifecycle/index.js\");\n\n\nconst isServer = typeof window === \"undefined\";\nconst useAuthQuery = (initializedAtom, path, $fetch, options) => {\n  const value = (0,nanostores__WEBPACK_IMPORTED_MODULE_0__.atom)({\n    data: null,\n    error: null,\n    isPending: true,\n    isRefetching: false,\n    refetch: (queryParams) => {\n      return fn(queryParams);\n    }\n  });\n  const fn = (queryParams) => {\n    const opts = typeof options === \"function\" ? options({\n      data: value.get().data,\n      error: value.get().error,\n      isPending: value.get().isPending\n    }) : options;\n    $fetch(path, {\n      ...opts,\n      query: {\n        ...opts?.query,\n        ...queryParams?.query\n      },\n      async onSuccess(context) {\n        value.set({\n          data: context.data,\n          error: null,\n          isPending: false,\n          isRefetching: false,\n          refetch: value.value.refetch\n        });\n        await opts?.onSuccess?.(context);\n      },\n      async onError(context) {\n        const { request } = context;\n        const retryAttempts = typeof request.retry === \"number\" ? request.retry : request.retry?.attempts;\n        const retryAttempt = request.retryAttempt || 0;\n        if (retryAttempts && retryAttempt < retryAttempts) return;\n        value.set({\n          error: context.error,\n          data: null,\n          isPending: false,\n          isRefetching: false,\n          refetch: value.value.refetch\n        });\n        await opts?.onError?.(context);\n      },\n      async onRequest(context) {\n        const currentValue = value.get();\n        value.set({\n          isPending: currentValue.data === null,\n          data: currentValue.data,\n          error: null,\n          isRefetching: true,\n          refetch: value.value.refetch\n        });\n        await opts?.onRequest?.(context);\n      }\n    }).catch((error) => {\n      value.set({\n        error,\n        data: null,\n        isPending: false,\n        isRefetching: false,\n        refetch: value.value.refetch\n      });\n    });\n  };\n  initializedAtom = Array.isArray(initializedAtom) ? initializedAtom : [initializedAtom];\n  let isMounted = false;\n  for (const initAtom of initializedAtom) {\n    initAtom.subscribe(() => {\n      if (isServer) {\n        return;\n      }\n      if (isMounted) {\n        fn();\n      } else {\n        (0,nanostores__WEBPACK_IMPORTED_MODULE_1__.onMount)(value, () => {\n          setTimeout(() => {\n            fn();\n          }, 0);\n          isMounted = true;\n          return () => {\n            value.off();\n            initAtom.off();\n          };\n        });\n      }\n    });\n  }\n  return value;\n};\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQ2tHc2dydnYubWpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUEyQzs7QUFFM0M7QUFDQTtBQUNBLGdCQUFnQixnREFBSTtBQUNwQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEdBQUc7QUFDSDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxPQUFPO0FBQ1A7QUFDQSxnQkFBZ0IsVUFBVTtBQUMxQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUFTO0FBQ1Q7QUFDQSxPQUFPO0FBQ1A7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLE9BQU87QUFDUCxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxRQUFRO0FBQ1IsUUFBUSxtREFBTztBQUNmO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRTZCIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxzaGFyZWRcXGJldHRlci1hdXRoLkNrR3NncnZ2Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBhdG9tLCBvbk1vdW50IH0gZnJvbSAnbmFub3N0b3Jlcyc7XG5cbmNvbnN0IGlzU2VydmVyID0gdHlwZW9mIHdpbmRvdyA9PT0gXCJ1bmRlZmluZWRcIjtcbmNvbnN0IHVzZUF1dGhRdWVyeSA9IChpbml0aWFsaXplZEF0b20sIHBhdGgsICRmZXRjaCwgb3B0aW9ucykgPT4ge1xuICBjb25zdCB2YWx1ZSA9IGF0b20oe1xuICAgIGRhdGE6IG51bGwsXG4gICAgZXJyb3I6IG51bGwsXG4gICAgaXNQZW5kaW5nOiB0cnVlLFxuICAgIGlzUmVmZXRjaGluZzogZmFsc2UsXG4gICAgcmVmZXRjaDogKHF1ZXJ5UGFyYW1zKSA9PiB7XG4gICAgICByZXR1cm4gZm4ocXVlcnlQYXJhbXMpO1xuICAgIH1cbiAgfSk7XG4gIGNvbnN0IGZuID0gKHF1ZXJ5UGFyYW1zKSA9PiB7XG4gICAgY29uc3Qgb3B0cyA9IHR5cGVvZiBvcHRpb25zID09PSBcImZ1bmN0aW9uXCIgPyBvcHRpb25zKHtcbiAgICAgIGRhdGE6IHZhbHVlLmdldCgpLmRhdGEsXG4gICAgICBlcnJvcjogdmFsdWUuZ2V0KCkuZXJyb3IsXG4gICAgICBpc1BlbmRpbmc6IHZhbHVlLmdldCgpLmlzUGVuZGluZ1xuICAgIH0pIDogb3B0aW9ucztcbiAgICAkZmV0Y2gocGF0aCwge1xuICAgICAgLi4ub3B0cyxcbiAgICAgIHF1ZXJ5OiB7XG4gICAgICAgIC4uLm9wdHM/LnF1ZXJ5LFxuICAgICAgICAuLi5xdWVyeVBhcmFtcz8ucXVlcnlcbiAgICAgIH0sXG4gICAgICBhc3luYyBvblN1Y2Nlc3MoY29udGV4dCkge1xuICAgICAgICB2YWx1ZS5zZXQoe1xuICAgICAgICAgIGRhdGE6IGNvbnRleHQuZGF0YSxcbiAgICAgICAgICBlcnJvcjogbnVsbCxcbiAgICAgICAgICBpc1BlbmRpbmc6IGZhbHNlLFxuICAgICAgICAgIGlzUmVmZXRjaGluZzogZmFsc2UsXG4gICAgICAgICAgcmVmZXRjaDogdmFsdWUudmFsdWUucmVmZXRjaFxuICAgICAgICB9KTtcbiAgICAgICAgYXdhaXQgb3B0cz8ub25TdWNjZXNzPy4oY29udGV4dCk7XG4gICAgICB9LFxuICAgICAgYXN5bmMgb25FcnJvcihjb250ZXh0KSB7XG4gICAgICAgIGNvbnN0IHsgcmVxdWVzdCB9ID0gY29udGV4dDtcbiAgICAgICAgY29uc3QgcmV0cnlBdHRlbXB0cyA9IHR5cGVvZiByZXF1ZXN0LnJldHJ5ID09PSBcIm51bWJlclwiID8gcmVxdWVzdC5yZXRyeSA6IHJlcXVlc3QucmV0cnk/LmF0dGVtcHRzO1xuICAgICAgICBjb25zdCByZXRyeUF0dGVtcHQgPSByZXF1ZXN0LnJldHJ5QXR0ZW1wdCB8fCAwO1xuICAgICAgICBpZiAocmV0cnlBdHRlbXB0cyAmJiByZXRyeUF0dGVtcHQgPCByZXRyeUF0dGVtcHRzKSByZXR1cm47XG4gICAgICAgIHZhbHVlLnNldCh7XG4gICAgICAgICAgZXJyb3I6IGNvbnRleHQuZXJyb3IsXG4gICAgICAgICAgZGF0YTogbnVsbCxcbiAgICAgICAgICBpc1BlbmRpbmc6IGZhbHNlLFxuICAgICAgICAgIGlzUmVmZXRjaGluZzogZmFsc2UsXG4gICAgICAgICAgcmVmZXRjaDogdmFsdWUudmFsdWUucmVmZXRjaFxuICAgICAgICB9KTtcbiAgICAgICAgYXdhaXQgb3B0cz8ub25FcnJvcj8uKGNvbnRleHQpO1xuICAgICAgfSxcbiAgICAgIGFzeW5jIG9uUmVxdWVzdChjb250ZXh0KSB7XG4gICAgICAgIGNvbnN0IGN1cnJlbnRWYWx1ZSA9IHZhbHVlLmdldCgpO1xuICAgICAgICB2YWx1ZS5zZXQoe1xuICAgICAgICAgIGlzUGVuZGluZzogY3VycmVudFZhbHVlLmRhdGEgPT09IG51bGwsXG4gICAgICAgICAgZGF0YTogY3VycmVudFZhbHVlLmRhdGEsXG4gICAgICAgICAgZXJyb3I6IG51bGwsXG4gICAgICAgICAgaXNSZWZldGNoaW5nOiB0cnVlLFxuICAgICAgICAgIHJlZmV0Y2g6IHZhbHVlLnZhbHVlLnJlZmV0Y2hcbiAgICAgICAgfSk7XG4gICAgICAgIGF3YWl0IG9wdHM/Lm9uUmVxdWVzdD8uKGNvbnRleHQpO1xuICAgICAgfVxuICAgIH0pLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgdmFsdWUuc2V0KHtcbiAgICAgICAgZXJyb3IsXG4gICAgICAgIGRhdGE6IG51bGwsXG4gICAgICAgIGlzUGVuZGluZzogZmFsc2UsXG4gICAgICAgIGlzUmVmZXRjaGluZzogZmFsc2UsXG4gICAgICAgIHJlZmV0Y2g6IHZhbHVlLnZhbHVlLnJlZmV0Y2hcbiAgICAgIH0pO1xuICAgIH0pO1xuICB9O1xuICBpbml0aWFsaXplZEF0b20gPSBBcnJheS5pc0FycmF5KGluaXRpYWxpemVkQXRvbSkgPyBpbml0aWFsaXplZEF0b20gOiBbaW5pdGlhbGl6ZWRBdG9tXTtcbiAgbGV0IGlzTW91bnRlZCA9IGZhbHNlO1xuICBmb3IgKGNvbnN0IGluaXRBdG9tIG9mIGluaXRpYWxpemVkQXRvbSkge1xuICAgIGluaXRBdG9tLnN1YnNjcmliZSgoKSA9PiB7XG4gICAgICBpZiAoaXNTZXJ2ZXIpIHtcbiAgICAgICAgcmV0dXJuO1xuICAgICAgfVxuICAgICAgaWYgKGlzTW91bnRlZCkge1xuICAgICAgICBmbigpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgb25Nb3VudCh2YWx1ZSwgKCkgPT4ge1xuICAgICAgICAgIHNldFRpbWVvdXQoKCkgPT4ge1xuICAgICAgICAgICAgZm4oKTtcbiAgICAgICAgICB9LCAwKTtcbiAgICAgICAgICBpc01vdW50ZWQgPSB0cnVlO1xuICAgICAgICAgIHJldHVybiAoKSA9PiB7XG4gICAgICAgICAgICB2YWx1ZS5vZmYoKTtcbiAgICAgICAgICAgIGluaXRBdG9tLm9mZigpO1xuICAgICAgICAgIH07XG4gICAgICAgIH0pO1xuICAgICAgfVxuICAgIH0pO1xuICB9XG4gIHJldHVybiB2YWx1ZTtcbn07XG5cbmV4cG9ydCB7IHVzZUF1dGhRdWVyeSBhcyB1IH07XG4iXSwibmFtZXMiOltdLCJpZ25vcmVMaXN0IjpbMF0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/better-auth/dist/shared/better-auth.CkGsgrvv.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/better-auth/dist/shared/better-auth.CuS_eDdK.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.CuS_eDdK.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   a: () => (/* binding */ getBaseURL),\n/* harmony export */   b: () => (/* binding */ getHost),\n/* harmony export */   c: () => (/* binding */ getProtocol),\n/* harmony export */   g: () => (/* binding */ getOrigin)\n/* harmony export */ });\n/* harmony import */ var _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./better-auth.CMQ3rA-I.mjs */ \"(ssr)/./node_modules/better-auth/dist/shared/better-auth.CMQ3rA-I.mjs\");\n/* harmony import */ var _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./better-auth.DdzSJf-n.mjs */ \"(ssr)/./node_modules/better-auth/dist/shared/better-auth.DdzSJf-n.mjs\");\n\n\n\nfunction checkHasPath(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.pathname !== \"/\";\n  } catch (error) {\n    throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_1__.B(\n      `Invalid base URL: ${url}. Please provide a valid base URL.`\n    );\n  }\n}\nfunction withPath(url, path = \"/api/auth\") {\n  const hasPath = checkHasPath(url);\n  if (hasPath) {\n    return url;\n  }\n  path = path.startsWith(\"/\") ? path : `/${path}`;\n  return `${url.replace(/\\/+$/, \"\")}${path}`;\n}\nfunction getBaseURL(url, path, request) {\n  if (url) {\n    return withPath(url, path);\n  }\n  const fromEnv = _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_0__.e.BETTER_AUTH_URL || _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_0__.e.NEXT_PUBLIC_BETTER_AUTH_URL || _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_0__.e.PUBLIC_BETTER_AUTH_URL || _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_0__.e.NUXT_PUBLIC_BETTER_AUTH_URL || _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_0__.e.NUXT_PUBLIC_AUTH_URL || (_better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_0__.e.BASE_URL !== \"/\" ? _better_auth_CMQ3rA_I_mjs__WEBPACK_IMPORTED_MODULE_0__.e.BASE_URL : void 0);\n  if (fromEnv) {\n    return withPath(fromEnv, path);\n  }\n  const fromRequest = request?.headers.get(\"x-forwarded-host\");\n  const fromRequestProto = request?.headers.get(\"x-forwarded-proto\");\n  if (fromRequest && fromRequestProto) {\n    return withPath(`${fromRequestProto}://${fromRequest}`, path);\n  }\n  if (request) {\n    const url2 = getOrigin(request.url);\n    if (!url2) {\n      throw new _better_auth_DdzSJf_n_mjs__WEBPACK_IMPORTED_MODULE_1__.B(\n        \"Could not get origin from request. Please provide a valid base URL.\"\n      );\n    }\n    return withPath(url2, path);\n  }\n  if (typeof window !== \"undefined\" && window.location) {\n    return withPath(window.location.origin, path);\n  }\n  return void 0;\n}\nfunction getOrigin(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.origin;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getProtocol(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.protocol;\n  } catch (error) {\n    return null;\n  }\n}\nfunction getHost(url) {\n  try {\n    const parsedUrl = new URL(url);\n    return parsedUrl.host;\n  } catch (error) {\n    return url;\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguQ3VTX2VEZEsubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7OztBQUFzRDtBQUNZOztBQUVsRTtBQUNBO0FBQ0E7QUFDQTtBQUNBLElBQUk7QUFDSixjQUFjLHdEQUFlO0FBQzdCLDJCQUEyQixJQUFJO0FBQy9CO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSwyQ0FBMkMsS0FBSztBQUNoRCxZQUFZLHdCQUF3QixFQUFFLEtBQUs7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGtCQUFrQix3REFBRyxvQkFBb0Isd0RBQUcsZ0NBQWdDLHdEQUFHLDJCQUEyQix3REFBRyxnQ0FBZ0Msd0RBQUcsMEJBQTBCLHdEQUFHLG9CQUFvQix3REFBRztBQUNwTTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSx1QkFBdUIsaUJBQWlCLEtBQUssWUFBWTtBQUN6RDtBQUNBO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQix3REFBZTtBQUMvQjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTs7QUFFMkUiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXGRpc3RcXHNoYXJlZFxcYmV0dGVyLWF1dGguQ3VTX2VEZEsubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGUgYXMgZW52IH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5DTVEzckEtSS5tanMnO1xuaW1wb3J0IHsgQiBhcyBCZXR0ZXJBdXRoRXJyb3IgfSBmcm9tICcuL2JldHRlci1hdXRoLkRkelNKZi1uLm1qcyc7XG5cbmZ1bmN0aW9uIGNoZWNrSGFzUGF0aCh1cmwpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKHVybCk7XG4gICAgcmV0dXJuIHBhcnNlZFVybC5wYXRobmFtZSAhPT0gXCIvXCI7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgIGBJbnZhbGlkIGJhc2UgVVJMOiAke3VybH0uIFBsZWFzZSBwcm92aWRlIGEgdmFsaWQgYmFzZSBVUkwuYFxuICAgICk7XG4gIH1cbn1cbmZ1bmN0aW9uIHdpdGhQYXRoKHVybCwgcGF0aCA9IFwiL2FwaS9hdXRoXCIpIHtcbiAgY29uc3QgaGFzUGF0aCA9IGNoZWNrSGFzUGF0aCh1cmwpO1xuICBpZiAoaGFzUGF0aCkge1xuICAgIHJldHVybiB1cmw7XG4gIH1cbiAgcGF0aCA9IHBhdGguc3RhcnRzV2l0aChcIi9cIikgPyBwYXRoIDogYC8ke3BhdGh9YDtcbiAgcmV0dXJuIGAke3VybC5yZXBsYWNlKC9cXC8rJC8sIFwiXCIpfSR7cGF0aH1gO1xufVxuZnVuY3Rpb24gZ2V0QmFzZVVSTCh1cmwsIHBhdGgsIHJlcXVlc3QpIHtcbiAgaWYgKHVybCkge1xuICAgIHJldHVybiB3aXRoUGF0aCh1cmwsIHBhdGgpO1xuICB9XG4gIGNvbnN0IGZyb21FbnYgPSBlbnYuQkVUVEVSX0FVVEhfVVJMIHx8IGVudi5ORVhUX1BVQkxJQ19CRVRURVJfQVVUSF9VUkwgfHwgZW52LlBVQkxJQ19CRVRURVJfQVVUSF9VUkwgfHwgZW52Lk5VWFRfUFVCTElDX0JFVFRFUl9BVVRIX1VSTCB8fCBlbnYuTlVYVF9QVUJMSUNfQVVUSF9VUkwgfHwgKGVudi5CQVNFX1VSTCAhPT0gXCIvXCIgPyBlbnYuQkFTRV9VUkwgOiB2b2lkIDApO1xuICBpZiAoZnJvbUVudikge1xuICAgIHJldHVybiB3aXRoUGF0aChmcm9tRW52LCBwYXRoKTtcbiAgfVxuICBjb25zdCBmcm9tUmVxdWVzdCA9IHJlcXVlc3Q/LmhlYWRlcnMuZ2V0KFwieC1mb3J3YXJkZWQtaG9zdFwiKTtcbiAgY29uc3QgZnJvbVJlcXVlc3RQcm90byA9IHJlcXVlc3Q/LmhlYWRlcnMuZ2V0KFwieC1mb3J3YXJkZWQtcHJvdG9cIik7XG4gIGlmIChmcm9tUmVxdWVzdCAmJiBmcm9tUmVxdWVzdFByb3RvKSB7XG4gICAgcmV0dXJuIHdpdGhQYXRoKGAke2Zyb21SZXF1ZXN0UHJvdG99Oi8vJHtmcm9tUmVxdWVzdH1gLCBwYXRoKTtcbiAgfVxuICBpZiAocmVxdWVzdCkge1xuICAgIGNvbnN0IHVybDIgPSBnZXRPcmlnaW4ocmVxdWVzdC51cmwpO1xuICAgIGlmICghdXJsMikge1xuICAgICAgdGhyb3cgbmV3IEJldHRlckF1dGhFcnJvcihcbiAgICAgICAgXCJDb3VsZCBub3QgZ2V0IG9yaWdpbiBmcm9tIHJlcXVlc3QuIFBsZWFzZSBwcm92aWRlIGEgdmFsaWQgYmFzZSBVUkwuXCJcbiAgICAgICk7XG4gICAgfVxuICAgIHJldHVybiB3aXRoUGF0aCh1cmwyLCBwYXRoKTtcbiAgfVxuICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gXCJ1bmRlZmluZWRcIiAmJiB3aW5kb3cubG9jYXRpb24pIHtcbiAgICByZXR1cm4gd2l0aFBhdGgod2luZG93LmxvY2F0aW9uLm9yaWdpbiwgcGF0aCk7XG4gIH1cbiAgcmV0dXJuIHZvaWQgMDtcbn1cbmZ1bmN0aW9uIGdldE9yaWdpbih1cmwpIHtcbiAgdHJ5IHtcbiAgICBjb25zdCBwYXJzZWRVcmwgPSBuZXcgVVJMKHVybCk7XG4gICAgcmV0dXJuIHBhcnNlZFVybC5vcmlnaW47XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbn1cbmZ1bmN0aW9uIGdldFByb3RvY29sKHVybCkge1xuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZFVybCA9IG5ldyBVUkwodXJsKTtcbiAgICByZXR1cm4gcGFyc2VkVXJsLnByb3RvY29sO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5mdW5jdGlvbiBnZXRIb3N0KHVybCkge1xuICB0cnkge1xuICAgIGNvbnN0IHBhcnNlZFVybCA9IG5ldyBVUkwodXJsKTtcbiAgICByZXR1cm4gcGFyc2VkVXJsLmhvc3Q7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgcmV0dXJuIHVybDtcbiAgfVxufVxuXG5leHBvcnQgeyBnZXRCYXNlVVJMIGFzIGEsIGdldEhvc3QgYXMgYiwgZ2V0UHJvdG9jb2wgYXMgYywgZ2V0T3JpZ2luIGFzIGcgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/better-auth/dist/shared/better-auth.CuS_eDdK.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/better-auth/dist/shared/better-auth.D7Ni8r_z.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.D7Ni8r_z.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   c: () => (/* binding */ createDynamicPathProxy),\n/* harmony export */   g: () => (/* binding */ getClientConfig)\n/* harmony export */ });\n/* harmony import */ var _better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @better-fetch/fetch */ \"(ssr)/./node_modules/@better-fetch/fetch/dist/index.js\");\n/* harmony import */ var _better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./better-auth.CuS_eDdK.mjs */ \"(ssr)/./node_modules/better-auth/dist/shared/better-auth.CuS_eDdK.mjs\");\n/* harmony import */ var nanostores__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! nanostores */ \"(ssr)/./node_modules/nanostores/atom/index.js\");\n/* harmony import */ var _better_auth_CkGsgrvv_mjs__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./better-auth.CkGsgrvv.mjs */ \"(ssr)/./node_modules/better-auth/dist/shared/better-auth.CkGsgrvv.mjs\");\n/* harmony import */ var _better_auth_ffWeg50w_mjs__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./better-auth.ffWeg50w.mjs */ \"(ssr)/./node_modules/better-auth/dist/shared/better-auth.ffWeg50w.mjs\");\n\n\n\n\n\n\nconst redirectPlugin = {\n  id: \"redirect\",\n  name: \"Redirect\",\n  hooks: {\n    onSuccess(context) {\n      if (context.data?.url && context.data?.redirect) {\n        if (typeof window !== \"undefined\" && window.location) {\n          if (window.location) {\n            try {\n              window.location.href = context.data.url;\n            } catch {\n            }\n          }\n        }\n      }\n    }\n  }\n};\n\nfunction getSessionAtom($fetch) {\n  const $signal = (0,nanostores__WEBPACK_IMPORTED_MODULE_4__.atom)(false);\n  const session = (0,_better_auth_CkGsgrvv_mjs__WEBPACK_IMPORTED_MODULE_2__.u)($signal, \"/get-session\", $fetch, {\n    method: \"GET\"\n  });\n  return {\n    session,\n    $sessionSignal: $signal\n  };\n}\n\nconst getClientConfig = (options) => {\n  const isCredentialsSupported = \"credentials\" in Request.prototype;\n  const baseURL = (0,_better_auth_CuS_eDdK_mjs__WEBPACK_IMPORTED_MODULE_1__.a)(options?.baseURL, options?.basePath);\n  const pluginsFetchPlugins = options?.plugins?.flatMap((plugin) => plugin.fetchPlugins).filter((pl) => pl !== void 0) || [];\n  const lifeCyclePlugin = {\n    id: \"lifecycle-hooks\",\n    name: \"lifecycle-hooks\",\n    hooks: {\n      onSuccess: options?.fetchOptions?.onSuccess,\n      onError: options?.fetchOptions?.onError,\n      onRequest: options?.fetchOptions?.onRequest,\n      onResponse: options?.fetchOptions?.onResponse\n    }\n  };\n  const { onSuccess, onError, onRequest, onResponse, ...restOfFetchOptions } = options?.fetchOptions || {};\n  const $fetch = (0,_better_fetch_fetch__WEBPACK_IMPORTED_MODULE_0__.createFetch)({\n    baseURL,\n    ...isCredentialsSupported ? { credentials: \"include\" } : {},\n    method: \"GET\",\n    jsonParser(text) {\n      if (!text) {\n        return null;\n      }\n      return (0,_better_auth_ffWeg50w_mjs__WEBPACK_IMPORTED_MODULE_3__.p)(text, {\n        strict: false\n      });\n    },\n    customFetchImpl: fetch,\n    ...restOfFetchOptions,\n    plugins: [\n      lifeCyclePlugin,\n      ...restOfFetchOptions.plugins || [],\n      ...options?.disableDefaultFetchPlugins ? [] : [redirectPlugin],\n      ...pluginsFetchPlugins\n    ]\n  });\n  const { $sessionSignal, session } = getSessionAtom($fetch);\n  const plugins = options?.plugins || [];\n  let pluginsActions = {};\n  let pluginsAtoms = {\n    $sessionSignal,\n    session\n  };\n  let pluginPathMethods = {\n    \"/sign-out\": \"POST\",\n    \"/revoke-sessions\": \"POST\",\n    \"/revoke-other-sessions\": \"POST\",\n    \"/delete-user\": \"POST\"\n  };\n  const atomListeners = [\n    {\n      signal: \"$sessionSignal\",\n      matcher(path) {\n        return path === \"/sign-out\" || path === \"/update-user\" || path.startsWith(\"/sign-in\") || path.startsWith(\"/sign-up\") || path === \"/delete-user\" || path === \"/verify-email\";\n      }\n    }\n  ];\n  for (const plugin of plugins) {\n    if (plugin.getAtoms) {\n      Object.assign(pluginsAtoms, plugin.getAtoms?.($fetch));\n    }\n    if (plugin.pathMethods) {\n      Object.assign(pluginPathMethods, plugin.pathMethods);\n    }\n    if (plugin.atomListeners) {\n      atomListeners.push(...plugin.atomListeners);\n    }\n  }\n  const $store = {\n    notify: (signal) => {\n      pluginsAtoms[signal].set(\n        !pluginsAtoms[signal].get()\n      );\n    },\n    listen: (signal, listener) => {\n      pluginsAtoms[signal].subscribe(listener);\n    },\n    atoms: pluginsAtoms\n  };\n  for (const plugin of plugins) {\n    if (plugin.getActions) {\n      Object.assign(\n        pluginsActions,\n        plugin.getActions?.($fetch, $store, options)\n      );\n    }\n  }\n  return {\n    pluginsActions,\n    pluginsAtoms,\n    pluginPathMethods,\n    atomListeners,\n    $fetch,\n    $store\n  };\n};\n\nfunction isAtom(value) {\n  return typeof value === \"object\" && value !== null && \"get\" in value && typeof value.get === \"function\" && \"lc\" in value && typeof value.lc === \"number\";\n}\n\nfunction getMethod(path, knownPathMethods, args) {\n  const method = knownPathMethods[path];\n  const { fetchOptions, query, ...body } = args || {};\n  if (method) {\n    return method;\n  }\n  if (fetchOptions?.method) {\n    return fetchOptions.method;\n  }\n  if (body && Object.keys(body).length > 0) {\n    return \"POST\";\n  }\n  return \"GET\";\n}\nfunction createDynamicPathProxy(routes, client, knownPathMethods, atoms, atomListeners) {\n  function createProxy(path = []) {\n    return new Proxy(function() {\n    }, {\n      get(target, prop) {\n        if (prop === \"then\" || prop === \"catch\" || prop === \"finally\") {\n          return void 0;\n        }\n        const fullPath = [...path, prop];\n        let current = routes;\n        for (const segment of fullPath) {\n          if (current && typeof current === \"object\" && segment in current) {\n            current = current[segment];\n          } else {\n            current = void 0;\n            break;\n          }\n        }\n        if (typeof current === \"function\") {\n          return current;\n        }\n        if (isAtom(current)) {\n          return current;\n        }\n        return createProxy(fullPath);\n      },\n      apply: async (_, __, args) => {\n        const routePath = \"/\" + path.map(\n          (segment) => segment.replace(/[A-Z]/g, (letter) => `-${letter.toLowerCase()}`)\n        ).join(\"/\");\n        const arg = args[0] || {};\n        const fetchOptions = args[1] || {};\n        const { query, fetchOptions: argFetchOptions, ...body } = arg;\n        const options = {\n          ...fetchOptions,\n          ...argFetchOptions\n        };\n        const method = getMethod(routePath, knownPathMethods, arg);\n        return await client(routePath, {\n          ...options,\n          body: method === \"GET\" ? void 0 : {\n            ...body,\n            ...options?.body || {}\n          },\n          query: query || options?.query,\n          method,\n          async onSuccess(context) {\n            await options?.onSuccess?.(context);\n            const matches = atomListeners?.find((s) => s.matcher(routePath));\n            if (!matches) return;\n            const signal = atoms[matches.signal];\n            if (!signal) return;\n            const val = signal.get();\n            setTimeout(() => {\n              signal.set(!val);\n            }, 10);\n          }\n        });\n      }\n    });\n  }\n  return createProxy();\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguRDdOaThyX3oubWpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7QUFBa0Q7QUFDVztBQUMzQjtBQUM2QjtBQUNIOztBQUU1RDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGNBQWM7QUFDZDtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBLGtCQUFrQixnREFBSTtBQUN0QixrQkFBa0IsNERBQVk7QUFDOUI7QUFDQSxHQUFHO0FBQ0g7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7QUFFQTtBQUNBO0FBQ0Esa0JBQWtCLDREQUFVO0FBQzVCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUFVLG1FQUFtRTtBQUM3RSxpQkFBaUIsZ0VBQVc7QUFDNUI7QUFDQSxrQ0FBa0MseUJBQXlCLElBQUk7QUFDL0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWEsNERBQVM7QUFDdEI7QUFDQSxPQUFPO0FBQ1AsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxHQUFHO0FBQ0gsVUFBVSwwQkFBMEI7QUFDcEM7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQSxLQUFLO0FBQ0w7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBOztBQUVBO0FBQ0E7QUFDQSxVQUFVLCtCQUErQjtBQUN6QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFlBQVk7QUFDWjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsT0FBTztBQUNQO0FBQ0E7QUFDQSxpRUFBaUUscUJBQXFCO0FBQ3RGO0FBQ0E7QUFDQTtBQUNBLGdCQUFnQixnREFBZ0Q7QUFDaEU7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxXQUFXO0FBQ1g7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLGFBQWE7QUFDYjtBQUNBLFNBQVM7QUFDVDtBQUNBLEtBQUs7QUFDTDtBQUNBO0FBQ0E7O0FBRTZEIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxzaGFyZWRcXGJldHRlci1hdXRoLkQ3Tmk4cl96Lm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBjcmVhdGVGZXRjaCB9IGZyb20gJ0BiZXR0ZXItZmV0Y2gvZmV0Y2gnO1xuaW1wb3J0IHsgYSBhcyBnZXRCYXNlVVJMIH0gZnJvbSAnLi9iZXR0ZXItYXV0aC5DdVNfZURkSy5tanMnO1xuaW1wb3J0IHsgYXRvbSB9IGZyb20gJ25hbm9zdG9yZXMnO1xuaW1wb3J0IHsgdSBhcyB1c2VBdXRoUXVlcnkgfSBmcm9tICcuL2JldHRlci1hdXRoLkNrR3NncnZ2Lm1qcyc7XG5pbXBvcnQgeyBwIGFzIHBhcnNlSlNPTiB9IGZyb20gJy4vYmV0dGVyLWF1dGguZmZXZWc1MHcubWpzJztcblxuY29uc3QgcmVkaXJlY3RQbHVnaW4gPSB7XG4gIGlkOiBcInJlZGlyZWN0XCIsXG4gIG5hbWU6IFwiUmVkaXJlY3RcIixcbiAgaG9va3M6IHtcbiAgICBvblN1Y2Nlc3MoY29udGV4dCkge1xuICAgICAgaWYgKGNvbnRleHQuZGF0YT8udXJsICYmIGNvbnRleHQuZGF0YT8ucmVkaXJlY3QpIHtcbiAgICAgICAgaWYgKHR5cGVvZiB3aW5kb3cgIT09IFwidW5kZWZpbmVkXCIgJiYgd2luZG93LmxvY2F0aW9uKSB7XG4gICAgICAgICAgaWYgKHdpbmRvdy5sb2NhdGlvbikge1xuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBjb250ZXh0LmRhdGEudXJsO1xuICAgICAgICAgICAgfSBjYXRjaCB7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfVxuICAgICAgICB9XG4gICAgICB9XG4gICAgfVxuICB9XG59O1xuXG5mdW5jdGlvbiBnZXRTZXNzaW9uQXRvbSgkZmV0Y2gpIHtcbiAgY29uc3QgJHNpZ25hbCA9IGF0b20oZmFsc2UpO1xuICBjb25zdCBzZXNzaW9uID0gdXNlQXV0aFF1ZXJ5KCRzaWduYWwsIFwiL2dldC1zZXNzaW9uXCIsICRmZXRjaCwge1xuICAgIG1ldGhvZDogXCJHRVRcIlxuICB9KTtcbiAgcmV0dXJuIHtcbiAgICBzZXNzaW9uLFxuICAgICRzZXNzaW9uU2lnbmFsOiAkc2lnbmFsXG4gIH07XG59XG5cbmNvbnN0IGdldENsaWVudENvbmZpZyA9IChvcHRpb25zKSA9PiB7XG4gIGNvbnN0IGlzQ3JlZGVudGlhbHNTdXBwb3J0ZWQgPSBcImNyZWRlbnRpYWxzXCIgaW4gUmVxdWVzdC5wcm90b3R5cGU7XG4gIGNvbnN0IGJhc2VVUkwgPSBnZXRCYXNlVVJMKG9wdGlvbnM/LmJhc2VVUkwsIG9wdGlvbnM/LmJhc2VQYXRoKTtcbiAgY29uc3QgcGx1Z2luc0ZldGNoUGx1Z2lucyA9IG9wdGlvbnM/LnBsdWdpbnM/LmZsYXRNYXAoKHBsdWdpbikgPT4gcGx1Z2luLmZldGNoUGx1Z2lucykuZmlsdGVyKChwbCkgPT4gcGwgIT09IHZvaWQgMCkgfHwgW107XG4gIGNvbnN0IGxpZmVDeWNsZVBsdWdpbiA9IHtcbiAgICBpZDogXCJsaWZlY3ljbGUtaG9va3NcIixcbiAgICBuYW1lOiBcImxpZmVjeWNsZS1ob29rc1wiLFxuICAgIGhvb2tzOiB7XG4gICAgICBvblN1Y2Nlc3M6IG9wdGlvbnM/LmZldGNoT3B0aW9ucz8ub25TdWNjZXNzLFxuICAgICAgb25FcnJvcjogb3B0aW9ucz8uZmV0Y2hPcHRpb25zPy5vbkVycm9yLFxuICAgICAgb25SZXF1ZXN0OiBvcHRpb25zPy5mZXRjaE9wdGlvbnM/Lm9uUmVxdWVzdCxcbiAgICAgIG9uUmVzcG9uc2U6IG9wdGlvbnM/LmZldGNoT3B0aW9ucz8ub25SZXNwb25zZVxuICAgIH1cbiAgfTtcbiAgY29uc3QgeyBvblN1Y2Nlc3MsIG9uRXJyb3IsIG9uUmVxdWVzdCwgb25SZXNwb25zZSwgLi4ucmVzdE9mRmV0Y2hPcHRpb25zIH0gPSBvcHRpb25zPy5mZXRjaE9wdGlvbnMgfHwge307XG4gIGNvbnN0ICRmZXRjaCA9IGNyZWF0ZUZldGNoKHtcbiAgICBiYXNlVVJMLFxuICAgIC4uLmlzQ3JlZGVudGlhbHNTdXBwb3J0ZWQgPyB7IGNyZWRlbnRpYWxzOiBcImluY2x1ZGVcIiB9IDoge30sXG4gICAgbWV0aG9kOiBcIkdFVFwiLFxuICAgIGpzb25QYXJzZXIodGV4dCkge1xuICAgICAgaWYgKCF0ZXh0KSB7XG4gICAgICAgIHJldHVybiBudWxsO1xuICAgICAgfVxuICAgICAgcmV0dXJuIHBhcnNlSlNPTih0ZXh0LCB7XG4gICAgICAgIHN0cmljdDogZmFsc2VcbiAgICAgIH0pO1xuICAgIH0sXG4gICAgY3VzdG9tRmV0Y2hJbXBsOiBmZXRjaCxcbiAgICAuLi5yZXN0T2ZGZXRjaE9wdGlvbnMsXG4gICAgcGx1Z2luczogW1xuICAgICAgbGlmZUN5Y2xlUGx1Z2luLFxuICAgICAgLi4ucmVzdE9mRmV0Y2hPcHRpb25zLnBsdWdpbnMgfHwgW10sXG4gICAgICAuLi5vcHRpb25zPy5kaXNhYmxlRGVmYXVsdEZldGNoUGx1Z2lucyA/IFtdIDogW3JlZGlyZWN0UGx1Z2luXSxcbiAgICAgIC4uLnBsdWdpbnNGZXRjaFBsdWdpbnNcbiAgICBdXG4gIH0pO1xuICBjb25zdCB7ICRzZXNzaW9uU2lnbmFsLCBzZXNzaW9uIH0gPSBnZXRTZXNzaW9uQXRvbSgkZmV0Y2gpO1xuICBjb25zdCBwbHVnaW5zID0gb3B0aW9ucz8ucGx1Z2lucyB8fCBbXTtcbiAgbGV0IHBsdWdpbnNBY3Rpb25zID0ge307XG4gIGxldCBwbHVnaW5zQXRvbXMgPSB7XG4gICAgJHNlc3Npb25TaWduYWwsXG4gICAgc2Vzc2lvblxuICB9O1xuICBsZXQgcGx1Z2luUGF0aE1ldGhvZHMgPSB7XG4gICAgXCIvc2lnbi1vdXRcIjogXCJQT1NUXCIsXG4gICAgXCIvcmV2b2tlLXNlc3Npb25zXCI6IFwiUE9TVFwiLFxuICAgIFwiL3Jldm9rZS1vdGhlci1zZXNzaW9uc1wiOiBcIlBPU1RcIixcbiAgICBcIi9kZWxldGUtdXNlclwiOiBcIlBPU1RcIlxuICB9O1xuICBjb25zdCBhdG9tTGlzdGVuZXJzID0gW1xuICAgIHtcbiAgICAgIHNpZ25hbDogXCIkc2Vzc2lvblNpZ25hbFwiLFxuICAgICAgbWF0Y2hlcihwYXRoKSB7XG4gICAgICAgIHJldHVybiBwYXRoID09PSBcIi9zaWduLW91dFwiIHx8IHBhdGggPT09IFwiL3VwZGF0ZS11c2VyXCIgfHwgcGF0aC5zdGFydHNXaXRoKFwiL3NpZ24taW5cIikgfHwgcGF0aC5zdGFydHNXaXRoKFwiL3NpZ24tdXBcIikgfHwgcGF0aCA9PT0gXCIvZGVsZXRlLXVzZXJcIiB8fCBwYXRoID09PSBcIi92ZXJpZnktZW1haWxcIjtcbiAgICAgIH1cbiAgICB9XG4gIF07XG4gIGZvciAoY29uc3QgcGx1Z2luIG9mIHBsdWdpbnMpIHtcbiAgICBpZiAocGx1Z2luLmdldEF0b21zKSB7XG4gICAgICBPYmplY3QuYXNzaWduKHBsdWdpbnNBdG9tcywgcGx1Z2luLmdldEF0b21zPy4oJGZldGNoKSk7XG4gICAgfVxuICAgIGlmIChwbHVnaW4ucGF0aE1ldGhvZHMpIHtcbiAgICAgIE9iamVjdC5hc3NpZ24ocGx1Z2luUGF0aE1ldGhvZHMsIHBsdWdpbi5wYXRoTWV0aG9kcyk7XG4gICAgfVxuICAgIGlmIChwbHVnaW4uYXRvbUxpc3RlbmVycykge1xuICAgICAgYXRvbUxpc3RlbmVycy5wdXNoKC4uLnBsdWdpbi5hdG9tTGlzdGVuZXJzKTtcbiAgICB9XG4gIH1cbiAgY29uc3QgJHN0b3JlID0ge1xuICAgIG5vdGlmeTogKHNpZ25hbCkgPT4ge1xuICAgICAgcGx1Z2luc0F0b21zW3NpZ25hbF0uc2V0KFxuICAgICAgICAhcGx1Z2luc0F0b21zW3NpZ25hbF0uZ2V0KClcbiAgICAgICk7XG4gICAgfSxcbiAgICBsaXN0ZW46IChzaWduYWwsIGxpc3RlbmVyKSA9PiB7XG4gICAgICBwbHVnaW5zQXRvbXNbc2lnbmFsXS5zdWJzY3JpYmUobGlzdGVuZXIpO1xuICAgIH0sXG4gICAgYXRvbXM6IHBsdWdpbnNBdG9tc1xuICB9O1xuICBmb3IgKGNvbnN0IHBsdWdpbiBvZiBwbHVnaW5zKSB7XG4gICAgaWYgKHBsdWdpbi5nZXRBY3Rpb25zKSB7XG4gICAgICBPYmplY3QuYXNzaWduKFxuICAgICAgICBwbHVnaW5zQWN0aW9ucyxcbiAgICAgICAgcGx1Z2luLmdldEFjdGlvbnM/LigkZmV0Y2gsICRzdG9yZSwgb3B0aW9ucylcbiAgICAgICk7XG4gICAgfVxuICB9XG4gIHJldHVybiB7XG4gICAgcGx1Z2luc0FjdGlvbnMsXG4gICAgcGx1Z2luc0F0b21zLFxuICAgIHBsdWdpblBhdGhNZXRob2RzLFxuICAgIGF0b21MaXN0ZW5lcnMsXG4gICAgJGZldGNoLFxuICAgICRzdG9yZVxuICB9O1xufTtcblxuZnVuY3Rpb24gaXNBdG9tKHZhbHVlKSB7XG4gIHJldHVybiB0eXBlb2YgdmFsdWUgPT09IFwib2JqZWN0XCIgJiYgdmFsdWUgIT09IG51bGwgJiYgXCJnZXRcIiBpbiB2YWx1ZSAmJiB0eXBlb2YgdmFsdWUuZ2V0ID09PSBcImZ1bmN0aW9uXCIgJiYgXCJsY1wiIGluIHZhbHVlICYmIHR5cGVvZiB2YWx1ZS5sYyA9PT0gXCJudW1iZXJcIjtcbn1cblxuZnVuY3Rpb24gZ2V0TWV0aG9kKHBhdGgsIGtub3duUGF0aE1ldGhvZHMsIGFyZ3MpIHtcbiAgY29uc3QgbWV0aG9kID0ga25vd25QYXRoTWV0aG9kc1twYXRoXTtcbiAgY29uc3QgeyBmZXRjaE9wdGlvbnMsIHF1ZXJ5LCAuLi5ib2R5IH0gPSBhcmdzIHx8IHt9O1xuICBpZiAobWV0aG9kKSB7XG4gICAgcmV0dXJuIG1ldGhvZDtcbiAgfVxuICBpZiAoZmV0Y2hPcHRpb25zPy5tZXRob2QpIHtcbiAgICByZXR1cm4gZmV0Y2hPcHRpb25zLm1ldGhvZDtcbiAgfVxuICBpZiAoYm9keSAmJiBPYmplY3Qua2V5cyhib2R5KS5sZW5ndGggPiAwKSB7XG4gICAgcmV0dXJuIFwiUE9TVFwiO1xuICB9XG4gIHJldHVybiBcIkdFVFwiO1xufVxuZnVuY3Rpb24gY3JlYXRlRHluYW1pY1BhdGhQcm94eShyb3V0ZXMsIGNsaWVudCwga25vd25QYXRoTWV0aG9kcywgYXRvbXMsIGF0b21MaXN0ZW5lcnMpIHtcbiAgZnVuY3Rpb24gY3JlYXRlUHJveHkocGF0aCA9IFtdKSB7XG4gICAgcmV0dXJuIG5ldyBQcm94eShmdW5jdGlvbigpIHtcbiAgICB9LCB7XG4gICAgICBnZXQodGFyZ2V0LCBwcm9wKSB7XG4gICAgICAgIGlmIChwcm9wID09PSBcInRoZW5cIiB8fCBwcm9wID09PSBcImNhdGNoXCIgfHwgcHJvcCA9PT0gXCJmaW5hbGx5XCIpIHtcbiAgICAgICAgICByZXR1cm4gdm9pZCAwO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IGZ1bGxQYXRoID0gWy4uLnBhdGgsIHByb3BdO1xuICAgICAgICBsZXQgY3VycmVudCA9IHJvdXRlcztcbiAgICAgICAgZm9yIChjb25zdCBzZWdtZW50IG9mIGZ1bGxQYXRoKSB7XG4gICAgICAgICAgaWYgKGN1cnJlbnQgJiYgdHlwZW9mIGN1cnJlbnQgPT09IFwib2JqZWN0XCIgJiYgc2VnbWVudCBpbiBjdXJyZW50KSB7XG4gICAgICAgICAgICBjdXJyZW50ID0gY3VycmVudFtzZWdtZW50XTtcbiAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgY3VycmVudCA9IHZvaWQgMDtcbiAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIGN1cnJlbnQgPT09IFwiZnVuY3Rpb25cIikge1xuICAgICAgICAgIHJldHVybiBjdXJyZW50O1xuICAgICAgICB9XG4gICAgICAgIGlmIChpc0F0b20oY3VycmVudCkpIHtcbiAgICAgICAgICByZXR1cm4gY3VycmVudDtcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gY3JlYXRlUHJveHkoZnVsbFBhdGgpO1xuICAgICAgfSxcbiAgICAgIGFwcGx5OiBhc3luYyAoXywgX18sIGFyZ3MpID0+IHtcbiAgICAgICAgY29uc3Qgcm91dGVQYXRoID0gXCIvXCIgKyBwYXRoLm1hcChcbiAgICAgICAgICAoc2VnbWVudCkgPT4gc2VnbWVudC5yZXBsYWNlKC9bQS1aXS9nLCAobGV0dGVyKSA9PiBgLSR7bGV0dGVyLnRvTG93ZXJDYXNlKCl9YClcbiAgICAgICAgKS5qb2luKFwiL1wiKTtcbiAgICAgICAgY29uc3QgYXJnID0gYXJnc1swXSB8fCB7fTtcbiAgICAgICAgY29uc3QgZmV0Y2hPcHRpb25zID0gYXJnc1sxXSB8fCB7fTtcbiAgICAgICAgY29uc3QgeyBxdWVyeSwgZmV0Y2hPcHRpb25zOiBhcmdGZXRjaE9wdGlvbnMsIC4uLmJvZHkgfSA9IGFyZztcbiAgICAgICAgY29uc3Qgb3B0aW9ucyA9IHtcbiAgICAgICAgICAuLi5mZXRjaE9wdGlvbnMsXG4gICAgICAgICAgLi4uYXJnRmV0Y2hPcHRpb25zXG4gICAgICAgIH07XG4gICAgICAgIGNvbnN0IG1ldGhvZCA9IGdldE1ldGhvZChyb3V0ZVBhdGgsIGtub3duUGF0aE1ldGhvZHMsIGFyZyk7XG4gICAgICAgIHJldHVybiBhd2FpdCBjbGllbnQocm91dGVQYXRoLCB7XG4gICAgICAgICAgLi4ub3B0aW9ucyxcbiAgICAgICAgICBib2R5OiBtZXRob2QgPT09IFwiR0VUXCIgPyB2b2lkIDAgOiB7XG4gICAgICAgICAgICAuLi5ib2R5LFxuICAgICAgICAgICAgLi4ub3B0aW9ucz8uYm9keSB8fCB7fVxuICAgICAgICAgIH0sXG4gICAgICAgICAgcXVlcnk6IHF1ZXJ5IHx8IG9wdGlvbnM/LnF1ZXJ5LFxuICAgICAgICAgIG1ldGhvZCxcbiAgICAgICAgICBhc3luYyBvblN1Y2Nlc3MoY29udGV4dCkge1xuICAgICAgICAgICAgYXdhaXQgb3B0aW9ucz8ub25TdWNjZXNzPy4oY29udGV4dCk7XG4gICAgICAgICAgICBjb25zdCBtYXRjaGVzID0gYXRvbUxpc3RlbmVycz8uZmluZCgocykgPT4gcy5tYXRjaGVyKHJvdXRlUGF0aCkpO1xuICAgICAgICAgICAgaWYgKCFtYXRjaGVzKSByZXR1cm47XG4gICAgICAgICAgICBjb25zdCBzaWduYWwgPSBhdG9tc1ttYXRjaGVzLnNpZ25hbF07XG4gICAgICAgICAgICBpZiAoIXNpZ25hbCkgcmV0dXJuO1xuICAgICAgICAgICAgY29uc3QgdmFsID0gc2lnbmFsLmdldCgpO1xuICAgICAgICAgICAgc2V0VGltZW91dCgoKSA9PiB7XG4gICAgICAgICAgICAgIHNpZ25hbC5zZXQoIXZhbCk7XG4gICAgICAgICAgICB9LCAxMCk7XG4gICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxuICByZXR1cm4gY3JlYXRlUHJveHkoKTtcbn1cblxuZXhwb3J0IHsgY3JlYXRlRHluYW1pY1BhdGhQcm94eSBhcyBjLCBnZXRDbGllbnRDb25maWcgYXMgZyB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/better-auth/dist/shared/better-auth.D7Ni8r_z.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/better-auth/dist/shared/better-auth.DdzSJf-n.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.DdzSJf-n.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   B: () => (/* binding */ BetterAuthError),\n/* harmony export */   M: () => (/* binding */ MissingDependencyError)\n/* harmony export */ });\nclass BetterAuthError extends Error {\n  constructor(message, cause) {\n    super(message);\n    this.name = \"BetterAuthError\";\n    this.message = message;\n    this.cause = cause;\n    this.stack = \"\";\n  }\n}\nclass MissingDependencyError extends BetterAuthError {\n  constructor(pkgName) {\n    super(\n      `The package \"${pkgName}\" is required. Make sure it is installed.`,\n      pkgName\n    );\n  }\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguRGR6U0pmLW4ubWpzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0JBQXNCLFFBQVE7QUFDOUI7QUFDQTtBQUNBO0FBQ0E7O0FBRTZEIiwic291cmNlcyI6WyJDOlxcVXNlcnNcXGF0aGFydmFcXERlc2t0b3BcXFN3YXN0aEFJXFxub2RlX21vZHVsZXNcXGJldHRlci1hdXRoXFxkaXN0XFxzaGFyZWRcXGJldHRlci1hdXRoLkRkelNKZi1uLm1qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJjbGFzcyBCZXR0ZXJBdXRoRXJyb3IgZXh0ZW5kcyBFcnJvciB7XG4gIGNvbnN0cnVjdG9yKG1lc3NhZ2UsIGNhdXNlKSB7XG4gICAgc3VwZXIobWVzc2FnZSk7XG4gICAgdGhpcy5uYW1lID0gXCJCZXR0ZXJBdXRoRXJyb3JcIjtcbiAgICB0aGlzLm1lc3NhZ2UgPSBtZXNzYWdlO1xuICAgIHRoaXMuY2F1c2UgPSBjYXVzZTtcbiAgICB0aGlzLnN0YWNrID0gXCJcIjtcbiAgfVxufVxuY2xhc3MgTWlzc2luZ0RlcGVuZGVuY3lFcnJvciBleHRlbmRzIEJldHRlckF1dGhFcnJvciB7XG4gIGNvbnN0cnVjdG9yKHBrZ05hbWUpIHtcbiAgICBzdXBlcihcbiAgICAgIGBUaGUgcGFja2FnZSBcIiR7cGtnTmFtZX1cIiBpcyByZXF1aXJlZC4gTWFrZSBzdXJlIGl0IGlzIGluc3RhbGxlZC5gLFxuICAgICAgcGtnTmFtZVxuICAgICk7XG4gIH1cbn1cblxuZXhwb3J0IHsgQmV0dGVyQXV0aEVycm9yIGFzIEIsIE1pc3NpbmdEZXBlbmRlbmN5RXJyb3IgYXMgTSB9O1xuIl0sIm5hbWVzIjpbXSwiaWdub3JlTGlzdCI6WzBdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/better-auth/dist/shared/better-auth.DdzSJf-n.mjs\n");

/***/ }),

/***/ "(ssr)/./node_modules/better-auth/dist/shared/better-auth.ffWeg50w.mjs":
/*!***********************************************************************!*\
  !*** ./node_modules/better-auth/dist/shared/better-auth.ffWeg50w.mjs ***!
  \***********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   p: () => (/* binding */ parseJSON)\n/* harmony export */ });\nconst PROTO_POLLUTION_PATTERNS = {\n  proto: /\"(?:_|\\\\u0{2}5[Ff]){2}(?:p|\\\\u0{2}70)(?:r|\\\\u0{2}72)(?:o|\\\\u0{2}6[Ff])(?:t|\\\\u0{2}74)(?:o|\\\\u0{2}6[Ff])(?:_|\\\\u0{2}5[Ff]){2}\"\\s*:/,\n  constructor: /\"(?:c|\\\\u0063)(?:o|\\\\u006[Ff])(?:n|\\\\u006[Ee])(?:s|\\\\u0073)(?:t|\\\\u0074)(?:r|\\\\u0072)(?:u|\\\\u0075)(?:c|\\\\u0063)(?:t|\\\\u0074)(?:o|\\\\u006[Ff])(?:r|\\\\u0072)\"\\s*:/,\n  protoShort: /\"__proto__\"\\s*:/,\n  constructorShort: /\"constructor\"\\s*:/\n};\nconst JSON_SIGNATURE = /^\\s*[\"[{]|^\\s*-?\\d{1,16}(\\.\\d{1,17})?([Ee][+-]?\\d+)?\\s*$/;\nconst SPECIAL_VALUES = {\n  true: true,\n  false: false,\n  null: null,\n  undefined: void 0,\n  nan: Number.NaN,\n  infinity: Number.POSITIVE_INFINITY,\n  \"-infinity\": Number.NEGATIVE_INFINITY\n};\nconst ISO_DATE_REGEX = /^(\\d{4})-(\\d{2})-(\\d{2})T(\\d{2}):(\\d{2}):(\\d{2})(?:\\.(\\d{1,7}))?(?:Z|([+-])(\\d{2}):(\\d{2}))$/;\nfunction isValidDate(date) {\n  return date instanceof Date && !isNaN(date.getTime());\n}\nfunction parseISODate(value) {\n  const match = ISO_DATE_REGEX.exec(value);\n  if (!match) return null;\n  const [\n    ,\n    year,\n    month,\n    day,\n    hour,\n    minute,\n    second,\n    ms,\n    offsetSign,\n    offsetHour,\n    offsetMinute\n  ] = match;\n  let date = new Date(\n    Date.UTC(\n      parseInt(year, 10),\n      parseInt(month, 10) - 1,\n      parseInt(day, 10),\n      parseInt(hour, 10),\n      parseInt(minute, 10),\n      parseInt(second, 10),\n      ms ? parseInt(ms.padEnd(3, \"0\"), 10) : 0\n    )\n  );\n  if (offsetSign) {\n    const offset = (parseInt(offsetHour, 10) * 60 + parseInt(offsetMinute, 10)) * (offsetSign === \"+\" ? -1 : 1);\n    date.setUTCMinutes(date.getUTCMinutes() + offset);\n  }\n  return isValidDate(date) ? date : null;\n}\nfunction betterJSONParse(value, options = {}) {\n  const {\n    strict = false,\n    warnings = false,\n    reviver,\n    parseDates = true\n  } = options;\n  if (typeof value !== \"string\") {\n    return value;\n  }\n  const trimmed = value.trim();\n  if (trimmed[0] === '\"' && trimmed.endsWith('\"') && !trimmed.slice(1, -1).includes('\"')) {\n    return trimmed.slice(1, -1);\n  }\n  const lowerValue = trimmed.toLowerCase();\n  if (lowerValue.length <= 9 && lowerValue in SPECIAL_VALUES) {\n    return SPECIAL_VALUES[lowerValue];\n  }\n  if (!JSON_SIGNATURE.test(trimmed)) {\n    if (strict) {\n      throw new SyntaxError(\"[better-json] Invalid JSON\");\n    }\n    return value;\n  }\n  const hasProtoPattern = Object.entries(PROTO_POLLUTION_PATTERNS).some(\n    ([key, pattern]) => {\n      const matches = pattern.test(trimmed);\n      if (matches && warnings) {\n        console.warn(\n          `[better-json] Detected potential prototype pollution attempt using ${key} pattern`\n        );\n      }\n      return matches;\n    }\n  );\n  if (hasProtoPattern && strict) {\n    throw new Error(\n      \"[better-json] Potential prototype pollution attempt detected\"\n    );\n  }\n  try {\n    const secureReviver = (key, value2) => {\n      if (key === \"__proto__\" || key === \"constructor\" && value2 && typeof value2 === \"object\" && \"prototype\" in value2) {\n        if (warnings) {\n          console.warn(\n            `[better-json] Dropping \"${key}\" key to prevent prototype pollution`\n          );\n        }\n        return void 0;\n      }\n      if (parseDates && typeof value2 === \"string\") {\n        const date = parseISODate(value2);\n        if (date) {\n          return date;\n        }\n      }\n      return reviver ? reviver(key, value2) : value2;\n    };\n    return JSON.parse(trimmed, secureReviver);\n  } catch (error) {\n    if (strict) {\n      throw error;\n    }\n    return value;\n  }\n}\nfunction parseJSON(value, options = { strict: true }) {\n  return betterJSONParse(value, options);\n}\n\n\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKHNzcikvLi9ub2RlX21vZHVsZXMvYmV0dGVyLWF1dGgvZGlzdC9zaGFyZWQvYmV0dGVyLWF1dGguZmZXZWc1MHcubWpzIiwibWFwcGluZ3MiOiI7Ozs7QUFBQTtBQUNBLHFCQUFxQixFQUFFLE9BQU8sRUFBRSxVQUFVLEVBQUUsYUFBYSxFQUFFLGFBQWEsRUFBRSxnQkFBZ0IsRUFBRSxhQUFhLEVBQUUsZ0JBQWdCLEVBQUUsT0FBTyxFQUFFO0FBQ3RJO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0NBQWdDLFdBQVcsS0FBSyxNQUFNLEtBQUs7QUFDM0Q7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsNkJBQTZCLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxNQUFNLEVBQUUsTUFBTSxFQUFFLE1BQU0sRUFBRSxVQUFVLElBQUksa0JBQWtCLEVBQUUsTUFBTSxFQUFFO0FBQ2pIO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLDRDQUE0QztBQUM1QztBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsSUFBSTtBQUNKO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsZ0ZBQWdGLEtBQUs7QUFDckY7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsdUNBQXVDLElBQUk7QUFDM0M7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxJQUFJO0FBQ0o7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0Esc0NBQXNDLGNBQWM7QUFDcEQ7QUFDQTs7QUFFMEIiLCJzb3VyY2VzIjpbIkM6XFxVc2Vyc1xcYXRoYXJ2YVxcRGVza3RvcFxcU3dhc3RoQUlcXG5vZGVfbW9kdWxlc1xcYmV0dGVyLWF1dGhcXGRpc3RcXHNoYXJlZFxcYmV0dGVyLWF1dGguZmZXZWc1MHcubWpzIl0sInNvdXJjZXNDb250ZW50IjpbImNvbnN0IFBST1RPX1BPTExVVElPTl9QQVRURVJOUyA9IHtcbiAgcHJvdG86IC9cIig/Ol98XFxcXHUwezJ9NVtGZl0pezJ9KD86cHxcXFxcdTB7Mn03MCkoPzpyfFxcXFx1MHsyfTcyKSg/Om98XFxcXHUwezJ9NltGZl0pKD86dHxcXFxcdTB7Mn03NCkoPzpvfFxcXFx1MHsyfTZbRmZdKSg/Ol98XFxcXHUwezJ9NVtGZl0pezJ9XCJcXHMqOi8sXG4gIGNvbnN0cnVjdG9yOiAvXCIoPzpjfFxcXFx1MDA2MykoPzpvfFxcXFx1MDA2W0ZmXSkoPzpufFxcXFx1MDA2W0VlXSkoPzpzfFxcXFx1MDA3MykoPzp0fFxcXFx1MDA3NCkoPzpyfFxcXFx1MDA3MikoPzp1fFxcXFx1MDA3NSkoPzpjfFxcXFx1MDA2MykoPzp0fFxcXFx1MDA3NCkoPzpvfFxcXFx1MDA2W0ZmXSkoPzpyfFxcXFx1MDA3MilcIlxccyo6LyxcbiAgcHJvdG9TaG9ydDogL1wiX19wcm90b19fXCJcXHMqOi8sXG4gIGNvbnN0cnVjdG9yU2hvcnQ6IC9cImNvbnN0cnVjdG9yXCJcXHMqOi9cbn07XG5jb25zdCBKU09OX1NJR05BVFVSRSA9IC9eXFxzKltcIlt7XXxeXFxzKi0/XFxkezEsMTZ9KFxcLlxcZHsxLDE3fSk/KFtFZV1bKy1dP1xcZCspP1xccyokLztcbmNvbnN0IFNQRUNJQUxfVkFMVUVTID0ge1xuICB0cnVlOiB0cnVlLFxuICBmYWxzZTogZmFsc2UsXG4gIG51bGw6IG51bGwsXG4gIHVuZGVmaW5lZDogdm9pZCAwLFxuICBuYW46IE51bWJlci5OYU4sXG4gIGluZmluaXR5OiBOdW1iZXIuUE9TSVRJVkVfSU5GSU5JVFksXG4gIFwiLWluZmluaXR5XCI6IE51bWJlci5ORUdBVElWRV9JTkZJTklUWVxufTtcbmNvbnN0IElTT19EQVRFX1JFR0VYID0gL14oXFxkezR9KS0oXFxkezJ9KS0oXFxkezJ9KVQoXFxkezJ9KTooXFxkezJ9KTooXFxkezJ9KSg/OlxcLihcXGR7MSw3fSkpPyg/Olp8KFsrLV0pKFxcZHsyfSk6KFxcZHsyfSkpJC87XG5mdW5jdGlvbiBpc1ZhbGlkRGF0ZShkYXRlKSB7XG4gIHJldHVybiBkYXRlIGluc3RhbmNlb2YgRGF0ZSAmJiAhaXNOYU4oZGF0ZS5nZXRUaW1lKCkpO1xufVxuZnVuY3Rpb24gcGFyc2VJU09EYXRlKHZhbHVlKSB7XG4gIGNvbnN0IG1hdGNoID0gSVNPX0RBVEVfUkVHRVguZXhlYyh2YWx1ZSk7XG4gIGlmICghbWF0Y2gpIHJldHVybiBudWxsO1xuICBjb25zdCBbXG4gICAgLFxuICAgIHllYXIsXG4gICAgbW9udGgsXG4gICAgZGF5LFxuICAgIGhvdXIsXG4gICAgbWludXRlLFxuICAgIHNlY29uZCxcbiAgICBtcyxcbiAgICBvZmZzZXRTaWduLFxuICAgIG9mZnNldEhvdXIsXG4gICAgb2Zmc2V0TWludXRlXG4gIF0gPSBtYXRjaDtcbiAgbGV0IGRhdGUgPSBuZXcgRGF0ZShcbiAgICBEYXRlLlVUQyhcbiAgICAgIHBhcnNlSW50KHllYXIsIDEwKSxcbiAgICAgIHBhcnNlSW50KG1vbnRoLCAxMCkgLSAxLFxuICAgICAgcGFyc2VJbnQoZGF5LCAxMCksXG4gICAgICBwYXJzZUludChob3VyLCAxMCksXG4gICAgICBwYXJzZUludChtaW51dGUsIDEwKSxcbiAgICAgIHBhcnNlSW50KHNlY29uZCwgMTApLFxuICAgICAgbXMgPyBwYXJzZUludChtcy5wYWRFbmQoMywgXCIwXCIpLCAxMCkgOiAwXG4gICAgKVxuICApO1xuICBpZiAob2Zmc2V0U2lnbikge1xuICAgIGNvbnN0IG9mZnNldCA9IChwYXJzZUludChvZmZzZXRIb3VyLCAxMCkgKiA2MCArIHBhcnNlSW50KG9mZnNldE1pbnV0ZSwgMTApKSAqIChvZmZzZXRTaWduID09PSBcIitcIiA/IC0xIDogMSk7XG4gICAgZGF0ZS5zZXRVVENNaW51dGVzKGRhdGUuZ2V0VVRDTWludXRlcygpICsgb2Zmc2V0KTtcbiAgfVxuICByZXR1cm4gaXNWYWxpZERhdGUoZGF0ZSkgPyBkYXRlIDogbnVsbDtcbn1cbmZ1bmN0aW9uIGJldHRlckpTT05QYXJzZSh2YWx1ZSwgb3B0aW9ucyA9IHt9KSB7XG4gIGNvbnN0IHtcbiAgICBzdHJpY3QgPSBmYWxzZSxcbiAgICB3YXJuaW5ncyA9IGZhbHNlLFxuICAgIHJldml2ZXIsXG4gICAgcGFyc2VEYXRlcyA9IHRydWVcbiAgfSA9IG9wdGlvbnM7XG4gIGlmICh0eXBlb2YgdmFsdWUgIT09IFwic3RyaW5nXCIpIHtcbiAgICByZXR1cm4gdmFsdWU7XG4gIH1cbiAgY29uc3QgdHJpbW1lZCA9IHZhbHVlLnRyaW0oKTtcbiAgaWYgKHRyaW1tZWRbMF0gPT09ICdcIicgJiYgdHJpbW1lZC5lbmRzV2l0aCgnXCInKSAmJiAhdHJpbW1lZC5zbGljZSgxLCAtMSkuaW5jbHVkZXMoJ1wiJykpIHtcbiAgICByZXR1cm4gdHJpbW1lZC5zbGljZSgxLCAtMSk7XG4gIH1cbiAgY29uc3QgbG93ZXJWYWx1ZSA9IHRyaW1tZWQudG9Mb3dlckNhc2UoKTtcbiAgaWYgKGxvd2VyVmFsdWUubGVuZ3RoIDw9IDkgJiYgbG93ZXJWYWx1ZSBpbiBTUEVDSUFMX1ZBTFVFUykge1xuICAgIHJldHVybiBTUEVDSUFMX1ZBTFVFU1tsb3dlclZhbHVlXTtcbiAgfVxuICBpZiAoIUpTT05fU0lHTkFUVVJFLnRlc3QodHJpbW1lZCkpIHtcbiAgICBpZiAoc3RyaWN0KSB7XG4gICAgICB0aHJvdyBuZXcgU3ludGF4RXJyb3IoXCJbYmV0dGVyLWpzb25dIEludmFsaWQgSlNPTlwiKTtcbiAgICB9XG4gICAgcmV0dXJuIHZhbHVlO1xuICB9XG4gIGNvbnN0IGhhc1Byb3RvUGF0dGVybiA9IE9iamVjdC5lbnRyaWVzKFBST1RPX1BPTExVVElPTl9QQVRURVJOUykuc29tZShcbiAgICAoW2tleSwgcGF0dGVybl0pID0+IHtcbiAgICAgIGNvbnN0IG1hdGNoZXMgPSBwYXR0ZXJuLnRlc3QodHJpbW1lZCk7XG4gICAgICBpZiAobWF0Y2hlcyAmJiB3YXJuaW5ncykge1xuICAgICAgICBjb25zb2xlLndhcm4oXG4gICAgICAgICAgYFtiZXR0ZXItanNvbl0gRGV0ZWN0ZWQgcG90ZW50aWFsIHByb3RvdHlwZSBwb2xsdXRpb24gYXR0ZW1wdCB1c2luZyAke2tleX0gcGF0dGVybmBcbiAgICAgICAgKTtcbiAgICAgIH1cbiAgICAgIHJldHVybiBtYXRjaGVzO1xuICAgIH1cbiAgKTtcbiAgaWYgKGhhc1Byb3RvUGF0dGVybiAmJiBzdHJpY3QpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICBcIltiZXR0ZXItanNvbl0gUG90ZW50aWFsIHByb3RvdHlwZSBwb2xsdXRpb24gYXR0ZW1wdCBkZXRlY3RlZFwiXG4gICAgKTtcbiAgfVxuICB0cnkge1xuICAgIGNvbnN0IHNlY3VyZVJldml2ZXIgPSAoa2V5LCB2YWx1ZTIpID0+IHtcbiAgICAgIGlmIChrZXkgPT09IFwiX19wcm90b19fXCIgfHwga2V5ID09PSBcImNvbnN0cnVjdG9yXCIgJiYgdmFsdWUyICYmIHR5cGVvZiB2YWx1ZTIgPT09IFwib2JqZWN0XCIgJiYgXCJwcm90b3R5cGVcIiBpbiB2YWx1ZTIpIHtcbiAgICAgICAgaWYgKHdhcm5pbmdzKSB7XG4gICAgICAgICAgY29uc29sZS53YXJuKFxuICAgICAgICAgICAgYFtiZXR0ZXItanNvbl0gRHJvcHBpbmcgXCIke2tleX1cIiBrZXkgdG8gcHJldmVudCBwcm90b3R5cGUgcG9sbHV0aW9uYFxuICAgICAgICAgICk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHZvaWQgMDtcbiAgICAgIH1cbiAgICAgIGlmIChwYXJzZURhdGVzICYmIHR5cGVvZiB2YWx1ZTIgPT09IFwic3RyaW5nXCIpIHtcbiAgICAgICAgY29uc3QgZGF0ZSA9IHBhcnNlSVNPRGF0ZSh2YWx1ZTIpO1xuICAgICAgICBpZiAoZGF0ZSkge1xuICAgICAgICAgIHJldHVybiBkYXRlO1xuICAgICAgICB9XG4gICAgICB9XG4gICAgICByZXR1cm4gcmV2aXZlciA/IHJldml2ZXIoa2V5LCB2YWx1ZTIpIDogdmFsdWUyO1xuICAgIH07XG4gICAgcmV0dXJuIEpTT04ucGFyc2UodHJpbW1lZCwgc2VjdXJlUmV2aXZlcik7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgaWYgKHN0cmljdCkge1xuICAgICAgdGhyb3cgZXJyb3I7XG4gICAgfVxuICAgIHJldHVybiB2YWx1ZTtcbiAgfVxufVxuZnVuY3Rpb24gcGFyc2VKU09OKHZhbHVlLCBvcHRpb25zID0geyBzdHJpY3Q6IHRydWUgfSkge1xuICByZXR1cm4gYmV0dGVySlNPTlBhcnNlKHZhbHVlLCBvcHRpb25zKTtcbn1cblxuZXhwb3J0IHsgcGFyc2VKU09OIGFzIHAgfTtcbiJdLCJuYW1lcyI6W10sImlnbm9yZUxpc3QiOlswXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(ssr)/./node_modules/better-auth/dist/shared/better-auth.ffWeg50w.mjs\n");

/***/ })

};
;